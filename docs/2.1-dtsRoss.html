<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>2.1 Deterministic, Discrete Time | Applied Malaria Dynamics</title>
  <meta name="description" content="2.1 Deterministic, Discrete Time | Applied Malaria Dynamics" />
  <meta name="generator" content="bookdown 0.39 and GitBook 2.6.7" />

  <meta property="og:title" content="2.1 Deterministic, Discrete Time | Applied Malaria Dynamics" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="2.1 Deterministic, Discrete Time | Applied Malaria Dynamics" />
  
  
  

<meta name="author" content="David L. Smith and the RAMP Team" />


<meta name="date" content="2024-06-10" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="2-basic-malaria-models.html"/>
<link rel="next" href="2.2-sdtsRoss.html"/>
<script src="assets/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="assets/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="assets/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="assets/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="assets/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Foreword</a>
<ul>
<li class="chapter" data-level="" data-path="contributors.html"><a href="contributors.html"><i class="fa fa-check"></i>Contributors</a></li>
</ul></li>
<li class="part"><span><b>I Introduction</b></span></li>
<li class="chapter" data-level="1" data-path="1-the-prevention-of-malaria.html"><a href="1-the-prevention-of-malaria.html"><i class="fa fa-check"></i><b>1</b> The Prevention of Malaria</a>
<ul>
<li class="chapter" data-level="1.1" data-path="1.1-the-quantitative-approach.html"><a href="1.1-the-quantitative-approach.html"><i class="fa fa-check"></i><b>1.1</b> The Quantitative Approach</a></li>
<li class="chapter" data-level="1.2" data-path="1.2-larval-source-management.html"><a href="1.2-larval-source-management.html"><i class="fa fa-check"></i><b>1.2</b> Larval Source Management</a></li>
<li class="chapter" data-level="1.3" data-path="1.3-malaria-population-dynamics.html"><a href="1.3-malaria-population-dynamics.html"><i class="fa fa-check"></i><b>1.3</b> Malaria Population Dynamics</a></li>
<li class="chapter" data-level="1.4" data-path="1.4-measuring-transmission.html"><a href="1.4-measuring-transmission.html"><i class="fa fa-check"></i><b>1.4</b> Measuring Transmission</a></li>
<li class="chapter" data-level="1.5" data-path="1.5-the-study-of-epidemics.html"><a href="1.5-the-study-of-epidemics.html"><i class="fa fa-check"></i><b>1.5</b> The Study of Epidemics</a></li>
<li class="chapter" data-level="1.6" data-path="1.6-mathematical-epidemiology.html"><a href="1.6-mathematical-epidemiology.html"><i class="fa fa-check"></i><b>1.6</b> Mathematical Epidemiology</a></li>
<li class="chapter" data-level="1.7" data-path="1.7-approaching-complexity.html"><a href="1.7-approaching-complexity.html"><i class="fa fa-check"></i><b>1.7</b> Approaching Complexity</a></li>
<li class="chapter" data-level="1.8" data-path="1.8-historical-notes.html"><a href="1.8-historical-notes.html"><i class="fa fa-check"></i><b>1.8</b> Historical Notes</a>
<ul>
<li class="chapter" data-level="1.8.1" data-path="1.8-historical-notes.html"><a href="1.8-historical-notes.html#the-light-microscope"><i class="fa fa-check"></i><b>1.8.1</b> The Light Microscope</a></li>
<li class="chapter" data-level="1.8.2" data-path="1.8-historical-notes.html"><a href="1.8-historical-notes.html#mathematical-epidemiology-before-ross"><i class="fa fa-check"></i><b>1.8.2</b> Mathematical Epidemiology Before Ross</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="2-basic-malaria-models.html"><a href="2-basic-malaria-models.html"><i class="fa fa-check"></i><b>2</b> Basic Malaria Models</a>
<ul>
<li class="chapter" data-level="2.1" data-path="2.1-dtsRoss.html"><a href="2.1-dtsRoss.html"><i class="fa fa-check"></i><b>2.1</b> Deterministic, Discrete Time</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="2.1-dtsRoss.html"><a href="2.1-dtsRoss.html#ross_dts_1"><i class="fa fa-check"></i><b>2.1.1</b> <code>ross_dts_1</code></a></li>
<li class="chapter" data-level="2.1.2" data-path="2.1-dtsRoss.html"><a href="2.1-dtsRoss.html#solving"><i class="fa fa-check"></i><b>2.1.2</b> Solving</a></li>
<li class="chapter" data-level="2.1.3" data-path="2.1-dtsRoss.html"><a href="2.1-dtsRoss.html#visualizing"><i class="fa fa-check"></i><b>2.1.3</b> Visualizing</a></li>
<li class="chapter" data-level="2.1.4" data-path="2.1-dtsRoss.html"><a href="2.1-dtsRoss.html#computation"><i class="fa fa-check"></i><b>2.1.4</b> Computation</a></li>
<li class="chapter" data-level="2.1.5" data-path="2.1-dtsRoss.html"><a href="2.1-dtsRoss.html#steady-states"><i class="fa fa-check"></i><b>2.1.5</b> Steady States</a></li>
<li class="chapter" data-level="2.1.6" data-path="2.1-dtsRoss.html"><a href="2.1-dtsRoss.html#thresholds"><i class="fa fa-check"></i><b>2.1.6</b> Thresholds</a></li>
<li class="chapter" data-level="2.1.7" data-path="2.1-dtsRoss.html"><a href="2.1-dtsRoss.html#verification"><i class="fa fa-check"></i><b>2.1.7</b> Verification</a></li>
<li class="chapter" data-level="2.1.8" data-path="2.1-dtsRoss.html"><a href="2.1-dtsRoss.html#numerical-instability"><i class="fa fa-check"></i><b>2.1.8</b> Numerical Instability</a></li>
<li class="chapter" data-level="2.1.9" data-path="2.1-dtsRoss.html"><a href="2.1-dtsRoss.html#dtsRoss2"><i class="fa fa-check"></i><b>2.1.9</b> <code>ross_dts_2</code></a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="2.2-sdtsRoss.html"><a href="2.2-sdtsRoss.html"><i class="fa fa-check"></i><b>2.2</b> Stochastic, Discrete Time</a></li>
<li class="chapter" data-level="2.3" data-path="2.3-xdeRoss.html"><a href="2.3-xdeRoss.html"><i class="fa fa-check"></i><b>2.3</b> Deterministic, Continuous Time</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="2.3-xdeRoss.html"><a href="2.3-xdeRoss.html#ross_xde"><i class="fa fa-check"></i><b>2.3.1</b> <code>ross_xde</code></a></li>
<li class="chapter" data-level="2.3.2" data-path="2.3-xdeRoss.html"><a href="2.3-xdeRoss.html#rates-vs.-proportions"><i class="fa fa-check"></i><b>2.3.2</b> Rates <em>vs.</em> Proportions</a></li>
<li class="chapter" data-level="2.3.3" data-path="2.3-xdeRoss.html"><a href="2.3-xdeRoss.html#solutions"><i class="fa fa-check"></i><b>2.3.3</b> Solutions</a></li>
<li class="chapter" data-level="2.3.4" data-path="2.3-xdeRoss.html"><a href="2.3-xdeRoss.html#computation-visualization"><i class="fa fa-check"></i><b>2.3.4</b> Computation &amp; Visualization</a></li>
<li class="chapter" data-level="2.3.5" data-path="2.3-xdeRoss.html"><a href="2.3-xdeRoss.html#steady-states-1"><i class="fa fa-check"></i><b>2.3.5</b> Steady States</a></li>
<li class="chapter" data-level="2.3.6" data-path="2.3-xdeRoss.html"><a href="2.3-xdeRoss.html#verification-1"><i class="fa fa-check"></i><b>2.3.6</b> Verification</a></li>
<li class="chapter" data-level="2.3.7" data-path="2.3-xdeRoss.html"><a href="2.3-xdeRoss.html#thresholds-1"><i class="fa fa-check"></i><b>2.3.7</b> Thresholds</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="2.4-sxdeRoss.html"><a href="2.4-sxdeRoss.html"><i class="fa fa-check"></i><b>2.4</b> Stochastic, Continuous Time</a></li>
<li class="chapter" data-level="2.5" data-path="2.5-mathSpecies.html"><a href="2.5-mathSpecies.html"><i class="fa fa-check"></i><b>2.5</b> Mathematical Species</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="2.5-mathSpecies.html"><a href="2.5-mathSpecies.html#deterministic-models"><i class="fa fa-check"></i><b>2.5.1</b> Deterministic Models</a></li>
<li class="chapter" data-level="2.5.2" data-path="2.5-mathSpecies.html"><a href="2.5-mathSpecies.html#stochastic-models"><i class="fa fa-check"></i><b>2.5.2</b> Stochastic Models</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="2.6-notes.html"><a href="2.6-notes.html"><i class="fa fa-check"></i><b>2.6</b> Notes</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="3-the-ross-macdonald-model.html"><a href="3-the-ross-macdonald-model.html"><i class="fa fa-check"></i><b>3</b> The Ross-Macdonald Model</a>
<ul>
<li class="chapter" data-level="3.1" data-path="3.1-infection.html"><a href="3.1-infection.html"><i class="fa fa-check"></i><b>3.1</b> Infection</a></li>
<li class="chapter" data-level="3.2" data-path="3.2-mosquito-bionomics.html"><a href="3.2-mosquito-bionomics.html"><i class="fa fa-check"></i><b>3.2</b> Mosquito Bionomics</a></li>
<li class="chapter" data-level="3.3" data-path="3.3-equations.html"><a href="3.3-equations.html"><i class="fa fa-check"></i><b>3.3</b> Equations</a></li>
<li class="chapter" data-level="3.4" data-path="3.4-solutions-1.html"><a href="3.4-solutions-1.html"><i class="fa fa-check"></i><b>3.4</b> Solutions</a></li>
<li class="chapter" data-level="3.5" data-path="3.5-the-basic-reproductive-number.html"><a href="3.5-the-basic-reproductive-number.html"><i class="fa fa-check"></i><b>3.5</b> The Basic Reproductive Number</a></li>
<li class="chapter" data-level="3.6" data-path="3.6-sensitivity-to-parameters.html"><a href="3.6-sensitivity-to-parameters.html"><i class="fa fa-check"></i><b>3.6</b> Sensitivity to Parameters</a></li>
<li class="chapter" data-level="3.7" data-path="3.7-vectorial-capacity.html"><a href="3.7-vectorial-capacity.html"><i class="fa fa-check"></i><b>3.7</b> Vectorial Capacity</a></li>
<li class="chapter" data-level="3.8" data-path="3.8-classifying-transmission.html"><a href="3.8-classifying-transmission.html"><i class="fa fa-check"></i><b>3.8</b> Classifying Transmission</a></li>
<li class="chapter" data-level="3.9" data-path="3.9-history.html"><a href="3.9-history.html"><i class="fa fa-check"></i><b>3.9</b> History</a>
<ul>
<li class="chapter" data-level="3.9.1" data-path="3.9-history.html"><a href="3.9-history.html#lotka"><i class="fa fa-check"></i><b>3.9.1</b> Lotka</a></li>
<li class="chapter" data-level="3.9.2" data-path="3.9-history.html"><a href="3.9-history.html#macdonald-and-medical-entomology"><i class="fa fa-check"></i><b>3.9.2</b> Macdonald and Medical Entomology</a></li>
<li class="chapter" data-level="3.9.3" data-path="3.9-history.html"><a href="3.9-history.html#r_0-in-the-gmep"><i class="fa fa-check"></i><b>3.9.3</b> <span class="math inline">\(R_0\)</span> in the GMEP</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="4-metrics-and-models.html"><a href="4-metrics-and-models.html"><i class="fa fa-check"></i><b>4</b> Metrics and Models</a>
<ul>
<li class="chapter" data-level="4.1" data-path="4.1-malaria-epidemiology.html"><a href="4.1-malaria-epidemiology.html"><i class="fa fa-check"></i><b>4.1</b> Malaria Epidemiology</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="4.1-malaria-epidemiology.html"><a href="4.1-malaria-epidemiology.html#infection-prevalence"><i class="fa fa-check"></i><b>4.1.1</b> Infection Prevalence</a></li>
<li class="chapter" data-level="4.1.2" data-path="4.1-malaria-epidemiology.html"><a href="4.1-malaria-epidemiology.html#infection-incidence"><i class="fa fa-check"></i><b>4.1.2</b> Infection Incidence</a></li>
<li class="chapter" data-level="4.1.3" data-path="4.1-malaria-epidemiology.html"><a href="4.1-malaria-epidemiology.html#disease"><i class="fa fa-check"></i><b>4.1.3</b> Disease</a></li>
<li class="chapter" data-level="4.1.4" data-path="4.1-malaria-epidemiology.html"><a href="4.1-malaria-epidemiology.html#serology"><i class="fa fa-check"></i><b>4.1.4</b> Serology</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="4.2-entomology.html"><a href="4.2-entomology.html"><i class="fa fa-check"></i><b>4.2</b> Entomology</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="4.2-entomology.html"><a href="4.2-entomology.html#entomological-inoculation-rates"><i class="fa fa-check"></i><b>4.2.1</b> Entomological Inoculation Rates</a></li>
<li class="chapter" data-level="4.2.2" data-path="4.2-entomology.html"><a href="4.2-entomology.html#bionomics"><i class="fa fa-check"></i><b>4.2.2</b> Bionomics</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="4.3-transmission.html"><a href="4.3-transmission.html"><i class="fa fa-check"></i><b>4.3</b> Transmission</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="4.3-transmission.html"><a href="4.3-transmission.html#infectiousness"><i class="fa fa-check"></i><b>4.3.1</b> Infectiousness</a></li>
<li class="chapter" data-level="4.3.2" data-path="4.3-transmission.html"><a href="4.3-transmission.html#vectorial-capacity-1"><i class="fa fa-check"></i><b>4.3.2</b> Vectorial Capacity</a></li>
<li class="chapter" data-level="4.3.3" data-path="4.3-transmission.html"><a href="4.3-transmission.html#transmission-efficiency"><i class="fa fa-check"></i><b>4.3.3</b> Transmission Efficiency</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="4.4-surveillance.html"><a href="4.4-surveillance.html"><i class="fa fa-check"></i><b>4.4</b> Surveillance</a></li>
<li class="chapter" data-level="4.5" data-path="4.5-observation.html"><a href="4.5-observation.html"><i class="fa fa-check"></i><b>4.5</b> Observation</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="5-research-and-policy.html"><a href="5-research-and-policy.html"><i class="fa fa-check"></i><b>5</b> Research and Policy</a>
<ul>
<li class="chapter" data-level="5.1" data-path="5.1-information-and-decisions.html"><a href="5.1-information-and-decisions.html"><i class="fa fa-check"></i><b>5.1</b> Information and Decisions</a></li>
<li class="chapter" data-level="5.2" data-path="5.2-a-models-skill-set.html"><a href="5.2-a-models-skill-set.html"><i class="fa fa-check"></i><b>5.2</b> A Model’s Skill Set</a></li>
<li class="chapter" data-level="5.3" data-path="5.3-temporal-epochs.html"><a href="5.3-temporal-epochs.html"><i class="fa fa-check"></i><b>5.3</b> Temporal Epochs</a></li>
<li class="chapter" data-level="5.4" data-path="5.4-inference.html"><a href="5.4-inference.html"><i class="fa fa-check"></i><b>5.4</b> Inference</a></li>
<li class="chapter" data-level="5.5" data-path="5.5-imputation.html"><a href="5.5-imputation.html"><i class="fa fa-check"></i><b>5.5</b> Imputation</a></li>
</ul></li>
<li class="part"><span><b>II Toolbox</b></span></li>
<li class="chapter" data-level="6" data-path="6-malaria-models-for-policy.html"><a href="6-malaria-models-for-policy.html"><i class="fa fa-check"></i><b>6</b> Malaria Models for Policy</a>
<ul>
<li class="chapter" data-level="6.1" data-path="6.1-malaria-epidemiology-1.html"><a href="6.1-malaria-epidemiology-1.html"><i class="fa fa-check"></i><b>6.1</b> Malaria Epidemiology</a></li>
<li class="chapter" data-level="6.2" data-path="6.2-human-demography.html"><a href="6.2-human-demography.html"><i class="fa fa-check"></i><b>6.2</b> Human Demography</a></li>
<li class="chapter" data-level="6.3" data-path="6.3-the-burden-of-malaria.html"><a href="6.3-the-burden-of-malaria.html"><i class="fa fa-check"></i><b>6.3</b> The Burden of Malaria</a></li>
<li class="chapter" data-level="6.4" data-path="6.4-mosquito-ecology-and-behavior.html"><a href="6.4-mosquito-ecology-and-behavior.html"><i class="fa fa-check"></i><b>6.4</b> Mosquito Ecology and Behavior</a></li>
<li class="chapter" data-level="6.5" data-path="6.5-theory-for-vector-control.html"><a href="6.5-theory-for-vector-control.html"><i class="fa fa-check"></i><b>6.5</b> Theory for Vector Control</a></li>
<li class="chapter" data-level="6.6" data-path="6.6-blood-feeding-and-transmission.html"><a href="6.6-blood-feeding-and-transmission.html"><i class="fa fa-check"></i><b>6.6</b> Blood Feeding and Transmission</a></li>
<li class="chapter" data-level="6.7" data-path="6.7-spatial-dynamics-and-connectivity.html"><a href="6.7-spatial-dynamics-and-connectivity.html"><i class="fa fa-check"></i><b>6.7</b> Spatial Dynamics and Connectivity</a></li>
<li class="chapter" data-level="6.8" data-path="6.8-parasite-diversity.html"><a href="6.8-parasite-diversity.html"><i class="fa fa-check"></i><b>6.8</b> Parasite Diversity</a></li>
<li class="chapter" data-level="6.9" data-path="6.9-evolution-of-drug-resistance.html"><a href="6.9-evolution-of-drug-resistance.html"><i class="fa fa-check"></i><b>6.9</b> Evolution of Drug Resistance</a></li>
<li class="chapter" data-level="6.10" data-path="6.10-evolution-of-insecticide-resistance.html"><a href="6.10-evolution-of-insecticide-resistance.html"><i class="fa fa-check"></i><b>6.10</b> Evolution of Insecticide Resistance</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="7-heterogeneous-transmission.html"><a href="7-heterogeneous-transmission.html"><i class="fa fa-check"></i><b>7</b> Heterogeneous Transmission</a>
<ul>
<li class="chapter" data-level="7.1" data-path="7.1-blood-feeding.html"><a href="7.1-blood-feeding.html"><i class="fa fa-check"></i><b>7.1</b> Blood Feeding</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="7.1-blood-feeding.html"><a href="7.1-blood-feeding.html#mosquito-searching"><i class="fa fa-check"></i><b>7.1.1</b> Mosquito Searching</a></li>
<li class="chapter" data-level="7.1.2" data-path="7.1-blood-feeding.html"><a href="7.1-blood-feeding.html#risky-human-behaviors"><i class="fa fa-check"></i><b>7.1.2</b> Risky Human Behaviors</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="7.2-environmental-heterogeneity.html"><a href="7.2-environmental-heterogeneity.html"><i class="fa fa-check"></i><b>7.2</b> Environmental Heterogeneity</a></li>
<li class="chapter" data-level="7.3" data-path="7.3-heterogeneous-biting.html"><a href="7.3-heterogeneous-biting.html"><i class="fa fa-check"></i><b>7.3</b> Heterogeneous Biting</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="8-aron-may.html"><a href="8-aron-may.html"><i class="fa fa-check"></i><b>8</b> Adult Mosquito Dynamics</a>
<ul>
<li class="chapter" data-level="8.1" data-path="8.1-emergence.html"><a href="8.1-emergence.html"><i class="fa fa-check"></i><b>8.1</b> Emergence</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="8.1-emergence.html"><a href="8.1-emergence.html#variables"><i class="fa fa-check"></i><b>8.1.1</b> Variables</a></li>
<li class="chapter" data-level="8.1.2" data-path="8.1-emergence.html"><a href="8.1-emergence.html#blood-fed-mosquitoes"><i class="fa fa-check"></i><b>8.1.2</b> Blood Fed Mosquitoes</a></li>
<li class="chapter" data-level="8.1.3" data-path="8.1-emergence.html"><a href="8.1-emergence.html#infected-mosquitoes"><i class="fa fa-check"></i><b>8.1.3</b> Infected Mosquitoes</a></li>
<li class="chapter" data-level="8.1.4" data-path="8.1-emergence.html"><a href="8.1-emergence.html#infectious-mosquitoes"><i class="fa fa-check"></i><b>8.1.4</b> Infectious Mosquitoes</a></li>
<li class="chapter" data-level="8.1.5" data-path="8.1-emergence.html"><a href="8.1-emergence.html#RossEqn"><i class="fa fa-check"></i><b>8.1.5</b> Infected Humans</a></li>
<li class="chapter" data-level="8.1.6" data-path="8.1-emergence.html"><a href="8.1-emergence.html#as-a-system"><i class="fa fa-check"></i><b>8.1.6</b> …as a System</a></li>
<li class="chapter" data-level="8.1.7" data-path="8.1-emergence.html"><a href="8.1-emergence.html#solutions-2"><i class="fa fa-check"></i><b>8.1.7</b> Solutions</a></li>
<li class="chapter" data-level="8.1.8" data-path="8.1-emergence.html"><a href="8.1-emergence.html#initial-values"><i class="fa fa-check"></i><b>8.1.8</b> Initial Values</a></li>
<li class="chapter" data-level="8.1.9" data-path="8.1-emergence.html"><a href="8.1-emergence.html#parameter-values"><i class="fa fa-check"></i><b>8.1.9</b> Parameter Values</a></li>
<li class="chapter" data-level="8.1.10" data-path="8.1-emergence.html"><a href="8.1-emergence.html#solving-1"><i class="fa fa-check"></i><b>8.1.10</b> Solving</a></li>
<li class="chapter" data-level="8.1.11" data-path="8.1-emergence.html"><a href="8.1-emergence.html#visualizing-1"><i class="fa fa-check"></i><b>8.1.11</b> Visualizing</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="8.2-steady-states-2.html"><a href="8.2-steady-states-2.html"><i class="fa fa-check"></i><b>8.2</b> Steady States</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="8.2-steady-states-2.html"><a href="8.2-steady-states-2.html#mosquito-density"><i class="fa fa-check"></i><b>8.2.1</b> Mosquito Density</a></li>
<li class="chapter" data-level="8.2.2" data-path="8.2-steady-states-2.html"><a href="8.2-steady-states-2.html#eir"><i class="fa fa-check"></i><b>8.2.2</b> EIR</a></li>
<li class="chapter" data-level="8.2.3" data-path="8.2-steady-states-2.html"><a href="8.2-steady-states-2.html#vectorial-capacity-2"><i class="fa fa-check"></i><b>8.2.3</b> Vectorial Capacity</a></li>
<li class="chapter" data-level="8.2.4" data-path="8.2-steady-states-2.html"><a href="8.2-steady-states-2.html#malaria-prevalence-thresholds"><i class="fa fa-check"></i><b>8.2.4</b> Malaria Prevalence &amp; Thresholds</a></li>
<li class="chapter" data-level="8.2.5" data-path="8.2-steady-states-2.html"><a href="8.2-steady-states-2.html#checking-our-work"><i class="fa fa-check"></i><b>8.2.5</b> Checking our Work</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="8.3-stable-orbits.html"><a href="8.3-stable-orbits.html"><i class="fa fa-check"></i><b>8.3</b> Stable Orbits</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="8.3-stable-orbits.html"><a href="8.3-stable-orbits.html#thresholds-2"><i class="fa fa-check"></i><b>8.3.1</b> Thresholds</a></li>
<li class="chapter" data-level="8.3.2" data-path="8.3-stable-orbits.html"><a href="8.3-stable-orbits.html#orbits"><i class="fa fa-check"></i><b>8.3.2</b> Orbits</a></li>
<li class="chapter" data-level="8.3.3" data-path="8.3-stable-orbits.html"><a href="8.3-stable-orbits.html#average-dynamics"><i class="fa fa-check"></i><b>8.3.3</b> Average Dynamics</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="9-human-age-demography.html"><a href="9-human-age-demography.html"><i class="fa fa-check"></i><b>9</b> Human Age &amp; Demography</a>
<ul>
<li class="chapter" data-level="9.1" data-path="9.1-cohort-dynamics.html"><a href="9.1-cohort-dynamics.html"><i class="fa fa-check"></i><b>9.1</b> Cohort Dynamics</a></li>
<li class="chapter" data-level="9.2" data-path="9.2-gallerkin.html"><a href="9.2-gallerkin.html"><i class="fa fa-check"></i><b>9.2</b> Gallerkin</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="10-mosquito-ecology.html"><a href="10-mosquito-ecology.html"><i class="fa fa-check"></i><b>10</b> Mosquito Ecology</a>
<ul>
<li class="chapter" data-level="10.1" data-path="10.1-egg-laying.html"><a href="10.1-egg-laying.html"><i class="fa fa-check"></i><b>10.1</b> Egg Laying</a></li>
</ul></li>
<li class="part"><span><b>III Malaria Modeling</b></span></li>
<li class="chapter" data-level="11" data-path="11-model-building.html"><a href="11-model-building.html"><i class="fa fa-check"></i><b>11</b> Model Building</a>
<ul>
<li class="chapter" data-level="11.1" data-path="11.1-compartment-models.html"><a href="11.1-compartment-models.html"><i class="fa fa-check"></i><b>11.1</b> Compartment Models</a></li>
<li class="chapter" data-level="11.2" data-path="11.2-primary-model-development.html"><a href="11.2-primary-model-development.html"><i class="fa fa-check"></i><b>11.2</b> Primary Model Development</a></li>
<li class="chapter" data-level="11.3" data-path="11.3-implementation-and-verification.html"><a href="11.3-implementation-and-verification.html"><i class="fa fa-check"></i><b>11.3</b> Implementation and Verification</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="11.3-implementation-and-verification.html"><a href="11.3-implementation-and-verification.html#solving-2"><i class="fa fa-check"></i><b>11.3.1</b> Solving</a></li>
<li class="chapter" data-level="11.3.2" data-path="11.3-implementation-and-verification.html"><a href="11.3-implementation-and-verification.html#mathematical-analysis"><i class="fa fa-check"></i><b>11.3.2</b> Mathematical Analysis</a></li>
<li class="chapter" data-level="11.3.3" data-path="11.3-implementation-and-verification.html"><a href="11.3-implementation-and-verification.html#simulation"><i class="fa fa-check"></i><b>11.3.3</b> Simulation</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="11.4-what-is-a-model.html"><a href="11.4-what-is-a-model.html"><i class="fa fa-check"></i><b>11.4</b> What is a Model?</a></li>
<li class="chapter" data-level="11.5" data-path="11.5-accuracy-validation.html"><a href="11.5-accuracy-validation.html"><i class="fa fa-check"></i><b>11.5</b> Accuracy &amp; Validation</a>
<ul>
<li class="chapter" data-level="11.5.1" data-path="11.5-accuracy-validation.html"><a href="11.5-accuracy-validation.html#validation-points"><i class="fa fa-check"></i><b>11.5.1</b> Validation Points</a></li>
</ul></li>
<li class="chapter" data-level="11.6" data-path="11.6-the-measure-of-a-model.html"><a href="11.6-the-measure-of-a-model.html"><i class="fa fa-check"></i><b>11.6</b> The Measure of a Model</a>
<ul>
<li class="chapter" data-level="11.6.1" data-path="11.6-the-measure-of-a-model.html"><a href="11.6-the-measure-of-a-model.html#limitations"><i class="fa fa-check"></i><b>11.6.1</b> Limitations</a></li>
<li class="chapter" data-level="11.6.2" data-path="11.6-the-measure-of-a-model.html"><a href="11.6-the-measure-of-a-model.html#parsimony"><i class="fa fa-check"></i><b>11.6.2</b> Parsimony</a></li>
</ul></li>
<li class="chapter" data-level="11.7" data-path="11.7-secondary-model-development.html"><a href="11.7-secondary-model-development.html"><i class="fa fa-check"></i><b>11.7</b> Secondary Model Development</a></li>
<li class="chapter" data-level="11.8" data-path="11.8-conclusions.html"><a href="11.8-conclusions.html"><i class="fa fa-check"></i><b>11.8</b> Conclusions</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="12-ch-uncertainty.html"><a href="12-ch-uncertainty.html"><i class="fa fa-check"></i><b>12</b> Uncertainty</a>
<ul>
<li class="chapter" data-level="12.1" data-path="12.1-what-we-dont-know-about-malaria.html"><a href="12.1-what-we-dont-know-about-malaria.html"><i class="fa fa-check"></i><b>12.1</b> What we Don’t Know about Malaria</a></li>
<li class="chapter" data-level="12.2" data-path="12.2-what-we-dont-know-about-malaria-1.html"><a href="12.2-what-we-dont-know-about-malaria-1.html"><i class="fa fa-check"></i><b>12.2</b> What we Don’t Know about Malaria</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="13-realism.html"><a href="13-realism.html"><i class="fa fa-check"></i><b>13</b> Realism</a>
<ul>
<li class="chapter" data-level="13.1" data-path="13.1-malaria-epidemiology-2.html"><a href="13.1-malaria-epidemiology-2.html"><i class="fa fa-check"></i><b>13.1</b> Malaria Epidemiology</a></li>
<li class="chapter" data-level="13.2" data-path="13.2-transmission-1.html"><a href="13.2-transmission-1.html"><i class="fa fa-check"></i><b>13.2</b> Transmission</a></li>
<li class="chapter" data-level="13.3" data-path="13.3-mosquito-ecology-1.html"><a href="13.3-mosquito-ecology-1.html"><i class="fa fa-check"></i><b>13.3</b> Mosquito Ecology</a>
<ul>
<li class="chapter" data-level="13.3.1" data-path="13.3-mosquito-ecology-1.html"><a href="13.3-mosquito-ecology-1.html#resource-availability"><i class="fa fa-check"></i><b>13.3.1</b> Resource Availability</a></li>
<li class="chapter" data-level="13.3.2" data-path="13.3-mosquito-ecology-1.html"><a href="13.3-mosquito-ecology-1.html#egg-laying-1"><i class="fa fa-check"></i><b>13.3.2</b> Egg Laying</a></li>
<li class="chapter" data-level="13.3.3" data-path="13.3-mosquito-ecology-1.html"><a href="13.3-mosquito-ecology-1.html#regulation"><i class="fa fa-check"></i><b>13.3.3</b> Regulation</a></li>
<li class="chapter" data-level="13.3.4" data-path="13.3-mosquito-ecology-1.html"><a href="13.3-mosquito-ecology-1.html#exogenous-forcing"><i class="fa fa-check"></i><b>13.3.4</b> Exogenous Forcing</a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="13.4-heterogeneity-stratification.html"><a href="13.4-heterogeneity-stratification.html"><i class="fa fa-check"></i><b>13.4</b> Heterogeneity &amp; Stratification</a>
<ul>
<li class="chapter" data-level="13.4.1" data-path="13.4-heterogeneity-stratification.html"><a href="13.4-heterogeneity-stratification.html#strata-in-the-ross-model"><i class="fa fa-check"></i><b>13.4.1</b> Strata in the Ross model</a></li>
<li class="chapter" data-level="13.4.2" data-path="13.4-heterogeneity-stratification.html"><a href="13.4-heterogeneity-stratification.html#frailties"><i class="fa fa-check"></i><b>13.4.2</b> Frailties</a></li>
<li class="chapter" data-level="13.4.3" data-path="13.4-heterogeneity-stratification.html"><a href="13.4-heterogeneity-stratification.html#age"><i class="fa fa-check"></i><b>13.4.3</b> Age</a></li>
</ul></li>
<li class="chapter" data-level="13.5" data-path="13.5-spatial-dynamics.html"><a href="13.5-spatial-dynamics.html"><i class="fa fa-check"></i><b>13.5</b> Spatial Dynamics</a>
<ul>
<li class="chapter" data-level="13.5.1" data-path="13.5-spatial-dynamics.html"><a href="13.5-spatial-dynamics.html#human-migration-mobility-travel"><i class="fa fa-check"></i><b>13.5.1</b> Human Migration, Mobility &amp; Travel</a></li>
<li class="chapter" data-level="13.5.2" data-path="13.5-spatial-dynamics.html"><a href="13.5-spatial-dynamics.html#mosquito-search-dispersal"><i class="fa fa-check"></i><b>13.5.2</b> Mosquito Search &amp; Dispersal</a></li>
<li class="chapter" data-level="13.5.3" data-path="13.5-spatial-dynamics.html"><a href="13.5-spatial-dynamics.html#the-mixing-matrix"><i class="fa fa-check"></i><b>13.5.3</b> The Mixing Matrix</a></li>
<li class="chapter" data-level="13.5.4" data-path="13.5-spatial-dynamics.html"><a href="13.5-spatial-dynamics.html#pathogen-dispersal-by-humans"><i class="fa fa-check"></i><b>13.5.4</b> Pathogen Dispersal by Humans</a></li>
<li class="chapter" data-level="13.5.5" data-path="13.5-spatial-dynamics.html"><a href="13.5-spatial-dynamics.html#pathogen-dispersal-by-mosquitoes"><i class="fa fa-check"></i><b>13.5.5</b> Pathogen Dispersal by Mosquitoes</a></li>
</ul></li>
<li class="chapter" data-level="13.6" data-path="13.6-exogenous-forcing-1.html"><a href="13.6-exogenous-forcing-1.html"><i class="fa fa-check"></i><b>13.6</b> Exogenous Forcing</a>
<ul>
<li class="chapter" data-level="13.6.1" data-path="13.6-exogenous-forcing-1.html"><a href="13.6-exogenous-forcing-1.html#weather"><i class="fa fa-check"></i><b>13.6.1</b> Weather</a></li>
<li class="chapter" data-level="13.6.2" data-path="13.6-exogenous-forcing-1.html"><a href="13.6-exogenous-forcing-1.html#habitat-dynamics"><i class="fa fa-check"></i><b>13.6.2</b> Habitat Dynamics</a></li>
<li class="chapter" data-level="13.6.3" data-path="13.6-exogenous-forcing-1.html"><a href="13.6-exogenous-forcing-1.html#the-eip"><i class="fa fa-check"></i><b>13.6.3</b> The EIP</a></li>
<li class="chapter" data-level="13.6.4" data-path="13.6-exogenous-forcing-1.html"><a href="13.6-exogenous-forcing-1.html#seasonality"><i class="fa fa-check"></i><b>13.6.4</b> Seasonality</a></li>
</ul></li>
<li class="chapter" data-level="13.7" data-path="13.7-integrated-vector-control.html"><a href="13.7-integrated-vector-control.html"><i class="fa fa-check"></i><b>13.7</b> Integrated Vector Control</a></li>
<li class="chapter" data-level="13.8" data-path="13.8-integrated-malaria-control.html"><a href="13.8-integrated-malaria-control.html"><i class="fa fa-check"></i><b>13.8</b> Integrated Malaria Control</a></li>
<li class="chapter" data-level="13.9" data-path="13.9-context.html"><a href="13.9-context.html"><i class="fa fa-check"></i><b>13.9</b> Context</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="14-modularity-and-software.html"><a href="14-modularity-and-software.html"><i class="fa fa-check"></i><b>14</b> Modularity and Software</a>
<ul>
<li class="chapter" data-level="14.1" data-path="14.1-model-building-1.html"><a href="14.1-model-building-1.html"><i class="fa fa-check"></i><b>14.1</b> Model Building</a></li>
<li class="chapter" data-level="14.2" data-path="14.2-modular-computation.html"><a href="14.2-modular-computation.html"><i class="fa fa-check"></i><b>14.2</b> Modular Computation</a>
<ul>
<li class="chapter" data-level="14.2.1" data-path="14.2-modular-computation.html"><a href="14.2-modular-computation.html#exde"><i class="fa fa-check"></i><b>14.2.1</b> <code>exDE</code></a></li>
</ul></li>
<li class="chapter" data-level="14.3" data-path="14.3-notes-1.html"><a href="14.3-notes-1.html"><i class="fa fa-check"></i><b>14.3</b> Notes</a>
<ul>
<li class="chapter" data-level="14.3.1" data-path="14.3-notes-1.html"><a href="14.3-notes-1.html#why-use-densities"><i class="fa fa-check"></i><b>14.3.1</b> Why use densities?</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>IV Epidemiology</b></span></li>
<li class="chapter" data-level="15" data-path="15-malaria-epidemiology-3.html"><a href="15-malaria-epidemiology-3.html"><i class="fa fa-check"></i><b>15</b> Malaria Epidemiology</a>
<ul>
<li class="chapter" data-level="15.1" data-path="15.1-life-stages.html"><a href="15.1-life-stages.html"><i class="fa fa-check"></i><b>15.1</b> Life Stages</a></li>
<li class="chapter" data-level="15.2" data-path="15.2-overview.html"><a href="15.2-overview.html"><i class="fa fa-check"></i><b>15.2</b> Overview</a></li>
<li class="chapter" data-level="15.3" data-path="15.3-infection-1.html"><a href="15.3-infection-1.html"><i class="fa fa-check"></i><b>15.3</b> Infection</a>
<ul>
<li class="chapter" data-level="15.3.1" data-path="15.3-infection-1.html"><a href="15.3-infection-1.html#superinfection"><i class="fa fa-check"></i><b>15.3.1</b> Superinfection</a></li>
</ul></li>
<li class="chapter" data-level="15.4" data-path="15.4-disease-immunity.html"><a href="15.4-disease-immunity.html"><i class="fa fa-check"></i><b>15.4</b> Disease &amp; Immunity</a></li>
<li class="chapter" data-level="15.5" data-path="15.5-gametocytes-and-infectiousness.html"><a href="15.5-gametocytes-and-infectiousness.html"><i class="fa fa-check"></i><b>15.5</b> Gametocytes and Infectiousness</a></li>
<li class="chapter" data-level="15.6" data-path="15.6-treatment-and-chemoprotection.html"><a href="15.6-treatment-and-chemoprotection.html"><i class="fa fa-check"></i><b>15.6</b> Treatment and Chemoprotection</a>
<ul>
<li class="chapter" data-level="15.6.1" data-path="15.6-treatment-and-chemoprotection.html"><a href="15.6-treatment-and-chemoprotection.html#the-time-course-of-an-infection"><i class="fa fa-check"></i><b>15.6.1</b> The Time Course of an Infection</a></li>
<li class="chapter" data-level="15.6.2" data-path="15.6-treatment-and-chemoprotection.html"><a href="15.6-treatment-and-chemoprotection.html#intrahost-models"><i class="fa fa-check"></i><b>15.6.2</b> Intrahost Models</a></li>
<li class="chapter" data-level="15.6.3" data-path="15.6-treatment-and-chemoprotection.html"><a href="15.6-treatment-and-chemoprotection.html#synthesis"><i class="fa fa-check"></i><b>15.6.3</b> Synthesis</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="16" data-path="16-stage-structured-infection.html"><a href="16-stage-structured-infection.html"><i class="fa fa-check"></i><b>16</b> Stage-Structured Infection</a>
<ul>
<li class="chapter" data-level="16.1" data-path="16.1-stages-of-infection.html"><a href="16.1-stages-of-infection.html"><i class="fa fa-check"></i><b>16.1</b> Stages of Infection</a></li>
<li class="chapter" data-level="16.2" data-path="16.2-controlled-infections.html"><a href="16.2-controlled-infections.html"><i class="fa fa-check"></i><b>16.2</b> Controlled Infections</a>
<ul>
<li class="chapter" data-level="16.2.1" data-path="16.2-controlled-infections.html"><a href="16.2-controlled-infections.html#malariotherapy"><i class="fa fa-check"></i><b>16.2.1</b> Malariotherapy</a></li>
<li class="chapter" data-level="16.2.2" data-path="16.2-controlled-infections.html"><a href="16.2-controlled-infections.html#chmi"><i class="fa fa-check"></i><b>16.2.2</b> CHMI</a></li>
</ul></li>
<li class="chapter" data-level="16.3" data-path="16.3-a-simple-infection.html"><a href="16.3-a-simple-infection.html"><i class="fa fa-check"></i><b>16.3</b> A Simple Infection</a>
<ul>
<li class="chapter" data-level="16.3.1" data-path="16.3-a-simple-infection.html"><a href="16.3-a-simple-infection.html#time-course"><i class="fa fa-check"></i><b>16.3.1</b> Time Course</a></li>
<li class="chapter" data-level="16.3.2" data-path="16.3-a-simple-infection.html"><a href="16.3-a-simple-infection.html#duration"><i class="fa fa-check"></i><b>16.3.2</b> Duration</a></li>
</ul></li>
<li class="chapter" data-level="16.4" data-path="16.4-superinfection-1.html"><a href="16.4-superinfection-1.html"><i class="fa fa-check"></i><b>16.4</b> Superinfection</a></li>
<li class="chapter" data-level="16.5" data-path="16.5-process-vs.-observation.html"><a href="16.5-process-vs.-observation.html"><i class="fa fa-check"></i><b>16.5</b> Process <em>vs.</em> Observation</a>
<ul>
<li class="chapter" data-level="16.5.1" data-path="16.5-process-vs.-observation.html"><a href="16.5-process-vs.-observation.html#detection"><i class="fa fa-check"></i><b>16.5.1</b> Detection</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="17" data-path="17-stage-structured-infections.html"><a href="17-stage-structured-infections.html"><i class="fa fa-check"></i><b>17</b> Stage-Structured Infections</a>
<ul>
<li class="chapter" data-level="17.1" data-path="17.1-stages-of-infection-1.html"><a href="17.1-stages-of-infection-1.html"><i class="fa fa-check"></i><b>17.1</b> Stages of Infection</a></li>
<li class="chapter" data-level="17.2" data-path="17.2-controlled-infections-1.html"><a href="17.2-controlled-infections-1.html"><i class="fa fa-check"></i><b>17.2</b> Controlled Infections</a>
<ul>
<li class="chapter" data-level="17.2.1" data-path="17.2-controlled-infections-1.html"><a href="17.2-controlled-infections-1.html#malariotherapy-1"><i class="fa fa-check"></i><b>17.2.1</b> Malariotherapy</a></li>
<li class="chapter" data-level="17.2.2" data-path="17.2-controlled-infections-1.html"><a href="17.2-controlled-infections-1.html#chmi-1"><i class="fa fa-check"></i><b>17.2.2</b> CHMI</a></li>
</ul></li>
<li class="chapter" data-level="17.3" data-path="17.3-a-simple-infection-1.html"><a href="17.3-a-simple-infection-1.html"><i class="fa fa-check"></i><b>17.3</b> A Simple Infection</a>
<ul>
<li class="chapter" data-level="17.3.1" data-path="17.3-a-simple-infection-1.html"><a href="17.3-a-simple-infection-1.html#time-course-1"><i class="fa fa-check"></i><b>17.3.1</b> Time Course</a></li>
<li class="chapter" data-level="17.3.2" data-path="17.3-a-simple-infection-1.html"><a href="17.3-a-simple-infection-1.html#duration-1"><i class="fa fa-check"></i><b>17.3.2</b> Duration</a></li>
</ul></li>
<li class="chapter" data-level="17.4" data-path="17.4-superinfection-2.html"><a href="17.4-superinfection-2.html"><i class="fa fa-check"></i><b>17.4</b> Superinfection</a></li>
<li class="chapter" data-level="17.5" data-path="17.5-process-vs.-observation-1.html"><a href="17.5-process-vs.-observation-1.html"><i class="fa fa-check"></i><b>17.5</b> Process <em>vs.</em> Observation</a>
<ul>
<li class="chapter" data-level="17.5.1" data-path="17.5-process-vs.-observation-1.html"><a href="17.5-process-vs.-observation-1.html#detection-1"><i class="fa fa-check"></i><b>17.5.1</b> Detection</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="18" data-path="18-queuing-models-and-superinfection.html"><a href="18-queuing-models-and-superinfection.html"><i class="fa fa-check"></i><b>18</b> Queuing Models and Superinfection</a>
<ul>
<li class="chapter" data-level="18.1" data-path="18.1-parasite-densities-and-detection.html"><a href="18.1-parasite-densities-and-detection.html"><i class="fa fa-check"></i><b>18.1</b> Parasite Densities and Detection</a></li>
<li class="chapter" data-level="18.2" data-path="18.2-light-microscopy.html"><a href="18.2-light-microscopy.html"><i class="fa fa-check"></i><b>18.2</b> Light Microscopy</a></li>
<li class="chapter" data-level="18.3" data-path="18.3-biomarkers-and-rdts.html"><a href="18.3-biomarkers-and-rdts.html"><i class="fa fa-check"></i><b>18.3</b> Biomarkers and RDTs</a></li>
<li class="chapter" data-level="18.4" data-path="18.4-pcr.html"><a href="18.4-pcr.html"><i class="fa fa-check"></i><b>18.4</b> PCR</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="19-stage-structured-immunity.html"><a href="19-stage-structured-immunity.html"><i class="fa fa-check"></i><b>19</b> Stage-Structured Immunity</a>
<ul>
<li class="chapter" data-level="19.1" data-path="19.1-the-garki-model.html"><a href="19.1-the-garki-model.html"><i class="fa fa-check"></i><b>19.1</b> The Garki Model</a></li>
<li class="chapter" data-level="19.2" data-path="19.2-stage-structured-immunity-1.html"><a href="19.2-stage-structured-immunity-1.html"><i class="fa fa-check"></i><b>19.2</b> Stage-Structured Immunity</a></li>
<li class="chapter" data-level="19.3" data-path="19.3-strain-specific-immunity.html"><a href="19.3-strain-specific-immunity.html"><i class="fa fa-check"></i><b>19.3</b> Strain Specific Immunity</a></li>
<li class="chapter" data-level="19.4" data-path="19.4-memory-tracking.html"><a href="19.4-memory-tracking.html"><i class="fa fa-check"></i><b>19.4</b> Memory Tracking</a></li>
<li class="chapter" data-level="19.5" data-path="19.5-age-vs.-prevalence.html"><a href="19.5-age-vs.-prevalence.html"><i class="fa fa-check"></i><b>19.5</b> Age <em>vs.</em> Prevalence</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="20-age-structured-infection-models.html"><a href="20-age-structured-infection-models.html"><i class="fa fa-check"></i><b>20</b> Age-Structured Infection Models</a></li>
<li class="chapter" data-level="21" data-path="21-hybrid-models.html"><a href="21-hybrid-models.html"><i class="fa fa-check"></i><b>21</b> Hybrid Models</a></li>
<li class="chapter" data-level="22" data-path="22-within-host.html"><a href="22-within-host.html"><i class="fa fa-check"></i><b>22</b> Within Host</a></li>
<li class="chapter" data-level="23" data-path="23-fever-and-severe-disease.html"><a href="23-fever-and-severe-disease.html"><i class="fa fa-check"></i><b>23</b> Fever and Severe Disease</a>
<ul>
<li class="chapter" data-level="23.1" data-path="23.1-fever.html"><a href="23.1-fever.html"><i class="fa fa-check"></i><b>23.1</b> Fever</a></li>
<li class="chapter" data-level="23.2" data-path="23.2-anemia.html"><a href="23.2-anemia.html"><i class="fa fa-check"></i><b>23.2</b> Anemia</a></li>
<li class="chapter" data-level="23.3" data-path="23.3-severe-disease.html"><a href="23.3-severe-disease.html"><i class="fa fa-check"></i><b>23.3</b> Severe Disease</a></li>
</ul></li>
<li class="chapter" data-level="24" data-path="24-drug-taking.html"><a href="24-drug-taking.html"><i class="fa fa-check"></i><b>24</b> Drug Taking</a>
<ul>
<li class="chapter" data-level="24.1" data-path="24.1-curing-infections.html"><a href="24.1-curing-infections.html"><i class="fa fa-check"></i><b>24.1</b> Curing Infections</a></li>
<li class="chapter" data-level="24.2" data-path="24.2-chemoprotection.html"><a href="24.2-chemoprotection.html"><i class="fa fa-check"></i><b>24.2</b> Chemoprotection</a></li>
<li class="chapter" data-level="24.3" data-path="24.3-adherance.html"><a href="24.3-adherance.html"><i class="fa fa-check"></i><b>24.3</b> Adherance</a></li>
<li class="chapter" data-level="24.4" data-path="24.4-treatment-rates.html"><a href="24.4-treatment-rates.html"><i class="fa fa-check"></i><b>24.4</b> Treatment Rates</a></li>
</ul></li>
<li class="chapter" data-level="25" data-path="25-gametocytes-and-infectiousness-1.html"><a href="25-gametocytes-and-infectiousness-1.html"><i class="fa fa-check"></i><b>25</b> Gametocytes and Infectiousness</a>
<ul>
<li class="chapter" data-level="25.1" data-path="25.1-gametocytemia.html"><a href="25.1-gametocytemia.html"><i class="fa fa-check"></i><b>25.1</b> Gametocytemia</a></li>
<li class="chapter" data-level="25.2" data-path="25.2-anti-gametocyte-immunity.html"><a href="25.2-anti-gametocyte-immunity.html"><i class="fa fa-check"></i><b>25.2</b> Anti-Gametocyte Immunity</a></li>
</ul></li>
<li class="chapter" data-level="26" data-path="26-models-and-malaria-epidemiology.html"><a href="26-models-and-malaria-epidemiology.html"><i class="fa fa-check"></i><b>26</b> Models and Malaria Epidemiology</a>
<ul>
<li class="chapter" data-level="26.1" data-path="26.1-section.html"><a href="26.1-section.html"><i class="fa fa-check"></i><b>26.1</b> </a></li>
</ul></li>
<li class="part"><span><b>V Mosquito Ecology</b></span></li>
<li class="chapter" data-level="27" data-path="27-mosquitoes.html"><a href="27-mosquitoes.html"><i class="fa fa-check"></i><b>27</b> Mosquitoes</a>
<ul>
<li class="chapter" data-level="27.1" data-path="27.1-aquatic-dynamics.html"><a href="27.1-aquatic-dynamics.html"><i class="fa fa-check"></i><b>27.1</b> Aquatic Dynamics</a>
<ul>
<li class="chapter" data-level="27.1.1" data-path="27.1-aquatic-dynamics.html"><a href="27.1-aquatic-dynamics.html#equations-1"><i class="fa fa-check"></i><b>27.1.1</b> Equations</a></li>
<li class="chapter" data-level="27.1.2" data-path="27.1-aquatic-dynamics.html"><a href="27.1-aquatic-dynamics.html#solutions-3"><i class="fa fa-check"></i><b>27.1.2</b> Solutions</a></li>
<li class="chapter" data-level="27.1.3" data-path="27.1-aquatic-dynamics.html"><a href="27.1-aquatic-dynamics.html#regulation-1"><i class="fa fa-check"></i><b>27.1.3</b> Regulation</a></li>
</ul></li>
<li class="chapter" data-level="27.2" data-path="27.2-understanding-mosquito-dynamics.html"><a href="27.2-understanding-mosquito-dynamics.html"><i class="fa fa-check"></i><b>27.2</b> Understanding Mosquito Dynamics</a></li>
</ul></li>
<li class="chapter" data-level="28" data-path="28-behavioral-state-models.html"><a href="28-behavioral-state-models.html"><i class="fa fa-check"></i><b>28</b> Behavioral State Models</a></li>
<li class="chapter" data-level="29" data-path="29-regulation-of-mosquito-populations.html"><a href="29-regulation-of-mosquito-populations.html"><i class="fa fa-check"></i><b>29</b> Regulation of Mosquito Populations</a></li>
<li class="chapter" data-level="30" data-path="30-mosquito-dispersal.html"><a href="30-mosquito-dispersal.html"><i class="fa fa-check"></i><b>30</b> Mosquito Dispersal</a></li>
<li class="chapter" data-level="31" data-path="31-mosquito-age.html"><a href="31-mosquito-age.html"><i class="fa fa-check"></i><b>31</b> Mosquito Age</a></li>
<li class="chapter" data-level="32" data-path="32-multi-species-models.html"><a href="32-multi-species-models.html"><i class="fa fa-check"></i><b>32</b> Multi-Species Models</a>
<ul>
<li class="chapter" data-level="32.1" data-path="32.1-vector-competence.html"><a href="32.1-vector-competence.html"><i class="fa fa-check"></i><b>32.1</b> Vector Competence</a></li>
</ul></li>
<li class="chapter" data-level="33" data-path="33-aquatic-ecology.html"><a href="33-aquatic-ecology.html"><i class="fa fa-check"></i><b>33</b> Aquatic Ecology</a></li>
<li class="chapter" data-level="34" data-path="34-mosquito-larval-stages.html"><a href="34-mosquito-larval-stages.html"><i class="fa fa-check"></i><b>34</b> Mosquito Larval Stages</a></li>
<li class="chapter" data-level="35" data-path="35-temporal-dynamics.html"><a href="35-temporal-dynamics.html"><i class="fa fa-check"></i><b>35</b> Temporal Dynamics</a>
<ul>
<li class="chapter" data-level="35.1" data-path="35.1-exogenous-forcing-2.html"><a href="35.1-exogenous-forcing-2.html"><i class="fa fa-check"></i><b>35.1</b> Exogenous Forcing</a></li>
<li class="chapter" data-level="35.2" data-path="35.2-mosquito-survival-through-the-eip.html"><a href="35.2-mosquito-survival-through-the-eip.html"><i class="fa fa-check"></i><b>35.2</b> Mosquito Survival through the EIP</a></li>
</ul></li>
<li class="chapter" data-level="36" data-path="36-measuring-mosquitoes.html"><a href="36-measuring-mosquitoes.html"><i class="fa fa-check"></i><b>36</b> Measuring Mosquitoes</a></li>
<li class="part"><span><b>VI Transmission</b></span></li>
<li class="chapter" data-level="37" data-path="37-blood-feeding-1.html"><a href="37-blood-feeding-1.html"><i class="fa fa-check"></i><b>37</b> Blood Feeding</a>
<ul>
<li class="chapter" data-level="37.0.1" data-path="37-blood-feeding-1.html"><a href="37-blood-feeding-1.html#search-and-risk"><i class="fa fa-check"></i><b>37.0.1</b> Search and Risk</a></li>
<li class="chapter" data-level="37.0.2" data-path="37-blood-feeding-1.html"><a href="37-blood-feeding-1.html#search-weights-and-availability"><i class="fa fa-check"></i><b>37.0.2</b> Search Weights and Availability</a></li>
<li class="chapter" data-level="37.0.3" data-path="37-blood-feeding-1.html"><a href="37-blood-feeding-1.html#functional-response"><i class="fa fa-check"></i><b>37.0.3</b> Functional Response</a></li>
<li class="chapter" data-level="37.0.4" data-path="37-blood-feeding-1.html"><a href="37-blood-feeding-1.html#environmental-heterogeneity-1"><i class="fa fa-check"></i><b>37.0.4</b> Environmental Heterogeneity</a></li>
<li class="chapter" data-level="37.1" data-path="37.1-host-availability.html"><a href="37.1-host-availability.html"><i class="fa fa-check"></i><b>37.1</b> Host Availability</a></li>
<li class="chapter" data-level="37.2" data-path="37.2-blood-feeding-rates.html"><a href="37.2-blood-feeding-rates.html"><i class="fa fa-check"></i><b>37.2</b> Blood Feeding Rates</a></li>
<li class="chapter" data-level="37.3" data-path="37.3-the-human-fraction.html"><a href="37.3-the-human-fraction.html"><i class="fa fa-check"></i><b>37.3</b> The Human Fraction</a></li>
<li class="chapter" data-level="37.4" data-path="37.4-the-mixing-matrix-beta.html"><a href="37.4-the-mixing-matrix-beta.html"><i class="fa fa-check"></i><b>37.4</b> The Mixing Matrix, <span class="math inline">\(\beta\)</span></a></li>
</ul></li>
<li class="chapter" data-level="38" data-path="38-human-mobility.html"><a href="38-human-mobility.html"><i class="fa fa-check"></i><b>38</b> Human Mobility</a>
<ul>
<li class="chapter" data-level="38.1" data-path="38.1-modalities.html"><a href="38.1-modalities.html"><i class="fa fa-check"></i><b>38.1</b> Modalities</a></li>
<li class="chapter" data-level="38.2" data-path="38.2-time-at-risk.html"><a href="38.2-time-at-risk.html"><i class="fa fa-check"></i><b>38.2</b> Time at Risk</a></li>
<li class="chapter" data-level="38.3" data-path="38.3-travel.html"><a href="38.3-travel.html"><i class="fa fa-check"></i><b>38.3</b> Travel</a></li>
<li class="chapter" data-level="38.4" data-path="38.4-migration.html"><a href="38.4-migration.html"><i class="fa fa-check"></i><b>38.4</b> Migration</a></li>
</ul></li>
<li class="chapter" data-level="39" data-path="39-spatial-dynamics-1.html"><a href="39-spatial-dynamics-1.html"><i class="fa fa-check"></i><b>39</b> Spatial Dynamics</a></li>
<li class="chapter" data-level="40" data-path="40-heterogeneous-transmission-1.html"><a href="40-heterogeneous-transmission-1.html"><i class="fa fa-check"></i><b>40</b> Heterogeneous Transmission</a>
<ul>
<li class="chapter" data-level="40.1" data-path="40.1-overview-1.html"><a href="40.1-overview-1.html"><i class="fa fa-check"></i><b>40.1</b> Overview</a>
<ul>
<li class="chapter" data-level="40.1.1" data-path="40.1-overview-1.html"><a href="40.1-overview-1.html#age-1"><i class="fa fa-check"></i><b>40.1.1</b> Age</a></li>
<li class="chapter" data-level="40.1.2" data-path="40.1-overview-1.html"><a href="40.1-overview-1.html#location"><i class="fa fa-check"></i><b>40.1.2</b> Location</a></li>
<li class="chapter" data-level="40.1.3" data-path="40.1-overview-1.html"><a href="40.1-overview-1.html#house-type"><i class="fa fa-check"></i><b>40.1.3</b> House Type</a></li>
<li class="chapter" data-level="40.1.4" data-path="40.1-overview-1.html"><a href="40.1-overview-1.html#activities"><i class="fa fa-check"></i><b>40.1.4</b> Activities</a></li>
</ul></li>
<li class="chapter" data-level="40.2" data-path="40.2-frailtyCh.html"><a href="40.2-frailtyCh.html"><i class="fa fa-check"></i><b>40.2</b> Frailty</a></li>
<li class="chapter" data-level="40.3" data-path="40.3-environmentalHeterogeneity.html"><a href="40.3-environmentalHeterogeneity.html"><i class="fa fa-check"></i><b>40.3</b> Environmental Heterogeneity</a></li>
</ul></li>
<li class="part"><span><b>VII Malaria Control</b></span></li>
<li class="chapter" data-level="41" data-path="41-malaria-control.html"><a href="41-malaria-control.html"><i class="fa fa-check"></i><b>41</b> Malaria Control</a>
<ul>
<li class="chapter" data-level="41.1" data-path="41.1-health-systems.html"><a href="41.1-health-systems.html"><i class="fa fa-check"></i><b>41.1</b> Health Systems</a></li>
<li class="chapter" data-level="41.2" data-path="41.2-vector-control.html"><a href="41.2-vector-control.html"><i class="fa fa-check"></i><b>41.2</b> Vector Control</a></li>
</ul></li>
<li class="chapter" data-level="42" data-path="42-insecticide-treated-bednets.html"><a href="42-insecticide-treated-bednets.html"><i class="fa fa-check"></i><b>42</b> Insecticide-Treated Bednets</a></li>
<li class="chapter" data-level="43" data-path="43-indoor-residual-spraying.html"><a href="43-indoor-residual-spraying.html"><i class="fa fa-check"></i><b>43</b> Indoor Residual Spraying</a></li>
<li class="chapter" data-level="44" data-path="44-larval-source-management-1.html"><a href="44-larval-source-management-1.html"><i class="fa fa-check"></i><b>44</b> Larval Source Management</a></li>
<li class="chapter" data-level="45" data-path="45-attractive-toxic-sugar-baits.html"><a href="45-attractive-toxic-sugar-baits.html"><i class="fa fa-check"></i><b>45</b> Attractive Toxic Sugar Baits</a></li>
<li class="chapter" data-level="46" data-path="46-integrated-vector-control-1.html"><a href="46-integrated-vector-control-1.html"><i class="fa fa-check"></i><b>46</b> Integrated Vector Control</a></li>
<li class="part"><span><b>VIII Health Systems</b></span></li>
<li class="chapter" data-level="47" data-path="47-cohort-dynamics-1.html"><a href="47-cohort-dynamics-1.html"><i class="fa fa-check"></i><b>47</b> Cohort Dynamics</a>
<ul>
<li class="chapter" data-level="47.1" data-path="47.1-boxcar-models.html"><a href="47.1-boxcar-models.html"><i class="fa fa-check"></i><b>47.1</b> Boxcar Models</a></li>
<li class="chapter" data-level="47.2" data-path="47.2-delay.html"><a href="47.2-delay.html"><i class="fa fa-check"></i><b>47.2</b> Delay</a></li>
</ul></li>
<li class="chapter" data-level="48" data-path="6.2-human-demography.html"><a href="6.2-human-demography.html#human-demography"><i class="fa fa-check"></i><b>48</b> Human Demography</a>
<ul>
<li class="chapter" data-level="48.1" data-path="48.1-migration-1.html"><a href="48.1-migration-1.html"><i class="fa fa-check"></i><b>48.1</b> Migration</a></li>
</ul></li>
<li class="chapter" data-level="49" data-path="49-human-travel-and-malaria-importation.html"><a href="49-human-travel-and-malaria-importation.html"><i class="fa fa-check"></i><b>49</b> Human Travel and Malaria Importation</a></li>
<li class="chapter" data-level="50" data-path="50-stratification.html"><a href="50-stratification.html"><i class="fa fa-check"></i><b>50</b> Stratification</a></li>
<li class="chapter" data-level="51" data-path="51-pharmaceutical-interventions.html"><a href="51-pharmaceutical-interventions.html"><i class="fa fa-check"></i><b>51</b> Pharmaceutical Interventions</a>
<ul>
<li class="chapter" data-level="51.1" data-path="51.1-smc.html"><a href="51.1-smc.html"><i class="fa fa-check"></i><b>51.1</b> SMC</a></li>
<li class="chapter" data-level="51.2" data-path="51.2-mda.html"><a href="51.2-mda.html"><i class="fa fa-check"></i><b>51.2</b> MDA</a></li>
<li class="chapter" data-level="51.3" data-path="51.3-drugs.html"><a href="51.3-drugs.html"><i class="fa fa-check"></i><b>51.3</b> Drugs</a></li>
<li class="chapter" data-level="51.4" data-path="51.4-vaccines.html"><a href="51.4-vaccines.html"><i class="fa fa-check"></i><b>51.4</b> Vaccines</a></li>
</ul></li>
<li class="part"><span><b>IX Analytics</b></span></li>
<li class="chapter" data-level="52" data-path="52-malaria-analytics.html"><a href="52-malaria-analytics.html"><i class="fa fa-check"></i><b>52</b> Malaria Analytics</a>
<ul>
<li class="chapter" data-level="52.1" data-path="52.1-the-burden-of-malaria-1.html"><a href="52.1-the-burden-of-malaria-1.html"><i class="fa fa-check"></i><b>52.1</b> The Burden of Malaria</a></li>
<li class="chapter" data-level="52.2" data-path="52.2-a-theory-of-control.html"><a href="52.2-a-theory-of-control.html"><i class="fa fa-check"></i><b>52.2</b> A Theory of Control</a></li>
<li class="chapter" data-level="52.3" data-path="52.3-generic-vs.-specific-advice.html"><a href="52.3-generic-vs.-specific-advice.html"><i class="fa fa-check"></i><b>52.3</b> Generic <em>vs.</em> Specific Advice</a></li>
<li class="chapter" data-level="52.4" data-path="52.4-imputation-1.html"><a href="52.4-imputation-1.html"><i class="fa fa-check"></i><b>52.4</b> Imputation</a></li>
<li class="chapter" data-level="52.5" data-path="52.5-robust-analytics.html"><a href="52.5-robust-analytics.html"><i class="fa fa-check"></i><b>52.5</b> Robust Analytics</a></li>
</ul></li>
<li class="chapter" data-level="53" data-path="53-malaria-metrics.html"><a href="53-malaria-metrics.html"><i class="fa fa-check"></i><b>53</b> Malaria Metrics</a>
<ul>
<li class="chapter" data-level="53.1" data-path="53.1-realistic-bounds.html"><a href="53.1-realistic-bounds.html"><i class="fa fa-check"></i><b>53.1</b> Realistic Bounds</a></li>
<li class="chapter" data-level="53.2" data-path="53.2-the-local-fraction.html"><a href="53.2-the-local-fraction.html"><i class="fa fa-check"></i><b>53.2</b> The Local Fraction</a>
<ul>
<li class="chapter" data-level="53.2.1" data-path="53.2-the-local-fraction.html"><a href="53.2-the-local-fraction.html#travel-1"><i class="fa fa-check"></i><b>53.2.1</b> Travel</a></li>
<li class="chapter" data-level="53.2.2" data-path="53.2-the-local-fraction.html"><a href="53.2-the-local-fraction.html#mobility"><i class="fa fa-check"></i><b>53.2.2</b> Mobility</a></li>
</ul></li>
<li class="chapter" data-level="53.3" data-path="53.3-drug-taking-1.html"><a href="53.3-drug-taking-1.html"><i class="fa fa-check"></i><b>53.3</b> Drug Taking</a></li>
<li class="chapter" data-level="53.4" data-path="53.4-seasonality-1.html"><a href="53.4-seasonality-1.html"><i class="fa fa-check"></i><b>53.4</b> Seasonality</a></li>
<li class="chapter" data-level="53.5" data-path="53.5-frailty.html"><a href="53.5-frailty.html"><i class="fa fa-check"></i><b>53.5</b> Frailty</a></li>
<li class="chapter" data-level="53.6" data-path="53.6-environmental-heterogeneity-2.html"><a href="53.6-environmental-heterogeneity-2.html"><i class="fa fa-check"></i><b>53.6</b> Environmental Heterogeneity</a></li>
<li class="chapter" data-level="53.7" data-path="53.7-pfeir-vs.-pfpr-in-data.html"><a href="53.7-pfeir-vs.-pfpr-in-data.html"><i class="fa fa-check"></i><b>53.7</b> <em>Pf</em>EIR <em>vs.</em> <em>Pf</em>PR in Data</a></li>
<li class="chapter" data-level="53.8" data-path="53.8-pfeir-vs.-pffoi-in-data.html"><a href="53.8-pfeir-vs.-pffoi-in-data.html"><i class="fa fa-check"></i><b>53.8</b> <em>Pf</em>EIR <em>vs.</em> <em>Pf</em>FoI in Data</a></li>
<li class="chapter" data-level="53.9" data-path="53.9-synthesis-1.html"><a href="53.9-synthesis-1.html"><i class="fa fa-check"></i><b>53.9</b> Synthesis</a></li>
</ul></li>
<li class="chapter" data-level="54" data-path="54-discrete-time.html"><a href="54-discrete-time.html"><i class="fa fa-check"></i><b>54</b> Discrete Time</a></li>
<li class="chapter" data-level="55" data-path="55-spatial-concepts-and-connectivity.html"><a href="55-spatial-concepts-and-connectivity.html"><i class="fa fa-check"></i><b>55</b> Spatial Concepts and Connectivity</a></li>
<li class="chapter" data-level="56" data-path="56-mosquito-microecology.html"><a href="56-mosquito-microecology.html"><i class="fa fa-check"></i><b>56</b> Mosquito Microecology</a></li>
<li class="chapter" data-level="57" data-path="57-microsimulation.html"><a href="57-microsimulation.html"><i class="fa fa-check"></i><b>57</b> Microsimulation</a></li>
<li class="chapter" data-level="58" data-path="58-spatial-control.html"><a href="58-spatial-control.html"><i class="fa fa-check"></i><b>58</b> Spatial Control</a></li>
<li class="chapter" data-level="59" data-path="59-model-libraries.html"><a href="59-model-libraries.html"><i class="fa fa-check"></i><b>59</b> Model Libraries</a></li>
<li class="chapter" data-level="60" data-path="60-base-models.html"><a href="60-base-models.html"><i class="fa fa-check"></i><b>60</b> Base Models</a></li>
<li class="chapter" data-level="61" data-path="61-built-in-analytics.html"><a href="61-built-in-analytics.html"><i class="fa fa-check"></i><b>61</b> Built-in Analytics</a></li>
<li class="chapter" data-level="62" data-path="62-stochasticity.html"><a href="62-stochasticity.html"><i class="fa fa-check"></i><b>62</b> Stochasticity</a></li>
<li class="chapter" data-level="63" data-path="63-a-glossary.html"><a href="63-a-glossary.html"><i class="fa fa-check"></i><b>63</b> A Glossary</a></li>
<li class="part"><span><b>X Supplements</b></span></li>
<li class="chapter" data-level="64" data-path="64-references.html"><a href="64-references.html"><i class="fa fa-check"></i><b>64</b> References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Applied Malaria Dynamics</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="dtsRoss" class="section level2 hasAnchor" number="2.1">
<h2><span class="header-section-number">2.1</span> Deterministic, Discrete Time<a href="2.1-dtsRoss.html#dtsRoss" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><em>The parts of a model: variables, parameters, initial conditions.</em></p>
<hr />
<p>In this section, we present the basic, deterministic, discrete-time model for a mosquito-transmitted pathogen. Because it is the first model in the book, we’ll take the time to explain some background material in detail. We’ll discuss the parts of a model, and we walk through sections about solving, computation, analysis, and model verification. The first model we present, called <code>ross_dts_1,</code> we is numerically unstable in some cases. At the end we present another model, called <code>ross_dts_2</code> that is numerically stable.</p>
<div id="ross_dts_1" class="section level3 hasAnchor" number="2.1.1">
<h3><span class="header-section-number">2.1.1</span> <code>ross_dts_1</code><a href="2.1-dtsRoss.html#ross_dts_1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We will present the parts of the model first, and write down the equations last. The parts of a model are called parameters and variables. To solve the model, we will need initial conditions for the variables. As we go, we will also write R code that implements the model and that solves it. In writing the code, we will adopt some conventions that we can use to help us write good code.</p>
<p><strong>Variables</strong> are quantities that describe the state of a system.
One variable in this model is time, denoted <span class="math inline">\(t.\)</span>
The <em>dependent variables</em> are the quantities that we want to compute, and they are
computed at various time points. Time is marching forward, unaffected by the dependent variables, so we call it the <em>independent variable.</em></p>
<p>In this model, there are two dependent variables: the proportion of humans and mosquitoes that are infected at each point in time. Since it is a discrete time system, the values of the variables are defined only at integer values of <span class="math inline">\(t.\)</span> We define the variables as follows:</p>
<ul>
<li><p>let <span class="math inline">\(t\)</span> represent time, in days;</p></li>
<li><p>let <span class="math inline">\(x_t\)</span> be the fraction of people who are infected at time <span class="math inline">\(t,\)</span> and <span class="math inline">\(0 \leq x_t \leq 1;\)</span></p></li>
<li><p>let <span class="math inline">\(y_t\)</span> be the fraction of mosquitoes who are infected at time <span class="math inline">\(t,\)</span> <span class="math inline">\(0 \leq y_t \leq 1.\)</span></p></li>
</ul>
<p>Another term for the fraction of a population that infected with parasites is <em>prevalence.</em></p>
<p><strong>Initial Conditions</strong> are the values of the variables at one point in time. Since the values of our variables in the next time step (at time <span class="math inline">\(t+1\)</span>) depend on their values now (at time <span class="math inline">\(t\)</span>), we can’t really compute anything specific unless we specify the values of the variables at one point in time. Having set one set of values, we can use the equations to compute the rest.</p>
<p>The initial conditions specify the values of all our variables at the beginning of the simulation. By convention, this is usually at time <span class="math inline">\(t=0,\)</span> but we could also specify their values at any other point in time.</p>
<p>We can now begin to write R code to set up the objects so we can compute them. We set these initial values to be small:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="2.1-dtsRoss.html#cb1-1" tabindex="-1"></a><span class="co"># Initial Conditions at a point in time, as a Named Vector </span></span>
<span id="cb1-2"><a href="2.1-dtsRoss.html#cb1-2" tabindex="-1"></a>xy <span class="ot">=</span> <span class="fu">c</span>(<span class="at">t=</span><span class="dv">0</span>, <span class="at">x=</span><span class="fl">0.01</span>, <span class="at">y=</span><span class="fl">0.001</span>)</span></code></pre></div>
<p>In R, this object <code>xy</code> is called a <em>named vector.</em> The names are carried along but they don’t affect any computation done with <code>xy.</code> It is also useful that the names often get inherited (but not always). The names can be used with <code>as.list()</code> or <code>data.frame().</code> When combined with the <code>with()</code> function, we can create a context where we can call them by name:</p>
<pre><code>## [1] 0.01</code></pre>
<p>This code has adopted the convention of using named vectors so that we can write functions in a way that is easy to read. It also makes it easier to deal with the model outputs.</p>
<p><strong>Parameters</strong> are quantities – rates, numbers, or probabilities – that describe some part of the process. Unlike variables, parameter values are chosen outside of a model and passed to it. In <code>ross_dts_1,</code> these parameters are constant. Since they are constant, we call this an <em>autonomous</em> system of equations. In other models, we could have parameter values that changes over time, so the system would be called <em>non-autonomous.</em></p>
<p>The parameters in this model define changes in prevalence: the fraction of humans that clear an infection each day; the fraction of infected mosquitoes that die; and blood feeding and infection.</p>
<ul>
<li><p>Let <span class="math inline">\(s\)</span> denote the fraction of people who clear infections after one day; <span class="math inline">\(0 &lt; s &lt; 1.\)</span></p></li>
<li><p>Let <span class="math inline">\(u\)</span> denote the fraction of mosquitoes who die in one day; <span class="math inline">\(0 &lt; u &lt; 1.\)</span></p></li>
<li><p>Let <span class="math inline">\(a\)</span> denote the fraction of mosquitoes who blood feed on a human in a day; <span class="math inline">\(0 &lt; a &lt; 1.\)</span></p></li>
<li><p>Let <span class="math inline">\(m\)</span> denote the number of mosquitoes per human; <span class="math inline">\(m \geq 0.\)</span></p></li>
</ul>
<p><strong>Equations</strong> describe dynamic changes in the variables over time. In this case, the process is described by a system of coupled difference equations.</p>
<p>Finally, we put all this together into a mathematical statement that has translated the description of a process, that are describe the process.</p>
<p><span class="math display" id="eq:ross1a">\[\begin{equation}
\begin{array}{rl}
x_{t+1} &amp;=  x_t - s x_t + m a y_t (1-x_t)  \\
y_{t+1} &amp;=  y_t - u y_t + a x_t (1 - y_t) \\
\end{array}
\tag{2.3}
\end{equation}\]</span></p>
<p>We could rewrite the equations to make it easier to interpret them.</p>
<p><span class="math display" id="eq:ross1b">\[\begin{equation}
\begin{array}{rl}
x_{t+1} - x_t &amp;=  - s x_t + m a y_t (1-x_t)  \\
y_{t+1} - y_t &amp;=  - u y_t + a x_t (1 - y_t) \\
\end{array}
\tag{2.4}
\end{equation}\]</span></p>
<p>In this alternative way of writing down the equations, the left hand side is interpreted as <em>the daily change,</em> and the terms on the right hand side describes those changes. The RHS has four terms:</p>
<ul>
<li><p><span class="math inline">\(- s x_t\)</span> – is a decrease in the prevalence of human malaria infections caused by clearance of human infections: the fraction of humans who are infected is <span class="math inline">\(x_t\)</span>; a fraction <span class="math inline">\(s\)</span> clears infections each day.</p></li>
<li><p><span class="math inline">\(+ may_t (1-x_t)\)</span> – is an increase in the prevalence of human malaria infections caused by the bites of infectious mosquitoes: the fraction of humans who are not infected is <span class="math inline">\(1-x_t\)</span>; a fraction <span class="math inline">\(m a y_t\)</span> gets infected.</p></li>
<li><p><span class="math inline">\(-u y_t\)</span> – is a decrease in the prevalence of mosquito malaria infections caused by mosquito mortality: the fraction of mosquitoes who are infected is <span class="math inline">\(y_t\)</span>; a fraction <span class="math inline">\(u\)</span> die.</p></li>
<li><p><span class="math inline">\(+ a x_t (1-y_t)\)</span> – is an increase in the prevalence of mosquito malaria infections caused blood feeding on an infected human: the fraction of mosquitoes who are not infected is <span class="math inline">\(1-y_t\)</span>; a fraction <span class="math inline">\(a x_t\)</span> blood feeds on an infected human and gets infected.</p></li>
</ul>
<p>To foreshadow something we will address in sub-section <a href="2.1-dtsRoss.html#dtsRoss2">2.1.9</a>, if <span class="math inline">\(may_t &gt;1,\)</span> then it is not a proportion, and the equations don’t make sense.</p>
<hr />
<p>To update the variables, we write a function in R. Since we will be developing a lot of functions and models, we adopt a simple naming convention: since it was developed by Ross, we attach the stem <code>ross</code>; since this is a discrete time system, we attach the suffix <code>dts</code>; we might want to generate other variants, so we append a number. The function is thus called <code>ross_dts_1.</code></p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="2.1-dtsRoss.html#cb3-1" tabindex="-1"></a><span class="co"># INPUTS</span></span>
<span id="cb3-2"><a href="2.1-dtsRoss.html#cb3-2" tabindex="-1"></a><span class="co"># xy - current variables, as a named vector</span></span>
<span id="cb3-3"><a href="2.1-dtsRoss.html#cb3-3" tabindex="-1"></a><span class="co"># p  - the parameters, as a list</span></span>
<span id="cb3-4"><a href="2.1-dtsRoss.html#cb3-4" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb3-5"><a href="2.1-dtsRoss.html#cb3-5" tabindex="-1"></a><span class="co"># OUTPUTS</span></span>
<span id="cb3-6"><a href="2.1-dtsRoss.html#cb3-6" tabindex="-1"></a><span class="co"># the updated values of the variables, as a named vector</span></span>
<span id="cb3-7"><a href="2.1-dtsRoss.html#cb3-7" tabindex="-1"></a></span>
<span id="cb3-8"><a href="2.1-dtsRoss.html#cb3-8" tabindex="-1"></a>ross_dts_1 <span class="ot">=</span> <span class="cf">function</span>(xy, p){</span>
<span id="cb3-9"><a href="2.1-dtsRoss.html#cb3-9" tabindex="-1"></a>  <span class="fu">with</span>(<span class="fu">as.list</span>(xy), </span>
<span id="cb3-10"><a href="2.1-dtsRoss.html#cb3-10" tabindex="-1"></a>    <span class="fu">with</span>(p,{</span>
<span id="cb3-11"><a href="2.1-dtsRoss.html#cb3-11" tabindex="-1"></a>      xn <span class="ot">=</span> x <span class="sc">-</span> s<span class="sc">*</span>x <span class="sc">+</span> m<span class="sc">*</span>a<span class="sc">*</span>y<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>x) </span>
<span id="cb3-12"><a href="2.1-dtsRoss.html#cb3-12" tabindex="-1"></a>      yn <span class="ot">=</span> y <span class="sc">-</span> u<span class="sc">*</span>y <span class="sc">+</span> a<span class="sc">*</span>x<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>y) </span>
<span id="cb3-13"><a href="2.1-dtsRoss.html#cb3-13" tabindex="-1"></a>      <span class="fu">return</span>(<span class="fu">c</span>(<span class="at">t=</span>t<span class="sc">+</span><span class="dv">1</span>, <span class="at">x=</span>xn, <span class="at">y=</span>yn))</span>
<span id="cb3-14"><a href="2.1-dtsRoss.html#cb3-14" tabindex="-1"></a>    })</span>
<span id="cb3-15"><a href="2.1-dtsRoss.html#cb3-15" tabindex="-1"></a>  )</span>
<span id="cb3-16"><a href="2.1-dtsRoss.html#cb3-16" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="solving" class="section level3 hasAnchor" number="2.1.2">
<h3><span class="header-section-number">2.1.2</span> Solving<a href="2.1-dtsRoss.html#solving" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>With the R code we developed, we can <em>solve</em> the equations, which involves computing the values of the variables iteratively. Since the values of the variables change, we create another object <code>xy_t</code> that we can use to store the values of computed variables over time.</p>
<p>We iterate in two steps. First, we compute the values.</p>
<p>Since we initialized the system at time <span class="math inline">\(t=0,\)</span> the following computes the values of the parameters at time <span class="math inline">\(t=1.\)</span> We can take a peak at the values we computed:</p>
<pre><code>##           t           x           y 
## 1.000000000 0.010445000 0.003414167</code></pre>
<p>Next, we store the values using <code>rbind</code></p>
<p>We can take a peak:</p>
<pre><code>##      t        x           y
## xy_t 0 0.010000 0.001000000
## xy   1 0.010445 0.003414167</code></pre>
<p>We can iterate over many time steps, each time storing the values:</p>
<p>We can look at the last few values, the values of <span class="math inline">\(t,\)</span> <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> are stored in columns:</p>
<pre><code>##     t         x         y
## xy 38 0.9865573 0.7465869
## xy 39 0.9866426 0.7468730
## xy 40 0.9866975 0.7470700</code></pre>
<p>As we can see, the values are changing a little at the end.</p>
</div>
<div id="visualizing" class="section level3 hasAnchor" number="2.1.3">
<h3><span class="header-section-number">2.1.3</span> Visualizing<a href="2.1-dtsRoss.html#visualizing" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We can now plot out the values over the first 40 days. Since <code>xy_t</code> is a named list, we transform it and plot:</p>
<p><img src="figs/plot_ross_dts_1-1.png" width="672" /></p>
<p>Notice that after 40 days, the values of <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> appear to be approaching some value asymptotically. This is an important feature of these systems, one that we would like to understand and explore a bit more in the following sections.</p>
</div>
<div id="computation" class="section level3 hasAnchor" number="2.1.4">
<h3><span class="header-section-number">2.1.4</span> Computation<a href="2.1-dtsRoss.html#computation" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Computers are very good at repeating tasks, but if we want to get the computers to repeat tasks efficiently, we must write code that does it. One useful trick is to write functions that call other functions to expedite workflows. In this case, we want to write a function that <em>solves</em> the equations (<em>i.e.</em> that iteratively computes and stores the values) over some time interval:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="2.1-dtsRoss.html#cb7-1" tabindex="-1"></a><span class="co"># INPUTS</span></span>
<span id="cb7-2"><a href="2.1-dtsRoss.html#cb7-2" tabindex="-1"></a><span class="co"># pars - the parameters, as a list </span></span>
<span id="cb7-3"><a href="2.1-dtsRoss.html#cb7-3" tabindex="-1"></a><span class="co"># x0   - the initial value of x</span></span>
<span id="cb7-4"><a href="2.1-dtsRoss.html#cb7-4" tabindex="-1"></a><span class="co"># y0   - the initial value of y</span></span>
<span id="cb7-5"><a href="2.1-dtsRoss.html#cb7-5" tabindex="-1"></a><span class="co"># t0   - the initial value of t</span></span>
<span id="cb7-6"><a href="2.1-dtsRoss.html#cb7-6" tabindex="-1"></a><span class="co"># tmax - the last value of t </span></span>
<span id="cb7-7"><a href="2.1-dtsRoss.html#cb7-7" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb7-8"><a href="2.1-dtsRoss.html#cb7-8" tabindex="-1"></a><span class="co"># OUTPUTS</span></span>
<span id="cb7-9"><a href="2.1-dtsRoss.html#cb7-9" tabindex="-1"></a><span class="co"># the values of the variables over time, as a list </span></span>
<span id="cb7-10"><a href="2.1-dtsRoss.html#cb7-10" tabindex="-1"></a>ross_dts_solve_1 <span class="ot">=</span> <span class="cf">function</span>(pars, <span class="at">x0=</span>.<span class="dv">01</span>, <span class="at">y0 =</span> <span class="fl">0.001</span>, <span class="at">t0=</span><span class="dv">0</span>, <span class="at">tmax=</span><span class="dv">100</span>){</span>
<span id="cb7-11"><a href="2.1-dtsRoss.html#cb7-11" tabindex="-1"></a>   xy <span class="ot">=</span> <span class="fu">c</span>(<span class="at">t=</span>t0, <span class="at">x=</span>x0, <span class="at">y=</span>y0) </span>
<span id="cb7-12"><a href="2.1-dtsRoss.html#cb7-12" tabindex="-1"></a>   xy_t <span class="ot">=</span> xy </span>
<span id="cb7-13"><a href="2.1-dtsRoss.html#cb7-13" tabindex="-1"></a>   <span class="cf">for</span>(t <span class="cf">in</span> (t0<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>tmax){</span>
<span id="cb7-14"><a href="2.1-dtsRoss.html#cb7-14" tabindex="-1"></a>     xy <span class="ot">=</span> <span class="fu">ross_dts_1</span>(xy, pars)</span>
<span id="cb7-15"><a href="2.1-dtsRoss.html#cb7-15" tabindex="-1"></a>     xy_t <span class="ot">=</span> <span class="fu">rbind</span>(xy_t, xy)</span>
<span id="cb7-16"><a href="2.1-dtsRoss.html#cb7-16" tabindex="-1"></a>   }</span>
<span id="cb7-17"><a href="2.1-dtsRoss.html#cb7-17" tabindex="-1"></a>   <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">time=</span>xy_t[,<span class="dv">1</span>], <span class="at">x=</span>xy_t[,<span class="dv">2</span>], <span class="at">y =</span> xy_t[,<span class="dv">3</span>], <span class="at">last =</span> xy)) </span>
<span id="cb7-18"><a href="2.1-dtsRoss.html#cb7-18" tabindex="-1"></a>}</span></code></pre></div>
<p>We can write another function that <em>plots</em> the equations (<em>i.e.</em> that iteratively computes and stores the values) over some time interval:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="2.1-dtsRoss.html#cb8-1" tabindex="-1"></a><span class="co"># INPUTS</span></span>
<span id="cb8-2"><a href="2.1-dtsRoss.html#cb8-2" tabindex="-1"></a><span class="co"># xy_t - a list with elements named x, y, and time</span></span>
<span id="cb8-3"><a href="2.1-dtsRoss.html#cb8-3" tabindex="-1"></a><span class="co"># type - plot type:  &quot;l&quot; or &quot;p&quot; or &quot;b&quot;</span></span>
<span id="cb8-4"><a href="2.1-dtsRoss.html#cb8-4" tabindex="-1"></a><span class="co"># lty  - lty  </span></span>
<span id="cb8-5"><a href="2.1-dtsRoss.html#cb8-5" tabindex="-1"></a><span class="co"># add  - if TRUE, add to existing plot </span></span>
<span id="cb8-6"><a href="2.1-dtsRoss.html#cb8-6" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb8-7"><a href="2.1-dtsRoss.html#cb8-7" tabindex="-1"></a><span class="co"># OUTPUTS</span></span>
<span id="cb8-8"><a href="2.1-dtsRoss.html#cb8-8" tabindex="-1"></a><span class="co"># the values of the variables over time, as a list </span></span>
<span id="cb8-9"><a href="2.1-dtsRoss.html#cb8-9" tabindex="-1"></a>plot_xy <span class="ot">=</span> <span class="cf">function</span>(xy_t, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">lty=</span><span class="dv">1</span>, <span class="at">add=</span><span class="cn">FALSE</span>){<span class="fu">with</span>(xy_t,{</span>
<span id="cb8-10"><a href="2.1-dtsRoss.html#cb8-10" tabindex="-1"></a>  <span class="cf">if</span>(add <span class="sc">==</span> <span class="cn">FALSE</span>) </span>
<span id="cb8-11"><a href="2.1-dtsRoss.html#cb8-11" tabindex="-1"></a>  <span class="fu">plot</span>(time, x, <span class="st">&quot;n&quot;</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">ylab =</span> <span class="st">&quot;Prevalence&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;Time&quot;</span>)</span>
<span id="cb8-12"><a href="2.1-dtsRoss.html#cb8-12" tabindex="-1"></a>  <span class="fu">lines</span>(time, x, <span class="at">type =</span> type, <span class="at">lty=</span>lty, <span class="at">col =</span> <span class="st">&quot;darkgreen&quot;</span>, <span class="at">pch =</span><span class="dv">15</span>)</span>
<span id="cb8-13"><a href="2.1-dtsRoss.html#cb8-13" tabindex="-1"></a>  <span class="fu">lines</span>(time, y, <span class="at">type =</span> type, <span class="at">lty=</span>lty, <span class="at">col =</span> <span class="st">&quot;darkorange&quot;</span>, <span class="at">pch =</span><span class="dv">19</span>)</span>
<span id="cb8-14"><a href="2.1-dtsRoss.html#cb8-14" tabindex="-1"></a>  <span class="fu">text</span>(<span class="dv">0</span>, <span class="fl">0.9</span>, <span class="st">&quot;x&quot;</span>, <span class="at">col =</span> <span class="st">&quot;darkgreen&quot;</span>, <span class="at">pos=</span><span class="dv">4</span>) </span>
<span id="cb8-15"><a href="2.1-dtsRoss.html#cb8-15" tabindex="-1"></a>  <span class="fu">text</span>(<span class="dv">0</span>, <span class="fl">0.8</span>, <span class="st">&quot;y&quot;</span>, <span class="at">col =</span> <span class="st">&quot;darkorange&quot;</span>, <span class="at">pos=</span><span class="dv">4</span>) </span>
<span id="cb8-16"><a href="2.1-dtsRoss.html#cb8-16" tabindex="-1"></a>})}</span></code></pre></div>
<p>Now, all the work we did above can be plotted using a single function call:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="2.1-dtsRoss.html#cb9-1" tabindex="-1"></a><span class="fu">plot_xy</span>(<span class="fu">ross_dts_solve_1</span>(ross_dts_par, <span class="at">tmax=</span><span class="dv">40</span>), <span class="at">type=</span><span class="st">&quot;p&quot;</span>) </span></code></pre></div>
<p><img src="figs/replot_ross_dts_1-1.png" width="672" /></p>
<p>Now, it is easier to repeat all our analysis with a simple function call.</p>
</div>
<div id="steady-states" class="section level3 hasAnchor" number="2.1.5">
<h3><span class="header-section-number">2.1.5</span> Steady States<a href="2.1-dtsRoss.html#steady-states" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The fact that our variables asymptotically approach some values over time is an important feature of dynamical systems, so we would like to do some analysis to understand it better. If we look at Eq. <a href="2.1-dtsRoss.html#eq:ross1b">(2.4)</a>, we can understand why. In this model, there is no change when the proportion of humans becoming infected is equal to the proportion clearing infections; and the proportion of mosquitoes becoming infected is equal to the proportion dying.</p>
<p>In the following, we compute how much the system is changing over time. We can simply iterate once and compare the differences. After iterating 40 times, the differences are very small:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="2.1-dtsRoss.html#cb10-1" tabindex="-1"></a><span class="co"># The last value is still stored as xy; the [-1] omits t</span></span>
<span id="cb10-2"><a href="2.1-dtsRoss.html#cb10-2" tabindex="-1"></a>xy[<span class="sc">-</span><span class="dv">1</span>] <span class="sc">-</span> <span class="fu">ross_dts_1</span>(xy, ross_dts_par)[<span class="sc">-</span><span class="dv">1</span>]</span></code></pre></div>
<pre><code>##             x             y 
## -3.545225e-05 -1.355019e-04</code></pre>
<p>If we iterate another hundred days and check again, the differences have gotten even smaller:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="2.1-dtsRoss.html#cb12-1" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">41</span><span class="sc">:</span><span class="dv">140</span>){</span>
<span id="cb12-2"><a href="2.1-dtsRoss.html#cb12-2" tabindex="-1"></a>  xy <span class="ot">=</span> <span class="fu">ross_dts_1</span>(xy, ross_dts_par)</span>
<span id="cb12-3"><a href="2.1-dtsRoss.html#cb12-3" tabindex="-1"></a>  xy_t <span class="ot">=</span> <span class="fu">rbind</span>(xy_t, xy) </span>
<span id="cb12-4"><a href="2.1-dtsRoss.html#cb12-4" tabindex="-1"></a>} </span>
<span id="cb12-5"><a href="2.1-dtsRoss.html#cb12-5" tabindex="-1"></a>xy[<span class="sc">-</span><span class="dv">1</span>] <span class="sc">-</span> <span class="fu">ross_dts_1</span>(xy, ross_dts_par)[<span class="sc">-</span><span class="dv">1</span>]</span></code></pre></div>
<pre><code>## x y 
## 0 0</code></pre>
<p>After simulating, the variables reach a steady state, where asymptotically <span class="math inline">\(x_{t+1} = x_t\)</span> and <span class="math inline">\(y_{t+1} = y_t\)</span>.</p>
<p>A steady state occurs when there is no daily change, so <span class="math inline">\(x_{t+1} - x_t = 0\)</span> and <span class="math inline">\(y_{t+1} - y_t = 0.\)</span> We can figure out the steady state values are by substituting <span class="math inline">\(x_{t+1} = x_t = x\)</span> and <span class="math inline">\(y_{t+1} = y_t = y\)</span> into Eq.<a href="2.1-dtsRoss.html#eq:ross1b">(2.4)</a> and then solving for <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span>. After cancelling and rearranging, we get:</p>
<p><span class="math display" id="eq:ross1steady">\[\begin{equation}
\begin{array}{rl}
m a y (1-x) &amp;=  s x \\
a x (1 - y) &amp;=  u y\\
\end{array}
\tag{2.5}
\end{equation}\]</span></p>
<p>Equations <a href="2.1-dtsRoss.html#eq:ross1steady">(2.5)</a> say: <em>the proportion of humans becoming infected is equal to the proportion clearing infections</em>; and <em>the proportion of mosquitoes becoming infected is equal to the proportion dying.</em></p>
<p>The most obvious solution to these equations is <span class="math inline">\(x=y=0,\)</span> when there is no malaria. We call it the disease-free steady state. A disease-free equilibrium makes sense, since if we start with no infected mosquitoes or infected humans in this deterministic model, there can never be any.</p>
<p>There is another solution where malaria is present. We solve the second equation first:</p>
<p><span class="math display">\[y = a x / (u + a x).\]</span></p>
<p>Next, we substitute this for the <span class="math inline">\(y\)</span> term that is in the first equation, and we get:</p>
<p><span class="math display">\[m a^2 (1-x) =  s (u+ax)\]</span></p>
<p>and now we solve for <span class="math inline">\(x\)</span></p>
<p><span class="math display">\[x = \frac{\textstyle{ma^2 - su}}{\textstyle{ma^2 + sa}}\]</span>
We can write a function to compute this steady state:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="2.1-dtsRoss.html#cb14-1" tabindex="-1"></a><span class="co"># INPUTS</span></span>
<span id="cb14-2"><a href="2.1-dtsRoss.html#cb14-2" tabindex="-1"></a><span class="co"># params - the parameters, as a list </span></span>
<span id="cb14-3"><a href="2.1-dtsRoss.html#cb14-3" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb14-4"><a href="2.1-dtsRoss.html#cb14-4" tabindex="-1"></a><span class="co"># OUTPUTS</span></span>
<span id="cb14-5"><a href="2.1-dtsRoss.html#cb14-5" tabindex="-1"></a><span class="co"># the steady state values of x and y </span></span>
<span id="cb14-6"><a href="2.1-dtsRoss.html#cb14-6" tabindex="-1"></a>ross_dts_steady_0 <span class="ot">=</span> <span class="cf">function</span>(params){<span class="fu">with</span>(params,{</span>
<span id="cb14-7"><a href="2.1-dtsRoss.html#cb14-7" tabindex="-1"></a>  xx <span class="ot">=</span> (m<span class="sc">*</span>a<span class="sc">^</span><span class="dv">2</span> <span class="sc">-</span> s<span class="sc">*</span>u)<span class="sc">/</span> (m<span class="sc">*</span>a<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> s<span class="sc">*</span>a)</span>
<span id="cb14-8"><a href="2.1-dtsRoss.html#cb14-8" tabindex="-1"></a>  yy <span class="ot">=</span> a<span class="sc">*</span>xx<span class="sc">/</span>(u<span class="sc">+</span>a<span class="sc">*</span>xx) </span>
<span id="cb14-9"><a href="2.1-dtsRoss.html#cb14-9" tabindex="-1"></a>  <span class="fu">c</span>(<span class="at">x=</span>xx,<span class="at">y=</span>yy)</span>
<span id="cb14-10"><a href="2.1-dtsRoss.html#cb14-10" tabindex="-1"></a>})}</span></code></pre></div>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="2.1-dtsRoss.html#cb15-1" tabindex="-1"></a><span class="fu">ross_dts_steady_0</span>(ross_dts_par)</span></code></pre></div>
<pre><code>##         x         y 
## 0.9867987 0.7475000</code></pre>
</div>
<div id="thresholds" class="section level3 hasAnchor" number="2.1.6">
<h3><span class="header-section-number">2.1.6</span> Thresholds<a href="2.1-dtsRoss.html#thresholds" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>All our analysis worked out well for the parameter values that we chose, but what if we had picked different parameters?</p>
<p>There must be some very low level of mosquitoes, for example, where malaria parasites can’t be sustained in a population. If we reduce <span class="math inline">\(m\)</span> to <span class="math inline">\(0.005\)</span> and evaluate the expression at the steady state, we get negative values for <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span>.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="2.1-dtsRoss.html#cb17-1" tabindex="-1"></a>ross_dts_par1 <span class="ot">=</span> ross_dts_par</span>
<span id="cb17-2"><a href="2.1-dtsRoss.html#cb17-2" tabindex="-1"></a>ross_dts_par1<span class="sc">$</span>m <span class="ot">=</span> <span class="fl">0.005</span></span>
<span id="cb17-3"><a href="2.1-dtsRoss.html#cb17-3" tabindex="-1"></a><span class="fu">ross_dts_steady_0</span>(ross_dts_par1)</span></code></pre></div>
<pre><code>##           x           y 
## -0.06666667 -0.25000000</code></pre>
<p>What happens if we simulate this? (Let’s set the initial conditions to reasonably high values)</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="2.1-dtsRoss.html#cb19-1" tabindex="-1"></a><span class="fu">plot_xy</span>(<span class="fu">ross_dts_solve_1</span>(ross_dts_par1, <span class="at">x0 =</span> .<span class="dv">5</span>, <span class="at">y0=</span>.<span class="dv">3</span>, <span class="at">tmax=</span><span class="dv">1500</span>)) </span></code></pre></div>
<p><img src="figs/ross_dts_1_zero-1.png" width="672" /></p>
<p>Our function <code>ross_dts_steady_0</code> gives us a negative number.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="2.1-dtsRoss.html#cb20-1" tabindex="-1"></a><span class="fu">ross_dts_steady_0</span>(ross_dts_par1)</span></code></pre></div>
<pre><code>##           x           y 
## -0.06666667 -0.25000000</code></pre>
<p>If we look at the equations, it’s easy enough to spot the problem. Since <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> must be positive, then it must be true that <span class="math display">\[m a^2 &gt; su.\]</span> We call this a threshold condition.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="2.1-dtsRoss.html#cb22-1" tabindex="-1"></a>m_crit <span class="ot">=</span> <span class="fu">with</span>(ross_dts_par, s<span class="sc">*</span>u<span class="sc">/</span>a<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb22-2"><a href="2.1-dtsRoss.html#cb22-2" tabindex="-1"></a>m_crit </span></code></pre></div>
<pre><code>## [1] 0.006666667</code></pre>
<p>If we check, we find that this gives us the disease free equilibrium.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="2.1-dtsRoss.html#cb24-1" tabindex="-1"></a>ross_dts_par2 <span class="ot">=</span> ross_dts_par</span>
<span id="cb24-2"><a href="2.1-dtsRoss.html#cb24-2" tabindex="-1"></a>ross_dts_par2<span class="sc">$</span>m <span class="ot">=</span> m_crit</span>
<span id="cb24-3"><a href="2.1-dtsRoss.html#cb24-3" tabindex="-1"></a><span class="fu">ross_dts_steady_0</span>(ross_dts_par2)</span></code></pre></div>
<pre><code>## x y 
## 0 0</code></pre>
<p>It doesn’t make sense to have a negative amount of malaria. Since <code>ross_dts_steady_0</code>gives us negative numbers, we can use this little bit of information to write a better function, one that returns <span class="math inline">\(0\)</span> instead of a negative number:</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="2.1-dtsRoss.html#cb26-1" tabindex="-1"></a><span class="co"># INPUTS</span></span>
<span id="cb26-2"><a href="2.1-dtsRoss.html#cb26-2" tabindex="-1"></a><span class="co"># params - the parameters, as a list </span></span>
<span id="cb26-3"><a href="2.1-dtsRoss.html#cb26-3" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb26-4"><a href="2.1-dtsRoss.html#cb26-4" tabindex="-1"></a><span class="co"># OUTPUTS</span></span>
<span id="cb26-5"><a href="2.1-dtsRoss.html#cb26-5" tabindex="-1"></a><span class="co"># the steady state values of x and y </span></span>
<span id="cb26-6"><a href="2.1-dtsRoss.html#cb26-6" tabindex="-1"></a>ross_dts_steady_1 <span class="ot">=</span> <span class="cf">function</span>(params){<span class="fu">with</span>(params,{</span>
<span id="cb26-7"><a href="2.1-dtsRoss.html#cb26-7" tabindex="-1"></a>  xx <span class="ot">=</span> <span class="fu">ifelse</span>(m<span class="sc">*</span>a<span class="sc">^</span><span class="dv">2</span> <span class="sc">&gt;</span> s<span class="sc">*</span>u, (m<span class="sc">*</span>a<span class="sc">^</span><span class="dv">2</span> <span class="sc">-</span> s<span class="sc">*</span>u)<span class="sc">/</span>(m<span class="sc">*</span>a<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> s<span class="sc">*</span>a), <span class="dv">0</span>) </span>
<span id="cb26-8"><a href="2.1-dtsRoss.html#cb26-8" tabindex="-1"></a>  yy <span class="ot">=</span> a<span class="sc">*</span>xx<span class="sc">/</span>(u<span class="sc">+</span>a<span class="sc">*</span>xx) </span>
<span id="cb26-9"><a href="2.1-dtsRoss.html#cb26-9" tabindex="-1"></a>  <span class="fu">c</span>(<span class="at">x=</span>xx,<span class="at">y=</span>yy)</span>
<span id="cb26-10"><a href="2.1-dtsRoss.html#cb26-10" tabindex="-1"></a>})}</span></code></pre></div>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="2.1-dtsRoss.html#cb27-1" tabindex="-1"></a><span class="fu">ross_dts_steady_1</span>(ross_dts_par1)</span></code></pre></div>
<pre><code>## x y 
## 0 0</code></pre>
</div>
<div id="verification" class="section level3 hasAnchor" number="2.1.7">
<h3><span class="header-section-number">2.1.7</span> Verification<a href="2.1-dtsRoss.html#verification" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>If we’re going to take ourselves seriously, we want to get used to double checking everything to avoid inserting mistakes. One way to do this is to find two or more ways of computing the same thing, for verification.</p>
<p>If we’ve done everything right, we ought to get the same values for the steady states through our analysis and simulation.</p>
<p>The last values of <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> from the simulation are:</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="2.1-dtsRoss.html#cb29-1" tabindex="-1"></a>xy[<span class="sc">-</span><span class="dv">1</span>]</span></code></pre></div>
<pre><code>##         x         y 
## 0.9867987 0.7475000</code></pre>
<p>The last values of <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> from evaluating <code>ross_dts_steady_1()</code> are:</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="2.1-dtsRoss.html#cb31-1" tabindex="-1"></a><span class="fu">ross_dts_steady_1</span>(ross_dts_par) </span></code></pre></div>
<pre><code>##         x         y 
## 0.9867987 0.7475000</code></pre>
<p>It’s tempting to look at the printout and assume these two numbers are exactly equal, but when we deal with computers, everything gets computed and stored in some way. We can never be sure that a match will be be exact. We can simply sum up the absolute values of the differences:</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="2.1-dtsRoss.html#cb33-1" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">abs</span>(xy[<span class="sc">-</span><span class="dv">1</span>] <span class="sc">-</span> <span class="fu">ross_dts_steady_1</span>(ross_dts_par)))</span></code></pre></div>
<pre><code>## [1] 3.330669e-16</code></pre>
<p>If we wanted to reduce this to a simple error check, we should pick a tolerance level – say <span class="math inline">\(10^{-9}\)</span> – and then just ask if we are closer than that:</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="2.1-dtsRoss.html#cb35-1" tabindex="-1"></a><span class="co"># INPUTS</span></span>
<span id="cb35-2"><a href="2.1-dtsRoss.html#cb35-2" tabindex="-1"></a><span class="co"># xy  - xy </span></span>
<span id="cb35-3"><a href="2.1-dtsRoss.html#cb35-3" tabindex="-1"></a><span class="co"># par - a set of parameters for a ross_dts model </span></span>
<span id="cb35-4"><a href="2.1-dtsRoss.html#cb35-4" tabindex="-1"></a><span class="co"># tol - a tolerance level </span></span>
<span id="cb35-5"><a href="2.1-dtsRoss.html#cb35-5" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb35-6"><a href="2.1-dtsRoss.html#cb35-6" tabindex="-1"></a><span class="co"># OUTPUTS</span></span>
<span id="cb35-7"><a href="2.1-dtsRoss.html#cb35-7" tabindex="-1"></a><span class="co"># boolean - </span></span>
<span id="cb35-8"><a href="2.1-dtsRoss.html#cb35-8" tabindex="-1"></a>ross_dts_checkit_1 <span class="ot">=</span> <span class="cf">function</span>(xy, ross_dts_pars, <span class="at">tol=</span><span class="fl">1e-9</span>){</span>
<span id="cb35-9"><a href="2.1-dtsRoss.html#cb35-9" tabindex="-1"></a>  <span class="fu">sum</span>(<span class="fu">abs</span>(xy[<span class="sc">-</span><span class="dv">1</span>] <span class="sc">-</span> <span class="fu">ross_dts_steady_1</span>(ross_dts_pars)))  <span class="sc">&lt;</span> tol</span>
<span id="cb35-10"><a href="2.1-dtsRoss.html#cb35-10" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="2.1-dtsRoss.html#cb36-1" tabindex="-1"></a><span class="fu">ross_dts_checkit_1</span>(xy, ross_dts_par)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
</div>
<div id="numerical-instability" class="section level3 hasAnchor" number="2.1.8">
<h3><span class="header-section-number">2.1.8</span> Numerical Instability<a href="2.1-dtsRoss.html#numerical-instability" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>There is another problem with the equations. If we set <span class="math inline">\(m\)</span> too high, such that at some point <span class="math inline">\(m a y_t &gt; 1,\)</span> then the whole system eventually crashes:</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="2.1-dtsRoss.html#cb38-1" tabindex="-1"></a>ross_dts_par3 <span class="ot">=</span> ross_dts_par</span>
<span id="cb38-2"><a href="2.1-dtsRoss.html#cb38-2" tabindex="-1"></a>ross_dts_par3<span class="sc">$</span>m <span class="ot">=</span> <span class="dv">20</span> </span>
<span id="cb38-3"><a href="2.1-dtsRoss.html#cb38-3" tabindex="-1"></a><span class="fu">plot_xy</span>(<span class="fu">ross_dts_solve_1</span>(ross_dts_par3, <span class="at">x0 =</span> .<span class="dv">01</span>, <span class="at">y0=</span>.<span class="dv">001</span>, <span class="at">tmax=</span><span class="dv">20</span>), <span class="st">&quot;b&quot;</span>) </span></code></pre></div>
<p><img src="figs/ross_dts_mess-1.png" width="672" /></p>
<p>In discrete time formulations, we must be very careful to ensure that we have formulated a proper model. How can we fix this problem? We have to go back and rethink the way we formulated our model. How does the probability of getting infected scale with the number of infective bites?</p>
</div>
<div id="dtsRoss2" class="section level3 hasAnchor" number="2.1.9">
<h3><span class="header-section-number">2.1.9</span> <code>ross_dts_2</code><a href="2.1-dtsRoss.html#dtsRoss2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>There is a good solution to the problem that gave rise to this numerical instability. The question at hand is what fraction of people would become infected, on average, if the expected number of bites was <span class="math inline">\(may_t?\)</span> Ideally, we want to return a proportion, even when <span class="math inline">\(may_t&gt;1.\)</span> We call this quantity – the fraction that gets infected in a day – the <em>daily attack rate.</em></p>
<p>If we knew that there were exactly an integer number of bites, <span class="math inline">\(ma,\)</span> then the proportion of people not getting infected would be those that didn’t get infected from any one of the bites, or <span class="math inline">\((1-y_t)^{ma}.\)</span> There is, however, an even better way to think about this.</p>
<p>In a lot of cases like this, without any other information, we would assume that the number of bites, per person, would follow a Poisson distribution. It’s actually easier to say who doesn’t get infected, and that’s the zero term of a Poisson, <span class="math inline">\(e^{-may_t}.\)</span> The probability of getting infected is the complement of the probability of getting at least one bite, or</p>
<p><span class="math display">\[1 - e^{-m a y_t}\]</span></p>
<p><strong>Equations</strong></p>
<p>Our variables, initial conditions, and parameters are all defined in the same way as <code>ross_dts_1,</code> but now our equations have changed:</p>
<p><span class="math display" id="eq:ross1c">\[\begin{equation}
\begin{array}{rl}
x_{t+1} &amp;=  x_t - s x_t + (1-e^{-m a y_t}) (1-x_t)  \\
y_{t+1} &amp;=  y_t - u y_t + a x_t (1 - y_t) \\
\end{array}
\tag{2.6}
\end{equation}\]</span></p>
<p>As before, we write a function to numerically solve the discrete time system:</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="2.1-dtsRoss.html#cb39-1" tabindex="-1"></a><span class="co"># INPUTS</span></span>
<span id="cb39-2"><a href="2.1-dtsRoss.html#cb39-2" tabindex="-1"></a><span class="co"># xy      - current variables, as a named vector</span></span>
<span id="cb39-3"><a href="2.1-dtsRoss.html#cb39-3" tabindex="-1"></a><span class="co"># params  - the parameters, as a list</span></span>
<span id="cb39-4"><a href="2.1-dtsRoss.html#cb39-4" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb39-5"><a href="2.1-dtsRoss.html#cb39-5" tabindex="-1"></a><span class="co"># OUTPUTS</span></span>
<span id="cb39-6"><a href="2.1-dtsRoss.html#cb39-6" tabindex="-1"></a><span class="co"># the updated values of the variables, as a named vector</span></span>
<span id="cb39-7"><a href="2.1-dtsRoss.html#cb39-7" tabindex="-1"></a>ross_dts_2 <span class="ot">=</span> <span class="cf">function</span>(xy, params){<span class="fu">with</span>(<span class="fu">as.list</span>(xy), <span class="fu">with</span>(params,{</span>
<span id="cb39-8"><a href="2.1-dtsRoss.html#cb39-8" tabindex="-1"></a>  xn <span class="ot">=</span> x <span class="sc">-</span> s<span class="sc">*</span>x <span class="sc">+</span> (<span class="dv">1</span><span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span>m<span class="sc">*</span>a<span class="sc">*</span>y))<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>x) </span>
<span id="cb39-9"><a href="2.1-dtsRoss.html#cb39-9" tabindex="-1"></a>  yn <span class="ot">=</span> y <span class="sc">-</span> u<span class="sc">*</span>y <span class="sc">+</span> a<span class="sc">*</span>x<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>y) </span>
<span id="cb39-10"><a href="2.1-dtsRoss.html#cb39-10" tabindex="-1"></a>  t<span class="ot">=</span>t<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb39-11"><a href="2.1-dtsRoss.html#cb39-11" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">c</span>(<span class="at">t=</span>t, <span class="at">x=</span>xn, <span class="at">y=</span>yn))</span>
<span id="cb39-12"><a href="2.1-dtsRoss.html#cb39-12" tabindex="-1"></a>}))}</span></code></pre></div>
<p>Once again, we can wrap a function around the solver so that it’s easier to use the code:</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="2.1-dtsRoss.html#cb40-1" tabindex="-1"></a><span class="co"># INPUTS</span></span>
<span id="cb40-2"><a href="2.1-dtsRoss.html#cb40-2" tabindex="-1"></a><span class="co"># pars - the parameters, as a list </span></span>
<span id="cb40-3"><a href="2.1-dtsRoss.html#cb40-3" tabindex="-1"></a><span class="co"># x0   - the initial value of x</span></span>
<span id="cb40-4"><a href="2.1-dtsRoss.html#cb40-4" tabindex="-1"></a><span class="co"># y0   - the initial value of y</span></span>
<span id="cb40-5"><a href="2.1-dtsRoss.html#cb40-5" tabindex="-1"></a><span class="co"># t0   - the initial value of t</span></span>
<span id="cb40-6"><a href="2.1-dtsRoss.html#cb40-6" tabindex="-1"></a><span class="co"># tmax - the last value of t </span></span>
<span id="cb40-7"><a href="2.1-dtsRoss.html#cb40-7" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb40-8"><a href="2.1-dtsRoss.html#cb40-8" tabindex="-1"></a><span class="co"># OUTPUTS</span></span>
<span id="cb40-9"><a href="2.1-dtsRoss.html#cb40-9" tabindex="-1"></a><span class="co"># the values of the variables over time, as a list </span></span>
<span id="cb40-10"><a href="2.1-dtsRoss.html#cb40-10" tabindex="-1"></a>ross_dts_solve_2 <span class="ot">=</span> <span class="cf">function</span>(pars, <span class="at">x0=</span>.<span class="dv">01</span>, <span class="at">y0 =</span> <span class="fl">0.001</span>, <span class="at">t0=</span><span class="dv">0</span>, <span class="at">tmax=</span><span class="dv">100</span>){</span>
<span id="cb40-11"><a href="2.1-dtsRoss.html#cb40-11" tabindex="-1"></a>   xy <span class="ot">=</span> <span class="fu">c</span>(<span class="at">t=</span>t0, <span class="at">x=</span>x0, <span class="at">y=</span>y0) </span>
<span id="cb40-12"><a href="2.1-dtsRoss.html#cb40-12" tabindex="-1"></a>   xy <span class="ot">=</span> <span class="fu">c</span>(<span class="at">t=</span><span class="dv">0</span>, <span class="at">x=</span>x0, <span class="at">y=</span>y0) </span>
<span id="cb40-13"><a href="2.1-dtsRoss.html#cb40-13" tabindex="-1"></a>   xy_t <span class="ot">=</span> xy </span>
<span id="cb40-14"><a href="2.1-dtsRoss.html#cb40-14" tabindex="-1"></a>   <span class="cf">for</span>(t <span class="cf">in</span> (t0<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>tmax){</span>
<span id="cb40-15"><a href="2.1-dtsRoss.html#cb40-15" tabindex="-1"></a>     xy <span class="ot">=</span> <span class="fu">ross_dts_2</span>(xy, pars)</span>
<span id="cb40-16"><a href="2.1-dtsRoss.html#cb40-16" tabindex="-1"></a>     xy_t <span class="ot">=</span> <span class="fu">rbind</span>(xy_t, xy)</span>
<span id="cb40-17"><a href="2.1-dtsRoss.html#cb40-17" tabindex="-1"></a>   }</span>
<span id="cb40-18"><a href="2.1-dtsRoss.html#cb40-18" tabindex="-1"></a>   <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">time=</span>xy_t[,<span class="dv">1</span>], <span class="at">x=</span>xy_t[,<span class="dv">2</span>], <span class="at">y =</span> xy_t[,<span class="dv">3</span>], <span class="at">last =</span> xy)) </span>
<span id="cb40-19"><a href="2.1-dtsRoss.html#cb40-19" tabindex="-1"></a>}</span></code></pre></div>
<p>Now, we can visualize the output using code we’ve already written, and can see that we have fixed our stability problem.</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="2.1-dtsRoss.html#cb41-1" tabindex="-1"></a><span class="fu">plot_xy</span>(<span class="fu">ross_dts_solve_2</span>(ross_dts_par3, <span class="at">x0 =</span> .<span class="dv">01</span>, <span class="at">y0=</span>.<span class="dv">001</span>, <span class="at">tmax=</span><span class="dv">20</span>), <span class="st">&quot;b&quot;</span>) </span></code></pre></div>
<p><img src="figs/plot_ross_dts_2-1.png" width="672" /></p>
<p><strong>Verification</strong></p>
<p>For verification, we want a method to solve things two different ways. If we want to compute the steady state, we’re stuck with the problem of solving this equation:</p>
<p><span class="math display">\[(1-e^{-m a^2 x/(u + a x)}) (1-x) = sx\]</span></p>
<p>It’s surprisingly easy to write down equations, like this one, that we can’t solve with pencil and paper. We can still find a way of computing the steady state, but we have to write R code that solves for <span class="math inline">\(x\)</span> numerically.</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="2.1-dtsRoss.html#cb42-1" tabindex="-1"></a><span class="co"># INPUTS</span></span>
<span id="cb42-2"><a href="2.1-dtsRoss.html#cb42-2" tabindex="-1"></a><span class="co"># par - the model parameters, as a list </span></span>
<span id="cb42-3"><a href="2.1-dtsRoss.html#cb42-3" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb42-4"><a href="2.1-dtsRoss.html#cb42-4" tabindex="-1"></a><span class="co"># OUTPUTS</span></span>
<span id="cb42-5"><a href="2.1-dtsRoss.html#cb42-5" tabindex="-1"></a><span class="co"># the steady state values of x and y </span></span>
<span id="cb42-6"><a href="2.1-dtsRoss.html#cb42-6" tabindex="-1"></a>ross_dts_steady_2 <span class="ot">=</span> <span class="cf">function</span>(pars){<span class="fu">with</span>(pars,{</span>
<span id="cb42-7"><a href="2.1-dtsRoss.html#cb42-7" tabindex="-1"></a>   f_xx <span class="ot">=</span> <span class="cf">function</span>(x, pp){<span class="fu">with</span>(pp,{</span>
<span id="cb42-8"><a href="2.1-dtsRoss.html#cb42-8" tabindex="-1"></a>     xx <span class="ot">=</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">exp</span>(<span class="sc">-</span>m<span class="sc">*</span>a<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>x<span class="sc">/</span>(u<span class="sc">+</span>a<span class="sc">*</span>x)))<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>x) <span class="sc">-</span> s<span class="sc">*</span>x</span>
<span id="cb42-9"><a href="2.1-dtsRoss.html#cb42-9" tabindex="-1"></a>     y <span class="ot">=</span> a<span class="sc">*</span>xx<span class="sc">/</span>(u<span class="sc">+</span>a<span class="sc">*</span>xx)</span>
<span id="cb42-10"><a href="2.1-dtsRoss.html#cb42-10" tabindex="-1"></a>     yy <span class="ot">=</span> u<span class="sc">*</span>y <span class="sc">+</span> a<span class="sc">*</span>xx<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>y) </span>
<span id="cb42-11"><a href="2.1-dtsRoss.html#cb42-11" tabindex="-1"></a>     <span class="fu">return</span>(xx<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> yy<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb42-12"><a href="2.1-dtsRoss.html#cb42-12" tabindex="-1"></a>   })}</span>
<span id="cb42-13"><a href="2.1-dtsRoss.html#cb42-13" tabindex="-1"></a>   xx <span class="ot">=</span> <span class="fu">optimize</span>(f_xx, <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">pp=</span>pars, <span class="at">tol =</span> <span class="fl">1e-10</span>)<span class="sc">$</span>min</span>
<span id="cb42-14"><a href="2.1-dtsRoss.html#cb42-14" tabindex="-1"></a>   yy <span class="ot">=</span> a<span class="sc">*</span>xx<span class="sc">/</span>(u<span class="sc">+</span>a<span class="sc">*</span>xx) </span>
<span id="cb42-15"><a href="2.1-dtsRoss.html#cb42-15" tabindex="-1"></a>   <span class="fu">c</span>(xx, yy)</span>
<span id="cb42-16"><a href="2.1-dtsRoss.html#cb42-16" tabindex="-1"></a>})}</span></code></pre></div>
<p>Finding the equilibrium this way, we get:</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="2.1-dtsRoss.html#cb43-1" tabindex="-1"></a><span class="fu">ross_dts_steady_2</span>(ross_dts_par3)</span></code></pre></div>
<pre><code>## [1] 0.9949051 0.7490410</code></pre>
<p>Second, by getting the solution after many iterations.</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="2.1-dtsRoss.html#cb45-1" tabindex="-1"></a><span class="fu">ross_dts_solve_2</span>(ross_dts_par3, <span class="at">x0=</span>.<span class="dv">1</span>, <span class="at">y0=</span>.<span class="dv">05</span>,<span class="at">tmax=</span><span class="dv">300</span>)<span class="sc">$</span>last[<span class="sc">-</span><span class="dv">1</span>]</span></code></pre></div>
<pre><code>##         x         y 
## 0.9949051 0.7490410</code></pre>
<p>By inspection, these two numbers are very close, but not exactly matching. Once again, we want to ensure that our code does not have any mistakes, so we write a function to verify our results. We set a term that describes an acceptable tolerance for computational errors, and ask if we’re at least that close.</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="2.1-dtsRoss.html#cb47-1" tabindex="-1"></a>ross_dts_checkit_2 <span class="ot">=</span> <span class="cf">function</span>(pars, <span class="at">x0 =</span> .<span class="dv">1</span>, <span class="at">y0=</span>.<span class="dv">05</span>, <span class="at">tmax=</span><span class="dv">500</span>, <span class="at">tol=</span><span class="fl">1e-7</span>){</span>
<span id="cb47-2"><a href="2.1-dtsRoss.html#cb47-2" tabindex="-1"></a>  xyt <span class="ot">=</span> <span class="fu">ross_dts_solve_2</span>(pars, <span class="at">x0=</span>x0, <span class="at">y0=</span>y0, <span class="at">tmax=</span>tmax)</span>
<span id="cb47-3"><a href="2.1-dtsRoss.html#cb47-3" tabindex="-1"></a>  <span class="fu">sum</span>(<span class="fu">abs</span>(xyt<span class="sc">$</span>last[<span class="sc">-</span><span class="dv">1</span>] <span class="sc">-</span> <span class="fu">ross_dts_steady_2</span>(pars))) <span class="sc">&lt;</span> tol</span>
<span id="cb47-4"><a href="2.1-dtsRoss.html#cb47-4" tabindex="-1"></a>}</span></code></pre></div>
<p>Do the two answers differ by less than <span class="math inline">\(10^{-7}\)</span>?</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="2.1-dtsRoss.html#cb48-1" tabindex="-1"></a><span class="fu">ross_dts_checkit_2</span>(ross_dts_par3)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<p>It’s a little unsatisfying to get numerical errors, but machines don’t do exact computation easily. We’re interested in getting as close as we need to get without doing a lot of work that would, in the end, never make a difference. The operating principle here is that we need to be sure that our code is doing what we think it should, and that it is giving answers that are close enough.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="2-basic-malaria-models.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="2.2-sdtsRoss.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="assets/gitbook-2.6.7/js/app.min.js"></script>
<script src="assets/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="assets/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
},
"toolbar": {
"position": "static"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
