<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>1.2 Solutions | Applied Malaria Dynamics</title>
  <meta name="description" content="The RAMP Model and Algorithm Library" />
  <meta name="generator" content="bookdown 0.31 and GitBook 2.6.7" />

  <meta property="og:title" content="1.2 Solutions | Applied Malaria Dynamics" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="The RAMP Model and Algorithm Library" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="1.2 Solutions | Applied Malaria Dynamics" />
  
  <meta name="twitter:description" content="The RAMP Model and Algorithm Library" />
  

<meta name="author" content="David L. Smith and the RAMP Team" />


<meta name="date" content="2023-01-28" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="aron-and-mays-equations.html"/>
<link rel="next" href="steady-states.html"/>
<script src="assets/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="assets/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="assets/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="assets/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="assets/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Foreword</a>
<ul>
<li class="chapter" data-level="" data-path="models-for-policy.html"><a href="models-for-policy.html"><i class="fa fa-check"></i>Models for Policy</a></li>
<li class="chapter" data-level="" data-path="contributors.html"><a href="contributors.html"><i class="fa fa-check"></i>Contributors</a></li>
</ul></li>
<li class="part"><span><b>I Basic Concepts</b></span></li>
<li class="chapter" data-level="1" data-path="malaria-dynamics.html"><a href="malaria-dynamics.html"><i class="fa fa-check"></i><b>1</b> Malaria Dynamics</a>
<ul>
<li class="chapter" data-level="1.1" data-path="aron-and-mays-equations.html"><a href="aron-and-mays-equations.html"><i class="fa fa-check"></i><b>1.1</b> Aron and May’s Equations</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="aron-and-mays-equations.html"><a href="aron-and-mays-equations.html#mosquito-ecology"><i class="fa fa-check"></i><b>1.1.1</b> Mosquito Ecology</a></li>
<li class="chapter" data-level="1.1.2" data-path="aron-and-mays-equations.html"><a href="aron-and-mays-equations.html#blood-fed-mosquitoes"><i class="fa fa-check"></i><b>1.1.2</b> Blood Fed Mosquitoes</a></li>
<li class="chapter" data-level="1.1.3" data-path="aron-and-mays-equations.html"><a href="aron-and-mays-equations.html#infected-mosquitoes"><i class="fa fa-check"></i><b>1.1.3</b> Infected Mosquitoes</a></li>
<li class="chapter" data-level="1.1.4" data-path="aron-and-mays-equations.html"><a href="aron-and-mays-equations.html#infectious-mosquitoes"><i class="fa fa-check"></i><b>1.1.4</b> Infectious Mosquitoes</a></li>
<li class="chapter" data-level="1.1.5" data-path="aron-and-mays-equations.html"><a href="aron-and-mays-equations.html#RossEqn"><i class="fa fa-check"></i><b>1.1.5</b> Infected Humans</a></li>
<li class="chapter" data-level="1.1.6" data-path="aron-and-mays-equations.html"><a href="aron-and-mays-equations.html#as-a-system"><i class="fa fa-check"></i><b>1.1.6</b> …as a System</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="solutions.html"><a href="solutions.html"><i class="fa fa-check"></i><b>1.2</b> Solutions</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="solutions.html"><a href="solutions.html#derivatives"><i class="fa fa-check"></i><b>1.2.1</b> Derivatives</a></li>
<li class="chapter" data-level="1.2.2" data-path="solutions.html"><a href="solutions.html#initial-values"><i class="fa fa-check"></i><b>1.2.2</b> Initial Values</a></li>
<li class="chapter" data-level="1.2.3" data-path="solutions.html"><a href="solutions.html#parameter-values"><i class="fa fa-check"></i><b>1.2.3</b> Parameter Values</a></li>
<li class="chapter" data-level="1.2.4" data-path="solutions.html"><a href="solutions.html#solving"><i class="fa fa-check"></i><b>1.2.4</b> Solving</a></li>
<li class="chapter" data-level="1.2.5" data-path="solutions.html"><a href="solutions.html#visualizing"><i class="fa fa-check"></i><b>1.2.5</b> Visualizing</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="steady-states.html"><a href="steady-states.html"><i class="fa fa-check"></i><b>1.3</b> Steady States</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="steady-states.html"><a href="steady-states.html#mosquito-density"><i class="fa fa-check"></i><b>1.3.1</b> Mosquito Density</a></li>
<li class="chapter" data-level="1.3.2" data-path="steady-states.html"><a href="steady-states.html#eir"><i class="fa fa-check"></i><b>1.3.2</b> EIR</a></li>
<li class="chapter" data-level="1.3.3" data-path="steady-states.html"><a href="steady-states.html#vectorial-capacity"><i class="fa fa-check"></i><b>1.3.3</b> Vectorial Capacity</a></li>
<li class="chapter" data-level="1.3.4" data-path="steady-states.html"><a href="steady-states.html#malaria-prevalence-thresholds"><i class="fa fa-check"></i><b>1.3.4</b> Malaria Prevalence &amp; Thresholds</a></li>
<li class="chapter" data-level="1.3.5" data-path="steady-states.html"><a href="steady-states.html#checking-our-work"><i class="fa fa-check"></i><b>1.3.5</b> Checking our Work</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="stable-orbits.html"><a href="stable-orbits.html"><i class="fa fa-check"></i><b>1.4</b> Stable Orbits</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="stable-orbits.html"><a href="stable-orbits.html#thresholds"><i class="fa fa-check"></i><b>1.4.1</b> Thresholds</a></li>
<li class="chapter" data-level="1.4.2" data-path="stable-orbits.html"><a href="stable-orbits.html#orbits"><i class="fa fa-check"></i><b>1.4.2</b> Orbits</a></li>
<li class="chapter" data-level="1.4.3" data-path="stable-orbits.html"><a href="stable-orbits.html#average-dynamics"><i class="fa fa-check"></i><b>1.4.3</b> Average Dynamics</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="discussion.html"><a href="discussion.html"><i class="fa fa-check"></i><b>1.5</b> Discussion</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="mosquito-dynamics.html"><a href="mosquito-dynamics.html"><i class="fa fa-check"></i><b>2</b> Mosquito Dynamics</a>
<ul>
<li class="chapter" data-level="2.1" data-path="aquatic-dynamics.html"><a href="aquatic-dynamics.html"><i class="fa fa-check"></i><b>2.1</b> Aquatic Dynamics</a></li>
<li class="chapter" data-level="2.2" data-path="understanding-mosquito-dynamics.html"><a href="understanding-mosquito-dynamics.html"><i class="fa fa-check"></i><b>2.2</b> Understanding Mosquito Dynamics</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="realism-pragmatism.html"><a href="realism-pragmatism.html"><i class="fa fa-check"></i><b>3</b> Realism &amp; Pragmatism</a>
<ul>
<li class="chapter" data-level="3.1" data-path="epidemiology.html"><a href="epidemiology.html"><i class="fa fa-check"></i><b>3.1</b> Epidemiology</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="epidemiology.html"><a href="epidemiology.html#superinfection"><i class="fa fa-check"></i><b>3.1.1</b> Superinfection</a></li>
<li class="chapter" data-level="3.1.2" data-path="epidemiology.html"><a href="epidemiology.html#infection-and-immunity"><i class="fa fa-check"></i><b>3.1.2</b> Infection and Immunity</a></li>
<li class="chapter" data-level="3.1.3" data-path="epidemiology.html"><a href="epidemiology.html#gametocytes-and-infectiousness"><i class="fa fa-check"></i><b>3.1.3</b> Gametocytes and Infectiousness</a></li>
<li class="chapter" data-level="3.1.4" data-path="epidemiology.html"><a href="epidemiology.html#disease"><i class="fa fa-check"></i><b>3.1.4</b> Disease</a></li>
<li class="chapter" data-level="3.1.5" data-path="epidemiology.html"><a href="epidemiology.html#treatment-and-chemoprotection"><i class="fa fa-check"></i><b>3.1.5</b> Treatment and Chemoprotection</a></li>
<li class="chapter" data-level="3.1.6" data-path="epidemiology.html"><a href="epidemiology.html#the-time-course-of-an-infection"><i class="fa fa-check"></i><b>3.1.6</b> The Time Course of an Infection</a></li>
<li class="chapter" data-level="3.1.7" data-path="epidemiology.html"><a href="epidemiology.html#intrahost-models"><i class="fa fa-check"></i><b>3.1.7</b> Intrahost Models</a></li>
<li class="chapter" data-level="3.1.8" data-path="epidemiology.html"><a href="epidemiology.html#synthesis"><i class="fa fa-check"></i><b>3.1.8</b> Synthesis</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="heterogeneous-transmission.html"><a href="heterogeneous-transmission.html"><i class="fa fa-check"></i><b>3.2</b> Heterogeneous Transmission</a></li>
<li class="chapter" data-level="3.3" data-path="stratification.html"><a href="stratification.html"><i class="fa fa-check"></i><b>3.3</b> Stratification</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="stratification.html"><a href="stratification.html#strata-in-the-ross-model"><i class="fa fa-check"></i><b>3.3.1</b> Strata in the Ross model</a></li>
<li class="chapter" data-level="3.3.2" data-path="stratification.html"><a href="stratification.html#frailties"><i class="fa fa-check"></i><b>3.3.2</b> Frailties</a></li>
<li class="chapter" data-level="3.3.3" data-path="stratification.html"><a href="stratification.html#age"><i class="fa fa-check"></i><b>3.3.3</b> Age</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="humans-on-the-move.html"><a href="humans-on-the-move.html"><i class="fa fa-check"></i><b>3.4</b> Humans on the Move</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="humans-on-the-move.html"><a href="humans-on-the-move.html#travel"><i class="fa fa-check"></i><b>3.4.1</b> Travel</a></li>
<li class="chapter" data-level="3.4.2" data-path="humans-on-the-move.html"><a href="humans-on-the-move.html#mobility"><i class="fa fa-check"></i><b>3.4.2</b> Mobility</a></li>
<li class="chapter" data-level="3.4.3" data-path="humans-on-the-move.html"><a href="humans-on-the-move.html#migration"><i class="fa fa-check"></i><b>3.4.3</b> Migration</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="blood-feeding.html"><a href="blood-feeding.html"><i class="fa fa-check"></i><b>3.5</b> Blood Feeding</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="blood-feeding.html"><a href="blood-feeding.html#search-and-risk"><i class="fa fa-check"></i><b>3.5.1</b> Search and Risk</a></li>
<li class="chapter" data-level="3.5.2" data-path="blood-feeding.html"><a href="blood-feeding.html#search-weights-and-availability"><i class="fa fa-check"></i><b>3.5.2</b> Search Weights and Availability</a></li>
<li class="chapter" data-level="3.5.3" data-path="blood-feeding.html"><a href="blood-feeding.html#functional-response"><i class="fa fa-check"></i><b>3.5.3</b> Functional Response</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="environmental-heterogeneity.html"><a href="environmental-heterogeneity.html"><i class="fa fa-check"></i><b>3.6</b> Environmental Heterogeneity</a></li>
<li class="chapter" data-level="3.7" data-path="mosquito-behavior.html"><a href="mosquito-behavior.html"><i class="fa fa-check"></i><b>3.7</b> Mosquito Behavior</a>
<ul>
<li class="chapter" data-level="3.7.1" data-path="mosquito-behavior.html"><a href="mosquito-behavior.html#resource-availability"><i class="fa fa-check"></i><b>3.7.1</b> Resource Availability</a></li>
<li class="chapter" data-level="3.7.2" data-path="mosquito-behavior.html"><a href="mosquito-behavior.html#egg-laying"><i class="fa fa-check"></i><b>3.7.2</b> Egg Laying</a></li>
<li class="chapter" data-level="3.7.3" data-path="mosquito-behavior.html"><a href="mosquito-behavior.html#search-and-dispersal"><i class="fa fa-check"></i><b>3.7.3</b> Search and Dispersal</a></li>
</ul></li>
<li class="chapter" data-level="3.8" data-path="space.html"><a href="space.html"><i class="fa fa-check"></i><b>3.8</b> Space</a>
<ul>
<li class="chapter" data-level="3.8.1" data-path="space.html"><a href="space.html#the-mixing-matrix"><i class="fa fa-check"></i><b>3.8.1</b> The Mixing Matrix</a></li>
<li class="chapter" data-level="3.8.2" data-path="space.html"><a href="space.html#pathogen-dispersal-by-humans"><i class="fa fa-check"></i><b>3.8.2</b> Pathogen Dispersal by Humans</a></li>
<li class="chapter" data-level="3.8.3" data-path="space.html"><a href="space.html#pathogen-dispersal-by-mosquitoes"><i class="fa fa-check"></i><b>3.8.3</b> Pathogen Dispersal by Mosquitoes</a></li>
</ul></li>
<li class="chapter" data-level="3.9" data-path="time.html"><a href="time.html"><i class="fa fa-check"></i><b>3.9</b> Time</a>
<ul>
<li class="chapter" data-level="3.9.1" data-path="time.html"><a href="time.html#the-eip"><i class="fa fa-check"></i><b>3.9.1</b> The EIP</a></li>
<li class="chapter" data-level="3.9.2" data-path="time.html"><a href="time.html#seasonality"><i class="fa fa-check"></i><b>3.9.2</b> Seasonality</a></li>
<li class="chapter" data-level="3.9.3" data-path="time.html"><a href="time.html#exogenous-forcing"><i class="fa fa-check"></i><b>3.9.3</b> Exogenous Forcing</a></li>
<li class="chapter" data-level="3.9.4" data-path="time.html"><a href="time.html#vector-control"><i class="fa fa-check"></i><b>3.9.4</b> Vector Control</a></li>
</ul></li>
<li class="chapter" data-level="3.10" data-path="mosquito-ecology-1.html"><a href="mosquito-ecology-1.html"><i class="fa fa-check"></i><b>3.10</b> Mosquito Ecology</a>
<ul>
<li class="chapter" data-level="3.10.1" data-path="mosquito-ecology-1.html"><a href="mosquito-ecology-1.html#regulation"><i class="fa fa-check"></i><b>3.10.1</b> Regulation</a></li>
<li class="chapter" data-level="3.10.2" data-path="mosquito-ecology-1.html"><a href="mosquito-ecology-1.html#exogenous-forcing-1"><i class="fa fa-check"></i><b>3.10.2</b> Exogenous Forcing</a></li>
<li class="chapter" data-level="3.10.3" data-path="mosquito-ecology-1.html"><a href="mosquito-ecology-1.html#habitat-dynamics"><i class="fa fa-check"></i><b>3.10.3</b> Habitat Dynamics</a></li>
</ul></li>
<li class="chapter" data-level="3.11" data-path="integrated-vector-control.html"><a href="integrated-vector-control.html"><i class="fa fa-check"></i><b>3.11</b> Integrated Vector Control</a></li>
<li class="chapter" data-level="3.12" data-path="pharmaceutic-interventions.html"><a href="pharmaceutic-interventions.html"><i class="fa fa-check"></i><b>3.12</b> Pharmaceutic Interventions</a></li>
<li class="chapter" data-level="3.13" data-path="context.html"><a href="context.html"><i class="fa fa-check"></i><b>3.13</b> Context</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="measuring-malaria.html"><a href="measuring-malaria.html"><i class="fa fa-check"></i><b>4</b> Measuring Malaria</a>
<ul>
<li class="chapter" data-level="4.1" data-path="realistic-bounds.html"><a href="realistic-bounds.html"><i class="fa fa-check"></i><b>4.1</b> Realistic Bounds</a></li>
<li class="chapter" data-level="4.2" data-path="the-local-fraction.html"><a href="the-local-fraction.html"><i class="fa fa-check"></i><b>4.2</b> The Local Fraction</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="the-local-fraction.html"><a href="the-local-fraction.html#travel-1"><i class="fa fa-check"></i><b>4.2.1</b> Travel</a></li>
<li class="chapter" data-level="4.2.2" data-path="the-local-fraction.html"><a href="the-local-fraction.html#mobility-1"><i class="fa fa-check"></i><b>4.2.2</b> Mobility</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="drug-taking.html"><a href="drug-taking.html"><i class="fa fa-check"></i><b>4.3</b> Drug Taking</a></li>
<li class="chapter" data-level="4.4" data-path="seasonality-1.html"><a href="seasonality-1.html"><i class="fa fa-check"></i><b>4.4</b> Seasonality</a></li>
<li class="chapter" data-level="4.5" data-path="frailty.html"><a href="frailty.html"><i class="fa fa-check"></i><b>4.5</b> Frailty</a></li>
<li class="chapter" data-level="4.6" data-path="environmental-heterogeneity-1.html"><a href="environmental-heterogeneity-1.html"><i class="fa fa-check"></i><b>4.6</b> Environmental Heterogeneity</a></li>
<li class="chapter" data-level="4.7" data-path="pfeir-vs.-pfpr-in-data.html"><a href="pfeir-vs.-pfpr-in-data.html"><i class="fa fa-check"></i><b>4.7</b> <em>Pf</em>EIR <em>vs.</em> <em>Pf</em>PR in Data</a></li>
<li class="chapter" data-level="4.8" data-path="pfeir-vs.-pffoi-in-data.html"><a href="pfeir-vs.-pffoi-in-data.html"><i class="fa fa-check"></i><b>4.8</b> <em>Pf</em>EIR <em>vs.</em> <em>Pf</em>FoI in Data</a></li>
<li class="chapter" data-level="4.9" data-path="synthesis-1.html"><a href="synthesis-1.html"><i class="fa fa-check"></i><b>4.9</b> Synthesis</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="measuring-control.html"><a href="measuring-control.html"><i class="fa fa-check"></i><b>5</b> Measuring Control</a>
<ul>
<li class="chapter" data-level="5.1" data-path="coverage.html"><a href="coverage.html"><i class="fa fa-check"></i><b>5.1</b> Coverage</a></li>
<li class="chapter" data-level="5.2" data-path="effect-sizes.html"><a href="effect-sizes.html"><i class="fa fa-check"></i><b>5.2</b> Effect Sizes</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="modularity-and-software.html"><a href="modularity-and-software.html"><i class="fa fa-check"></i><b>6</b> Modularity and Software</a>
<ul>
<li class="chapter" data-level="6.1" data-path="model-building.html"><a href="model-building.html"><i class="fa fa-check"></i><b>6.1</b> Model Building</a></li>
<li class="chapter" data-level="6.2" data-path="modular-computation.html"><a href="modular-computation.html"><i class="fa fa-check"></i><b>6.2</b> Modular Computation</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="modular-computation.html"><a href="modular-computation.html#exde"><i class="fa fa-check"></i><b>6.2.1</b> <code>exDE</code></a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>II Transmission</b></span></li>
<li class="chapter" data-level="7" data-path="heterogeneous-exposure.html"><a href="heterogeneous-exposure.html"><i class="fa fa-check"></i><b>7</b> Heterogeneous Exposure</a>
<ul>
<li class="chapter" data-level="7.1" data-path="overview.html"><a href="overview.html"><i class="fa fa-check"></i><b>7.1</b> Overview</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="overview.html"><a href="overview.html#age-1"><i class="fa fa-check"></i><b>7.1.1</b> Age</a></li>
<li class="chapter" data-level="7.1.2" data-path="overview.html"><a href="overview.html#location"><i class="fa fa-check"></i><b>7.1.2</b> Location</a></li>
<li class="chapter" data-level="7.1.3" data-path="overview.html"><a href="overview.html#house-type"><i class="fa fa-check"></i><b>7.1.3</b> House Type</a></li>
<li class="chapter" data-level="7.1.4" data-path="overview.html"><a href="overview.html#activities"><i class="fa fa-check"></i><b>7.1.4</b> Activities</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="frailtyCh.html"><a href="frailtyCh.html"><i class="fa fa-check"></i><b>7.2</b> Frailty</a></li>
<li class="chapter" data-level="7.3" data-path="environmentalHeterogeneity.html"><a href="environmentalHeterogeneity.html"><i class="fa fa-check"></i><b>7.3</b> Environmental Heterogeneity</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="blood-feeding-1.html"><a href="blood-feeding-1.html"><i class="fa fa-check"></i><b>8</b> Blood Feeding</a>
<ul>
<li class="chapter" data-level="8.1" data-path="host-availability.html"><a href="host-availability.html"><i class="fa fa-check"></i><b>8.1</b> Host Availability</a></li>
<li class="chapter" data-level="8.2" data-path="blood-feeding-rates.html"><a href="blood-feeding-rates.html"><i class="fa fa-check"></i><b>8.2</b> Blood Feeding Rates</a></li>
<li class="chapter" data-level="8.3" data-path="the-human-fraction.html"><a href="the-human-fraction.html"><i class="fa fa-check"></i><b>8.3</b> The Human Fraction</a></li>
<li class="chapter" data-level="8.4" data-path="the-mixing-matrix-beta.html"><a href="the-mixing-matrix-beta.html"><i class="fa fa-check"></i><b>8.4</b> The Mixing Matrix, <span class="math inline">\(\beta\)</span></a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="spatial-dynamics.html"><a href="spatial-dynamics.html"><i class="fa fa-check"></i><b>9</b> Spatial Dynamics</a></li>
<li class="chapter" data-level="10" data-path="temporal-dynamics.html"><a href="temporal-dynamics.html"><i class="fa fa-check"></i><b>10</b> Temporal Dynamics</a>
<ul>
<li class="chapter" data-level="10.1" data-path="exogenous-forcing-2.html"><a href="exogenous-forcing-2.html"><i class="fa fa-check"></i><b>10.1</b> Exogenous Forcing</a></li>
<li class="chapter" data-level="10.2" data-path="mosquito-survival-through-the-eip.html"><a href="mosquito-survival-through-the-eip.html"><i class="fa fa-check"></i><b>10.2</b> Mosquito Survival through the EIP</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="cohort-dynamics.html"><a href="cohort-dynamics.html"><i class="fa fa-check"></i><b>11</b> Cohort Dynamics</a>
<ul>
<li class="chapter" data-level="11.1" data-path="boxcar-models.html"><a href="boxcar-models.html"><i class="fa fa-check"></i><b>11.1</b> Boxcar Models</a></li>
<li class="chapter" data-level="11.2" data-path="delay.html"><a href="delay.html"><i class="fa fa-check"></i><b>11.2</b> Delay</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="demography.html"><a href="demography.html"><i class="fa fa-check"></i><b>12</b> Demography</a>
<ul>
<li class="chapter" data-level="12.1" data-path="migration-1.html"><a href="migration-1.html"><i class="fa fa-check"></i><b>12.1</b> Migration</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="stratification-1.html"><a href="stratification-1.html"><i class="fa fa-check"></i><b>13</b> Stratification</a></li>
<li class="part"><span><b>III Human Ecology</b></span></li>
<li class="chapter" data-level="14" data-path="human-behavior.html"><a href="human-behavior.html"><i class="fa fa-check"></i><b>14</b> Human Behavior</a></li>
<li class="chapter" data-level="15" data-path="human-mobility.html"><a href="human-mobility.html"><i class="fa fa-check"></i><b>15</b> Human Mobility</a></li>
<li class="chapter" data-level="16" data-path="human-travel-and-malaria-importation.html"><a href="human-travel-and-malaria-importation.html"><i class="fa fa-check"></i><b>16</b> Human Travel and Malaria Importation</a></li>
<li class="part"><span><b>IV Epidemiology</b></span></li>
<li class="chapter" data-level="17" data-path="malaria-infection.html"><a href="malaria-infection.html"><i class="fa fa-check"></i><b>17</b> Malaria Infection</a>
<ul>
<li class="chapter" data-level="17.1" data-path="overview-1.html"><a href="overview-1.html"><i class="fa fa-check"></i><b>17.1</b> Overview</a></li>
<li class="chapter" data-level="17.2" data-path="multiplicity-of-infection-moi.html"><a href="multiplicity-of-infection-moi.html"><i class="fa fa-check"></i><b>17.2</b> Multiplicity of Infection (MoI)</a></li>
<li class="chapter" data-level="17.3" data-path="age-of-infection-aoi.html"><a href="age-of-infection-aoi.html"><i class="fa fa-check"></i><b>17.3</b> Age of Infection (AoI)</a></li>
<li class="chapter" data-level="17.4" data-path="stage-of-infection-soi.html"><a href="stage-of-infection-soi.html"><i class="fa fa-check"></i><b>17.4</b> Stage of Infection (SoI)</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="malaria-immunity.html"><a href="malaria-immunity.html"><i class="fa fa-check"></i><b>18</b> Malaria Immunity</a>
<ul>
<li class="chapter" data-level="18.1" data-path="the-garki-model.html"><a href="the-garki-model.html"><i class="fa fa-check"></i><b>18.1</b> The Garki Model</a></li>
<li class="chapter" data-level="18.2" data-path="stage-structured-immunity.html"><a href="stage-structured-immunity.html"><i class="fa fa-check"></i><b>18.2</b> Stage-Structured Immunity</a></li>
<li class="chapter" data-level="18.3" data-path="strain-specific-immunity.html"><a href="strain-specific-immunity.html"><i class="fa fa-check"></i><b>18.3</b> Strain Specific Immunity</a></li>
<li class="chapter" data-level="18.4" data-path="memory-tracking.html"><a href="memory-tracking.html"><i class="fa fa-check"></i><b>18.4</b> Memory Tracking</a></li>
<li class="chapter" data-level="18.5" data-path="age-vs.-prevalence.html"><a href="age-vs.-prevalence.html"><i class="fa fa-check"></i><b>18.5</b> Age <em>vs.</em> Prevalence</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="detecting-parasites.html"><a href="detecting-parasites.html"><i class="fa fa-check"></i><b>19</b> Detecting Parasites</a>
<ul>
<li class="chapter" data-level="19.1" data-path="parasite-densities-and-detection.html"><a href="parasite-densities-and-detection.html"><i class="fa fa-check"></i><b>19.1</b> Parasite Densities and Detection</a></li>
<li class="chapter" data-level="19.2" data-path="light-microscopy.html"><a href="light-microscopy.html"><i class="fa fa-check"></i><b>19.2</b> Light Microscopy</a></li>
<li class="chapter" data-level="19.3" data-path="biomarkers-and-rdts.html"><a href="biomarkers-and-rdts.html"><i class="fa fa-check"></i><b>19.3</b> Biomarkers and RDTs</a></li>
<li class="chapter" data-level="19.4" data-path="pcr.html"><a href="pcr.html"><i class="fa fa-check"></i><b>19.4</b> PCR</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="gametocytes-and-infectiousness-1.html"><a href="gametocytes-and-infectiousness-1.html"><i class="fa fa-check"></i><b>20</b> Gametocytes and Infectiousness</a>
<ul>
<li class="chapter" data-level="20.1" data-path="gametocytemia.html"><a href="gametocytemia.html"><i class="fa fa-check"></i><b>20.1</b> Gametocytemia</a></li>
<li class="chapter" data-level="20.2" data-path="anti-gametocyte-immunity.html"><a href="anti-gametocyte-immunity.html"><i class="fa fa-check"></i><b>20.2</b> Anti-Gametocyte Immunity</a></li>
</ul></li>
<li class="chapter" data-level="21" data-path="fever-and-severe-disease.html"><a href="fever-and-severe-disease.html"><i class="fa fa-check"></i><b>21</b> Fever and Severe Disease</a>
<ul>
<li class="chapter" data-level="21.1" data-path="fever.html"><a href="fever.html"><i class="fa fa-check"></i><b>21.1</b> Fever</a></li>
<li class="chapter" data-level="21.2" data-path="anemia.html"><a href="anemia.html"><i class="fa fa-check"></i><b>21.2</b> Anemia</a></li>
<li class="chapter" data-level="21.3" data-path="severe-disease.html"><a href="severe-disease.html"><i class="fa fa-check"></i><b>21.3</b> Severe Disease</a></li>
</ul></li>
<li class="chapter" data-level="22" data-path="care-seeking.html"><a href="care-seeking.html"><i class="fa fa-check"></i><b>22</b> Care Seeking</a></li>
<li class="chapter" data-level="23" data-path="drug-taking-1.html"><a href="drug-taking-1.html"><i class="fa fa-check"></i><b>23</b> Drug Taking</a>
<ul>
<li class="chapter" data-level="23.1" data-path="curing-infections.html"><a href="curing-infections.html"><i class="fa fa-check"></i><b>23.1</b> Curing Infections</a></li>
<li class="chapter" data-level="23.2" data-path="chemoprotection.html"><a href="chemoprotection.html"><i class="fa fa-check"></i><b>23.2</b> Chemoprotection</a></li>
<li class="chapter" data-level="23.3" data-path="adherance.html"><a href="adherance.html"><i class="fa fa-check"></i><b>23.3</b> Adherance</a></li>
<li class="chapter" data-level="23.4" data-path="treatment-rates.html"><a href="treatment-rates.html"><i class="fa fa-check"></i><b>23.4</b> Treatment Rates</a></li>
</ul></li>
<li class="chapter" data-level="24" data-path="pharmaceutical-interventions.html"><a href="pharmaceutical-interventions.html"><i class="fa fa-check"></i><b>24</b> Pharmaceutical Interventions</a>
<ul>
<li class="chapter" data-level="24.1" data-path="smc.html"><a href="smc.html"><i class="fa fa-check"></i><b>24.1</b> SMC</a></li>
<li class="chapter" data-level="24.2" data-path="mda.html"><a href="mda.html"><i class="fa fa-check"></i><b>24.2</b> MDA</a></li>
<li class="chapter" data-level="24.3" data-path="drugs.html"><a href="drugs.html"><i class="fa fa-check"></i><b>24.3</b> Drugs</a></li>
<li class="chapter" data-level="24.4" data-path="vaccines.html"><a href="vaccines.html"><i class="fa fa-check"></i><b>24.4</b> Vaccines</a></li>
</ul></li>
<li class="chapter" data-level="25" data-path="malaria-epidemiology.html"><a href="malaria-epidemiology.html"><i class="fa fa-check"></i><b>25</b> Malaria Epidemiology</a>
<ul>
<li class="chapter" data-level="25.1" data-path="age-of-the-youngest-infection.html"><a href="age-of-the-youngest-infection.html"><i class="fa fa-check"></i><b>25.1</b> Age of the Youngest Infection</a></li>
</ul></li>
<li class="part"><span><b>V Mosquito Ecology</b></span></li>
<li class="chapter" data-level="26" data-path="mosquitoes.html"><a href="mosquitoes.html"><i class="fa fa-check"></i><b>26</b> Mosquitoes</a></li>
<li class="chapter" data-level="27" data-path="behavioral-state-models.html"><a href="behavioral-state-models.html"><i class="fa fa-check"></i><b>27</b> Behavioral State Models</a></li>
<li class="chapter" data-level="28" data-path="aquatic-ecology.html"><a href="aquatic-ecology.html"><i class="fa fa-check"></i><b>28</b> Aquatic Ecology</a></li>
<li class="chapter" data-level="29" data-path="mosquito-microecology.html"><a href="mosquito-microecology.html"><i class="fa fa-check"></i><b>29</b> Mosquito Microecology</a></li>
<li class="chapter" data-level="30" data-path="mosquito-dispersal.html"><a href="mosquito-dispersal.html"><i class="fa fa-check"></i><b>30</b> Mosquito Dispersal</a></li>
<li class="chapter" data-level="31" data-path="microsimulation.html"><a href="microsimulation.html"><i class="fa fa-check"></i><b>31</b> Microsimulation</a></li>
<li class="chapter" data-level="32" data-path="mosquito-ecology-2.html"><a href="mosquito-ecology-2.html"><i class="fa fa-check"></i><b>32</b> Mosquito Ecology</a>
<ul>
<li class="chapter" data-level="32.1" data-path="population-dynamics.html"><a href="population-dynamics.html"><i class="fa fa-check"></i><b>32.1</b> Population Dynamics</a></li>
</ul></li>
<li class="chapter" data-level="33" data-path="vector-competence.html"><a href="vector-competence.html"><i class="fa fa-check"></i><b>33</b> Vector Competence</a></li>
<li class="chapter" data-level="34" data-path="measuring-mosquitoes.html"><a href="measuring-mosquitoes.html"><i class="fa fa-check"></i><b>34</b> Measuring Mosquitoes</a></li>
<li class="part"><span><b>VI Malaria Control</b></span></li>
<li class="chapter" data-level="35" data-path="vector-control-1.html"><a href="vector-control-1.html"><i class="fa fa-check"></i><b>35</b> Vector Control</a></li>
<li class="chapter" data-level="36" data-path="insecticide-treated-bednets.html"><a href="insecticide-treated-bednets.html"><i class="fa fa-check"></i><b>36</b> Insecticide-Treated Bednets</a></li>
<li class="chapter" data-level="37" data-path="indoor-residual-spraying.html"><a href="indoor-residual-spraying.html"><i class="fa fa-check"></i><b>37</b> Indoor Residual Spraying</a></li>
<li class="chapter" data-level="38" data-path="larval-source-management.html"><a href="larval-source-management.html"><i class="fa fa-check"></i><b>38</b> Larval Source Management</a></li>
<li class="chapter" data-level="39" data-path="attractive-toxic-sugar-baits.html"><a href="attractive-toxic-sugar-baits.html"><i class="fa fa-check"></i><b>39</b> Attractive Toxic Sugar Baits</a></li>
<li class="chapter" data-level="40" data-path="integrated-vector-control-1.html"><a href="integrated-vector-control-1.html"><i class="fa fa-check"></i><b>40</b> Integrated Vector Control</a></li>
<li class="chapter" data-level="41" data-path="spatial-control.html"><a href="spatial-control.html"><i class="fa fa-check"></i><b>41</b> Spatial Control</a></li>
<li class="chapter" data-level="42" data-path="pharmaceutical-interventions-1.html"><a href="pharmaceutical-interventions-1.html"><i class="fa fa-check"></i><b>42</b> Pharmaceutical Interventions</a>
<ul>
<li class="chapter" data-level="42.1" data-path="smc-1.html"><a href="smc-1.html"><i class="fa fa-check"></i><b>42.1</b> SMC</a></li>
<li class="chapter" data-level="42.2" data-path="mda-1.html"><a href="mda-1.html"><i class="fa fa-check"></i><b>42.2</b> MDA</a></li>
<li class="chapter" data-level="42.3" data-path="drugs-1.html"><a href="drugs-1.html"><i class="fa fa-check"></i><b>42.3</b> Drugs</a></li>
<li class="chapter" data-level="42.4" data-path="vaccines-1.html"><a href="vaccines-1.html"><i class="fa fa-check"></i><b>42.4</b> Vaccines</a></li>
</ul></li>
<li class="chapter" data-level="43" data-path="discrete-time.html"><a href="discrete-time.html"><i class="fa fa-check"></i><b>43</b> Discrete Time</a></li>
<li class="chapter" data-level="44" data-path="stochasticity.html"><a href="stochasticity.html"><i class="fa fa-check"></i><b>44</b> Stochasticity</a></li>
<li class="chapter" data-level="45" data-path="base-models.html"><a href="base-models.html"><i class="fa fa-check"></i><b>45</b> Base Models</a></li>
<li class="chapter" data-level="46" data-path="built-in-analytics.html"><a href="built-in-analytics.html"><i class="fa fa-check"></i><b>46</b> Built-in Analytics</a></li>
<li class="chapter" data-level="47" data-path="spatial-concepts-and-connectivity.html"><a href="spatial-concepts-and-connectivity.html"><i class="fa fa-check"></i><b>47</b> Spatial Concepts and Connectivity</a></li>
<li class="chapter" data-level="48" data-path="model-libraries.html"><a href="model-libraries.html"><i class="fa fa-check"></i><b>48</b> Model Libraries</a></li>
<li class="part"><span><b>VII Supplements</b></span></li>
<li class="chapter" data-level="49" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i><b>49</b> References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Applied Malaria Dynamics</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="solutions" class="section level2 hasAnchor" number="1.2">
<h2><span class="header-section-number">1.2</span> Solutions<a href="solutions.html#solutions" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>What does a <strong>solution</strong> to these equations look like?</p>
<p>Solutions to these equations are values of the variables over time <span class="math inline">\(\left( M(t), Y(t), Z(t), X(t) \right)\)</span> that satisfy the system of four equations described above. We call these solutions <em>orbits.</em> To put it another way, if we took the derivatives of the orbits for any variable at any point in time using the basic definition <span class="math display">\[\lim_{h\rightarrow 0} \frac{x(t+h)-x(t)}{h},\]</span> and then we used the values of the variables at time <span class="math inline">\(t\)</span> to compute <span class="math inline">\(dM/dt\)</span>, <span class="math inline">\(dY/dt\)</span>, <span class="math inline">\(dZ/dt\)</span>, and <span class="math inline">\(dX/dt\)</span> (<em>i.e.</em>, using the formulas), we would get the same values.</p>
<p>It is important that these orbits are unique: after specifying the <em>initial values</em> of the variables, there is one and only one set of orbits that solves the equations. When we solve the equations, we usually produce solutions from a starting point into a future, but the orbits are defined for all time – <span class="math inline">\(i.e.\)</span> the process implies the existence of solutions far back into the past. These are deterministic equations, after all.</p>
<p>As written, the equations do not define a <em>model.</em> Instead, the equations define a process or a <strong>model family.</strong> A model is something that <em>can</em> produce orbits. A model is defined only after assigning specific values to the parameters. Informally, we will often slip and use the “model” to describe a model family. It’s easy to slip up, and sometimes we can get by with being sloppy, but we need to remember the distinction. When we say that the software is <em>modular,</em> we mean that it is easy to swap out one <em>model family</em> for another.</p>
<p>To find solutions of equations we use an R software package called <code>deSolve.</code> Because of the delay for the EIP, these are called <em>delay differential equations,</em> which are handled using a function called <code>dede</code>. An important step in solving delay differential equations is a function <code>lagvalue()</code> that computes and returns the values of variables at a time lag, <span class="math inline">\(\ell\)</span>. In these equations, the lag is set by the EIP, <span class="math inline">\(\tau\)</span>, so we must evaluate
<code>lagvalue(t-tau).</code></p>
<p>In solving <em>ordinary differential equations,</em> we must pass initial conditions. To solve a delay differential equations with a maximum lag <span class="math inline">\(\ell\)</span>, we must specify the initial conditions for the interval <span class="math inline">\([-\ell, t_0)\)</span>, where <span class="math inline">\(t_0\)</span> is the point in time when we start computing solutions.
In these equations, since the equation for <span class="math inline">\(dZ/dt\)</span> looks back <span class="math inline">\(\tau\)</span> units, we must specify values of <span class="math inline">\(M(t)\)</span>, <span class="math inline">\(Y(t)\)</span>, and <span class="math inline">\(X(t)\)</span> for all values of <span class="math inline">\(t \in [-\tau, t_0)\)</span>. This forces an awkward choice, since we don’t know the solutions backwards in time, but would need to know those solutions to use them. What is typically done – and we’ve done it here – is to specify a constant set of initial values and moving on.</p>
<p>Doing this introduces a little <em>numerical slop.</em> By slop, we mean that these values are <em>not</em> what we would get if we ran the equations backwards in time. In these equations, it won’t affect our analysis most of the time, so we’re happy to acknowledge this little problem and find ways around it. It’s a little thing, but we should never forget it, because we might find that it <em>is</em> affecting our analysis at some point.</p>
<p>With <code>deSolve,</code> solving differential equations is not difficult – it just involves following a few steps. In the following, we walk through these steps:</p>
<ul>
<li><p>Write a function that computes the derivatives;</p></li>
<li><p>Define initial conditions;</p></li>
<li><p>Define the values of the parameters;</p></li>
<li><p>Define a mesh on time;</p></li>
<li><p>Call a function that solves the equations, such as <code>dede</code> for delay differential equations.</p></li>
</ul>
<p>Many users will find that reading this code is like learning how to compute <span class="math inline">\(\sqrt{2}\)</span>. If so, feel free to learn it once and then skip it.</p>
<div id="derivatives" class="section level3 hasAnchor" number="1.2.1">
<h3><span class="header-section-number">1.2.1</span> Derivatives<a href="solutions.html#derivatives" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The first step is to write down the equations to compute the derivatives. The solver expects a function with three required arguments (in this order):</p>
<ul>
<li><p><code>t</code> is time</p></li>
<li><p><code>y</code> is the list of variables</p></li>
<li><p><code>params</code> is a set of parameters</p></li>
</ul>
<p>The derivatives are computed and returned in the same order as ‘y’ in a <code>list</code>. To make code that is easy to read, we make <code>params</code> as a <code>list</code> with parameter names (see below), so that inside the function <code>with(params,{...})</code>, the parameter names are visible.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="solutions.html#cb1-1" aria-hidden="true" tabindex="-1"></a>dAronMay <span class="ot">=</span> <span class="cf">function</span>(t, y, params){<span class="fu">with</span>(params,{</span>
<span id="cb1-2"><a href="solutions.html#cb1-2" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb1-3"><a href="solutions.html#cb1-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Variables  </span></span>
<span id="cb1-4"><a href="solutions.html#cb1-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(t<span class="sc">&lt;=</span>tau) ylag<span class="ot">&lt;-</span>y0 <span class="cf">else</span> ylag <span class="ot">&lt;-</span> <span class="fu">lagvalue</span>(t<span class="sc">-</span>tau)</span>
<span id="cb1-5"><a href="solutions.html#cb1-5" aria-hidden="true" tabindex="-1"></a>  M<span class="ot">=</span>y[<span class="dv">1</span>]; M_tau <span class="ot">=</span> ylag[<span class="dv">1</span>]</span>
<span id="cb1-6"><a href="solutions.html#cb1-6" aria-hidden="true" tabindex="-1"></a>  Y<span class="ot">=</span>y[<span class="dv">2</span>]; Y_tau <span class="ot">=</span> ylag[<span class="dv">2</span>]; </span>
<span id="cb1-7"><a href="solutions.html#cb1-7" aria-hidden="true" tabindex="-1"></a>  Z<span class="ot">=</span>y[<span class="dv">3</span>]; </span>
<span id="cb1-8"><a href="solutions.html#cb1-8" aria-hidden="true" tabindex="-1"></a>  X<span class="ot">=</span>y[<span class="dv">4</span>]; X_tau <span class="ot">=</span> ylag[<span class="dv">4</span>]</span>
<span id="cb1-9"><a href="solutions.html#cb1-9" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb1-10"><a href="solutions.html#cb1-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Terms </span></span>
<span id="cb1-11"><a href="solutions.html#cb1-11" aria-hidden="true" tabindex="-1"></a>  kappa <span class="ot">=</span> c<span class="sc">*</span>X<span class="sc">/</span>H; kappa_tau <span class="ot">=</span> c<span class="sc">*</span>X_tau<span class="sc">/</span>H</span>
<span id="cb1-12"><a href="solutions.html#cb1-12" aria-hidden="true" tabindex="-1"></a>  h <span class="ot">=</span> b<span class="sc">*</span>f<span class="sc">*</span>q<span class="sc">*</span>Z<span class="sc">/</span>H </span>
<span id="cb1-13"><a href="solutions.html#cb1-13" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb1-14"><a href="solutions.html#cb1-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Dynamics </span></span>
<span id="cb1-15"><a href="solutions.html#cb1-15" aria-hidden="true" tabindex="-1"></a>  dM <span class="ot">=</span> <span class="fu">Lambda</span>(t) <span class="sc">-</span> g<span class="sc">*</span>M</span>
<span id="cb1-16"><a href="solutions.html#cb1-16" aria-hidden="true" tabindex="-1"></a>  dY <span class="ot">=</span> f<span class="sc">*</span>q<span class="sc">*</span>kappa<span class="sc">*</span>(M<span class="sc">-</span>Y) <span class="sc">-</span>g<span class="sc">*</span>Y</span>
<span id="cb1-17"><a href="solutions.html#cb1-17" aria-hidden="true" tabindex="-1"></a>  dZ <span class="ot">=</span> f<span class="sc">*</span>q<span class="sc">*</span>kappa_tau<span class="sc">*</span>(M_tau<span class="sc">-</span>Y_tau)<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>g<span class="sc">*</span>tau) <span class="sc">-</span>g<span class="sc">*</span>Z</span>
<span id="cb1-18"><a href="solutions.html#cb1-18" aria-hidden="true" tabindex="-1"></a>  dX <span class="ot">=</span> h<span class="sc">*</span>(H<span class="sc">-</span>X)<span class="sc">-</span>r<span class="sc">*</span>X</span>
<span id="cb1-19"><a href="solutions.html#cb1-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-20"><a href="solutions.html#cb1-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="fu">c</span>(dM, dY, dZ, dX)))</span>
<span id="cb1-21"><a href="solutions.html#cb1-21" aria-hidden="true" tabindex="-1"></a>})} </span></code></pre></div>
</div>
<div id="initial-values" class="section level3 hasAnchor" number="1.2.2">
<h3><span class="header-section-number">1.2.2</span> Initial Values<a href="solutions.html#initial-values" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>To run the model, we must supply initial values. If you were writing code yourself, it would be important to remember that the initial values and the return value for the derivatives must occur in the same order.</p>
<p>A useful convention in {R} is to pass the initial values as a named list. Later, we can turn the outputs into a data frame, and then we can retrieve the variables by name.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="solutions.html#cb2-1" aria-hidden="true" tabindex="-1"></a>y0<span class="ot">=</span> <span class="fu">c</span>(<span class="at">M=</span><span class="dv">60</span>, <span class="at">Y=</span><span class="dv">0</span>, <span class="at">Z=</span><span class="dv">0</span>, <span class="at">X=</span><span class="dv">1</span>)</span></code></pre></div>
<p>The object <code>y0</code> is a named list – the names are attached but invisible.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="solutions.html#cb3-1" aria-hidden="true" tabindex="-1"></a>y0</span></code></pre></div>
<pre><code>##  M  Y  Z  X 
## 60  0  0  1</code></pre>
<p>When we turn it into a list, with <code>as.list,</code> the names are attached to the values:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="solutions.html#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as.list</span>(y0)<span class="sc">$</span>M</span></code></pre></div>
<pre><code>## [1] 60</code></pre>
<p>If we use <code>with</code>, we create an environment where we can simply use the names:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="solutions.html#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(<span class="fu">as.list</span>(y0), {</span>
<span id="cb7-2"><a href="solutions.html#cb7-2" aria-hidden="true" tabindex="-1"></a>  M</span>
<span id="cb7-3"><a href="solutions.html#cb7-3" aria-hidden="true" tabindex="-1"></a>})</span></code></pre></div>
<pre><code>## [1] 60</code></pre>
</div>
<div id="parameter-values" class="section level3 hasAnchor" number="1.2.3">
<h3><span class="header-section-number">1.2.3</span> Parameter Values<a href="solutions.html#parameter-values" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We pass the parameters as a list. It might seem like overkill, but we have written a function <code>makeParams()</code> that takes default values and generates a list. This makes it easy to generate a new set of parameter values with alternative values, and it also helps us to write and pass function <span class="math inline">\(\Lambda(t)\)</span> with parameters we like. By passing the parameter as a list, the parameter values are available to the function <code>dAronMay</code> when we use <code>with(params, {})</code>.</p>
<p>Note that we have also attached the initial values of the variables as a parameter set, which are the return values for <code>lagvalue(t)</code> when <code>t&lt;0</code>.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="solutions.html#cb9-1" aria-hidden="true" tabindex="-1"></a>makeParams <span class="ot">=</span> <span class="cf">function</span>(y0, </span>
<span id="cb9-2"><a href="solutions.html#cb9-2" aria-hidden="true" tabindex="-1"></a>                      <span class="at">g=</span><span class="dv">1</span><span class="sc">/</span><span class="dv">12</span>, <span class="at">f=</span><span class="dv">1</span><span class="sc">/</span><span class="fl">2.5</span>, <span class="at">q=</span><span class="fl">0.95</span>,  </span>
<span id="cb9-3"><a href="solutions.html#cb9-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">c=</span><span class="fl">0.15</span>,</span>
<span id="cb9-4"><a href="solutions.html#cb9-4" aria-hidden="true" tabindex="-1"></a>                      <span class="at">b=</span><span class="fl">0.55</span>, <span class="at">r=</span><span class="dv">1</span><span class="sc">/</span><span class="dv">200</span>, <span class="at">H=</span><span class="dv">1000</span>,  </span>
<span id="cb9-5"><a href="solutions.html#cb9-5" aria-hidden="true" tabindex="-1"></a>                      <span class="at">m=</span>.<span class="dv">05</span>, <span class="at">ss=</span><span class="dv">1</span>,  </span>
<span id="cb9-6"><a href="solutions.html#cb9-6" aria-hidden="true" tabindex="-1"></a>                      <span class="at">tau=</span><span class="dv">10</span>  </span>
<span id="cb9-7"><a href="solutions.html#cb9-7" aria-hidden="true" tabindex="-1"></a>                      ){</span>
<span id="cb9-8"><a href="solutions.html#cb9-8" aria-hidden="true" tabindex="-1"></a>  ss <span class="ot">=</span> <span class="fu">min</span>(<span class="dv">1</span>,<span class="fu">max</span>(<span class="dv">0</span>, ss))</span>
<span id="cb9-9"><a href="solutions.html#cb9-9" aria-hidden="true" tabindex="-1"></a>  Lambda <span class="ot">=</span> <span class="cf">function</span>(t){m<span class="sc">*</span>H<span class="sc">*</span>(<span class="dv">1</span> <span class="sc">+</span> ss<span class="sc">*</span><span class="fu">sin</span>(<span class="dv">2</span><span class="sc">*</span>pi<span class="sc">*</span>t<span class="sc">/</span><span class="dv">365</span>))}</span>
<span id="cb9-10"><a href="solutions.html#cb9-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">y0=</span>y0,<span class="at">g=</span>g,<span class="at">f=</span>f,<span class="at">q=</span>q,<span class="at">c=</span>c,</span>
<span id="cb9-11"><a href="solutions.html#cb9-11" aria-hidden="true" tabindex="-1"></a>              <span class="at">H=</span>H,<span class="at">m=</span>m,<span class="at">tau=</span>tau,<span class="at">b=</span>b,<span class="at">r=</span>r,<span class="at">Lambda=</span>Lambda))</span>
<span id="cb9-12"><a href="solutions.html#cb9-12" aria-hidden="true" tabindex="-1"></a>} </span>
<span id="cb9-13"><a href="solutions.html#cb9-13" aria-hidden="true" tabindex="-1"></a>params <span class="ot">=</span> <span class="fu">makeParams</span>(y0)</span></code></pre></div>
<p>To make it absolutely clear, we are assuming:</p>
<ul>
<li><p><span class="math inline">\(g=1/12\)</span>: mosquitoes live about <span class="math inline">\(12\)</span> days, on average</p></li>
<li><p><span class="math inline">\(f=1/2.5\)</span>: mosquitoes feed every 2.5 days, on average</p></li>
<li><p><span class="math inline">\(q=0.95\)</span>: the human fraction is 95%; mosquitoes feed on humans 95% of the time</p></li>
<li><p><span class="math inline">\(c=0.15\)</span>: about 15% of bites on infectious humans infect a mosquito</p></li>
<li><p><span class="math inline">\(b=0.55\)</span>: about 55% of bites by infective mosquitoes cause an infection</p></li>
<li><p><span class="math inline">\(r=1/200\)</span>: human infections last about <span class="math inline">\(200\)</span> days, on average</p></li>
<li><p><span class="math inline">\(H=1000\)</span>: we’re simulating transmission in a population of a thousand humans</p></li>
<li><p><span class="math inline">\(\tau=10\)</span>: the extrinsic incubation period is about 10 days</p></li>
<li><p>For emergence, we tune the average value using <span class="math inline">\(m\)</span> and it is scaled to <span class="math inline">\(H\)</span>:</p>
<ul>
<li><p>The parameter <span class="math inline">\(m\)</span> in the function above has been set to <span class="math inline">\(0.05\)</span> by default.</p></li>
<li><p>The parameter <span class="math inline">\(ss\)</span> affects the amplitude of the fluctuations. We force it to take on values between 0 and 1.</p></li>
<li><p>Emergence is modeled as a sinusoidal function with a yearly cycle.</p></li>
</ul></li>
</ul>
<p><span class="math display">\[\Lambda(t) = m H \left(1 + \sin \left(\frac{2\pi t}{365}\right)\right)\]</span></p>
</div>
<div id="solving" class="section level3 hasAnchor" number="1.2.4">
<h3><span class="header-section-number">1.2.4</span> Solving<a href="solutions.html#solving" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We define a mesh over time – the points in time when we would like to know the values of the variables:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="solutions.html#cb10-1" aria-hidden="true" tabindex="-1"></a>tt <span class="ot">=</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">5</span><span class="sc">*</span><span class="dv">365</span>, <span class="at">by=</span><span class="dv">5</span>) </span></code></pre></div>
<p>This code solves the equations:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="solutions.html#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(deSolve)</span>
<span id="cb11-2"><a href="solutions.html#cb11-2" aria-hidden="true" tabindex="-1"></a>yout <span class="ot">&lt;-</span> <span class="fu">dede</span>(<span class="at">y=</span>y0, <span class="at">times=</span>tt, <span class="at">func=</span>dAronMay, <span class="at">parms=</span>params) </span></code></pre></div>
</div>
<div id="visualizing" class="section level3 hasAnchor" number="1.2.5">
<h3><span class="header-section-number">1.2.5</span> Visualizing<a href="solutions.html#visualizing" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>When we plot out the solutions, they look like this.</p>
<p><img src="_main_files/figure-html/unnamed-chunk-11-1.png" width="528" /></p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="aron-and-mays-equations.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="steady-states.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="assets/gitbook-2.6.7/js/app.min.js"></script>
<script src="assets/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="assets/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
},
"toolbar": {
"position": "static"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
