[["index.html", "Applied Malaria Dynamics Dynamical Systems for Adaptive Malaria Control Foreword", " Applied Malaria Dynamics Dynamical Systems for Adaptive Malaria Control David L. Smith and the RAMP Team 2023-06-30 Foreword A large fraction of my time over the past 20 years has been devoted to learning about mathematical models of malaria epidemiology, transmission dynamics, mosquito ecology, vector control, and the evolution of resistance. All the time I was building and analyzing models, I was looking for a way of organizing and applying the rich body of theory developed over more than a century of malaria research, starting with Ronald Ross.1,2 A new framework would integrate the concepts and models that have influenced malaria through the present day,3,4 and it might even serve as a platform for recasting a theory of malaria epidemiology, transmission dynamics, and control.5 My goal was to build a framework that could serve studies of malaria policy. Policy discussions might need to use mathemetics, but the policy (and not the math) should be the focus. Ideally, mathematical ideas should help structure the discussions without ever drawing attention to themselves, except perhaps in the rare circumstance when it could help to clarify something. There were some core challenges, but if we could solve those, we could make the math easier to use so that discussions would focus on the issues that mattered. Ideally, the framework could be taken up and used by teams of local experts working in their own countries to reduce the burden of malaria and plan for its elimination. The academic activities supporting all this would meanwhile be taken up on the side. I wanted the new framework to be extensible, with plug-and-play modularity (for major dynamical components), with flexibility in the choice of functional forms describing various relationships, and with flexibility on the structural components, including space, time, and population strata. It should have the capability of scaling down for fine-grained spatial simulations,6,7,8 or scaling up to understand or analyze regional processes and the emerging patterns9. To serve the needs of malaria programs, a framework would need built-in support for exogenous forcing by weather and vector control to model malaria as a changing baseline modified by control. To get integrated vector control right, we went all in on mosquito ecology with an individual-based simulation model with exquisite biological detail,10 which inspired new ideas about mosquito search and a new base model for mosquito ecology and behavior. To serve programmatic needs, we needed algorithms that could address the durability of a unit of vector control – coverage could decay over time through loss (e.g. bed nets) or waning potency. To make all the pieces fit together, we needed interfaces that could connect up models in a generic way; in the design phase, we worked with two model families for each major dynamical component – one that was dead simple, and one that had a was highly realistic. In some cases, the interface designs called for development of new algorithms: blood feeding, egg laying, environmental heterogeneity, human mobility, and mosquito dispersal. In making a master list to test the framework’s extensibility, we found that some odd cases that needed to pass information among components – endectocides and auto-disseminated larvicides – but it was easy enough to accommodate these. Beyond the algorithms, these models needed the support of mathematical theory. We wanted the software to help understand thresholds, so we wrote the routines that would compute thresholds for malaria transmission in heterogeneous systems, when appropriate. Sometime in the fall of 2022, the last few pieces came together. We published the first versions of MicroMoB and exDE at CRAN. We submitted a paper to PLoS Computational Biology.11 Then it was time to write this book. The software lowers the costs of building models that are up to the task of guiding malaria policy. An advantage of using this framework and accompanying software is that we found design solutions to problems that we discovered, usually the hard way, the potential pitfalls that arise when combining models. The framework took longer than expected, in part, because there were more pitfalls than we had anticipated. This book shows, through examples, how to use the software to build malaria models. Even without the software, it fills a gap for students who have taken an introduction to mathematical epidemiology or infectious disease modeling and want to go on in malaria. What are all the special topics that would need to be covered to build models that could be needed in malaria? This book could be the basis for such a course, if there were ever enough students. Since there will probably never be enough graduate students at my university who are interested in applied malaria dynamics, the material is being developed for any student anywhere. I will also be writing and recording some short lectures. This book teaches how to build models for malaria policy, but it stops short of applying models to policy. That is covered in another book, Robust Analytics for Malaria Policy. The premise of this book is thus that the reader has started with a solid background in infectious disease models and malaria. We assume they’ve seen the Ross-Macdonald model before, that they’ve taken a class in mathematical epidemiology, and that they know something about how to construct and analyze models. This book emphasizes concepts and teaches through examples. We have left out a lot of the technical and mathemtical details, but we have written some vignettes and lessons to supplement the book. Most of this is found in the documentation for exDE or MicroMoB or it can be found in the RAMP-Model-Library. References "],["models-for-policy.html", "Models for Policy", " Models for Policy Malaria is complex and heterogeneous, which makes it difficult to study and manage. A core challenge in both science and policy is the availability of information. Mathematical models can help us understand and analyze all that complexity and make informed decisions despite the data gaps. Policy and science are different in many ways, so there are good reasons why we might want to use different models and methods for basic research and policy analytics. In policy, decisions must be made in a timely way, and they should use all available evidence, even if it’s weak. Basic research is epistemologically conservative, by design. Studies that are published in peer review must be repeatable, and in anticipation of criticism, the scientists aim to do things so well that they are unassailable. This usually has the effect of narrowing and controlling the conditions under which the study was conducted. When we operate in policy settings, we should design our studies in a different way, and we will thus need to deal with the uncertainty differently. The studies that inform policies will need to take an approach that is broader – the models should be realistic enough to address the question of interest. Such studies will often need to make compromises and decisions that are poorly informed by the evidence, which raises the question of how much a policy maker could trust it. One strategy for making policies trustworthy is to repeat the supporting analysis using every reasonable approach, so that we can be reasonably sure our policy recommendations would not change. The idea of fully propagating uncertainty is the essential feature of robust analytics. If we make the effort, we can identify key sources of uncertainty, identify priority data needs, and collect new data that could help resolve some of the most important sources of uncertainty. Building models to do this is challenging for practical reasons, and it requires drawing heavily on basic research. In giving advice, we must give different weights to the uncertainty than we would in research. In basic research, we develop mechanistic models to understand malaria as a biological process. In malaria epidemiology, the states and parameters describe infection, immunity, infectiousness, disease, and drug taking in response to exposure. Scientists focus on basic biological mechanisms in order to understand differences in malaria across spectrum of transmission. Immunity and drug-taking are important factors to consider, but it may be that differences in epidemiology and disease across settings arise from differences in the local parasite populations. The models are a way of summarizing knowledge in a quantitative form – something like a complex hypothesis. A test of a model’s adequacy is whether it can describe malaria accurately after accounting for differences in drug taking patterns and pattern of exposure. We study mosquito ecology and blood feeding to understand malaria transmission and develop theory for malaria control. Transmission models couple parasite infection dynamics in humans and mosquitoes through blood feeding. Mosquito populations are shaped by the aquatic habitats for immature mosquito populations. These habitats are standing water bodies, and they are shaped by topography, hydrology, land use, and the water chemistry, which is affected by surrounding rocks, soils, vegetation and pollution. These habitats are filled (exogenously forced) by rainfall and after some eggs are laid, the mosquito dynamics are affected by crowding, predation, and other endogenous dynamics. Larval development and parasite development rates are modified by temperature. Adult mosquito activity rates are affected by temperature, relative humidity, and vector control. Indoor residual spraying (IRS) kills mosquitoes when they rest on a sprayed surface, usually after blood feeding or during the process of searching for a host. Insecticide treated nets (ITNs) protect humans from biting and kill some mosquitoes. By reducing the availability of potential blood hosts, nets can slow blood feeding in some contexts. Larval source management (LSM) reduces immature population densities. By studying mosquito ecology and malaria transmission dynamics, we can start to understand malaria as a changing baseline that has been modified by malaria control. This is the problem confronted daily in malaria programs, but dealing with the evidence requires having the tools available to synthesize data describing different parts of malaria. The models help translate evidence into information that can be used to make decisions, to make strategic plans, and to mark progress against national plans. The models encapsulate information about transmission in context, so it is possible to study how malaria persists in a place over time, and how various factors have modified (or could modify) mosquito population dynamics and blood feeding and thereby suppress transmission. Transmission models help us to set intervention coverage targets based on an understanding of malaria connectivity to surrounding regions and local thresholds. In policy, we use these models with the expectation that – if we fit the models by adjusting parameters that affect how malaria works in some particular place – they should help us understand transmission in some particular context and make good decisions about what to do. Frustratingly, the heterogeneity and the complexity conspire against us. We would like to be sure about how malaria works across settings before we start using the models to stratify populations, tailor interventions to context, or targeting the interventions. Instead, we must admit that we don’t know everything we’d like to, and we probably never will. We must proceed with policy without having satisfactory answers to some basic questions. In policy, we will use the models to evaluate the consequences of having missing information, but we will also use the models to help us prioritize missing data so we can fill in the gaps. What missing data would reduce our uncertainty about what to do about malaria? How do we fill the critical knowledge gaps. To understand malaria or to give policy advice, we must start simple and then add complexity, layer on layer. To deal with missing information, we start with generic models, and then add details to address concerns about some of the details that we hope to identify by studying the systems as we intervene. This approach – starting simple and then layering on complexity – makes it possible to learn as we go. A question is when it stops making sense to add realism to a model. A model that it too simple and abstract might help us understand the basic dynamics and give generic advice, but we would question the model’s adequacy if it could not reproduce the patterns we cared about in some particular place at some particular time. As a rule of thumb, a model should be just complex enough to describe the patterns we care about and weigh the relevant options to give advice. Practically speaking, it’s hard to know you’ve gone far enough unless, at some point, it’s clear that you’ve gone a bit too far. Over the past few years, we developed a new framework for building models that would make it possible to start simple and then build models of malaria transmission at any level of complexity. We wanted to be able to build in realism by adding complexity one feature at a time. Through this process we can create nested, hierarchical models in branching chains. At the ends of the chains, we might find highly realistic models that are, perhaps, overfit. (The cautions against overfitting play out differently in policy given the urgency of acting in a timely way, but it is also possible to go out and collect new data.) We call the framework’s ability to do this scalability and the resulting swarms have scalable complexity. The iterative attempt to make plans, weigh evidence, quantify uncertainty, gather new data to reduce uncertainty, and then restart the annual cycle, is called adaptive malaria control. To make this possible, we needed a way of building models that would keep the focus on the policy questions and on a dialogue between malaria managers and the analytical support team. We thus sought to design modular software with plug-and-play functionality and a high degree of structural flexibility. We needed the framework to be extensible. After making a lot of mistakes, the primary design phase is over, and the algorithms have been published in two software packages. We are currently extending the library of base models, which includes some simple or classical models that are instructive or of historical interest. We are also fine-tuning the design requirements for models as we develop protocols that streamline fitting models to data. The software avoids the mistakes we made over the past few years, reuses models, and streamlines the model building process. We hope this software has dramatically lowered the costs of building and analyzing these complex, realistic models. A schematic diagram of the elements in the framework (top half) and the process of model building and model fitting (bottom half) This book has been written to introduce the features of the framework (see Figure 1.1). The book itself is embedded in the RAMP-Model-Library, which was set up during the primary design phase. The RAMP-Model-Library is where we made all our design mistakes: was the software truly plug-and-play, and was the framework truly extensible? As the primary design phase came to a close, the library that was once the laboratory became a classroom and a museum. The library is being transformed into a resource for any developer who wants to add new base models to the library or add functionality. Most of all, it is being set up for the end user, someone in a malaria program or working with a malaria program who wants to use simulation based analytics to analyze policies. This book is structured into a set of lessons that teach concepts. Some of the concepts build on one another, and others take on new challenges. We combine these lessons into some examples where we show some algorithms to build models fit for purpose. When a topic deserves a deeper dive, we have supplemented this book with vignettes or lessons. In malaria epidemiology (narrowly defined as a study of infection and disease in humans), the relationship between exposure, infection, immunity, disease, and infectiousness changes in populations as they age, and it is affected by drug taking. This picture grows more complex as we consider intervening with vaccines or monoclonal antibodies, or as we look at interactions with anemia, nutritional status, and human genetics. Our models need to interface with data from clinical settings and research, so they will need to consider diagnostics, parasite counts, detection, and transmission. Combining these factors can give rise to an overwhelming amount of complexity. Later, we will introduce new models and show how it possible to simplify all this complexity and make sense of malaria. We are interested in using these models to guide policy, which requires both solid computation and good communication. In this book, we lay a foundation for understanding the complexity by studying some simple compartmental models. We will review classical queuing models for superinfection and the multiplicity of infection (MoI); new models for the age of infection (AoI) or stage of infection (SoI); immunity; parasite densities, fever, disease, and detection; gametocytes and transmission, and drug taking. To end up with models that can handle all the complexity, we build probabilistic models that combine these factors. In doing so, we find that we can do some powerful analysis, and we can map the states in these models onto outcomes that matter for research and policy: test positivity, parasite counts, infectiousness, and disease. With patience, we can combine these factors and develop a framework for understanding malaria in populations that match the features of individual-based simulation models. We end up with a sensible understanding malaria epidemiology as ontogeny – development of immunity as a part of an organisms history. We back this view with some very usable models that capture the changing character of malaria in cohorts of humans as they age. We are interested in understanding malaria control in context, which requires delving into mosquito ecology and behavior. In this book, we start with a simple model for mosquito ecology and parasite infection dynamics in mosquitoes. We add aquatic population dynamics, mosquito population regulation, and exogenous forcing by weather. Later, we worry about adult mosquito behavioral states such as mating, sugar feeding, and egg laying. We introduce the concept of resource availability, and we develop an understanding of mosquito search and movement in response to resource availability. We take some deep dives to understand how mosquito spatial dynamics work at a fine spatial grain, and then we scale up to understand mosquito populations on landscapes. At first, we describe mosquito blood feeding and transmission with a few simple parameters. Later, we develop a new model for mosquito blood feeding in a dynamically changing host population with parameters that allow host strata to be more or less available. We also modify our understanding of heterogeneous exposure to biting. We develop a methods for modeling environmental heterogeneity, heterogeneous exposure by age, and a generalized way of handling failty– other sources of heterogeneous biting – through stratification. We must take a detour to understand how to handle the effects of temperature on the parasite’s extrinsic incubation period (EIP). We need a way of dealing with mosquito survival and dispersal through the EIP. This problem has been effectively solved. To round out this picture, we need a way of dealing with other aspects of human ecology that affect malaria transmission dynamics, including human mobility, human demography, bed net usage, adherance to drugs, and care seeking. Differences among humans call for a synthesis of studies that have identified traits that affect malaria, stratification, and simulation to identify useful ways of propagating the heterogeneity through analyses. To go along with a theory of transmission, we need a theory of control. We compute effect sizes and evaluate area effects. We develop a generalized concept of effect modification that considers the total effect of a single unit of control. We modify basic processes by including the effects of vector control and mass medical interventions (e.g. seasonal malaria chemoprotection, mass drug administration, vaccines, and monoclonal antibodies). Relying on behavioral state models and the concept of resource availability, we develop a models for integrated vector control. In doing all this, we are building on an enormous body of work that started with Ronald Ross. While Ross is better known for identifying malaria parasites in a mosquito gut, which proved that malaria is mosquito transmitted, we are more interested in the academic work that followed. After winning the Nobel Prize in 1902, Ross was instrumental in building solid quantitative foundations for malaria transmission and its measurement. Ronald Ross wrote the first models describing malaria transmission. In his writings from 1899 to 1908, it’s clear that he was searching for quantitative way of saying something simple – if there are not enough mosquitoes, the malaria transmission can’t be sustained. There must be a critical mosquito density, above the cutoff malaria transmission would be sustained, and below it malaria would be eliminated. Ross was looking for a formula that encapsulated his intuition: how were thresholds related to the fact that it took two bites for a mosquito to complete its life cycle? Eventually, Ross wrote down some systems of equations that would describe malaria. The ideas, mathematics, and identification of parameters and processes were extended by other scientists later, most notably Alfred Lotka and George Macdonald. It seems that the challenge of malaria control was what pushed Ross toward modeling. Ross’s first model was a discussion of adult mosquito movement to guide larval source management12. The first model describing malaria transmission appeared in a book, The Prevention of Malaria in Mauritius13. When it came to thinking through control, Ross found it useful to do the math. This is a book about how to do the math that is required for malaria programs. The goal is to use all the data available, but especially the data generated by malaria programs, to paint a clear picture of malaria transmission as a changing baseline that has been modified by control. The software is structured into three major domains: the humans and malaria epidemiology, including the effects of treating malaria with drugs; the mosquitoes and the way they have been changed by weather and vector control; and parasite transmission through mosquito blood feeding. Within each domain, there are multiple sub-domains, and there are built in design features to deal with heterogeneity and other features for malaria control. After a 140 years of studying malaria, there’s a lot of detail that could be important in some way. Part of what we need to do is sort through all that detail to find what is most relevant. We have organized the concepts in this book around a narrative that allows us to introduce the core concepts – those that make modular computation possible – in an order that minimizes the need to draw on unfamiliar concepts. We start with the Ross-Maconald model, but our next task is to update the model for mosquito blood feeding. Our philosophy has been to design a framework for model building that can be used by programs. The material in this book is designed to be used by non-experts too, so in this context, model building means applying a set of tools to to computational tasks we wish our brains could do. The software we have developed is meant to lower the costs of building and using models. We want programs to be focused on the decisions, the data, the concepts, and the analysis. As a metaphor, some students learn a numerical method for approximating \\(\\sqrt{2}\\) in school, but after learning it once, they stop worrying about how it is computed and they punch buttons into a calculator. Knowing how to compute something is sometimes useful, but worrying about how to compute it each time would interrupt the process that called for computing it. Instead, we punch the formula into a scientific calculator or any software that does computation confident that the machine knows how to do it. In applying models, the same kind of logic applies. People need to understand the concepts, but like a calculator, the tools should hide the technical details that don’t add to a discussion. The software we have developed is a reliable interface for calculations designed to support policy. To learn how to use that software, we need to get through a lot of material. The background material in the following presentation is fairly sparse. We are trying to introduce just enough mathematics to teach users the critical concepts so they know what the software can do. We assume that the work will be done by teams that include a few people who understand the mathematics, who can guide others through the process. To fill in some of the gaps and technical, we have written (or can write) vignettes. On occasion, the text includes links to these vignettes for those who might find them useful. Please send suggestions about new vignettes to smitdave@gmail.com. The first model we present is a Ross-Macdonald model. References "],["contributors.html", "Contributors", " Contributors I’ve done the primary writing for this book. The framework would not exist without the work of Sean L Wu and a few others. The book borrows from the work of others, and we have done our best to give credit through citations. It has been a collaborative process (see Contributors). The errors, however, are mostly mine. If you find mistakes or have questions, please drop me a note by email: smitdave@gmail.com. This is a work in progress, so the list of contributors will change over time. The software package MicroMoB was written by Sean L Wu, Sophie Liebkind, and David L Smith. The software package exDE was written by Sean L Wu and David L Smith. Most of the content so far was written by David L Smith. Contributors from the RAMP Team include: …please consult Dave if you would like a writing role. "],["the-study-of-malaria-in-populations.html", "1 The Study of Malaria in Populations", " 1 The Study of Malaria in Populations Ronald Ross is best known for being the first person to observe malaria parasites infecting a mosquito,14 an event that is now celebrated as mosquito day. In his next paper, Ross presented evidence that mosquitoes transmit the parasites to humans, a step that was required to prove that the parasites cause malaria.15 A few months later, the life-cycle of human malaria parasites was described by an Italian team, led by Giovanni Battista Grassi.16,17 Ross’s discoveries had closed a loop that Charles Laveran opened in 1880 when he published his discovery of malaria parasites infecting humans18,19. After Laveran, several studies described basic features of malaria infections in humans.20 These discoveries and studies set the stage for the modern study of malaria epidemiology. The life-cycle of human malaria parasites as it is now taught was not described fully until the 1940s, when Garnham and colleagues described the liver stages of malaria parasites.20,21 The story of how the malaria parasite’s life cycle was unravelled over time is a topic that worth taking some time to learn, and several good accounts have been written.20,22,23,24 While that story that is of great interest, this book on Applied Malaria Dynamics is about the use mathematics – including dynamical systems – to study malaria in populations and the prevention of malaria, which brings us back to Ronald Ross. In 1899, Ross launched a new career that took a very broad approach to the prevention of malaria.25,26 Ross was a key player in the early days malaria research, initiating studies of all sorts in malaria epidemiology and control. Among his publications are found the first three mathematical models describing malaria transmission dynamics or control.1,12,13,27 For the most part, the end of this phase of his career is marked by publication of the \\(2^{nd}\\) edition of The Prevention of Malaria in 1911,1 when Ross changed gears once again. His next ambitious goal was to describe mathematical foundations for epidemiology.28,29 In 1917, he teamed up with Hilda Hudson, a Cambridge mathematician, to write the first major contribution to mathematical epidemiology, or what he called a priori pathometry.30,31 Over 18 years (1899-1917), Ross’s ideas laid a solid foundations for the modern study of malaria transmission and theory of malaria control.2 The narrative in this book is often historical, which serves two purposes. First, it provides an excuse to cite and discuss old papers that should not get overlooked. Second, a historical narrative allows us to introduce malaria complexity in an ordered way, starting from principles that are simple and abstract, and progressing towards ideas that are non-linear, messy, or subtle. We will often use history as a way of structuring discussions, even as our attention turns increasingly to the mathematics we need to deal with the biological complexity of malaria in populations. References "],["the-prevention-of-malaria.html", "1.1 The Prevention of Malaria", " 1.1 The Prevention of Malaria Ross’s interest in malaria control traces to 1899,25,26 just a few months after mosquito day: …in order to eliminate malaria wholly or partly from a given locality, it is necessary only to exterminate the various species of insect which carry the infection. This will certainly remove the malaria to a large extent and will almost certainly remove it altogether. It remains only to consider whether such a measure is practical25. Through the first half of the 1900s, Ross promoted malaria control and research on malaria control in various ways. He engaged in public debates about malaria control hosted by the British Medical Journal, and he published a book, Mosquito Brigades and How to Organize Them32. Many of the early attempts to control malaria were implemented by the British Military. In the first few years, there were some successes, but there were also some failures33. Heterogeneity in the responses to malaria control efforts seem to have turned Ross to mathematics. In 1904, he presented a paper at the International Congress of Arts and Science in St. Louis, Missouri that applied diffusion models to larval source management (published also in Science12). Ross’s transmission models appear to trace back to his work consulting with national malaria programs in Mauritius and Greece13,34. While he was writing about the nuts and bolts of control, he was also grappling with mathematical formulas that could help him understand malaria control quantitatively. How would reducing mosquito densities change the prevalence of malaria? Was there a critical population density of mosquitoes required to sustain transmission? The result was the first mathematical model to describe malaria transmission dynamics13. A short time later, Ross would reformulate the model in the \\(2^{nd}\\) edition of his book, The Prevention of Malaria1. For Ross, the mathematical models were a logical next step of trying to understand malaria control in rigorous quantitative terms. References "],["malaria-in-populations.html", "1.2 Malaria in Populations", " 1.2 Malaria in Populations "],["a-priori-pathometry.html", "1.3 A priori Pathometry", " 1.3 A priori Pathometry By 1915, Ross had taken a broader view of the study of epidemics. His intent was to establish a discipline, that he called a priori pathometry. He starts29: It is somewhat surprising that soo little mathematical work should have been done on the subject of epidemics… He argues that …the principles of epidemiology on which preventive measures largely depend, such as the rate of infection, the frequency of outbreaks, and the loss of immunity, can scarceley ever be resolved by any other methods than those of analysis. After discussing some major differences observed in the patterns of epidemics exemplified by three diseases: tuberculosis; measles; and plague. Ross asks: Why, indeed, should epidemics occur at all, and why should not all infectious diseases belong to the first group and always remain at an almost flat rate? After his years of studying malaria, he realized the difficulty of measuring malaria in populations, so he argued for an integrated approach: The whole subject is capable of study by two distinct methods which are used in other branches of science, which are complementary of each other, and which should converge towards the same results – the a posteriori and the a priori methods. In the former we commence with observed statistics, endeavor to fit analytical laws to them, and so work backwards to the underlying cause (as done in much statistical work of the day); and in the latter, we assume a knowledge of the causes, construct our differential equations on that supposition, follow up the logical consequences, and finally test the calculated results by comparing them with the observed statistics. He teamed up with Hilda Hudson, a Cambridge mathematician, and they finished publishing a major general treatment of mathematical epidemiology. Taken altogether, we can see Ross’s efforts as establishing a rigorous, general approach to inference for infectious diseases. To be clear, Ross was not the first to publish a mathematical model describing infectious disease dynamics. References "],["transmission-dynamics.html", "1.4 Transmission Dynamics", " 1.4 Transmission Dynamics The development of the Ross-Macdonald model has been discussed elsewhere2. There is not a single paper where a system of equations was published by Macdonald. Instead, the model traces back to several different publications that present equations and formulas describing malaria transmission. We have already mentioned that Ronald Ross published two models of malaria. The first described malaria transmission dynamics using difference equations13; it was reviewed, analyzed, and critiqued by H. Waite35. The second was formulated as a system of two ordinary differential equations, in the \\(2^{nd}\\) edition of The Prevention of Malaria1. Ross also published the same model in Nature27 in this form: \\[ \\begin{array}{rl} dz/dt &amp;= k&#39; z&#39; (p-z) + q z \\\\ dz&#39;/dt &amp;= k z (p&#39;-z&#39;) + q&#39; z&#39; \\\\ \\end{array} \\] At the time, there was not much evidence from malaria research to frame the problem. A fully parameterized model, using biologically meaningful parameters, would have to wait for a few decades of research and a synthesis by Macdonald. 1.4.1 Alfred J. Lotka While Alfred J. Lotka is more famous for his work in demography and ecology, he took an interest in Ross’s work on malaria and he made some important contributions to mathematical malaria epidemiology: In 1912, he published a set of solutions to Ross’s equations36; In 1923, Lotka published an analysis of malaria dynamics in five parts. The first two parts reformulate Ross’s models37,38. The third part tackles numerical issues, which includes a photograph of a clay model of the phase plane as a surface39, and the fifth part is a concise summary40. In the \\(4^{th}\\), which was led by Sharpe, a new model was introduced that included delays for the latent periods41. Most importantly, Lotka developed the concept of the basic reproductive number in his work in human demography, which was defined as the expected number of females that would be born to a newborn female. 1.4.2 George Macdonald In the 1950s, George Macdonald published a set of papers describing malaria transmission dynamics and control, culminating in publicataion of a book The Epidemiology and Control of Malaria42. An important caveat is that Macdonald relied on the mathematical talents of Armitage for the equations describing superinfection and the sporozoite rate43. In 1950, Macdonald published a synthetic review of malaria epidemiology44. In 1950, Macdonald also published a new model of malaria epidemiology with superinfection45. In 1952, Macdonald published a synthetic review of medical entomology46. In 1952, Macdonald described malaria transmission dynamics in a paper that combined his other work, in which he introduced \\(R_0\\)47. It’s highly likely that Macdonald was aware of Lotka’s demographic concept of \\(R_0\\), as well as his work with Sharpe on delay differential equations41, though I have been unable to find a single line where Macdonald gives Lotka the credit. For these reasons, and others, the equations ought to be described as the Ross-Lotka-Macdonald model. References "],["rebuilding-macdonalds-model.html", "1.5 Rebuilding Macdonald’s Model", " 1.5 Rebuilding Macdonald’s Model The following is a candidate for what the Ross-Macdonald model might have looked like, if Macdonald had ever written it down. 1.5.1 Variables The model has two variables: \\(x\\) is the fraction of humans who are infected; \\(y\\) is the fraction of mosquitoes who are infected. 1.5.2 Parameters The model has several parameters: \\(g\\): mosquitoes die at a constant rate, \\(g\\). This is equivalent to assuming that the mosquito lifespan is exponentially distributed with a mean \\(1/g\\). Macdonald’s equation use \\(p\\), the fraction surviving one day, \\(p = e^{-g}\\). \\(\\tau\\): it takes \\(\\tau\\) days for parasites to mature and reach the salivary glands, called the EIP. The fraction surviving the EIP is \\(p^\\tau = e^{-g \\tau}\\). \\(m\\): there are \\(m\\) mosquitoes per human; \\(a\\): mosquitoes blood feed on humans at the rate \\(a\\); \\(b\\): a fraction of bites by infectious mosquitoes causes an infection; \\(r\\): human malaria infections clear at the rate \\(r\\); \\(c\\): a fraction of bites on infected humans infect a mosquito, denoted \\(c\\) 1.5.3 Dynamics In this formulation of the model, we ignore the delay for the EIP but we count the mortality: \\[ \\begin{array}{rl} dx/dt &amp;= b m a z (1-x) - r x \\\\ dy/dt &amp;= c a x (1-y) - g y \\\\ dz/dt &amp;= c a x_\\tau (1-y_\\tau) - g z \\\\ \\end{array} \\] this. "],["the-basic-reproductive-number.html", "1.6 The Basic Reproductive Number", " 1.6 The Basic Reproductive Number "],["sensitivity-to-parameters.html", "1.7 Sensitivity to Parameters", " 1.7 Sensitivity to Parameters "],["the-classification-of-transmission.html", "1.8 The Classification of Transmission", " 1.8 The Classification of Transmission "],["extensible-transmission-dynamics.html", "2 Extensible Transmission Dynamics", " 2 Extensible Transmission Dynamics If we want to use mathematical models to evaluate policies, we must acknowledge the limitations of the Ross-Macdonald model. Its simplicity is useful as a concise way of understanding malaria transmsission through the parasite’s life-cycle. There is, however, a great deal of complexity that the Ross-Macdonald model does can not address, and some of it matters a great deal in policy. We must extend the model using new mathematical constructs to deal with several features of malaria: malaria immunity and disease in cohorts of humans as they age; anti-malaria drugs and other pharmaceutical interventions; heterogeneous exposure spatial dynamics and malaria importation; temporal dynamics including seasonality, perhaps exogenously forced by weather; mosquito ecology and behavior; and vector control. In the following chapters, we will introduce and critically review the models that have been developed to address these topics in some detail. As we take on these new features and add complexity, we will (in effect) be going around the parasite and mosquito life-cycles over and over again, each time pursuing a new theme. We want to pursue the idea of scaling complexity in dynamic models ranging from simple and abstract to highly realistic. We want to arrive at a happy compromise – a model that is (as Einstein probably never exactly said48) “as simple as possible, but no simpler.” It might be hard to convince anyone that a model of intermediate complexity is good enough unless at least some of the models have clearly gone too far. We don’t want to add new features to our models unless they would affect some important aspect of malaria transmission dynamics and control. Fortunately, we can pursue many of these questions about what details are biologically relevant through model-model comparison. We think of all these models as crude approximations to a messy reality – the question we want to address is whether the approximations are good enough to use as a basis for giving policy advice. Building very complex models that are also mathematically and biologically sound and meaningful is a daunting task, but we have developed a modular system for building models that streamlines the model building process. To get started, we will reintroduce the Ross-Macdonald model in a form that is easier to extend than the one Macdonald made famous2. We will start with a model that first appeared in a 1982 book chapter written by Joan Aron and Robert May49. It is a good starting point because it is extensible. We chose it because the variables represent population densities, which are used to compute proportions, like prevalence. In the version of the Ross-Macdonald we presented before (in Rebuilding Macdonald’s Model), the variables are proportions. In some models, we would like the total number of hosts to change over space or time, but if our state variables are proportions, then these densities appear in the denominators, which would make them much more difficult to modify. By writing down equations using densities, it is far easier to add complexity. The model is extensible because, as we will see, mosquito population density is a variable, not a term. A parameter in the equation describing changes in mosquito density provides a link to aquatic mosquito ecology, which makes it possible to develop models for mosquito population dynamics, when that is an important consideration. In this version, we find that the formulas describing \\(R_0\\) and vectorial capacity tell the story of parasite transmission through two blood meals. We will thus update the classical formulas. While Macdonald’s analysis and formulas are familiar to many, they were incomplete50,51. We develop a formula for vectorial capacity that is consistent with the intent of the original, but our analysis of sensitivity to parameters includes effects on mosquito ecology52. (A lengthy and philosophical discussion of the history and its failings is planned.) We chose it because it is realistic. Time does not appear in most versions of the Ross-Macdonald model: the equations are autonomous. These equations use time to drive a seasonal pattern: they are non-autonomous. Since we know we are interested in dealing with exogenous forcing, we start out with a model that is forced. While the following model is basic, we recommend reading it, if only because we introduce concepts and conventions that are important for the software design. References "],["the-aron-may-model.html", "2.1 The Aron-May Model", " 2.1 The Aron-May Model We define the following variables: \\(M\\) is the density of mosquitoes. \\(Y\\) is the density of infected mosquitoes. \\(Z\\) is the density of infectious mosquitoes. \\(X\\) is the density of infected humans. In dynamical systems, we ask how the variables (i.e. \\(M\\), \\(Y\\), \\(Z\\), and \\(X\\)) change over time. In the following, we describe the changes on variable about a time. 2.1.1 Mosquito Ecology For our first equation, we start with adult, female mosquito populations. (It is tiresome to repeat adult, female each time, and we’re ignoring male mosquitoes at this point anyway, so mosquito hereafter means adult, female mosquito, unless we say otherwise.) The number of mosquitoes is changing as new adults emerge from aquatic habitats or die. To model changes in \\(M\\), we assume the following: mosquitoes emerge from aquatic habitats at the rate of \\(\\Lambda(t)\\) adults, per day; mosquitoes die at a constant rate, \\(g\\). This is equivalent to assuming that the mosquito lifespan is exponentially distributed with a mean \\(1/g\\). The fraction surviving one day is \\(e^{-g}\\). Our first equation describes changes in the number of mosquitoes: \\[\\begin{equation} \\frac{dM}{dt} = \\Lambda(t) - g M \\end{equation}\\] 2.1.2 Blood Fed Mosquitoes At this point, we will take a detour and define a variable describing the density of mosquitoes that have blood fed at least once, \\(V\\). After blood feeding, a mosquito is either gravid or parous, meaning its ovaries are distended from laying an egg batch. We do this, in part, because the fraction of mosquitoes that are parous is routinely collected, and because it gives us a chance to focus on blood feeding. To describe blood feeding, we assume the following: mosquitoes blood feed at the rate \\(f\\), per mosquito, per day; in this model, this implies that the waiting time to a blood meal is \\(1/f\\) days. a fraction of all mosquito blood meals, \\(q\\), is taken on humans; we call this the human fraction the human blood feeding rate is the product of these two parameters, \\(fq\\), which is defined as the number of human blood meals, per mosquito, per day. The number of human blood meals by a population of vector mosquitoes, per person, per day is called the human biting rate (HBR). In this model, HBR is given by a formula: \\[\\mbox{HBR} = \\frac{fqM}{H}\\] Later, we discuss the correspondence between the HBR in models and data. \\[\\begin{equation} \\frac{dV}{dt} = f q (M-V) - g V \\end{equation}\\] We won’t use \\(V\\) to describe the dynamics of infection, but we might find it useful to understand how parity changes in mosquito populations. 2.1.3 Infected Mosquitoes Mosquitoes become infected after blood feeding on an infectious human. To model changes in \\(Y\\), we extend the model of blood feeding to include infection. We need to know what fraction of blood meals end up infecting a mosquito that has not already been infected. To model changes in \\(Y\\), we need to describe infection rates. We assume the following: a fraction of human blood meals, infects mosquitoes. We call this quantity net infectiousness (NI) and (for reasons that we will discuss in a moment), we give it a name, \\(\\kappa\\): \\[\\begin{equation} \\kappa(t) = c \\frac{X(t)}{H} \\tag{2.1} \\end{equation}\\] infected mosquitoes die at the same rate as uninfected mosquitoes. We can now write down our second equation describing changes in the number of infected mosquitoes: \\[\\begin{equation} \\frac{dY}{dt} = f q \\kappa (M-Y) -g Y \\end{equation}\\] 2.1.4 Infectious Mosquitoes To become infectious, a mosquito has to become infected and then survive through the extrinsic incubation period (EIP). We assume: mosquitoes become infectious after a fixed delay, \\(\\tau\\) days, called the EIP. The fraction of mosquitoes that survive through the EIP is \\(e^{-g \\tau}\\). infectious mosquitoes die at the same rate as other mosquitoes. For a mosquito to become infectious, it must have become infected \\(\\tau\\) days ago and survived through \\(\\tau\\) days with probability \\(e^{-g\\tau}\\). To write this in equations, we use a subscripted \\(\\tau\\) to denote the value of a variable (\\(M\\), \\(Y\\) or \\(X\\)) or term (\\(\\kappa\\)) at time \\(t-\\tau\\). For example \\(X_\\tau\\) is the number of people who were infected and infecious at time \\(t-\\tau\\), and \\(M_\\tau\\) is the number of mosquitoes at time \\(t-\\tau\\). The number of infectious mosquitoes that are added to the population at a point in time includes all the mosquitoes that became infected at time \\(t-\\tau\\) and survived the EIP. This is our third equation describing changes in the number of infectious mosquitoes: \\[\\begin{equation} \\frac{dZ}{dt} = f q \\kappa_\\tau (M_\\tau-Y_\\tau) e^{-g\\tau} -g Z \\end{equation}\\] Here, \\(Z\\) represents the number of mosquitoes with sporozoites in their salivary glands. The fraction of mosquitoes with sporozoites in their salivary glands has been called the sporozoite rate (SR), which in our notation is \\[ z = \\frac{Z}{M}\\] The number of bites by vector mosquitoes, per person, per day is called the entomological inoculation rate (EIR). It is defined as the product of the HBR and the SR: \\[\\mbox{EIR} = \\mbox{SR} \\times \\mbox{HBR}\\] In our notation, the EIR is: \\[\\mbox{EIR} = z \\frac{fqM}{H} = \\frac{fqZ}{H}\\] As with the HBR, we would like to know how to connect estiamted values of the EIR to our formulas. Since that’s really complicated, we’ve spent a lot of time in the following sections discussing it. 2.1.5 Infected Humans Humans become infected after being bitten by an infectious mosquito. We assume the following: A fraction \\(b\\) of all bites by infectious mosquitoes cause an infection. The hazard rate for infection, also called the force of infection (FoI) and denoted \\(h\\) is \\(b \\times\\) EIR: \\[h = fqb \\frac{Z}{H}\\] Infections clear at the rate \\(r\\), per infection, per day (the average time to clear is \\(1/r\\) days), and after clearing an infection a person becomes susceptible to infection again. We can now write down our fourth equation describing changes in the number of infected humans: \\[\\begin{equation} \\frac{dX}{dt} = h (H-X) - r X \\end{equation}\\] 2.1.6 …as a System While we presented these equations one at a time, they work as a system. To see it all at once, we write it here as a system with four equations and two terms: \\[\\begin{equation} \\begin{array}{rl} \\frac{dM}{dt} &amp;= \\Lambda(t) - g M \\\\ \\frac{dY}{dt} &amp;= fq\\kappa(M-Y) - g Y \\\\ \\frac{dZ}{dt} &amp;= fq\\kappa_\\tau(M_\\tau-Y_\\tau)e^{-g\\tau} - g Z \\\\ \\frac{dX}{dt} &amp;= h (H-X) - rX \\\\ \\\\ \\hline \\\\ \\kappa &amp;= c \\frac{X(t)}{H} \\\\ h &amp;= b fq \\frac{Z(t)}{H} \\\\ \\end{array} \\end{equation}\\] A diagram of the a version of the Ross-Macdonald model, using equations from Aron and May49 These equations describe processes in three domains (Figure 2.1): adult mosquito ecology (\\(M\\), and perhaps \\(V\\)); parasite infection dynamics in mosquito populations (\\(Y\\) and \\(Z\\)); parasite infection dynamics in human populations (\\(X\\)). The equations describing parasite infections in mosquito populations also include the variable \\(M\\), so the mosquito infection dynamics are coupled to the mosquito population dynamics. The way we’ve written the equations, each compartment has an input term (i.e., \\(\\Lambda\\), \\(\\kappa\\), or \\(h\\)) that depends on something else. We’ve passed \\(\\Lambda\\) as a parameter. For the infection dynamics, the terms \\(\\kappa\\) and \\(h\\) couple two separate systems. For adult mosquito dynamics, emergence is passed to the model as a parameters. There are, of course, more compact ways of writing these equations. We have written the equations this way to emphasize a few things. First, the terms make it clear exactly how the equations in one domain are connected to another. Second, if we wanted to start changing some of the assumptions, these terms help to isolate the parts we might like to change. By writing the equations in this modularized form, we can start to understand how we might be able to write software that would allow us to represent mosquito infection dynamics with different systems of equations. The next step is to find solutions. NOTE: We don’t introduce exDE or MicroMoB until Modularity and Software. References "],["solutions.html", "2.2 Solutions", " 2.2 Solutions What does a solution to these equations look like? Solutions to these equations are values of the variables over time \\(\\left( M(t), Y(t), Z(t), X(t) \\right)\\) that satisfy the system of four equations described above. We call these solutions orbits. To put it another way, if we took the derivatives of the orbits for any variable at any point in time using the basic definition \\[\\lim_{h\\rightarrow 0} \\frac{x(t+h)-x(t)}{h},\\] and then we used the values of the variables at time \\(t\\) to compute \\(dM/dt\\), \\(dY/dt\\), \\(dZ/dt\\), and \\(dX/dt\\) (i.e., using the formulas), we would get the same values. It is important that these orbits are unique: after specifying the initial values of the variables, there is one and only one set of orbits that solves the equations. When we solve the equations, we usually produce solutions from a starting point into a future, but the orbits are defined for all time – \\(i.e.\\) the process implies the existence of solutions far back into the past. These are deterministic equations, after all. As written, the equations do not define a model. Instead, the equations define a process or a model family. A model is something that can produce orbits. A model is defined only after assigning specific values to the parameters. Informally, we will often slip and use the “model” to describe a model family. It’s easy to slip up, and sometimes we can get by with being sloppy, but we need to remember the distinction. When we say that the software is modular, we mean that it is easy to swap out one model family for another. To find solutions of equations we use an R software package called deSolve. Because of the delay for the EIP, these are called delay differential equations, which are handled using a function called dede. An important step in solving delay differential equations is a function lagvalue() that computes and returns the values of variables at a time lag, \\(\\ell\\). In these equations, the lag is set by the EIP, \\(\\tau\\), so we must evaluate lagvalue(t-tau). In solving ordinary differential equations, we must pass initial conditions. To solve a delay differential equations with a maximum lag \\(\\ell\\), we must specify the initial conditions for the interval \\([-\\ell, t_0)\\), where \\(t_0\\) is the point in time when we start computing solutions. In these equations, since the equation for \\(dZ/dt\\) looks back \\(\\tau\\) units, we must specify values of \\(M(t)\\), \\(Y(t)\\), and \\(X(t)\\) for all values of \\(t \\in [-\\tau, t_0)\\). This forces an awkward choice, since we don’t know the solutions backwards in time, but would need to know those solutions to use them. What is typically done – and we’ve done it here – is to specify a constant set of initial values and moving on. Doing this introduces a little numerical slop. By slop, we mean that these values are not what we would get if we ran the equations backwards in time. In these equations, it won’t affect our analysis most of the time, so we’re happy to acknowledge this little problem and find ways around it. It’s a little thing, but we should never forget it, because we might find that it is affecting our analysis at some point. With deSolve, solving differential equations is not difficult – it just involves following a few steps. In the following, we walk through these steps: Write a function that computes the derivatives; Define initial conditions; Define the values of the parameters; Define a mesh on time; Call a function that solves the equations, such as dede for delay differential equations. Many users will find that reading this code is like learning how to compute \\(\\sqrt{2}\\). If so, feel free to learn it once and then skip it. 2.2.1 Derivatives The first step is to write down the equations to compute the derivatives. The solver expects a function with three required arguments (in this order): t is time y is the list of variables params is a set of parameters The derivatives are computed and returned in the same order as ‘y’ in a list. To make code that is easy to read, we make params as a list with parameter names (see below), so that inside the function with(params,{...}), the parameter names are visible. dAronMay = function(t, y, params){with(params,{ # Variables if(t&lt;=tau) ylag&lt;-y0 else ylag &lt;- lagvalue(t-tau) M=y[1]; M_tau = ylag[1] Y=y[2]; Y_tau = ylag[2]; Z=y[3]; X=y[4]; X_tau = ylag[4] # Terms kappa = c*X/H; kappa_tau = c*X_tau/H h = b*f*q*Z/H # Dynamics dM = Lambda(t) - g*M dY = f*q*kappa*(M-Y) -g*Y dZ = f*q*kappa_tau*(M_tau-Y_tau)*exp(-g*tau) -g*Z dX = h*(H-X)-r*X return(list(c(dM, dY, dZ, dX))) })} 2.2.2 Initial Values To run the model, we must supply initial values. If you were writing code yourself, it would be important to remember that the initial values and the return value for the derivatives must occur in the same order. A useful convention in {R} is to pass the initial values as a named list. Later, we can turn the outputs into a data frame, and then we can retrieve the variables by name. y0= c(M=60, Y=0, Z=0, X=1) The object y0 is a named list – the names are attached but invisible. y0 ## M Y Z X ## 60 0 0 1 When we turn it into a list, with as.list, the names are attached to the values: as.list(y0)$M ## [1] 60 If we use with, we create an environment where we can simply use the names: with(as.list(y0), { M }) ## [1] 60 2.2.3 Parameter Values We pass the parameters as a list. It might seem like overkill, but we have written a function makeParams() that takes default values and generates a list. This makes it easy to generate a new set of parameter values with alternative values, and it also helps us to write and pass function \\(\\Lambda(t)\\) with parameters we like. By passing the parameter as a list, the parameter values are available to the function dAronMay when we use with(params, {}). Note that we have also attached the initial values of the variables as a parameter set, which are the return values for lagvalue(t) when t&lt;0. makeParams = function(y0, g=1/12, f=1/2.5, q=0.95, c=0.15, b=0.55, r=1/200, H=1000, m=.05, ss=1, tau=10 ){ ss = min(1,max(0, ss)) Lambda = function(t){m*H*(1 + ss*sin(2*pi*t/365))} return(list(y0=y0,g=g,f=f,q=q,c=c, H=H,m=m,tau=tau,b=b,r=r,Lambda=Lambda)) } params = makeParams(y0) To make it absolutely clear, we are assuming: \\(g=1/12\\): mosquitoes live about \\(12\\) days, on average \\(f=1/2.5\\): mosquitoes feed every 2.5 days, on average \\(q=0.95\\): the human fraction is 95%; mosquitoes feed on humans 95% of the time \\(c=0.15\\): about 15% of bites on infectious humans infect a mosquito \\(b=0.55\\): about 55% of bites by infective mosquitoes cause an infection \\(r=1/200\\): human infections last about \\(200\\) days, on average \\(H=1000\\): we’re simulating transmission in a population of a thousand humans \\(\\tau=10\\): the extrinsic incubation period is about 10 days For emergence, we tune the average value using \\(m\\) and it is scaled to \\(H\\): The parameter \\(m\\) in the function above has been set to \\(0.05\\) by default. The parameter \\(ss\\) affects the amplitude of the fluctuations. We force it to take on values between 0 and 1. Emergence is modeled as a sinusoidal function with a yearly cycle. \\[\\Lambda(t) = m H \\left(1 + \\sin \\left(\\frac{2\\pi t}{365}\\right)\\right)\\] 2.2.4 Solving We define a mesh over time – the points in time when we would like to know the values of the variables: tt = seq(0,5*365, by=5) This code solves the equations: require(deSolve) yout &lt;- dede(y=y0, times=tt, func=dAronMay, parms=params) 2.2.5 Visualizing When we plot out the solutions, they look like this. "],["steady-states.html", "2.3 Steady States", " 2.3 Steady States Here, we analyze the system of equations in a narrow case when there is no seasonality, and the system reaches a steady state. To do so, we set the parameter ss=1, so that \\(\\Lambda(t)\\) is a constant; the resulting system is autonomous. We do this, in part, because the resulting system is easier to understand. We can develop intuition that can be applied (albeit with caution) to more complex systems. To be clear, we are dealing with this system: \\[\\begin{equation} \\begin{array}{rl} \\frac{dM}{dt} &amp;= \\Lambda - g M \\\\ \\frac{dY}{dt} &amp;= fq\\kappa(M-Y) - g Y \\\\ \\frac{dZ}{dt} &amp;= fq\\kappa_\\tau(M_\\tau-Y_\\tau)e^{-g\\tau} - g Z \\\\ \\frac{dX}{dt} &amp;= h (H-X) - rX \\\\ \\\\ \\hline \\\\ \\kappa &amp;= c \\frac{X(t)}{H} \\\\ h &amp;= b fq \\frac{Z(t)}{H} \\\\ \\end{array} \\end{equation}\\] As before, we have put the equations in their modularized form above, and the connecting terms below. The first thing to note is that \\(M\\) affects \\(Y\\) and \\(Z\\), which affect \\(X\\); but \\(M\\) is not affected by \\(Y\\) or \\(Z\\). Mosquito population density is exogenous to malaria dynamics. 2.3.1 Mosquito Density We can thus treat it separately in the analysis: \\[\\begin{equation} \\frac{dM}{dt} = \\Lambda - g M \\end{equation}\\] Since emergence rates are steady, mosquito population density reaches a steady state when \\(dM/dt=0\\), which occurs at: \\[\\begin{equation} \\bar M = \\frac{\\Lambda}{g} \\end{equation}\\] 2.3.2 EIR Next, we note that at a steady state, the delayed values of variables and terms don’t change, so from \\(dY/dt\\), we get: \\[\\begin{equation} g \\bar Y = fq\\kappa(\\bar M- \\bar Y) \\end{equation}\\] If we substitute the formula for \\(\\bar M\\) and solve for \\(\\bar Y\\), we get: \\[\\begin{equation} \\bar Y = \\frac{fq\\kappa}{g + fq\\kappa} \\frac{\\Lambda}{g} \\end{equation}\\] and since at the steady state, any variable at time \\(t+\\tau\\) is equal to its value at time \\(t\\), we substitute the formula for \\(g \\bar Y\\) into \\(dZ/dt\\) to get: \\[\\begin{equation} g \\bar Y e^{-g\\tau} = g \\bar Z \\end{equation}\\] Solving for \\(\\bar Z\\) we get: \\[\\begin{equation} \\bar Z = \\frac{f q \\kappa}{g + fq \\kappa} \\frac{\\Lambda}{g} e^{-g\\tau} \\end{equation}\\] At the steady state, \\[\\mbox{EIR} = fq \\frac{\\bar Z}{H}.\\] In field studies, the EIR is the product of the HBR and the sporozoite rate (SR). The sporozoite rate (SR, \\(z\\)) is given by: \\[\\begin{equation} \\bar z = \\frac{Z}{M} = \\frac{f q \\kappa}{g + fq \\kappa} e^{-g\\tau} \\end{equation}\\] So we can understand the EIR as having two parts: \\[\\begin{equation} \\mbox{EIR} = \\mbox{HBR} \\times \\mbox{SR} \\end{equation}\\] or equivalently \\[\\begin{equation} \\mbox{EIR} = \\frac{\\textstyle{fq\\Lambda}}{\\textstyle{H}} \\times \\frac{\\textstyle{f q \\kappa}}{\\textstyle{g + fq \\kappa}} e^{-g\\tau} \\end{equation}\\] This formula for the SR (albeit with slightly different notation) was originally derived as part of the Ross-Macdonald model43,46. Also, Smith and McKenzie (2004) have written a useful discussion of mosquito demography50. 2.3.3 Vectorial Capacity Here, we pause to define a term that describes the number of human blood meals each mosquito would take over its whole life: \\[S = \\frac{fq}{g}.\\] Since \\(1/g\\) is the mosquito lifespan in days, and \\(fq\\) is the human blood feeding rate, \\(S\\) is the number of human bloodmeals a mosquito would take over its lifespan. Intuitively, it makes sense that this should be what drives transmission, since it takes two human blood meals to transmit malaria parasites. If we rearrange the terms a bit, we can rewrite out the expression for the EIR: \\[\\begin{equation} \\mbox{EIR}(\\kappa) = fq \\frac{\\bar Z}{H} = \\frac{\\Lambda}{H} S^2 e^{-g\\tau} \\frac{\\kappa}{1 + S \\kappa} \\end{equation}\\] This formula for the EIR has two parts. We call the first part vectorial capacity (\\(V\\)): \\[\\begin{equation} V = \\frac{\\Lambda}{H} S^2 e^{-g\\tau} \\tag{2.2} \\end{equation}\\] The second part is an expression that involves mainly \\(\\kappa\\). \\[\\begin{equation} \\frac{\\kappa}{1 + S \\kappa} \\tag{2.3} \\end{equation}\\] The relationship between VC and EIR at a steady state is a product: \\[\\begin{equation} \\mbox{EIR}(\\kappa) = V \\frac{\\kappa}{1 + S \\kappa} \\tag{2.4} \\end{equation}\\] Vectorial capacity describes the slope of the EIR when \\(\\kappa\\) is small: \\[\\begin{equation} \\left. d\\frac{\\mbox{EIR}(\\kappa)}{d\\kappa}\\right|_{\\kappa = 0} = V \\tag{2.5} \\end{equation}\\] We say that VC describes potential transmission, even if the parasites are absent. Another way to say the same thing is that when \\(\\kappa\\) is small, then: \\[\\begin{equation} \\mbox{EIR}(\\kappa) \\approx V \\kappa \\end{equation}\\] We can interpret vectorial capacity (\\(V\\)) in simple terms. It describes the number of infective bites that would arise from all the mosquitoes biting a single human on a single day but only if all those mosquitoes became infected. Vectorial capacity tells the story of potential parasite transmission by mosquitoes in four steps, which highlights the fact that two human blood meals are required for the parasite to be transmitted and complete its life-cycle. \\[\\begin{equation} \\begin{array}{|c|c|c|c|c|c|c|} \\Lambda/H &amp; &amp; S \\kappa &amp; &amp; e^{-g\\tau} &amp; &amp; S \\\\ &amp; \\rightarrow &amp; &amp; \\rightarrow &amp; &amp; \\rightarrow &amp; \\\\ \\mbox{Mosquito} &amp; &amp; \\mbox{Parasite} &amp; &amp; \\mbox{Mosquito} &amp;&amp; \\mbox{Parasite} \\\\ \\mbox{Emerges} &amp; &amp; \\mbox{Infects} &amp; &amp; \\mbox{Survives} &amp;&amp; \\mbox{Infects} \\\\ &amp; &amp; \\mbox{Mosquito} &amp; &amp; \\mbox{EIP} &amp;&amp; \\mbox{Human} \\end{array} \\tag{2.6} \\end{equation}\\] As a reminder, while Eq. (2.6) includes \\(\\kappa\\), the formula for VC, in Eq. (2.2), assumes that \\(\\kappa=1\\): the VC describes transmission as if humans were perfectly infectious. It was defined this way on purpose: it was meant to include mosquito parameters and exclude human factors. We can think of VC as defining something like a conditional expectation, a maximum, or (as we have already said) a measure of potential transmission by mosquitoes that is independent of human factors. While \\(\\kappa\\) (the numerator in Eq.(2.3) accounts for most of the difference between the EIR and the VC, the rest of the difference is due to the denominator in Eq. (2.3), \\(1+S\\kappa\\), which traces back to the formula from \\(dY/dt\\), which assumes that mosquitoes are either infected or not. The denominator is a measure of saturation – the fraction of mosquitoes that get superinfected with parasites. The main point here is that as \\(\\kappa\\) increases, saturation increases. If we set \\(S\\) to the values in the previous plots, we can isolate the relationship: Figure 2.1: The effect (compare the solid and dashed black lines) and effect size of saturation (blue), graphically. In these formulas, the measure of saturation is exactly \\(1+S\\kappa\\). We could rewrite the relationship between the EIR and VC in a way that tells us something about how we might be underestimating a parasite’s reproductive success: \\[\\mbox{EIR}\\times (1 + S \\kappa) = V \\kappa\\] which suggests that each infectious bite is passing along an excess \\(S\\kappa\\) bites. 2.3.4 Malaria Prevalence &amp; Thresholds We let \\(x\\) denote infection prevalence: \\[\\begin{equation} x = \\frac{X}{H} \\end{equation}\\] so \\(\\kappa = c x\\), and \\[\\begin{equation} \\frac{dx}{dt} = \\frac{1}{H} \\frac{dX}{dt} = h (1-x)-r x \\end{equation}\\] We can also define the basic reproductive number: \\[\\begin{equation} R_0 = \\frac{bcV}{r}. \\end{equation}\\] It is the product of four terms: Vectorial capacity, \\(V\\), the number of infective bites, per person, per day; The number of days a person would remain infectious, \\(1/r\\); The fraction of infectious bites that would infect a human, \\(b\\); The fraction of blood meals on infectious humans that would infect a mosquito, \\(c\\) After taking their product, we can interpret \\(R_0\\) as a measure of the parasite’s reproductive success after a single generation. It only depends on where we start counting. It could be one of the following: the number of infected mosquitoes that would arise from a single infected mosquito; the number of infectious mosquitoes that would arise from a single infectious mosquito; the number of infected and infectious humans that would arise from a single infected and infectious human. Here, \\(R_0\\) plays an important role in these equations if we start with \\(dX/dt\\); then transform it to \\(dx/dt\\); then replace \\(h\\) with \\(bE\\); then replace \\(\\kappa\\) with \\(cx\\); then divide by \\(r\\); and rearrange: \\[\\begin{equation} \\frac{1}{r} \\frac{dx}{dt} = x \\left[R_0 \\left(\\frac{1-x}{1 + cSx} \\right) - 1\\right] \\end{equation}\\] Since \\(x\\) is the prevalence, it is always in the interval \\([0,1]\\). When \\(x\\) is very close to \\(0\\), then \\[\\begin{equation} \\frac{1-x}{1 + cSx} \\lesssim 1. \\end{equation}\\] and as \\(x\\) grows very small: \\[\\begin{equation} \\lim_{x \\rightarrow 0} \\frac{1-x}{1 + cSx} = 1. \\end{equation}\\] It follows that when \\(x\\) is small, \\(dx/dt&gt;0\\) if and only if \\(R_0 &gt; 1\\). Depending on \\(R_0\\), only one of two possibilities can hold: either \\(R_0&lt;1\\), so that \\(x=0\\) is the steady state; or \\(R_0 &gt; 1\\), and the steady state is: \\[\\begin{equation} \\bar x = \\frac{R_0 -1}{R_0 + c S} \\end{equation}\\] Since at the steady state, \\(\\kappa = c \\bar x\\), we can plug this back into the formulas above to get \\(\\bar Y\\) and \\(\\bar Z\\). What we’ve learned about these equations is that if mosquito population densities are constant, then malaria reaches a steady state: if \\(R_0 &gt;1\\), then there is a positive endemic equilibrium, and if \\(R_0 &lt; 1\\), then malaria is absent from the system. The system is said to be stable – in fact, is is globally asymptotically stable, which means that all the orbits end up converging to the steady state. This statement has been proved many times in many papers, and since this book is focused on policy, we’ll let others worry about proofs. 2.3.5 Checking our Work An advantage of working in this environment is that we can check our work. One way we could solve these equations would be to run them for a very long time: We make a parameter set that defines the model: y0=c(M=100, Y=10, Z=5, X=200) paramsSteady = makeParams(y0, ss=0) dede(y0, times=tt, func=dAronMay, parms=paramsSteady) -&gt; yout tail(yout, 1)[-1] -&gt; eq1 eq1 ## [1] 600.00000 211.01706 91.70764 793.10541 By plotting it out, we can check to see if we’ve run it for long enough: We can check our algebra by computing the same quantities, and \\(R_0\\) and other quantities we care about: steadyStates_AronMay = function(params){with(params,{ Lambda = m*H Meq = Lambda/g S = with(paramsSteady, f*q/g) V = m*S^2*exp(-g*tau) R0 = b*c*V/r x = ifelse(R0&gt;1,(R0-1)/(R0+c*S), 0) Xeq = x*H kappa = c*x Yeq = S*kappa/(1+S*kappa)*Meq Zeq = Yeq*exp(-g*tau) EIR = f*q*Zeq/H FoI = b*EIR aEIR = 365*EIR aFoI = 365*FoI extra=c(S=S, V=V, R0=R0, x=x, kappa=kappa, EIR=EIR, FoI=FoI) annual =c(aEIR = aEIR, aFoI=aFoI) list(std=c(M=Meq, Y=Yeq, Z=Zeq, X=Xeq), extra=signif(extra, 3), annual = signif(annual,3)) })} steadyStates_AronMay(paramsSteady) -&gt; eq2 eq2 ## $std ## M Y Z X ## 600.00000 211.01706 91.70764 793.10541 ## ## $extra ## S V R0 x kappa EIR FoI ## 4.5600 0.4520 7.4600 0.7930 0.1190 0.0348 0.0192 ## ## $annual ## aEIR aFoI ## 12.7 7.0 Now, we can compare directly: rbind(eq1=eq1, eq2=eq2$std) ## M Y Z X ## eq1 600 211.0171 91.70764 793.1054 ## eq2 600 211.0171 91.70764 793.1054 References "],["stable-orbits.html", "2.4 Stable Orbits", " 2.4 Stable Orbits If emergence rates vary seasonally, how much of the analysis that we did to understand steady states still holds? Obviously, if conditions are changing seasonally, the model does not reach a steady state. In fact, after modification to suit the context, many of the same principles translate. The steady state analysis provides a good qualitative guide, but that the answers will look different. Here, we illustrate by solving systems to illustrate some basic points, which is easy enough. Analysis of the resulting dynamics can be quite difficult; it is covered in Temporal Dynamics. 2.4.1 Thresholds There is a threshold condition \\(R_0&gt;1\\) that determines whether malaria is endemic, but the formula for \\(R_0\\) depends on the form of \\(\\Lambda(t)\\). If we set \\(R_0=1\\), we can show that the threshold for persistence in a seasonal environment is \\(R_0 &gt; \\sigma &gt; 1\\) (see Figure 1.1). The math to compute threshold conditions in seasonal environments is in Temporal Dynamics. Figure 2.2: Here, we set \\(R_0= 1.02\\) for the model with constant emergence, and we show that malaria persists. For the same parameters and for the same average emergence rate, malaria declines with seasonality. 2.4.2 Orbits If \\(R_0 &gt;1\\), then all orbits converge to a set of stable orbits (See Figure 1.1). If \\(\\Lambda(t)\\) has an annual cycle, then after the orbits converge: - $M(t+365) = M(t)$; - $Y(t+365) = Y(t)$ and $Z(t+365) = Z(t)$; - $X(t+365) = X(t)$. Figure 2.3: With different initial values, the orbits converge and eventually lie on top of one another. 2.4.3 Average Dynamics If \\(R_0&gt;1\\) and malaria is endemic, the average prevalence of malaria infection is variable in a seasonal environment. While the prevalence is higher at the peak, the average for the whole year tends to be lower. Figure 2.4: Here, we set \\(R_0= 2\\) for the model with constant emergence, and we show that the prevalence of malaria is similar in the seasonal environment, but it’s higher as transmission peaks, lower in the off-season, and lower overall. "],["discussion.html", "2.5 Discussion", " 2.5 Discussion If we were simply learning the math, … When we analyze these equations to determine their stability and to identify threshold conditions, we focus on threshold conditions and the behavior of these systems when malaria is rare. In most places, malaria is endemic so we need to be concerned about malaria immunity and its effects on transmission; malaria is under some level of control; and because of weather and other factors, the baseline conditions change from year to year. "],["realism-complexity.html", "3 Realism &amp; Complexity", " 3 Realism &amp; Complexity There are several reasons why models for policy will tend to be more complex than models developed for science. In science, the questions are narrow and the study designs are focused enough to form tests of ideas that have clear outcomes. When models are used to guide policy, the same level of scientific rigor should be applied, but weighing all the evidence requires a broder synthesis. To build models that can guide malaria policies, the models must be realistic enough to be compelling, and they ought to reflect the knowledge and experience accumulated over years of studying and controlling malaria. Policy advice should be checked for consistency across studies. The models must be complex enough to serve many purposes all at once. To weigh tradeoffs, policy requires broad, synthetic models that allow for comparisons across subject matter domains. To carry a conversation forward, the models used to guide discussions will need to retain a memory of what has been learned already, so they will tend to add features and grow more complex. Given the uncertainty, policy should be based on model swarms that propagate the uncertainty. The predictions of those models must be specific enough to be proven wrong, so that over time some of the models can be trusted over others. The same models can be used to identify which missing data would have the greatest impact on a policy, and ideally, studies can be conducted to gather this data. Over time, the advice should shift from generic advice to specific advice as more evidence is gathered. This is, in a nutshell, how daptive management works. It might take a lot of work to build a model that has been fit to all the evidence describing malaria in a management unit over the recent past, and it might cut against the instincts we have as scientists to add all that realism, but it’s worth it to make the effort if it helps communicate with malaria managers. In designing a software solution to the problem of building realistic models, we designed a framework for building models and a toolbox to build model swarms that would address the concerns of malaria programs. In the chapters that follow, we’ll show the features of this framework by constructing examples. Even if we’re principled about adding complexity, a cost of doing so is computational complexity. That is something the software was designed to manage. For the moment, we thus want to set aside concerns about realism vs. abstraction, about parsimony, and about error propagation, and we want to simply ask the question of how to build models with the features we want. This chapter is an overview of the historical development of malaria models and an introduction to the toolbox. We’ll cover the same material in much greater detail in the chapters that follow, and we’ll construct examples using exDE and MicroMoB. "],["epidemiology.html", "3.1 Epidemiology", " 3.1 Epidemiology A major challenge for malaria dynamics is how to define an state space describing malaria infection and immunity in human populations that captures the essential elements of malaria dynamics well enough to trust for making policies. There are features of malaria infections that have been identified and studied in the past: superinfection; the complex time course of an infection – including fluctuating parasite densities – and the problem of detection; gametogenesis, gametocyte maturation and gametocyte dynamics; fever and disease; development of immunity with exposure including its effects on infection, disease, and infectiousness; treatment, adherence to drug regimens, chemoprotection and infection curing. Over time, these issues have been addressed in various models. We need model that is good enough for policy, but this also means developing a commmon understanding of malaria that can serve as a basis for discussion. To get to that point, we must start simple and add complexity. The model for malaria infection that we presented in [Malaria Dynamics] was developed by Ross. In today’s vernacular, it would be called an SIS compartment model. The model is very simple, and it is probably inadequate for every task, but it is useful and it has been used. The model assumes that malaria infections clear at a constant rate regardless of the age of infection or other factors. The persistence of malaria infections over decades tells us that this assumption is clearly false, but it is good enough for some programmatic needs. During the GMEP, Ross’s model was used to characterized the response timelines for the PfPR after the interruption of transmission. Drawing on multiple sources, Macdonald estimated that the duration of infection was around 200 days, which was good enough to use as a basis for monitoring and evaluating the interruption of transmission53. The simpler model was used even though Macdonald had already proposed an alternative model that considered superinfection45. Despite the simplicity, the model was adequate to the task54. An important lesson is that the simplicity has some advantages, and the models that get used in policy tend to be very simple. The question is how to develop models that are simple and yet are up to policy tasks, which means that the models must (at some point) get validated against research data. Doing so means having sufficient complexity to deal with exposure, infection, detection, immunity, disease, infectiousness, care seeking, and drug taking. Whatever model is selected as a basis for policy, it should be simple enough to understand and yet complex enough to capture the gist of malaria epidemiology. The models, however chosen, must get it right. Sorting through all the complexity to get a model that is good enough is a daunting task. This introduction is mainly historical, but we use it to preview some of the themes. In the following history, we discuss some of the important innovations. 3.1.1 Superinfection From early on in malaria epidemiology it was clear that exposure to malaria differed among populations, and that in some places, the rate of exposure was far higher than the rate of clearance. Ross emphasized a need to measure exposure both entomologically, through metrics that are known today as the EIR and the FoI, and parasitologically, through the prevalence of infection by light microscopy (or more commonly today, through RDTs), which was called the malaria parasite rate . There was no good reason to believe that people in highly malarious areas would be exposed faster than they would clear infections, so they would carry infections that could be traced back to many infectious mosquitoes55. This phenomenon was called superinfection. Macdonald was the first to develop a mechanistic model of superinfection45, but the mathematical formulation was at odds with his description56. It is an interesting bit of history for a different time. A mathematical basis for understanding superinfection was worked out as a problem in the study of stochastic processes as part of queueing theory. This may seem strange, but understanding how many people are queueing involves understanding how people come in and how fast they are processed. One of these queuing models has become a mainstay of malaria epidemiology; in queuing theory, it is called \\(M/M/\\infty\\). The model tracks the multiplicity of infection (MoI). It assumes that infections arrive through exposure at a rate \\(h\\) (the FoI), and that they clear independently. Without clearance, the MoI, denoted \\(\\zeta\\), would just go up. The model assumes that each infection clears at the rate \\(r\\); if the MoI were \\(3\\) then infections would clear at the rate \\(3r\\). Regardless of how fast infections arrive, the fact that the pressure for the MOI to go down increases with MoI means that the MoI will reach a stable state. The mean MoI is \\(h/r.\\) The following diagram illustrates and provides the equations: \\[\\begin{equation*} \\begin{array}{c} % \\begin{array}{ccccccccc} \\zeta_0 &amp; {h\\atop \\longrightarrow} \\atop {\\longleftarrow \\atop r} &amp; \\zeta_1 &amp; {h\\atop \\longrightarrow} \\atop {\\longleftarrow \\atop {2r}} &amp; \\zeta_2 &amp; {h \\atop \\longrightarrow} \\atop {\\longleftarrow \\atop {3r}} &amp; \\zeta_3 &amp; {h \\atop \\longrightarrow} \\atop {\\longleftarrow \\atop {4r}}&amp; \\ldots \\end{array} \\\\ \\\\ \\begin{array}{rl} d\\zeta_0/dt &amp;= -h \\zeta_0 + r \\zeta_1 \\\\ d \\zeta_i /dt &amp;= -(h+r) \\zeta_i + h \\zeta_{i-1} + r(i+1) \\zeta_{i+1} \\\\ \\end{array} \\end{array} \\end{equation*}\\] If one is willing to abandon compartment models, then it is possible to formulate more elegant solution using hybrid models. The mean MoI, \\(m\\) changes according to the equation: \\[\\frac{dm}{dt} = h - r m.\\] Using queuing models, it is easy to show that the distribution of the MoI is Poisson, and in these hybrid models, if the initial distribution is not Poisson, then it will converge to the Poisson distribution asymptotically. The complex dynamics of superinfection can thus be reduced to this simple equation. Unfortunately, things become more complex if we add simple features such as treatment with drugs, or heterogeneous exposure. The distribution of the MoI is no longer Poisson57. Superinfection is an important part of malaria epidemiology, and we will use these models for superinfection in developing some adequate models for infection and immunity. In the Garki Model (see below), the waiting time to clear an infection used these queuing models to formulate an approximate clearance rate: \\[ \\frac{h}{e^{h/r}-1}\\] 3.1.2 Infection and Immunity The biggest failing of Ross’s model, perhaps, was that it did not make any attempt to grapple with acquired immunity to malaria. It had always been clear that immunity to malaria was important because the prevalence of infection declined throughout adolescence and was consistently lower in adults, and because disease and severe disease were common in young children. The data accumulated through years of studying malaria, done as part of malaria therapy, provided supporting evidence for immunity. There was a difference in outcomes from being exposed to the same parasite (homologous challenge) compared with a different parasite (a heterologous challenge). Immunity had something to do with the number of different parasites that a person had seen. The first model to grapple with immunity was the Garki Model58. The main idea in the Garki Model was that it would be possible to understand malaria dynamics by expanding the number of compartments: the population was sub-divided into two non-immmune or semi-immune. Infection dynamics were tracked separately within each immune category: the infections would clear faster from semi-immune individuals, they were are not infectious, and they are less likely to test positive if they were infectious. Some features of the Garki model seem odd in retrospect: there were two infected states for non-immunes (\\(y_1\\) and \\(y_2\\)), but only one for semi-immunes; there was no way to lose immunity; and the assumption that semi-immunes are not infectious. The Garki Model has had a poweful influence on malaria modeling. Several models since then have expanded on various themes. Several compartment models have been developed that replicate infection dynamics across immune stages: we call this stage-structured immunity. In the Garki Model, we can simulate the immuno-epidemiology of cohorts as they age. Eventually, the cohort would settle to an equilibrium. At that point, everyone is semi-immune, a sizable fraction remains non-immune after a century. By the time the cohort reaches the steady state, everyone in the cohort has died. If we focus on the dynamics in the first two decades of life, prevalence rises as people become infected, and then it falls as people become semi-immune. The changing epidemiology as cohorts age is an important feature of malaria. In models like this, the concept of a steady state teaches us something, but the models draw attention to the sharp changes in malaria that occur throught the first 20 years of life. We can adapt the idea of steady state to suit our needs – under constant exposure, cohorts trace out stable orbits as they age. These stable orbits are a basis for understanding malaria dynamics vs. age. One application of these stable orbits is to understand the the relationship between age and infection prevalence as a function of exposure. Curiously, the Garki Model captures the basic shape of age-PfPR curves, but it does not get the details right. When we start to look at the factors affecting the PfPR by age in populations, we must acknowledge the need to add other features: drug taking and chemoprotection; differences in exposure that arise for a number of reasons; anemia, perhaps; seasonality. Not everything is about immuno-epidemiology. 3.1.3 Gametocytes and Infectiousness In Ross’s models, everyone who is infected is also infectious. This is clearly wrong, but it may not be a terrible assumption under most circumstances. The Garki Model made the extreme assumption that semi-immune individuals are not infectious at all. There is now copious evidence that adults do transmit parasites to mosquitoes, but they are not as infectious. This decline in infectiousness occurs for two reasons: first, the densities of asexual-stage parasites in adults are controlled by immunity, so they are lower. Since a fraction of asexual parasites becomes gametocytes, the densities of gametocytes are also lower in adults. Second, gametocyte densities are modulated by an immune response that affects malaria parasites in mosquitoes, which is called gametocyte-stage transmission blocking immunity. The dynamics of gametocyte-stage immunity change with age and exposure, and we will need to understand how this form of immunity waxes and wanes. There are some other important details about malaria infections that might be relevant in some contexts. First, P. falciparum gametocytes take 8-12 days to mature. When combined with the 6 days in the liver, we must acknowledge that the latent period is at least 2 weeks. Because gametocytes must reach densities high enough to be transmitted, the effective latent period for humans is probably closer to 20 days. Since the parasites also need 10 days or more to mature in mosquitoes, the shortest parasite generations are probably at least a month long. Another feature of gametocytes that matters is that gametocyte populations are not always affected by anti-malarial drugs, so after taking drugs that clear all the asexual-stages, some people will remain infectious to mosquitoes for quite a while after being treated with some drugs. Ross’s assumption may serve most needs, but the models must be good enough to guide policies, such as MDA or malaria elimination, when details about gametocytes and infectiousness can affect the outcomes of policies. 3.1.4 Disease Disease was not incorporated into most mechnanistic models of malaria until recently. 3.1.5 Treatment and Chemoprotection It is impossible to understand malaria infection dynamics without accounting for treatment with anti-malarial drugs and a brief period of chemo-protection that follows. The first model for drug treatment was developed to understand MDA59. In developing models for policy, we must be careful about drug taking and its effects because it modifies the relationship between exposure (the EIR) and infection. 3.1.6 The Time Course of an Infection The time course of infections is complex, and we will need to develop some models that relate parasite densities. In the chapters that follow, we introduce two main kinds of models: AoI SoI 3.1.7 Intrahost Models There are two kinds of models we will discuss, but we would like to avoid them in making policy if possible. In host models; Individual-based models. 3.1.8 Synthesis In the end, we do not need perfect models of malaria infection and immunity, but we do need a sound understanding of several things to make policy: The prevalence of infection by age as a function of exposure and drug-taking; …in a cross-section of the population; …in the care-seeking population. The incidence of malaria by severity and by age; The fraction of malaria that is promptly treated by severity and by age; The net infectiousness of a population of humans to mosquitoes. In the chapters that follow, we will develop some models that based on a new concept – the age of the youngest infection – that combine many of the ideas in the chapters above. References "],["heterogeneous-transmission.html", "3.2 Heterogeneous Transmission", " 3.2 Heterogeneous Transmission "],["stratification.html", "3.3 Stratification", " 3.3 Stratification Human populations are heterogeneous. Some kinds of heterogeneity affect how we understand malaria and what we should do, including who to target. To deal with heterogeneity in models, we will often need to segment a human population into sub-populations, or strata. When we talk about stratification, we mean it the narrow sense of segmenting a human population (i.e. not subdividing landscapes spatially1), because the model predictions made by creating strata that are more homogeneous should be more accurate. The guiding principle is that our analytics will should strive to be more accurate, and that we should thus identify and remove those sources of heterogeneity that would affect policy advice, whether it affects estimating the impact of interventions in the past or projecting those impacts into the future. We acknowledge that models are approximations, and that our approximations don’t have to be perfect. The goal is to find ways of propagating uncertainty that are good enough for the task at hand. In malaria epidemiology, some kinds of endogenous heterogeneity could be built into the epidemiological state space. Other kinds of heterogeneity, including consistent differences in exposure, differences in care seeking and drug taking, and differences created by malaria control (e.g. net ownership or vaccination), usually require stratification. The decision about how to strike the right balance depends on the model and the purpose of a study. The framework and supporting software offer a toolbox for stratification. It is designed to stratify populations in a principled way, so that we can understand how the heterogeneity affects transmission or outcomes that we care about, but we can also combine effects. We want to stratify populations by applying rules that split populations when the differences are large enough. (If we started with complex models, we might choose to join populations if the differences were small.) By so doing, we can compare the behaviors of models that differ from each other in only one way. If the differences are not too large, or if the differences in dynamical behaviors we care about are not too large, we might decide not to split the strata, and use the average. Because of the way models are encoded, it’s easy to build models that split the strata in multiple, independent ways. 3.3.1 Strata in the Ross model As a simple example, consider a simple Ross-style model for infection with exposure and recovery (described in Section 2.1.5): \\[\\frac{dX}{dt} = h (H-X)-r X\\] If exposure is heterogeneous, we could split this population into two strata and add subscripts (i.e., indexed by \\(i \\in \\left\\{1,2, \\ldots \\right\\}\\)): \\[\\frac{dX_i}{dt} = k_i h (H_i -X_i)-r X_i\\] We hold the average FoI constant by constraining the values of \\(k_i\\): \\[\\frac{\\sum_i k_i H_i}{H} = 1\\] Stratification is important if the differences are large. With two strata, it would not make sense to stratify if \\(k_1 \\approx k_2\\), but if \\(k_2 \\gg k_1\\) then it might change our expectations, or it might change what we recommend. 3.3.2 Frailties We will introduce segmentation first through models of Heterogeneous Exposure to malaria, where we consider various sources of frailty – proportional differences in the average hazard rate for infection (\\(k_i\\), in the example above). These differences in exposure can arise because of age, house type, risky behaviors, other factors. Frailty that is attributable to location (e.g. proximity of home to aquatic habitats) can be dealt with by sub-dividing space into patches, a topic that is taken up in Space below and Spatial Dynamics. Depending on the size of the patches, some differences in average rates of exposure due to location can persist, and these could be dealt with by generic stratification into high vs. low exposure strata. Some of the heterogeneous traits that we care about change dynamically, so we will also need to consider population flows among strata, which change the sizes of the strata. We would like to deal with these flows in a principled way. Bed net ownership and use are among the human behaviors that matters most for programs. In some cases, we will want to understand dynamic changes in bed net ownership, the patterns of use among those who own a net, personal protection, and community effects. Later, we show how to construct an example that describes all of these aspects of bednets. Segmentation is what we need to build models of pharmaceutical interventions with waning effectiveness, such as mass vaccination. Among the most important factors in malaria is age. We have defined algorithms to model [Aging] and other demographic change, the loss of bednets, waning protection or changing housing quality. 3.3.3 Age Immunity to malaria develops with age and exposure. The development of immunity is probably changing throughout life, so it makes sense to think of malaria epidemiology as ontogeny. For systems described generically by the state space, \\(\\mathscr X\\), the dynamics we care about have the form: \\[\\frac{\\partial {\\mathscr X}(a,t)}{\\partial a} + \\frac{\\partial {\\mathscr X}(a,t)}{\\partial t}\\] We might want to deal with malaria differently if we are studying malaria in cohorts. In a population where the FoI over time is \\(h(t)\\), we might want to follow a birth cohort, so we define \\(h_d(a) = h(t-a)\\) for all \\(t&gt;d\\). We can then solve: \\[\\frac{d{\\mathscr X}}{d a} \\] which produces states in cohorts as they age, \\({\\mathscr X}(a|h).\\) When we simulate malaria transmission dynamics in populations for policy, we will want to put a mesh on age and segment the population. The dynamics are define for age strata, where the FoI is defined differently for each age stratum: \\[\\frac{d{\\mathscr X}_a}{d t}\\] which produces age-dependent states over time, \\({\\mathscr X}_a(t|h).\\) Our algorithms should guarantee that the epidemiological states over time provide an accurate match for the epidemiological states over age. In a broader sense, stratification is also about subdividing landscapes into a set of spatial domains that share relevant features in order to tailor interventions to context. That is a topic we take up in a separate book, ( Robust Analytics for Malaria Policy. ).↩︎ "],["humans-on-the-move.html", "3.4 Humans on the Move", " 3.4 Humans on the Move The notion of a spatially distributed risk for humans and the modalities of human travel. Humans move around, so we develop a model of time spent. Time spent is sub-divided into three parts: time spent at home; time spent traveling, when a night is spent away from home; human mobility, which describes time spent around home when not traveling. For travel, we estimate a travel FoI. For time at home and mobility, after weighing time spent and mosquito diurnal activity patterns by time of day, we modify time spent to get a notion of time at risk After modifying time at risk by search weights, mosquito blood meals are distributed among all hosts according to their availability. 3.4.1 Travel 3.4.2 Mobility 3.4.3 Migration "],["blood-feeding.html", "3.5 Blood Feeding", " 3.5 Blood Feeding The second topic we must tackle is blood feeding, which is an interaction between mosquitoes and humans. It is an asymmetric relationship – mosquitoes search for blood hosts, select a host, and blood feed. Humans, for their part, attract mosquitoes from a distance, move around, and spend time in places when mosquitoes are biting. Humans can wear protective clothing (or not), use bed nets (or not), or do other things that make them more or less available to humans. Despite all this, humans are often unaware that they have been bitten. Transmission occurs during blood feeding, and models of blood feeding should be able to take all this heterogeneity into account. If the models do a proper accounting, then the total number of human blood meals taken by mosquitoes would equal the number of blood meals received by humans. In doing so, we find no inspiration from Macdonald, whose description of human blood feeding was simple and phenomenological: a single parameter described the human blood feeding rates. After Garrett-Jones described the human blood index, drawing on decades of work, the one parameter was split into an overall blood feeding rate (\\(f\\)) and a human fraction (\\(q\\)). The question left unaddressed by Macdonald was how these rates vary by context, and the consequences for exposure. To do this, we reformulated the algorithm describing blood feeding11. Over the past two decades, several papers have drawn attention to the way blood feeding behaviors are or ought to be constrained by the availability of vertebrate hosts. It may be fine to assume that the density of vertebrate hosts doesn’t change, but something should change when a large fraction of people are using bednets. Even with static parameters, we should think through the limiting cases: if there are no vertebrate hosts, then there blood feeding should not occur (i.e., \\(f=0\\)); if there are no human hosts, then there should be no human blood meals (\\(q=0\\)); and if there are no alternatives to humans, all blood meals should be on humans (\\(q=1\\)). The concepts we devised for blood feeding must, therefore, integrate the notion of frailty with the process of mosquito search. On the one hand, the mosquitoes should blood feed at a slower rate if hosts are unavailable. On the other hand, human biting should become heterogeneous. To arrive at an adequate description, we need to formalize this notion of host availability. The logic is that mosquitoes search for humans. Differences among humans in their attractiveness are represented by a search weight. Mosquito search in a place depends on the amount of time spent by humans, but also by daily mosquito activity patterns; from these, we develop a notion of time at risk that characterize the way human activities expose them to mosquitoes. The mosquitoes add up all the time at risk spent by all the humans, which gives a measure of their availability. Availability describes humans as well as other vertebrate hosts, which are modified by mosquito preferences. The overall feeding rates and the human fraction are computed from availability using functional responses. To complete the picture, we consider how the expected rate of exposure could have a distribution in the population, which we call environmental heterogeneity. 3.5.1 Search and Risk 3.5.2 Search Weights and Availability To deal with heterogeneous exposure and many other phenomena, we need a sensible way of segmenting humans into population strata. Stratification makes it possible to deal with population heterogeneity. A new model of blood feeding is based on a model of blood feeding as the endpoint of a search for a blood host11. Each sub-population has a search weight (\\(w\\)), and the total availability of humans for blood feeding (\\(W\\)) is the sum of the sizes of the strata weighted by their search weights. We also consider the availability of alternative vertebrate species for blood feeding (\\(O\\)). 3.5.3 Functional Response Mosquito blood feeding rates are computed using a functional response to total availability of vertebrate hosts (\\(f = F_f(B)\\)). To compute total availability, we add a scaling parameter on alternative hosts, because mosquito preferences can translate into different patterns of search; total availability is \\(B=W + O^\\zeta\\). The human fraction is proportional to the relative availability of hosts \\(q = W/B\\). References "],["environmental-heterogeneity.html", "3.6 Environmental Heterogeneity", " 3.6 Environmental Heterogeneity The search weights thus translate into a kind of Frailty, which is one component of heterogeneous exposure. Important sources of frailty include bednet use, housing type, and age. We also want to consider variability in exposure within a stratum – what is the distribution of the expected number of bites over time? We have already discussed frailties, so this is a different kind of heterogeneous exposure that we call Environmental Heterogeneity. This helps us to align models with data: mosquito counts data tend to be described well by negative binomial distributions, so it is likely that the distribution of infectious bites also follows a negative binomial distribution. We introduce a function that translate the EIR into the FoI: \\[h=F_h(E)\\] In the Ross-Macdonald model, the underlying assumption is consistent with a Poisson distribution, but we have also derived negative binomial hazard rates. Environmental heterogeneity can arise from two sources: the aggregated distributions of mosquitoes in micro-habitats, and the redistribution of mosquito populations by wind and weather; random movements of humans around mosquito micro-habitats that affect their risk in a way that doesn’t tend to change the mean; "],["mosquito-behavior-and-ecology.html", "3.7 Mosquito Behavior and Ecology", " 3.7 Mosquito Behavior and Ecology 3.7.1 Resource Availability 3.7.2 Egg Laying 3.7.3 Search and Dispersal "],["aquatic-mosquito-ecology.html", "3.8 Aquatic Mosquito Ecology", " 3.8 Aquatic Mosquito Ecology 3.8.1 Regulation 3.8.2 Exogenous Forcing 3.8.3 Habitat Dynamics "],["space.html", "3.9 Space", " 3.9 Space Space is big, so we start by drawing boundaries around a part of the world we want to study, that we call the spatial domain. 3.9.1 The Mixing Matrix 3.9.2 Pathogen Dispersal by Humans 3.9.3 Pathogen Dispersal by Mosquitoes To describe mosquito spatial dynamics, we "],["time.html", "3.10 Time", " 3.10 Time 3.10.1 The EIP 3.10.2 Seasonality 3.10.3 Exogenous Forcing 3.10.4 Vector Control "],["integrated-vector-control.html", "3.11 Integrated Vector Control", " 3.11 Integrated Vector Control "],["pharmaceutic-interventions.html", "3.12 Pharmaceutic Interventions", " 3.12 Pharmaceutic Interventions "],["context.html", "3.13 Context", " 3.13 Context "],["building-evaluating-models.html", "4 Building &amp; Evaluating Models", " 4 Building &amp; Evaluating Models There must have been a time, in the beginning, when we could have said – no. But somehow we missed it. (Guildenstern) – from Rosencranz and Guildenstern are Dead, Tom Stoppard If we want to scale up simulation-based analytics to support malaria policy through eradication, it will inevitably involve capacity building, but what sort of training is needed? Certainly, we hope that an analytics team would include someone who has the skills required to critically evaluate models, but this is not as easy as you think. What makes a model good? What makes an analysis useful? It is easy to imagine training up a generation who could do some kind of analysis, but we don’t want to train automata – people who would keep doing some analysis, over and over, just because it is what has been done before. We ought to have a reason for doing the analysis. It ought to serve some purpose. Success in policy analytics requires people who have skills in thinking creatively and critically to solve problems. We need people who can build and evaluate models. If we want to discuss the models we might use to analyze malaria policies, and if we want to have a discussion about that process, it will probably help us to be more careful about how we use terms like model and model building. In the service of defining the skill sets required to be a good analyst, this chapter discusses the life-cycle of a model, including the process of building and evaluating models from the beginning to the end (or in math from \\(\\alpha\\) to \\(\\omega\\)). "],["primary-model-development.html", "4.1 Primary Model Development", " 4.1 Primary Model Development Most models started with a question: something like Why is the sky blue? or How many mosquitoes does it take to sustain malaria transmission? Blue sky questions don’t go anywhere unless there’s a basis for understanding the underlying process. If there is some kind of basis, the next step is to try represent the process in some logically compelling form, such as a diagram with boxes and arrows. In the case of malaria, the first step looked something like this: \\[ \\left[ \\begin{array}{rcl} \\mbox{# People Infected Today} &amp;=&amp; \\mbox{# People Infected Yesterday} \\;\\; -\\\\ &amp;&amp; \\mbox{# Who Cleared Infections} \\;\\; + \\\\ &amp;&amp; \\mbox{# Uninfected Who Got Infected}\\\\ \\end{array} \\right] \\] This description ignores infected people who died, infected people who emigrated, and infected people who immigrated. It’s not perfect, but it’s a starting point. The biggest problem with this description is that it lacks mosquitoes. So we write down: \\[ \\left[ \\begin{array}{rcl} \\mbox{# Mosquitoes Infected Today} &amp;=&amp; \\mbox{# Mosquitoes Infected Yesterday} \\;\\; -\\\\ &amp;&amp; \\mbox{# that Died} \\;\\; + \\\\ &amp;&amp; \\mbox{# Uninfected Who Got Infected}\\\\ \\end{array} \\right] \\] What’s important here is that infectious mosquitoes are infecting people when they bite, and infectious people are infecting mosquitoes when the mosquito blood feeds. This process is clarified by a diagram: 4.1.1 Variables What is critical here is that the uninfected people got infected when they were bitten by an infectious mosquito, and the uninfected mosquitoes who got infected yesterday must have blood fed on an infected person. To build a model, we need to be quantitative, so we need to start being very precise: Let \\(H\\) be the number of people, and we assume that number doesn’t change Let \\(X_t\\) be the number of people who are infected at time \\(t\\) Let \\(M\\) be the number of mosquitoes, and we assume that number doesn’t change Let \\(Y_t\\) be the number of mosquitoes who are infected at time \\(t\\) So now we 0 Variables: Defining the state space Parameters: transitions / rates equations / algorithms "],["implementation-and-verification.html", "4.2 Implementation and Verification", " 4.2 Implementation and Verification 4.2.1 Solving Fitted Parameters: Initial Conditions: 4.2.2 Mathematical Analysis steady states stability analysis algorithms primary analysis 4.2.3 Simulation "],["what-is-a-model.html", "4.3 What is a Model?", " 4.3 What is a Model? "],["accuracy-validation.html", "4.4 Accuracy &amp; Validation", " 4.4 Accuracy &amp; Validation Model features Functional range Heterogeneity 4.4.1 Validation Points "],["the-measure-of-a-model.html", "4.5 The Measure of a Model", " 4.5 The Measure of a Model If we want to evaluate whether a model is good 4.5.1 Limitations Functional Range the maximum granularity 4.5.2 Parsimony "],["secondary-model-development.html", "4.6 Secondary Model Development", " 4.6 Secondary Model Development elaboration Model building is a core part of applied dynamics, but if we are to othere are many different activities What does it mean to build a model? "],["conclusions.html", "4.7 Conclusions", " 4.7 Conclusions "],["modularity-and-software.html", "5 Modularity and Software", " 5 Modularity and Software Hundreds of publications have described new models of malaria3,4. The challenge we have taken on is to find a new way of building models for malaria that draws from all those good ideas to build models at any level of complexity. We want to do this with reusable, professional quality software. Ideally, the models that we develop would be sufficiently complex to address policy questions, yet remain amenable to analysis. To get there, we took a step back to try and understand malaria models, and to put this into a birds-eye view of the process of model building. From Ross’s first published model in 1905 to the first draft of this book, 117 years have passed. The story of malaria models can be summarized in three epochs. Ross’s models, and contributions to mathematical study of malaria made by Alfred J Lotka (1912-1923), George Macdonald (1950-1968), and Garrett-Jones (1964-1970) take us to the end first epoch, which is marked by the end of the Global Malaria Eradication Programme (GMEP, 1955-1969). As part of the GMEP, Macdonald’s formulas were extended by Garrett-Jones into the concept of vectorial capacity and a rudimentary theory of vector control. By 1970, the Ross-Macdonald model was more than just a set of equations. It was a theory for malaria dynamics and control supported by a well-developed set of concepts, parameters and metrics2. Over that same period of time, mathematical theory for directly transmitted diseases took a parallel path, with important mathematical contributions from Kermack and McKendrick, NTJ Bailey, and Bartlett. Sometime around 1980, mathematical epidemiology began a period of innovation and synthesis, particularly after the publications of Robert May and Roy Anderson made it a mainstream activity in departments of ecology. In malaria and mosquito-borne diseases, Klaus Dietz publications span the second epoch (1971-2006), including development of a mathematical model with immunity for the Garki Project58, work on the dynamics of malaria under treatment by drugs59, seasonality60, and heterogeneous biting61,62. During this time, theory developed for malaria borrowed concepts and methods. In spatial dynamics, the patch models of Yorke and ** were modified to by Dye and Hasibeder to describe mosquito-borne pathogens63,64. The last epoch of malaria, which starts around 2006, is marked by two major developments: a maturing theory of malaria control; and the rise of branded, individual-based models. The publication of OpenMalaria in 2006 marks the beginning of the last epoch of malaria. Some important antecedents were Dana Fochs models for Aedes dynamics and dengue virus transmission, as CIMSiM and DENSiM. In malaria, several within-host models had been developed65,66. OpenMalaria traces its history back to an intrahost model developed by Dietz and Louis Molineaux66. After OpenMalaria, two other branded individual-based models were developed. One was developed by a team at Imperial College called Malaria Tools. Another was developed by a team at the Institute for Disease Modeling called eMod. The fact that the models were named and branded was significant – the authors had developed software that they would maintain and that they were willing to stand behind. The models had finally dealt with disease in a serious way, and through publications, the fitted models demonstrated a fidelity to evidence. The branding signaled continuity and consistency. Around 2007, new models of vector control began to appear that related intevention coverage levels to effect sizes. Macdonald’s work had focused on sensitivity to parameters, and the GMEP emphasized technical efficiency to achieve very high coverage (with IRS). Garrett-Jones developed vectorial capacity as a way of understanding vector control and effect modification by insecticide resistance. The new models extended Garrett-Jones ideas. The need for new models was motivated, at least in part, by the goal of achieving universal coverage with ITNs. What were reasonable coverage targets? The new generation of vector control models introduced the concept of an effect size on transmission as a function of intervention coverage levels, where coverage had one definition for operations (e.g. something like ownership) and another for effect sizes (e.g. related to vector contact rates with interventions). The goal of achieving very high coverage with ITNs bumped into the reality that nets are not durable, so new models have been devised to look at intervention coverage in relation to distribution schemes and product durability. While these concepts had been considered during the GMEP design phase, they did not appear in Macdonald’s models. If we want to take advantage of all the research that has been done, we need a way of understanding malaria models and the whole business of model building. References "],["model-building.html", "5.1 Model Building", " 5.1 Model Building Model building is a fairly involved process that includes several unavoidable steps: There must be some motivation for building a model, which usually starts with a conversation, boxes and arrows drawn on paper or a chalkboard or whiteboard. The process involves refining the questions, until there’s a well-formed idea – a reason for building a model. The idea gets translated into mathematics. The boxes get translated into variables, the arrows are rate parameters, a mathematical formalism is selected. The model gets analyzed. In some cases, when the model complexity exceeds a very low threshold on complexity, this is done with pencil and paper. It is only possible to analyze individual parts of the model this way. The model gets translated into pseudo-code, and then it gets implemented as software that can produce output. This is followed by a long and painful process of verifying that the software does what the pseudo-code says it should do. After awhile, the software is trusted, and it’s time to use it. Some thought is given to the correspondence between the variables in a model, observable quantities, and the observational process itself. This process can be a part of what happens above, but at some point, the models need to be fitted to data. The software produces output and then: the outputs are visualized; models are fitted to data; graphs are made; papers or reports are published; and careers advance. That’s the simple story of model development. What happens next is could be one of the following: Someone re-examines an existing model and notices it is inadequate in some way: it is missing some features, or it might make an assumption that ought to be modified. Simple models become spatial models, single populations are structured. Someone decides to implement the model in a different way, perhaps with a different mathematical formalism. Continuous time models are translated into discrete time models. Deterministic models become stochastic. Autonomous processes become non-autonomous. Through this process, hundreds of malaria models were published. A problem with this process has been that the software is often developed for bespoke tasks (i.e. to publish a paper). The software is often poorly documented and difficult to reuse. The costs of building a model for one task limited the complexity of the model. It was difficult to combine elements of one model developed for one purpose, with someone else’s model developed for another purpose. In malaria, this ad hoc process of writing new models was found to be inadequate to serve the broad range of policy questions. One way of dealing with the complexity was to build individual-based models, but individual-based models have some of the same limitations as reality. "],["modular-computation.html", "5.2 Modular Computation", " 5.2 Modular Computation Before OpenMalaria, most models of malaria modified the Ross-Macdonald model in one way3. The innovation was focused on specific themes or questions: how long would an infection last in models with superinfection? 5.2.1 exDE We have written the software that solves these equations in a package called exDE. References "],["measuring-malaria.html", "6 Measuring Malaria", " 6 Measuring Malaria If we want to use evidence to make policy, we need to understand transmission and disease in its local context, which we learn about from assembling and analyzing the evidence. In malaria, the evidence is usually one or more of a core set of metrics. One useful metric is the PfPR from cross sectional surveys; these are available from research studies, but they are also available from demographic health surveys (DHS) or malaria indicator surveys (MIS). If we are lucky, we will also have mosquito catch counts data (by some method), which we scale by effort and report as something like the PfHBR. We estimate the PfSR from some of these caught mosquitoes, and we take their product, the PfEIR. From other designs, we might have estimtes of the PfFoI, or if serology was done, we might know the PfSCR. From routine clinical surveillance, we could get case counts or the PfSPR. We can learn more if we stratify by age, or if we follow populations over time. If we are to make sense of malaria as a changing baseline that has been modified by control, then we must know something about how transmission has been modified by control. First and foremost, we must understand anti-malarial drug taking, including the frequency of drug taking (for any purpose), adherence to prescribed regimens, and drug taking by severity. To understand transmission, we must have data describing intervention coverage and its timing. This would include patterns of bed net ownership and use over time, IRS and its coverage. We can’t make sense of vector control coverage data without knowing something about the patterns of insecticide resistance. We discuss Measuring Vector Control in the next chapter. For planning, we would like to know the burden of malaria, and we would like to have an estimate of transmission – something like a malaria reproductive number. In most places, we will have routine surveillance data. We would like to piece together a coherent and accurate picture of transmission from this and from any other data we may have. To do so, we would like to know how these statistics compare in settings where two or more of them have been measured at the same place and at the same time. From studies like this, we can start to understand the scaling relationships among metrics, and the factors that influence them. What we have learned from studying these relationships is that there the relationship are highly non-linear67, and that some of the factors affecting this relationship are context dependent. We have already mentioned drug taking, and we must acknowledge the difficulty of estimating drug taking by age, in part, because it is often highly heterogeneous in populations. Other factors that have been implicated are heterogeneous biting, environmental heterogeneity, seasonality, travel and mobility. Sitting between us and the truth is an observational process, and we must attempt to quantify bias and error in this sampling process if we are to have any hope of getting an accurate picture of transmission in context. To get there, we need to organize our algorithms: The PfPR varies in a population by age, sex, and the diagnostic method; so we simulate malaria in cohorts as they age, and we output the predicted PfPR by age, sex, and diagnostic method. The PfPR is modified by drug-taking; the effect modification varies in a population by age, access to care, and adherence to drug regimens. In our algorithms, we must consider various patterns of drug taking and chemoprotection. Exposure is seasonal seasonality would affect the true PfPR and the true PfEIR over time; seasonality could be a source of error in the estimated PfPR (especially with respect to age) and estimated PfEIR, particularly if the PfPR is reported in young children, and mismatched even slightly with PfEIR. Heterogeneous exposure: exposure varies by age; there are other identifiable sources of frailty that we can deal with through stratification (e.g. house type, location, bed net use), and there are many frailties we will not be able to identify; the relationship between exposure and infection is affected by environmental heterogeneity; because of variability in mosquito populations at a fine spatial grain over time and space, and the trajectories of individual humans who are put at risk, The PfEIR near home is obscured by human mobility through time at risk and exposure away from home; Travel and imported malaria can increase the PfPR, even if there is no local exposure. Measurement errors in the PfEIR There are house effects that bias the estimation of the PfEIR Different methods of catching mosquitoes give different estimates for the HBR. These effects are incorporated into the framework. Frailties are dealt with by stratifying by age (\\(\\omega(a)\\)) and other traits and assigning biting weights; when combined with mobility, these become part of the mixing matrix, \\(\\beta\\). Environmental heterogeneity modifies the relationship between the PfEIR by stratum and the PfFoI (through \\(F_h\\)). Seasonality in mosquito density (\\(Z(t)\\)) translates into seasonality in exposure (\\(S(t)\\)). Drug taking and immunity modify the PfPR after exposure. We would like to understand mosquito populations, but we will rely on whatever data we have to estimate the PfEIR (see Figure 4.1). This is a core algorithm for simulation-based analytics, and the framework was designed to serve these ends. In the following sections, we use the framework to illustrate the effects and effect sizes of these factors. The task of estimating is for another book, Robust Analytics for Malaria Policy. In this study, we make full use of modularity. We start by stratifying our human population by age, and possibly by other factors. We write algorithms that pass the density of blood feeding mosquitoes in a place, and our algorithms predict mosquito catch counts, depending on the method. From this, we compute the total FoI, which includes the local FoI (at and around home), and the travel FoI. These exposure rates, and algorithms describing drug taking, are translated into estimates of the true PfPR. The models output the predicted PfPR by age, sex, and method; and we also output the predicted patterns of care seeking and associated metrics at health facilities in an HMIS, by age and sex. Figure 4.1: A generalized framwork for understanding the relationship between the PfEIR and the PfPR: References "],["realistic-bounds.html", "6.1 Realistic Bounds", " 6.1 Realistic Bounds An important reality check is that we can set sensible expectations about upper bounds on the PfPR in relation to exposure. The maximum value of the PfPR will tend to be observed in untreated populations with homogeneous exposure. To identify these bounds, we assume that we are passing the true PfEIR, but not necessarily the local PfEIR. "],["the-local-fraction.html", "6.2 The Local Fraction", " 6.2 The Local Fraction 6.2.1 Travel 6.2.2 Mobility "],["drug-taking.html", "6.3 Drug Taking", " 6.3 Drug Taking "],["seasonality-1.html", "6.4 Seasonality", " 6.4 Seasonality "],["frailty.html", "6.5 Frailty", " 6.5 Frailty At low intensity, frailty can affect the prevalence "],["environmental-heterogeneity-1.html", "6.6 Environmental Heterogeneity", " 6.6 Environmental Heterogeneity "],["pfeir-vs.-pfpr-in-data.html", "6.7 PfEIR vs. PfPR in Data", " 6.7 PfEIR vs. PfPR in Data "],["pfeir-vs.-pffoi-in-data.html", "6.8 PfEIR vs. PfFoI in Data", " 6.8 PfEIR vs. PfFoI in Data "],["synthesis-1.html", "6.9 Synthesis", " 6.9 Synthesis "],["measuring-vector-control.html", "7 Measuring Vector Control", " 7 Measuring Vector Control In the previous chapter, we consider adult mosquito population density as a process closely related to, but also exogenous to the process of parasite transmission. "],["coverage.html", "7.1 Coverage", " 7.1 Coverage "],["effect-sizes.html", "7.2 Effect Sizes", " 7.2 Effect Sizes "],["heterogeneous-exposure.html", "8 Heterogeneous Exposure", " 8 Heterogeneous Exposure For humans, exposure to malaria means exposure to the bites of infectious mosquitoes. A problem that we’ll have to deal with sooner or later is that exposure risk differs among humans over space and time. While this might seem like an odd thing to introduce so early, we will have to tackle the topic sometime. The discussion of [Heterogeneous Biting], in the previous chapter, showed that heterogeneity plays an important in understanding transmission and thresholds. This discussion of heterogeneous exposure (i.e., looking at heterogeneous biting from the human side) is a good way of introducing some of the core concepts that are built into the framework: [Heterogeneous Biting] is one way of getting around a conundrum. In models with homogeneous biting, the relationship between average mosquito density and the prevalence of infection would lead us to make quantitative predictions about the likely effects of vector control. We discuss two different kinds of heterogeneous exposure: frailty, and environmental heterogeneity. In a nutshell, frailty multiplies the mean hazard rate for a sub-population by some amount \\(k\\). Environmental heterogeneity does not affect the mean, but it changes the distribution of the mean. We introduce the idea that we can deal with frailties in human populations by segmenting the population into strata. We set the stage for a new model of mosquito blood feeding that we introduce in the next chapter. In a chapter on [Approximation], we use these models to discuss the problem of model-based inference. "],["overview.html", "8.1 Overview", " 8.1 Overview Some reasons heterogeneous exposure to malaria have been documented in hundreds of studies. This is an overview. 8.1.1 Age Port, Boreham Carnevale 8.1.2 Location 8.1.3 House Type 8.1.4 Activities "],["frailtyCh.html", "8.2 Frailty", " 8.2 Frailty In general, we define frailty as a multiplicative factor on the FoI. If the average FoI in the population is \\(h\\), then the FoI in a stratum is \\(hk\\). The size of the stratum, \\(p_k\\), is constrained such that: \\[\\int_0^\\infty k \\; p_k \\; dk = 1\\] With this constraint, the mean FoI in the population is \\(h\\). Continuous distributions are difficult to extend, but we can stratify a population to accomplish some of the same effects. "],["environmentalHeterogeneity.html", "8.3 Environmental Heterogeneity", " 8.3 Environmental Heterogeneity "],["blood-feeding-1.html", "9 Blood Feeding", " 9 Blood Feeding The endpoint "],["host-availability.html", "9.1 Host Availability", " 9.1 Host Availability "],["blood-feeding-rates.html", "9.2 Blood Feeding Rates", " 9.2 Blood Feeding Rates "],["the-human-fraction.html", "9.3 The Human Fraction", " 9.3 The Human Fraction "],["the-mixing-matrix-beta.html", "9.4 The Mixing Matrix, \\(\\beta\\)", " 9.4 The Mixing Matrix, \\(\\beta\\) "],["spatial-dynamics.html", "10 Spatial Dynamics", " 10 Spatial Dynamics "],["temporal-dynamics.html", "11 Temporal Dynamics ", " 11 Temporal Dynamics "],["exogenous-forcing-2.html", "11.1 Exogenous Forcing", " 11.1 Exogenous Forcing "],["mosquito-survival-through-the-eip.html", "11.2 Mosquito Survival through the EIP", " 11.2 Mosquito Survival through the EIP "],["cohort-dynamics.html", "12 Cohort Dynamics", " 12 Cohort Dynamics We need a way of incorporating age into our models. "],["boxcar-models.html", "12.1 Boxcar Models", " 12.1 Boxcar Models "],["delay.html", "12.2 Delay", " 12.2 Delay "],["demography.html", "13 Demography ", " 13 Demography "],["migration-1.html", "13.1 Migration", " 13.1 Migration "],["stratification-1.html", "14 Stratification", " 14 Stratification "],["human-behavior.html", "15 Human Behavior", " 15 Human Behavior "],["human-mobility.html", "16 Human Mobility", " 16 Human Mobility "],["human-travel-and-malaria-importation.html", "17 Human Travel and Malaria Importation", " 17 Human Travel and Malaria Importation "],["malaria-infection-and-immunity.html", "18 Malaria Infection and Immunity", " 18 Malaria Infection and Immunity In the following sections, we walk through several models for the dynamics of malaria infection and immunity in humans. We cover infection and detection, immunity, infectiousness, disease, drug taking, and cohort dynamics. "],["infection.html", "18.1 Infection", " 18.1 Infection 18.1.1 Duration of a Simple Infection 18.1.2 Superinfection 18.1.3 Age of Infection (AoI) 18.1.4 Parasite Densities 18.1.5 Stage of Infection (SoI) "],["immunity.html", "18.2 Immunity", " 18.2 Immunity "],["within-host-models.html", "18.3 Within Host Models", " 18.3 Within Host Models "],["age-exposure-and-malaria-immunity.html", "19 Age, Exposure and Malaria Immunity", " 19 Age, Exposure and Malaria Immunity Immunity to malaria has been described as being weak and immunity has a poor memory. In quantitative terms, this means that almost every aspect of infection is affected by the history of exposure, and exposure accumulates with age. In developing our models so far, we have ignored age as a factor in malaria epidemiology. In analyzing the models, we looked for steady states or stable temporal orbits. These analyses give a misleading impression of malaria. The first model to examine malaria immunity was developed for the Garki Project58. We will present the model, for historical reasons, and then we will it is much easier to formulate models for malaria infection dynamics in cohorts as they age. References "],["the-garki-model.html", "19.1 The Garki Model", " 19.1 The Garki Model "],["stage-structured-immunity.html", "19.2 Stage-Structured Immunity", " 19.2 Stage-Structured Immunity "],["strain-specific-immunity.html", "19.3 Strain Specific Immunity", " 19.3 Strain Specific Immunity "],["memory-tracking.html", "19.4 Memory Tracking", " 19.4 Memory Tracking "],["age-vs.-prevalence.html", "19.5 Age vs. Prevalence", " 19.5 Age vs. Prevalence "],["detecting-parasites.html", "20 Detecting Parasites ", " 20 Detecting Parasites "],["parasite-densities-and-detection.html", "20.1 Parasite Densities and Detection", " 20.1 Parasite Densities and Detection "],["light-microscopy.html", "20.2 Light Microscopy", " 20.2 Light Microscopy "],["biomarkers-and-rdts.html", "20.3 Biomarkers and RDTs", " 20.3 Biomarkers and RDTs "],["pcr.html", "20.4 PCR", " 20.4 PCR "],["gametocytes-and-infectiousness-1.html", "21 Gametocytes and Infectiousness ", " 21 Gametocytes and Infectiousness "],["gametocytemia.html", "21.1 Gametocytemia", " 21.1 Gametocytemia "],["anti-gametocyte-immunity.html", "21.2 Anti-Gametocyte Immunity", " 21.2 Anti-Gametocyte Immunity "],["fever-and-severe-disease.html", "22 Fever and Severe Disease ", " 22 Fever and Severe Disease "],["fever.html", "22.1 Fever", " 22.1 Fever "],["anemia.html", "22.2 Anemia", " 22.2 Anemia "],["severe-disease.html", "22.3 Severe Disease", " 22.3 Severe Disease "],["care-seeking.html", "23 Care Seeking", " 23 Care Seeking "],["drug-taking-1.html", "24 Drug Taking ", " 24 Drug Taking "],["curing-infections.html", "24.1 Curing Infections", " 24.1 Curing Infections "],["chemoprotection.html", "24.2 Chemoprotection", " 24.2 Chemoprotection "],["adherance.html", "24.3 Adherance", " 24.3 Adherance "],["treatment-rates.html", "24.4 Treatment Rates", " 24.4 Treatment Rates "],["pharmaceutical-interventions.html", "25 Pharmaceutical Interventions ", " 25 Pharmaceutical Interventions "],["smc.html", "25.1 SMC", " 25.1 SMC "],["mda.html", "25.2 MDA", " 25.2 MDA "],["drugs.html", "25.3 Drugs", " 25.3 Drugs "],["vaccines.html", "25.4 Vaccines", " 25.4 Vaccines "],["malaria-epidemiology.html", "26 Malaria Epidemiology ", " 26 Malaria Epidemiology "],["age-of-the-youngest-infection.html", "26.1 Age of the Youngest Infection", " 26.1 Age of the Youngest Infection "],["mosquitoes.html", "27 Mosquitoes", " 27 Mosquitoes In a previous chapter, we consider adult mosquito population density as a process closely related to, but also exogenous to the process of parasite transmission. We formulated the models for mosquito density in terms of an emergence rate, \\(\\Lambda(t)\\). In many studies, this might be good enough. There are some challenges in vector control, however, that call for a deeper understanding of adult mosquito population dynamics in relation to the population dynamics of immature mosquito populations. It’s hard to imagine giving any advice about LSM without a model of mosquito ecology. Adult vector control will reduce mosquito population densities, but it would also reduce egg laying affecting immature mosquito populations52. Mosquito populations have their own thresholds for persistence, and their own spatial dynamics. While it could be argued that these are not the primary concerns for malaria programs – we would not disagree – our mathematical framework must be strong enough to support analytics for integrated vector control, including LSM. Immature mosquito dynamics are one of the core dynamical components in our framework. We introduce the topic here, using a very basic model for mosquito ecology68. To extend the previous model, we need to make several changes and additional assumptions: We define terms that describe egg-laying by adult mosquitoes; We write a basic equation to describe the dynamics of immature mosquitoes in aquatic habitats as a function of egg-laying. These models describe how eggs hatch, how mosquito larvae develop and mature in aquatic habitats, pupate, and then emerge as adults. The models do not need to be complex, but they could be. We replace the parameter \\(\\Lambda(t)\\) from the Aron-May model with a term that describes emergence of adults from aquatic habitats. One of the big themes we want to introduce here is that the outcomes of vector control can vary substantially by context because of differences in mosquito ecology. References "],["aquatic-dynamics.html", "27.1 Aquatic Dynamics", " 27.1 Aquatic Dynamics 27.1.1 Equations Here, we start with the equation for adult ecology from before, leaving out parasite transmission dynamics. We modify the basic slightly by adding one extra term that describes delayed maturation, a different response to crowding68. The mosquito maturation rate, \\(\\psi e^{-\\sigma L}\\) defines the average time from egg to emergence, and we add one parameter that slows down larval development in response to crowding. The per-capita mortality rate, \\(\\psi + \\theta L\\), has two parts: a density independent term \\(\\psi\\) and a response to mean crowding \\(\\theta L\\). We assume that adults lay \\(\\chi\\) eggs per feeding cycle. \\[\\begin{equation} \\begin{array}{rl} \\frac{dM}{dt} &amp;= \\Lambda - g M\\\\ \\\\ \\hline \\frac{dL}{dt} &amp;= \\eta - (\\psi e^{-\\sigma L} + \\phi + \\theta L) L \\\\ \\Lambda &amp;= \\frac{1}{2} \\psi L e^{-\\sigma L}\\\\ \\eta &amp;= \\chi f M \\\\ \\end{array} \\end{equation}\\] 27.1.2 Solutions BasicAquatic_dML = function(t, y, params){with(c(params, as.list(y)),{ # Terms Lambda = psi*exp(-sigma*L)*L/2 eta = chi*f*M # Dynamics dM = Lambda - g*M dL = eta - (psi*exp(-sigma*L) + phi + theta*L)*L return(list(c(dM, dL))) })} makePar_BasicAquatic = function(f=1/2.5, g=1/10, chi = 50, psi = 1/10, phi = 1/10, theta = 1/100, sigma=0){ list(f=f, g=g, chi=chi, psi=psi, phi=phi, theta=theta, sigma=sigma) } 27.1.3 Regulation tt = seq(0,100, by=1) y0 = c(M=1, L=1) params = makePar_BasicAquatic() params1 = makePar_BasicAquatic(phi=1) params2 = makePar_BasicAquatic(theta=1/10) params3 = makePar_BasicAquatic(sigma=1/100, theta=0) This code solves the equations: require(deSolve) yout &lt;- lsode(y=y0, times=tt, func=BasicAquatic_dML, parms=params) yout1 &lt;- lsode(y=y0, times=tt, func=BasicAquatic_dML, parms=params1) yout2 &lt;- lsode(y=y0, times=tt, func=BasicAquatic_dML, parms=params2) yout3 &lt;- lsode(y=y0, times=tt, func=BasicAquatic_dML, parms=params3) plotML = function(out, llwd=1, clrL = &quot;blue&quot;, clrM=&quot;red&quot;){with(data.frame(out),{ plot(time, L, type = &quot;l&quot;, lwd=llwd, col = clrL, xlab = &quot;Time (Days)&quot;, ylab = &quot;Density&quot;) lines(time, M, col = clrM, lwd=llwd) })} addML = function(out, llty = 2, llwd=1, clrL = &quot;blue&quot;, clrM=&quot;red&quot;){with(data.frame(out),{ lines(time, L, col = clrL, lty=llty, lwd=llwd) lines(time, M, col = clrM, lty=llty, lwd=llwd) })} The first thing to point out is that changing the dynamics take some time to approach equilibrium – a couple of months, in this model. The second is that increasing mortality rates for mosquitoes in aquatic habitats by a factor of 10 affects the mosquito densities in minor ways. plotML(yout) addML(yout1, clrL = &quot;darkblue&quot;, clrM=&quot;darkred&quot;, llwd=1.5) The third is that increasing the response to mean crowding has a very strong effect on the population dynamics. plotML(yout) addML(yout2, clrL = &quot;darkblue&quot;, clrM=&quot;darkred&quot;, llwd=1.5) The third point is that density dependent responses to mean crowding cause much larger changes to this system than density-dependent mortality. Aquatic dynamics have a strong tendency to oscillate, but more critically, delayed maturation strongly affects the ratio of adult mosquitoes to adults. plotML(yout) addML(yout3, clrL = &quot;darkblue&quot;, clrM=&quot;darkred&quot;, llwd=1.5) plot(1,1) References "],["understanding-mosquito-dynamics.html", "27.2 Understanding Mosquito Dynamics", " 27.2 Understanding Mosquito Dynamics This "],["behavioral-state-models.html", "28 Behavioral State Models", " 28 Behavioral State Models "],["aquatic-ecology.html", "29 Aquatic Ecology", " 29 Aquatic Ecology "],["mosquito-microecology.html", "30 Mosquito Microecology", " 30 Mosquito Microecology Modeling mosquito population dynamics on point sets. "],["mosquito-dispersal.html", "31 Mosquito Dispersal", " 31 Mosquito Dispersal "],["microsimulation.html", "32 Microsimulation", " 32 Microsimulation "],["mosquito-ecology-1.html", "33 Mosquito Ecology ", " 33 Mosquito Ecology "],["population-dynamics.html", "33.1 Population Dynamics", " 33.1 Population Dynamics "],["vector-competence.html", "34 Vector Competence", " 34 Vector Competence "],["measuring-mosquitoes.html", "35 Measuring Mosquitoes", " 35 Measuring Mosquitoes "],["vector-control-1.html", "36 Vector Control", " 36 Vector Control Towards a theory of vector control. "],["insecticide-treated-bednets.html", "37 Insecticide-Treated Bednets", " 37 Insecticide-Treated Bednets "],["indoor-residual-spraying.html", "38 Indoor Residual Spraying", " 38 Indoor Residual Spraying "],["larval-source-management.html", "39 Larval Source Management", " 39 Larval Source Management "],["attractive-toxic-sugar-baits.html", "40 Attractive Toxic Sugar Baits", " 40 Attractive Toxic Sugar Baits "],["integrated-vector-control-1.html", "41 Integrated Vector Control", " 41 Integrated Vector Control "],["spatial-control.html", "42 Spatial Control", " 42 Spatial Control "],["pharmaceutical-interventions-1.html", "43 Pharmaceutical Interventions ", " 43 Pharmaceutical Interventions "],["smc-1.html", "43.1 SMC", " 43.1 SMC "],["mda-1.html", "43.2 MDA", " 43.2 MDA "],["drugs-1.html", "43.3 Drugs", " 43.3 Drugs "],["vaccines-1.html", "43.4 Vaccines", " 43.4 Vaccines "],["discrete-time.html", "44 Discrete Time", " 44 Discrete Time "],["stochasticity.html", "45 Stochasticity", " 45 Stochasticity "],["base-models.html", "46 Base Models", " 46 Base Models "],["built-in-analytics.html", "47 Built-in Analytics", " 47 Built-in Analytics "],["spatial-concepts-and-connectivity.html", "48 Spatial Concepts and Connectivity", " 48 Spatial Concepts and Connectivity "],["model-libraries.html", "49 Model Libraries", " 49 Model Libraries "],["references.html", "50 References", " 50 References If you want a PDF and can’t find it at the link provided, let us know and we can help you find a copy. "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
