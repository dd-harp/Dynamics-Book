<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Applied Malaria Dynamics</title>
  <meta name="description" content="Applied Malaria Dynamics" />
  <meta name="generator" content="bookdown #bookdown:version# and GitBook 2.6.7" />

  <meta property="og:title" content="Applied Malaria Dynamics" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Applied Malaria Dynamics" />
  
  
  

<meta name="author" content="David L. Smith and the RAMP Team" />


<meta name="date" content="2024-06-10" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<!--bookdown:link_prev-->
<!--bookdown:link_next-->
<script src="assets/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="assets/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />
<script src="assets/gitbook-2.6.7/js/app.min.js"></script>
<script src="assets/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="assets/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<link href="assets/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="assets/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="assets/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

</head>

<body>



<!--bookdown:title:start-->
<div id="header">
<h1 class="title">Applied Malaria Dynamics</h1>
<h2 class="subtitle"><em>Theory and Computation for Robust Analytics and Adaptive Malaria Control</em></h2>
<p class="author"><em>David L. Smith and the RAMP Team</em></p>
<p class="date"><em>2024-06-10</em></p>
</div>
<!--bookdown:title:end-->

<!--bookdown:toc:start-->
  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">
<!--bookdown:toc2:start-->
<ul>
<li><a href="#foreword" id="toc-foreword">Foreword</a>
<ul>
<li><a href="#contributors" id="toc-contributors">Contributors</a></li>
</ul></li>
<li><a href="#part-introduction" id="toc-part-introduction">(PART) Introduction</a></li>
<li><a href="#the-prevention-of-malaria" id="toc-the-prevention-of-malaria"><span class="toc-section-number">1</span> The Prevention of Malaria</a>
<ul>
<li><a href="#the-quantitative-approach" id="toc-the-quantitative-approach"><span class="toc-section-number">1.1</span> The Quantitative Approach</a></li>
<li><a href="#larval-source-management" id="toc-larval-source-management"><span class="toc-section-number">1.2</span> Larval Source Management</a></li>
<li><a href="#malaria-population-dynamics" id="toc-malaria-population-dynamics"><span class="toc-section-number">1.3</span> Malaria Population Dynamics</a></li>
<li><a href="#measuring-transmission" id="toc-measuring-transmission"><span class="toc-section-number">1.4</span> Measuring Transmission</a></li>
<li><a href="#the-study-of-epidemics" id="toc-the-study-of-epidemics"><span class="toc-section-number">1.5</span> The Study of Epidemics</a></li>
<li><a href="#mathematical-epidemiology" id="toc-mathematical-epidemiology"><span class="toc-section-number">1.6</span> Mathematical Epidemiology</a></li>
<li><a href="#approaching-complexity" id="toc-approaching-complexity"><span class="toc-section-number">1.7</span> Approaching Complexity</a></li>
<li><a href="#historical-notes" id="toc-historical-notes"><span class="toc-section-number">1.8</span> Historical Notes</a>
<ul>
<li><a href="#the-light-microscope" id="toc-the-light-microscope"><span class="toc-section-number">1.8.1</span> The Light Microscope</a></li>
<li><a href="#mathematical-epidemiology-before-ross" id="toc-mathematical-epidemiology-before-ross"><span class="toc-section-number">1.8.2</span> Mathematical Epidemiology Before Ross</a></li>
</ul></li>
</ul></li>
<li><a href="#basic-malaria-models" id="toc-basic-malaria-models"><span class="toc-section-number">2</span> Basic Malaria Models</a>
<ul>
<li><a href="#dtsRoss" id="toc-dtsRoss"><span class="toc-section-number">2.1</span> Deterministic, Discrete Time</a>
<ul>
<li><a href="#ross_dts_1" id="toc-ross_dts_1"><span class="toc-section-number">2.1.1</span> <code>ross_dts_1</code></a></li>
<li><a href="#solving" id="toc-solving"><span class="toc-section-number">2.1.2</span> Solving</a></li>
<li><a href="#visualizing" id="toc-visualizing"><span class="toc-section-number">2.1.3</span> Visualizing</a></li>
<li><a href="#computation" id="toc-computation"><span class="toc-section-number">2.1.4</span> Computation</a></li>
<li><a href="#steady-states" id="toc-steady-states"><span class="toc-section-number">2.1.5</span> Steady States</a></li>
<li><a href="#thresholds" id="toc-thresholds"><span class="toc-section-number">2.1.6</span> Thresholds</a></li>
<li><a href="#verification" id="toc-verification"><span class="toc-section-number">2.1.7</span> Verification</a></li>
<li><a href="#numerical-instability" id="toc-numerical-instability"><span class="toc-section-number">2.1.8</span> Numerical Instability</a></li>
<li><a href="#dtsRoss2" id="toc-dtsRoss2"><span class="toc-section-number">2.1.9</span> <code>ross_dts_2</code></a></li>
</ul></li>
<li><a href="#sdtsRoss" id="toc-sdtsRoss"><span class="toc-section-number">2.2</span> Stochastic, Discrete Time</a></li>
<li><a href="#xdeRoss" id="toc-xdeRoss"><span class="toc-section-number">2.3</span> Deterministic, Continuous Time</a>
<ul>
<li><a href="#ross_xde" id="toc-ross_xde"><span class="toc-section-number">2.3.1</span> <code>ross_xde</code></a></li>
<li><a href="#rates-vs.-proportions" id="toc-rates-vs.-proportions"><span class="toc-section-number">2.3.2</span> Rates <em>vs.</em> Proportions</a></li>
<li><a href="#solutions" id="toc-solutions"><span class="toc-section-number">2.3.3</span> Solutions</a></li>
<li><a href="#computation-visualization" id="toc-computation-visualization"><span class="toc-section-number">2.3.4</span> Computation &amp; Visualization</a></li>
<li><a href="#steady-states-1" id="toc-steady-states-1"><span class="toc-section-number">2.3.5</span> Steady States</a></li>
<li><a href="#verification-1" id="toc-verification-1"><span class="toc-section-number">2.3.6</span> Verification</a></li>
<li><a href="#thresholds-1" id="toc-thresholds-1"><span class="toc-section-number">2.3.7</span> Thresholds</a></li>
</ul></li>
<li><a href="#sxdeRoss" id="toc-sxdeRoss"><span class="toc-section-number">2.4</span> Stochastic, Continuous Time</a></li>
<li><a href="#mathSpecies" id="toc-mathSpecies"><span class="toc-section-number">2.5</span> Mathematical Species</a>
<ul>
<li><a href="#deterministic-models" id="toc-deterministic-models"><span class="toc-section-number">2.5.1</span> Deterministic Models</a></li>
<li><a href="#stochastic-models" id="toc-stochastic-models"><span class="toc-section-number">2.5.2</span> Stochastic Models</a></li>
</ul></li>
<li><a href="#notes" id="toc-notes"><span class="toc-section-number">2.6</span> Notes</a></li>
</ul></li>
<li><a href="#the-ross-macdonald-model" id="toc-the-ross-macdonald-model"><span class="toc-section-number">3</span> The Ross-Macdonald Model</a>
<ul>
<li><a href="#infection" id="toc-infection"><span class="toc-section-number">3.1</span> Infection</a></li>
<li><a href="#mosquito-bionomics" id="toc-mosquito-bionomics"><span class="toc-section-number">3.2</span> Mosquito Bionomics</a></li>
<li><a href="#equations" id="toc-equations"><span class="toc-section-number">3.3</span> Equations</a></li>
<li><a href="#solutions-1" id="toc-solutions-1"><span class="toc-section-number">3.4</span> Solutions</a></li>
<li><a href="#the-basic-reproductive-number" id="toc-the-basic-reproductive-number"><span class="toc-section-number">3.5</span> The Basic Reproductive Number</a></li>
<li><a href="#sensitivity-to-parameters" id="toc-sensitivity-to-parameters"><span class="toc-section-number">3.6</span> Sensitivity to Parameters</a></li>
<li><a href="#vectorial-capacity" id="toc-vectorial-capacity"><span class="toc-section-number">3.7</span> Vectorial Capacity</a></li>
<li><a href="#classifying-transmission" id="toc-classifying-transmission"><span class="toc-section-number">3.8</span> Classifying Transmission</a></li>
<li><a href="#history" id="toc-history"><span class="toc-section-number">3.9</span> History</a>
<ul>
<li><a href="#lotka" id="toc-lotka"><span class="toc-section-number">3.9.1</span> Lotka</a></li>
<li><a href="#macdonald-and-medical-entomology" id="toc-macdonald-and-medical-entomology"><span class="toc-section-number">3.9.2</span> Macdonald and Medical Entomology</a></li>
<li><a href="#r_0-in-the-gmep" id="toc-r_0-in-the-gmep"><span class="toc-section-number">3.9.3</span> <span class="math inline">\(R_0\)</span> in the GMEP</a></li>
</ul></li>
</ul></li>
<li><a href="#metrics-and-models" id="toc-metrics-and-models"><span class="toc-section-number">4</span> Metrics and Models</a>
<ul>
<li><a href="#malaria-epidemiology" id="toc-malaria-epidemiology"><span class="toc-section-number">4.1</span> Malaria Epidemiology</a>
<ul>
<li><a href="#infection-prevalence" id="toc-infection-prevalence"><span class="toc-section-number">4.1.1</span> Infection Prevalence</a></li>
<li><a href="#infection-incidence" id="toc-infection-incidence"><span class="toc-section-number">4.1.2</span> Infection Incidence</a></li>
<li><a href="#disease" id="toc-disease"><span class="toc-section-number">4.1.3</span> Disease</a></li>
<li><a href="#serology" id="toc-serology"><span class="toc-section-number">4.1.4</span> Serology</a></li>
</ul></li>
<li><a href="#entomology" id="toc-entomology"><span class="toc-section-number">4.2</span> Entomology</a>
<ul>
<li><a href="#entomological-inoculation-rates" id="toc-entomological-inoculation-rates"><span class="toc-section-number">4.2.1</span> Entomological Inoculation Rates</a></li>
<li><a href="#bionomics" id="toc-bionomics"><span class="toc-section-number">4.2.2</span> Bionomics</a></li>
</ul></li>
<li><a href="#transmission" id="toc-transmission"><span class="toc-section-number">4.3</span> Transmission</a>
<ul>
<li><a href="#infectiousness" id="toc-infectiousness"><span class="toc-section-number">4.3.1</span> Infectiousness</a></li>
<li><a href="#vectorial-capacity-1" id="toc-vectorial-capacity-1"><span class="toc-section-number">4.3.2</span> Vectorial Capacity</a></li>
<li><a href="#transmission-efficiency" id="toc-transmission-efficiency"><span class="toc-section-number">4.3.3</span> Transmission Efficiency</a></li>
</ul></li>
<li><a href="#surveillance" id="toc-surveillance"><span class="toc-section-number">4.4</span> Surveillance</a></li>
<li><a href="#observation" id="toc-observation"><span class="toc-section-number">4.5</span> Observation</a></li>
</ul></li>
<li><a href="#research-and-policy" id="toc-research-and-policy"><span class="toc-section-number">5</span> Research and Policy</a>
<ul>
<li><a href="#information-and-decisions" id="toc-information-and-decisions"><span class="toc-section-number">5.1</span> Information and Decisions</a></li>
<li><a href="#a-models-skill-set" id="toc-a-models-skill-set"><span class="toc-section-number">5.2</span> A Model’s Skill Set</a></li>
<li><a href="#temporal-epochs" id="toc-temporal-epochs"><span class="toc-section-number">5.3</span> Temporal Epochs</a></li>
<li><a href="#inference" id="toc-inference"><span class="toc-section-number">5.4</span> Inference</a></li>
<li><a href="#imputation" id="toc-imputation"><span class="toc-section-number">5.5</span> Imputation</a></li>
</ul></li>
<li><a href="#part-toolbox" id="toc-part-toolbox">(PART) Toolbox</a></li>
<li><a href="#malaria-models-for-policy" id="toc-malaria-models-for-policy"><span class="toc-section-number">6</span> Malaria Models for Policy</a>
<ul>
<li><a href="#malaria-epidemiology-1" id="toc-malaria-epidemiology-1"><span class="toc-section-number">6.1</span> Malaria Epidemiology</a></li>
<li><a href="#human-demography" id="toc-human-demography"><span class="toc-section-number">6.2</span> Human Demography</a></li>
<li><a href="#the-burden-of-malaria" id="toc-the-burden-of-malaria"><span class="toc-section-number">6.3</span> The Burden of Malaria</a></li>
<li><a href="#mosquito-ecology-and-behavior" id="toc-mosquito-ecology-and-behavior"><span class="toc-section-number">6.4</span> Mosquito Ecology and Behavior</a></li>
<li><a href="#theory-for-vector-control" id="toc-theory-for-vector-control"><span class="toc-section-number">6.5</span> Theory for Vector Control</a></li>
<li><a href="#blood-feeding-and-transmission" id="toc-blood-feeding-and-transmission"><span class="toc-section-number">6.6</span> Blood Feeding and Transmission</a></li>
<li><a href="#spatial-dynamics-and-connectivity" id="toc-spatial-dynamics-and-connectivity"><span class="toc-section-number">6.7</span> Spatial Dynamics and Connectivity</a></li>
<li><a href="#parasite-diversity" id="toc-parasite-diversity"><span class="toc-section-number">6.8</span> Parasite Diversity</a></li>
<li><a href="#evolution-of-drug-resistance" id="toc-evolution-of-drug-resistance"><span class="toc-section-number">6.9</span> Evolution of Drug Resistance</a></li>
<li><a href="#evolution-of-insecticide-resistance" id="toc-evolution-of-insecticide-resistance"><span class="toc-section-number">6.10</span> Evolution of Insecticide Resistance</a></li>
</ul></li>
<li><a href="#heterogeneous-transmission" id="toc-heterogeneous-transmission"><span class="toc-section-number">7</span> Heterogeneous Transmission</a>
<ul>
<li><a href="#blood-feeding" id="toc-blood-feeding"><span class="toc-section-number">7.1</span> Blood Feeding</a>
<ul>
<li><a href="#mosquito-searching" id="toc-mosquito-searching"><span class="toc-section-number">7.1.1</span> Mosquito Searching</a></li>
<li><a href="#risky-human-behaviors" id="toc-risky-human-behaviors"><span class="toc-section-number">7.1.2</span> Risky Human Behaviors</a></li>
</ul></li>
<li><a href="#environmental-heterogeneity" id="toc-environmental-heterogeneity"><span class="toc-section-number">7.2</span> Environmental Heterogeneity</a></li>
<li><a href="#heterogeneous-biting" id="toc-heterogeneous-biting"><span class="toc-section-number">7.3</span> Heterogeneous Biting</a></li>
</ul></li>
<li><a href="#aron-may" id="toc-aron-may"><span class="toc-section-number">8</span> Adult Mosquito Dynamics</a>
<ul>
<li><a href="#emergence" id="toc-emergence"><span class="toc-section-number">8.1</span> Emergence</a>
<ul>
<li><a href="#variables" id="toc-variables"><span class="toc-section-number">8.1.1</span> Variables</a></li>
<li><a href="#blood-fed-mosquitoes" id="toc-blood-fed-mosquitoes"><span class="toc-section-number">8.1.2</span> Blood Fed Mosquitoes</a></li>
<li><a href="#infected-mosquitoes" id="toc-infected-mosquitoes"><span class="toc-section-number">8.1.3</span> Infected Mosquitoes</a></li>
<li><a href="#infectious-mosquitoes" id="toc-infectious-mosquitoes"><span class="toc-section-number">8.1.4</span> Infectious Mosquitoes</a></li>
<li><a href="#RossEqn" id="toc-RossEqn"><span class="toc-section-number">8.1.5</span> Infected Humans</a></li>
<li><a href="#as-a-system" id="toc-as-a-system"><span class="toc-section-number">8.1.6</span> …as a System</a></li>
<li><a href="#solutions-2" id="toc-solutions-2"><span class="toc-section-number">8.1.7</span> Solutions</a></li>
<li><a href="#initial-values" id="toc-initial-values"><span class="toc-section-number">8.1.8</span> Initial Values</a></li>
<li><a href="#parameter-values" id="toc-parameter-values"><span class="toc-section-number">8.1.9</span> Parameter Values</a></li>
<li><a href="#solving-1" id="toc-solving-1"><span class="toc-section-number">8.1.10</span> Solving</a></li>
<li><a href="#visualizing-1" id="toc-visualizing-1"><span class="toc-section-number">8.1.11</span> Visualizing</a></li>
</ul></li>
<li><a href="#steady-states-2" id="toc-steady-states-2"><span class="toc-section-number">8.2</span> Steady States</a>
<ul>
<li><a href="#mosquito-density" id="toc-mosquito-density"><span class="toc-section-number">8.2.1</span> Mosquito Density</a></li>
<li><a href="#eir" id="toc-eir"><span class="toc-section-number">8.2.2</span> EIR</a></li>
<li><a href="#vectorial-capacity-2" id="toc-vectorial-capacity-2"><span class="toc-section-number">8.2.3</span> Vectorial Capacity</a></li>
<li><a href="#malaria-prevalence-thresholds" id="toc-malaria-prevalence-thresholds"><span class="toc-section-number">8.2.4</span> Malaria Prevalence &amp; Thresholds</a></li>
<li><a href="#checking-our-work" id="toc-checking-our-work"><span class="toc-section-number">8.2.5</span> Checking our Work</a></li>
</ul></li>
<li><a href="#stable-orbits" id="toc-stable-orbits"><span class="toc-section-number">8.3</span> Stable Orbits</a>
<ul>
<li><a href="#thresholds-2" id="toc-thresholds-2"><span class="toc-section-number">8.3.1</span> Thresholds</a></li>
<li><a href="#orbits" id="toc-orbits"><span class="toc-section-number">8.3.2</span> Orbits</a></li>
<li><a href="#average-dynamics" id="toc-average-dynamics"><span class="toc-section-number">8.3.3</span> Average Dynamics</a></li>
</ul></li>
</ul></li>
<li><a href="#human-age-demography" id="toc-human-age-demography"><span class="toc-section-number">9</span> Human Age &amp; Demography</a>
<ul>
<li><a href="#cohort-dynamics" id="toc-cohort-dynamics"><span class="toc-section-number">9.1</span> Cohort Dynamics</a></li>
<li><a href="#gallerkin" id="toc-gallerkin"><span class="toc-section-number">9.2</span> Gallerkin</a></li>
</ul></li>
<li><a href="#mosquito-ecology" id="toc-mosquito-ecology"><span class="toc-section-number">10</span> Mosquito Ecology</a>
<ul>
<li><a href="#egg-laying" id="toc-egg-laying"><span class="toc-section-number">10.1</span> Egg Laying</a></li>
</ul></li>
<li><a href="#part-malaria-modeling" id="toc-part-malaria-modeling">(PART) Malaria Modeling</a></li>
<li><a href="#model-building" id="toc-model-building"><span class="toc-section-number">11</span> Model Building</a>
<ul>
<li><a href="#compartment-models" id="toc-compartment-models"><span class="toc-section-number">11.1</span> Compartment Models</a></li>
<li><a href="#primary-model-development" id="toc-primary-model-development"><span class="toc-section-number">11.2</span> Primary Model Development</a></li>
<li><a href="#implementation-and-verification" id="toc-implementation-and-verification"><span class="toc-section-number">11.3</span> Implementation and Verification</a>
<ul>
<li><a href="#solving-2" id="toc-solving-2"><span class="toc-section-number">11.3.1</span> Solving</a></li>
<li><a href="#mathematical-analysis" id="toc-mathematical-analysis"><span class="toc-section-number">11.3.2</span> Mathematical Analysis</a></li>
<li><a href="#simulation" id="toc-simulation"><span class="toc-section-number">11.3.3</span> Simulation</a></li>
</ul></li>
<li><a href="#what-is-a-model" id="toc-what-is-a-model"><span class="toc-section-number">11.4</span> What is a Model?</a></li>
<li><a href="#accuracy-validation" id="toc-accuracy-validation"><span class="toc-section-number">11.5</span> Accuracy &amp; Validation</a>
<ul>
<li><a href="#validation-points" id="toc-validation-points"><span class="toc-section-number">11.5.1</span> Validation Points</a></li>
</ul></li>
<li><a href="#the-measure-of-a-model" id="toc-the-measure-of-a-model"><span class="toc-section-number">11.6</span> The Measure of a Model</a>
<ul>
<li><a href="#limitations" id="toc-limitations"><span class="toc-section-number">11.6.1</span> Limitations</a></li>
<li><a href="#parsimony" id="toc-parsimony"><span class="toc-section-number">11.6.2</span> Parsimony</a></li>
</ul></li>
<li><a href="#secondary-model-development" id="toc-secondary-model-development"><span class="toc-section-number">11.7</span> Secondary Model Development</a></li>
<li><a href="#conclusions" id="toc-conclusions"><span class="toc-section-number">11.8</span> Conclusions</a></li>
</ul></li>
<li><a href="#ch-uncertainty" id="toc-ch-uncertainty"><span class="toc-section-number">12</span> Uncertainty</a>
<ul>
<li><a href="#what-we-dont-know-about-malaria" id="toc-what-we-dont-know-about-malaria"><span class="toc-section-number">12.1</span> What we Don’t Know about Malaria</a></li>
<li><a href="#what-we-dont-know-about-malaria-1" id="toc-what-we-dont-know-about-malaria-1"><span class="toc-section-number">12.2</span> What we Don’t Know about Malaria</a></li>
</ul></li>
<li><a href="#realism" id="toc-realism"><span class="toc-section-number">13</span> Realism</a>
<ul>
<li><a href="#malaria-epidemiology-2" id="toc-malaria-epidemiology-2"><span class="toc-section-number">13.1</span> Malaria Epidemiology</a></li>
<li><a href="#transmission-1" id="toc-transmission-1"><span class="toc-section-number">13.2</span> Transmission</a></li>
<li><a href="#mosquito-ecology-1" id="toc-mosquito-ecology-1"><span class="toc-section-number">13.3</span> Mosquito Ecology</a>
<ul>
<li><a href="#resource-availability" id="toc-resource-availability"><span class="toc-section-number">13.3.1</span> Resource Availability</a></li>
<li><a href="#egg-laying-1" id="toc-egg-laying-1"><span class="toc-section-number">13.3.2</span> Egg Laying</a></li>
<li><a href="#regulation" id="toc-regulation"><span class="toc-section-number">13.3.3</span> Regulation</a></li>
<li><a href="#exogenous-forcing" id="toc-exogenous-forcing"><span class="toc-section-number">13.3.4</span> Exogenous Forcing</a></li>
</ul></li>
<li><a href="#heterogeneity-stratification" id="toc-heterogeneity-stratification"><span class="toc-section-number">13.4</span> Heterogeneity &amp; Stratification</a>
<ul>
<li><a href="#strata-in-the-ross-model" id="toc-strata-in-the-ross-model"><span class="toc-section-number">13.4.1</span> Strata in the Ross model</a></li>
<li><a href="#frailties" id="toc-frailties"><span class="toc-section-number">13.4.2</span> Frailties</a></li>
<li><a href="#age" id="toc-age"><span class="toc-section-number">13.4.3</span> Age</a></li>
</ul></li>
<li><a href="#spatial-dynamics" id="toc-spatial-dynamics"><span class="toc-section-number">13.5</span> Spatial Dynamics</a>
<ul>
<li><a href="#human-migration-mobility-travel" id="toc-human-migration-mobility-travel"><span class="toc-section-number">13.5.1</span> Human Migration, Mobility &amp; Travel</a></li>
<li><a href="#mosquito-search-dispersal" id="toc-mosquito-search-dispersal"><span class="toc-section-number">13.5.2</span> Mosquito Search &amp; Dispersal</a></li>
<li><a href="#the-mixing-matrix" id="toc-the-mixing-matrix"><span class="toc-section-number">13.5.3</span> The Mixing Matrix</a></li>
<li><a href="#pathogen-dispersal-by-humans" id="toc-pathogen-dispersal-by-humans"><span class="toc-section-number">13.5.4</span> Pathogen Dispersal by Humans</a></li>
<li><a href="#pathogen-dispersal-by-mosquitoes" id="toc-pathogen-dispersal-by-mosquitoes"><span class="toc-section-number">13.5.5</span> Pathogen Dispersal by Mosquitoes</a></li>
</ul></li>
<li><a href="#exogenous-forcing-1" id="toc-exogenous-forcing-1"><span class="toc-section-number">13.6</span> Exogenous Forcing</a>
<ul>
<li><a href="#weather" id="toc-weather"><span class="toc-section-number">13.6.1</span> Weather</a></li>
<li><a href="#habitat-dynamics" id="toc-habitat-dynamics"><span class="toc-section-number">13.6.2</span> Habitat Dynamics</a></li>
<li><a href="#the-eip" id="toc-the-eip"><span class="toc-section-number">13.6.3</span> The EIP</a></li>
<li><a href="#seasonality" id="toc-seasonality"><span class="toc-section-number">13.6.4</span> Seasonality</a></li>
</ul></li>
<li><a href="#integrated-vector-control" id="toc-integrated-vector-control"><span class="toc-section-number">13.7</span> Integrated Vector Control</a></li>
<li><a href="#integrated-malaria-control" id="toc-integrated-malaria-control"><span class="toc-section-number">13.8</span> Integrated Malaria Control</a></li>
<li><a href="#context" id="toc-context"><span class="toc-section-number">13.9</span> Context</a></li>
</ul></li>
<li><a href="#modularity-and-software" id="toc-modularity-and-software"><span class="toc-section-number">14</span> Modularity and Software</a>
<ul>
<li><a href="#model-building-1" id="toc-model-building-1"><span class="toc-section-number">14.1</span> Model Building</a></li>
<li><a href="#modular-computation" id="toc-modular-computation"><span class="toc-section-number">14.2</span> Modular Computation</a>
<ul>
<li><a href="#exde" id="toc-exde"><span class="toc-section-number">14.2.1</span> <code>exDE</code></a></li>
</ul></li>
<li><a href="#notes-1" id="toc-notes-1"><span class="toc-section-number">14.3</span> Notes</a>
<ul>
<li><a href="#why-use-densities" id="toc-why-use-densities"><span class="toc-section-number">14.3.1</span> Why use densities?</a></li>
</ul></li>
</ul></li>
<li><a href="#part-epidemiology" id="toc-part-epidemiology">(PART) Epidemiology</a></li>
<li><a href="#malaria-epidemiology-3" id="toc-malaria-epidemiology-3"><span class="toc-section-number">15</span> Malaria Epidemiology</a>
<ul>
<li><a href="#life-stages" id="toc-life-stages"><span class="toc-section-number">15.1</span> Life Stages</a></li>
<li><a href="#overview" id="toc-overview"><span class="toc-section-number">15.2</span> Overview</a></li>
<li><a href="#infection-1" id="toc-infection-1"><span class="toc-section-number">15.3</span> Infection</a>
<ul>
<li><a href="#superinfection" id="toc-superinfection"><span class="toc-section-number">15.3.1</span> Superinfection</a></li>
</ul></li>
<li><a href="#disease-immunity" id="toc-disease-immunity"><span class="toc-section-number">15.4</span> Disease &amp; Immunity</a></li>
<li><a href="#gametocytes-and-infectiousness" id="toc-gametocytes-and-infectiousness"><span class="toc-section-number">15.5</span> Gametocytes and Infectiousness</a></li>
<li><a href="#treatment-and-chemoprotection" id="toc-treatment-and-chemoprotection"><span class="toc-section-number">15.6</span> Treatment and Chemoprotection</a>
<ul>
<li><a href="#the-time-course-of-an-infection" id="toc-the-time-course-of-an-infection"><span class="toc-section-number">15.6.1</span> The Time Course of an Infection</a></li>
<li><a href="#intrahost-models" id="toc-intrahost-models"><span class="toc-section-number">15.6.2</span> Intrahost Models</a></li>
<li><a href="#synthesis" id="toc-synthesis"><span class="toc-section-number">15.6.3</span> Synthesis</a></li>
</ul></li>
</ul></li>
<li><a href="#stage-structured-infection" id="toc-stage-structured-infection"><span class="toc-section-number">16</span> Stage-Structured Infection</a>
<ul>
<li><a href="#stages-of-infection" id="toc-stages-of-infection"><span class="toc-section-number">16.1</span> Stages of Infection</a></li>
<li><a href="#controlled-infections" id="toc-controlled-infections"><span class="toc-section-number">16.2</span> Controlled Infections</a>
<ul>
<li><a href="#malariotherapy" id="toc-malariotherapy"><span class="toc-section-number">16.2.1</span> Malariotherapy</a></li>
<li><a href="#chmi" id="toc-chmi"><span class="toc-section-number">16.2.2</span> CHMI</a></li>
</ul></li>
<li><a href="#a-simple-infection" id="toc-a-simple-infection"><span class="toc-section-number">16.3</span> A Simple Infection</a>
<ul>
<li><a href="#time-course" id="toc-time-course"><span class="toc-section-number">16.3.1</span> Time Course</a></li>
<li><a href="#duration" id="toc-duration"><span class="toc-section-number">16.3.2</span> Duration</a></li>
</ul></li>
<li><a href="#superinfection-1" id="toc-superinfection-1"><span class="toc-section-number">16.4</span> Superinfection</a></li>
<li><a href="#process-vs.-observation" id="toc-process-vs.-observation"><span class="toc-section-number">16.5</span> Process <em>vs.</em> Observation</a>
<ul>
<li><a href="#detection" id="toc-detection"><span class="toc-section-number">16.5.1</span> Detection</a></li>
</ul></li>
</ul></li>
<li><a href="#stage-structured-infections" id="toc-stage-structured-infections"><span class="toc-section-number">17</span> Stage-Structured Infections</a>
<ul>
<li><a href="#stages-of-infection-1" id="toc-stages-of-infection-1"><span class="toc-section-number">17.1</span> Stages of Infection</a></li>
<li><a href="#controlled-infections-1" id="toc-controlled-infections-1"><span class="toc-section-number">17.2</span> Controlled Infections</a>
<ul>
<li><a href="#malariotherapy-1" id="toc-malariotherapy-1"><span class="toc-section-number">17.2.1</span> Malariotherapy</a></li>
<li><a href="#chmi-1" id="toc-chmi-1"><span class="toc-section-number">17.2.2</span> CHMI</a></li>
</ul></li>
<li><a href="#a-simple-infection-1" id="toc-a-simple-infection-1"><span class="toc-section-number">17.3</span> A Simple Infection</a>
<ul>
<li><a href="#time-course-1" id="toc-time-course-1"><span class="toc-section-number">17.3.1</span> Time Course</a></li>
<li><a href="#duration-1" id="toc-duration-1"><span class="toc-section-number">17.3.2</span> Duration</a></li>
</ul></li>
<li><a href="#superinfection-2" id="toc-superinfection-2"><span class="toc-section-number">17.4</span> Superinfection</a></li>
<li><a href="#process-vs.-observation-1" id="toc-process-vs.-observation-1"><span class="toc-section-number">17.5</span> Process <em>vs.</em> Observation</a>
<ul>
<li><a href="#detection-1" id="toc-detection-1"><span class="toc-section-number">17.5.1</span> Detection</a></li>
</ul></li>
</ul></li>
<li><a href="#queuing-models-and-superinfection" id="toc-queuing-models-and-superinfection"><span class="toc-section-number">18</span> Queuing Models and Superinfection</a>
<ul>
<li><a href="#parasite-densities-and-detection" id="toc-parasite-densities-and-detection"><span class="toc-section-number">18.1</span> Parasite Densities and Detection</a></li>
<li><a href="#light-microscopy" id="toc-light-microscopy"><span class="toc-section-number">18.2</span> Light Microscopy</a></li>
<li><a href="#biomarkers-and-rdts" id="toc-biomarkers-and-rdts"><span class="toc-section-number">18.3</span> Biomarkers and RDTs</a></li>
<li><a href="#pcr" id="toc-pcr"><span class="toc-section-number">18.4</span> PCR</a></li>
</ul></li>
<li><a href="#stage-structured-immunity" id="toc-stage-structured-immunity"><span class="toc-section-number">19</span> Stage-Structured Immunity</a>
<ul>
<li><a href="#the-garki-model" id="toc-the-garki-model"><span class="toc-section-number">19.1</span> The Garki Model</a></li>
<li><a href="#stage-structured-immunity-1" id="toc-stage-structured-immunity-1"><span class="toc-section-number">19.2</span> Stage-Structured Immunity</a></li>
<li><a href="#strain-specific-immunity" id="toc-strain-specific-immunity"><span class="toc-section-number">19.3</span> Strain Specific Immunity</a></li>
<li><a href="#memory-tracking" id="toc-memory-tracking"><span class="toc-section-number">19.4</span> Memory Tracking</a></li>
<li><a href="#age-vs.-prevalence" id="toc-age-vs.-prevalence"><span class="toc-section-number">19.5</span> Age <em>vs.</em> Prevalence</a></li>
</ul></li>
<li><a href="#age-structured-infection-models" id="toc-age-structured-infection-models"><span class="toc-section-number">20</span> Age-Structured Infection Models</a></li>
<li><a href="#hybrid-models" id="toc-hybrid-models"><span class="toc-section-number">21</span> Hybrid Models</a></li>
<li><a href="#within-host" id="toc-within-host"><span class="toc-section-number">22</span> Within Host</a></li>
<li><a href="#fever-and-severe-disease" id="toc-fever-and-severe-disease"><span class="toc-section-number">23</span> Fever and Severe Disease</a>
<ul>
<li><a href="#fever" id="toc-fever"><span class="toc-section-number">23.1</span> Fever</a></li>
<li><a href="#anemia" id="toc-anemia"><span class="toc-section-number">23.2</span> Anemia</a></li>
<li><a href="#severe-disease" id="toc-severe-disease"><span class="toc-section-number">23.3</span> Severe Disease</a></li>
</ul></li>
<li><a href="#drug-taking" id="toc-drug-taking"><span class="toc-section-number">24</span> Drug Taking</a>
<ul>
<li><a href="#curing-infections" id="toc-curing-infections"><span class="toc-section-number">24.1</span> Curing Infections</a></li>
<li><a href="#chemoprotection" id="toc-chemoprotection"><span class="toc-section-number">24.2</span> Chemoprotection</a></li>
<li><a href="#adherance" id="toc-adherance"><span class="toc-section-number">24.3</span> Adherance</a></li>
<li><a href="#treatment-rates" id="toc-treatment-rates"><span class="toc-section-number">24.4</span> Treatment Rates</a></li>
</ul></li>
<li><a href="#gametocytes-and-infectiousness-1" id="toc-gametocytes-and-infectiousness-1"><span class="toc-section-number">25</span> Gametocytes and Infectiousness</a>
<ul>
<li><a href="#gametocytemia" id="toc-gametocytemia"><span class="toc-section-number">25.1</span> Gametocytemia</a></li>
<li><a href="#anti-gametocyte-immunity" id="toc-anti-gametocyte-immunity"><span class="toc-section-number">25.2</span> Anti-Gametocyte Immunity</a></li>
</ul></li>
<li><a href="#models-and-malaria-epidemiology" id="toc-models-and-malaria-epidemiology"><span class="toc-section-number">26</span> Models and Malaria Epidemiology</a>
<ul>
<li><a href="#section" id="toc-section"><span class="toc-section-number">26.1</span> </a></li>
</ul></li>
<li><a href="#part-mosquito-ecology" id="toc-part-mosquito-ecology">(PART) Mosquito Ecology</a></li>
<li><a href="#mosquitoes" id="toc-mosquitoes"><span class="toc-section-number">27</span> Mosquitoes</a>
<ul>
<li><a href="#aquatic-dynamics" id="toc-aquatic-dynamics"><span class="toc-section-number">27.1</span> Aquatic Dynamics</a>
<ul>
<li><a href="#equations-1" id="toc-equations-1"><span class="toc-section-number">27.1.1</span> Equations</a></li>
<li><a href="#solutions-3" id="toc-solutions-3"><span class="toc-section-number">27.1.2</span> Solutions</a></li>
<li><a href="#regulation-1" id="toc-regulation-1"><span class="toc-section-number">27.1.3</span> Regulation</a></li>
</ul></li>
<li><a href="#understanding-mosquito-dynamics" id="toc-understanding-mosquito-dynamics"><span class="toc-section-number">27.2</span> Understanding Mosquito Dynamics</a></li>
</ul></li>
<li><a href="#behavioral-state-models" id="toc-behavioral-state-models"><span class="toc-section-number">28</span> Behavioral State Models</a></li>
<li><a href="#regulation-of-mosquito-populations" id="toc-regulation-of-mosquito-populations"><span class="toc-section-number">29</span> Regulation of Mosquito Populations</a></li>
<li><a href="#mosquito-dispersal" id="toc-mosquito-dispersal"><span class="toc-section-number">30</span> Mosquito Dispersal</a></li>
<li><a href="#mosquito-age" id="toc-mosquito-age"><span class="toc-section-number">31</span> Mosquito Age</a></li>
<li><a href="#multi-species-models" id="toc-multi-species-models"><span class="toc-section-number">32</span> Multi-Species Models</a>
<ul>
<li><a href="#vector-competence" id="toc-vector-competence"><span class="toc-section-number">32.1</span> Vector Competence</a></li>
</ul></li>
<li><a href="#aquatic-ecology" id="toc-aquatic-ecology"><span class="toc-section-number">33</span> Aquatic Ecology</a></li>
<li><a href="#mosquito-larval-stages" id="toc-mosquito-larval-stages"><span class="toc-section-number">34</span> Mosquito Larval Stages</a></li>
<li><a href="#temporal-dynamics" id="toc-temporal-dynamics"><span class="toc-section-number">35</span> Temporal Dynamics</a>
<ul>
<li><a href="#exogenous-forcing-2" id="toc-exogenous-forcing-2"><span class="toc-section-number">35.1</span> Exogenous Forcing</a></li>
<li><a href="#mosquito-survival-through-the-eip" id="toc-mosquito-survival-through-the-eip"><span class="toc-section-number">35.2</span> Mosquito Survival through the EIP</a></li>
</ul></li>
<li><a href="#measuring-mosquitoes" id="toc-measuring-mosquitoes"><span class="toc-section-number">36</span> Measuring Mosquitoes</a></li>
<li><a href="#part-transmission" id="toc-part-transmission">(PART) Transmission</a></li>
<li><a href="#blood-feeding-1" id="toc-blood-feeding-1"><span class="toc-section-number">37</span> Blood Feeding</a>
<ul>
<li><a href="#search-and-risk" id="toc-search-and-risk"><span class="toc-section-number">37.0.1</span> Search and Risk</a></li>
<li><a href="#search-weights-and-availability" id="toc-search-weights-and-availability"><span class="toc-section-number">37.0.2</span> Search Weights and Availability</a></li>
<li><a href="#functional-response" id="toc-functional-response"><span class="toc-section-number">37.0.3</span> Functional Response</a></li>
<li><a href="#environmental-heterogeneity-1" id="toc-environmental-heterogeneity-1"><span class="toc-section-number">37.0.4</span> Environmental Heterogeneity</a></li>
<li><a href="#host-availability" id="toc-host-availability"><span class="toc-section-number">37.1</span> Host Availability</a></li>
<li><a href="#blood-feeding-rates" id="toc-blood-feeding-rates"><span class="toc-section-number">37.2</span> Blood Feeding Rates</a></li>
<li><a href="#the-human-fraction" id="toc-the-human-fraction"><span class="toc-section-number">37.3</span> The Human Fraction</a></li>
<li><a href="#the-mixing-matrix-beta" id="toc-the-mixing-matrix-beta"><span class="toc-section-number">37.4</span> The Mixing Matrix, <span class="math inline">\(\beta\)</span></a></li>
</ul></li>
<li><a href="#human-mobility" id="toc-human-mobility"><span class="toc-section-number">38</span> Human Mobility</a>
<ul>
<li><a href="#modalities" id="toc-modalities"><span class="toc-section-number">38.1</span> Modalities</a></li>
<li><a href="#time-at-risk" id="toc-time-at-risk"><span class="toc-section-number">38.2</span> Time at Risk</a></li>
<li><a href="#travel" id="toc-travel"><span class="toc-section-number">38.3</span> Travel</a></li>
<li><a href="#migration" id="toc-migration"><span class="toc-section-number">38.4</span> Migration</a></li>
</ul></li>
<li><a href="#spatial-dynamics-1" id="toc-spatial-dynamics-1"><span class="toc-section-number">39</span> Spatial Dynamics</a></li>
<li><a href="#heterogeneous-transmission-1" id="toc-heterogeneous-transmission-1"><span class="toc-section-number">40</span> Heterogeneous Transmission</a>
<ul>
<li><a href="#overview-1" id="toc-overview-1"><span class="toc-section-number">40.1</span> Overview</a>
<ul>
<li><a href="#age-1" id="toc-age-1"><span class="toc-section-number">40.1.1</span> Age</a></li>
<li><a href="#location" id="toc-location"><span class="toc-section-number">40.1.2</span> Location</a></li>
<li><a href="#house-type" id="toc-house-type"><span class="toc-section-number">40.1.3</span> House Type</a></li>
<li><a href="#activities" id="toc-activities"><span class="toc-section-number">40.1.4</span> Activities</a></li>
</ul></li>
<li><a href="#frailtyCh" id="toc-frailtyCh"><span class="toc-section-number">40.2</span> Frailty</a></li>
<li><a href="#environmentalHeterogeneity" id="toc-environmentalHeterogeneity"><span class="toc-section-number">40.3</span> Environmental Heterogeneity</a></li>
</ul></li>
<li><a href="#part-malaria-control" id="toc-part-malaria-control">(PART) Malaria Control</a></li>
<li><a href="#malaria-control" id="toc-malaria-control"><span class="toc-section-number">41</span> Malaria Control</a>
<ul>
<li><a href="#health-systems" id="toc-health-systems"><span class="toc-section-number">41.1</span> Health Systems</a></li>
<li><a href="#vector-control" id="toc-vector-control"><span class="toc-section-number">41.2</span> Vector Control</a></li>
</ul></li>
<li><a href="#insecticide-treated-bednets" id="toc-insecticide-treated-bednets"><span class="toc-section-number">42</span> Insecticide-Treated Bednets</a></li>
<li><a href="#indoor-residual-spraying" id="toc-indoor-residual-spraying"><span class="toc-section-number">43</span> Indoor Residual Spraying</a></li>
<li><a href="#larval-source-management-1" id="toc-larval-source-management-1"><span class="toc-section-number">44</span> Larval Source Management</a></li>
<li><a href="#attractive-toxic-sugar-baits" id="toc-attractive-toxic-sugar-baits"><span class="toc-section-number">45</span> Attractive Toxic Sugar Baits</a></li>
<li><a href="#integrated-vector-control-1" id="toc-integrated-vector-control-1"><span class="toc-section-number">46</span> Integrated Vector Control</a></li>
<li><a href="#part-health-systems" id="toc-part-health-systems">(PART) Health Systems</a></li>
<li><a href="#cohort-dynamics-1" id="toc-cohort-dynamics-1"><span class="toc-section-number">47</span> Cohort Dynamics</a>
<ul>
<li><a href="#boxcar-models" id="toc-boxcar-models"><span class="toc-section-number">47.1</span> Boxcar Models</a></li>
<li><a href="#delay" id="toc-delay"><span class="toc-section-number">47.2</span> Delay</a></li>
</ul></li>
<li><a href="#human-demography" id="toc-human-demography"><span class="toc-section-number">48</span> Human Demography</a>
<ul>
<li><a href="#migration-1" id="toc-migration-1"><span class="toc-section-number">48.1</span> Migration</a></li>
</ul></li>
<li><a href="#human-travel-and-malaria-importation" id="toc-human-travel-and-malaria-importation"><span class="toc-section-number">49</span> Human Travel and Malaria Importation</a></li>
<li><a href="#stratification" id="toc-stratification"><span class="toc-section-number">50</span> Stratification</a></li>
<li><a href="#pharmaceutical-interventions" id="toc-pharmaceutical-interventions"><span class="toc-section-number">51</span> Pharmaceutical Interventions</a>
<ul>
<li><a href="#smc" id="toc-smc"><span class="toc-section-number">51.1</span> SMC</a></li>
<li><a href="#mda" id="toc-mda"><span class="toc-section-number">51.2</span> MDA</a></li>
<li><a href="#drugs" id="toc-drugs"><span class="toc-section-number">51.3</span> Drugs</a></li>
<li><a href="#vaccines" id="toc-vaccines"><span class="toc-section-number">51.4</span> Vaccines</a></li>
</ul></li>
<li><a href="#part-analytics" id="toc-part-analytics">(PART) Analytics</a></li>
<li><a href="#malaria-analytics" id="toc-malaria-analytics"><span class="toc-section-number">52</span> Malaria Analytics</a>
<ul>
<li><a href="#the-burden-of-malaria-1" id="toc-the-burden-of-malaria-1"><span class="toc-section-number">52.1</span> The Burden of Malaria</a></li>
<li><a href="#a-theory-of-control" id="toc-a-theory-of-control"><span class="toc-section-number">52.2</span> A Theory of Control</a></li>
<li><a href="#generic-vs.-specific-advice" id="toc-generic-vs.-specific-advice"><span class="toc-section-number">52.3</span> Generic <em>vs.</em> Specific Advice</a></li>
<li><a href="#imputation-1" id="toc-imputation-1"><span class="toc-section-number">52.4</span> Imputation</a></li>
<li><a href="#robust-analytics" id="toc-robust-analytics"><span class="toc-section-number">52.5</span> Robust Analytics</a></li>
</ul></li>
<li><a href="#malaria-metrics" id="toc-malaria-metrics"><span class="toc-section-number">53</span> Malaria Metrics</a>
<ul>
<li><a href="#realistic-bounds" id="toc-realistic-bounds"><span class="toc-section-number">53.1</span> Realistic Bounds</a></li>
<li><a href="#the-local-fraction" id="toc-the-local-fraction"><span class="toc-section-number">53.2</span> The Local Fraction</a>
<ul>
<li><a href="#travel-1" id="toc-travel-1"><span class="toc-section-number">53.2.1</span> Travel</a></li>
<li><a href="#mobility" id="toc-mobility"><span class="toc-section-number">53.2.2</span> Mobility</a></li>
</ul></li>
<li><a href="#drug-taking-1" id="toc-drug-taking-1"><span class="toc-section-number">53.3</span> Drug Taking</a></li>
<li><a href="#seasonality-1" id="toc-seasonality-1"><span class="toc-section-number">53.4</span> Seasonality</a></li>
<li><a href="#frailty" id="toc-frailty"><span class="toc-section-number">53.5</span> Frailty</a></li>
<li><a href="#environmental-heterogeneity-2" id="toc-environmental-heterogeneity-2"><span class="toc-section-number">53.6</span> Environmental Heterogeneity</a></li>
<li><a href="#pfeir-vs.-pfpr-in-data" id="toc-pfeir-vs.-pfpr-in-data"><span class="toc-section-number">53.7</span> <em>Pf</em>EIR <em>vs.</em> <em>Pf</em>PR in Data</a></li>
<li><a href="#pfeir-vs.-pffoi-in-data" id="toc-pfeir-vs.-pffoi-in-data"><span class="toc-section-number">53.8</span> <em>Pf</em>EIR <em>vs.</em> <em>Pf</em>FoI in Data</a></li>
<li><a href="#synthesis-1" id="toc-synthesis-1"><span class="toc-section-number">53.9</span> Synthesis</a></li>
</ul></li>
<li><a href="#discrete-time" id="toc-discrete-time"><span class="toc-section-number">54</span> Discrete Time</a></li>
<li><a href="#spatial-concepts-and-connectivity" id="toc-spatial-concepts-and-connectivity"><span class="toc-section-number">55</span> Spatial Concepts and Connectivity</a></li>
<li><a href="#mosquito-microecology" id="toc-mosquito-microecology"><span class="toc-section-number">56</span> Mosquito Microecology</a></li>
<li><a href="#microsimulation" id="toc-microsimulation"><span class="toc-section-number">57</span> Microsimulation</a></li>
<li><a href="#spatial-control" id="toc-spatial-control"><span class="toc-section-number">58</span> Spatial Control</a></li>
<li><a href="#model-libraries" id="toc-model-libraries"><span class="toc-section-number">59</span> Model Libraries</a></li>
<li><a href="#base-models" id="toc-base-models"><span class="toc-section-number">60</span> Base Models</a></li>
<li><a href="#built-in-analytics" id="toc-built-in-analytics"><span class="toc-section-number">61</span> Built-in Analytics</a></li>
<li><a href="#stochasticity" id="toc-stochasticity"><span class="toc-section-number">62</span> Stochasticity</a></li>
<li><a href="#a-glossary" id="toc-a-glossary"><span class="toc-section-number">63</span> A Glossary</a></li>
<li><a href="#part-supplements" id="toc-part-supplements">(PART) Supplements</a></li>
<li><a href="#references" id="toc-references"><span class="toc-section-number">64</span> References</a></li>
</ul>
<!--bookdown:toc2:end-->
      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Applied Malaria Dynamics</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<!--bookdown:toc:end-->
<!--bookdown:body:start-->
<div id="foreword" class="section level1 unnumbered hasAnchor">
<h1 class="unnumbered hasAnchor">Foreword<a href="#foreword" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>A large fraction of my time over the past 25 years has been devoted to learning about malaria and mathematical models of malaria epidemiology, transmission dynamics, mosquito ecology, malaria control, and the evolution of drug and insecticide resistance.
While I was building and analyzing models, I was looking for a way of organizing, synthesizing, operationalizing, and applying the rich body of theory developed over more than a century of malaria research.</p>
<p>Malaria was a name for a disease associated with recurring fevers. Starting around 1660, malaria was treated with a tea made from the bark of the Cinchona tree.
In 1824, the drug quinine was isolated and used to treat malaria.
Later in the 19th century, Charles Laveran and Ronald Ross identified the cause of malaria and its mode of transmission
<span class="citation">[<a href="#ref-RossR1911Book">1</a>,<a href="#ref-SmithDL2012_RossMacdonald">2</a>]</span>.</p>
<p>In the 1900s, Ross developed the first mathematical models of malaria transmission to help with planning for the prevention of malaria.
In the early 1950s, George Macdonald’s updated Ross’s mathematical theory and published a quantitative synthesis of malaria epidemiology and control.
Some of the weaknesses of Macdonald’s model were exposed in field trials in the late 1960s. Many of these were addressed when Klaus Dietz and his colleagues published a new malaria model, in the 1970s, that was field tested in The Garki Project.
In the 1980s, Dietz developed models describing seasonality, treatment with anti-malarial drugs, and heterogeneous transmission.
Mathematical models of malaria and other infectious diseases were taken up by departments of ecology, leading to new and innovative approaches <span class="citation">[<a href="#ref-ReinerRC2013SystematicReview">3</a>]</span>.
In the 1990s, within-host malaria models were developed <span class="citation">[<a href="#ref-MolineauxL1999ReviewIntrahost">4</a>]</span>.
The mathematical theory developed for malaria epidemiology and transmission dynamics was incorporated into comprehensive individual-based malaria models (IBMs) developed at the Swiss Tropical Public Health Institute (2006), Imperial College (2010), and the Institute for Disease Modeling (2013).</p>
<p>IBMs had solved one of the core challenges of using models for malaria policy – a practical way of dealing with the complexity of malaria. While these IBMs represented an important advance, I had some lingering questions about the relationship between exposure, immunity, age, and disease; the spatial scales that characterized malaria transmission <span class="citation">[<a href="#ref-SmithDL2014Recasting">5</a>]</span>; and the stability of malaria elimination <span class="citation">[<a href="#ref-SmithDL2013StickySituation">6</a>,<a href="#ref-ChiyakaC2013Sticky">7</a>]</span>. I started developing my own framework for individual-based simulation. Sean L. Wu and I developed an IBM, called MBITES, that could simulate adult mosquito ecology and behavior in exquisite detail <span class="citation">[<a href="#ref-WuSL2020MBITES">8</a>]</span>. As we attempted to connect MBITES to models of human infection and immunity, I confronted the heavy computational load associated with using MBITES to simulate mosquito blood feeding at an individual level.</p>
<p>I was looking for a way of translating evidence into policy that was powerful enough to handle the complexity of malaria and yet deal with the uncertainty. I was also hoping to identify a way of taming the complexity through identification of relevant detail <span class="citation">[<a href="#ref-LevinS1991RelevantDetail">9</a>]</span>. Despite the advantages of IBMs, I realized they might not be the tool I was looking for.
I shifted gears and started working towards a mathematical and computational framework that was <em>not</em> an individual-based simulation model <span class="citation">[<a href="#ref-ReinerRC2013SystematicReview">3</a>,<a href="#ref-SmithNR2018AgentbasedModels">10</a>]</span>.</p>
<p>I wanted a way of building models to support <strong><em>adaptive malaria control.</em></strong>
Since malaria is so complex and locally peculiar, a core part of adaptive malaria control is using mathematical models for simulation-based analytics through iterative policy engagement.
Over time, malaria programs <em>adapt</em> by identifying key knowledge gaps and modifying surveillance, monitoring and evaluation activities to fill those gaps.
We wanted to give advice that was robust to uncertainty; analytics are robust if they characterize, quantify, and propagate uncertainty.
We needed a mathematical framework for model building that was up to the task of analyzing malaria transmission dynamics and control <em>in situ,</em> all while quantifying and propagating uncertainty.
Over time, we developed a bespoke inferential framework called <strong><em>robust analytics for malaria policy (RAMP):</em></strong></p>
<p>I thus thus set out to develop a nimble mathematical and computational framework for model building. To support RAMP and adaptive malaria control, the framework should be <em>extensible,</em> with a <em>plug-and-play </em> modular design;
it should make it easy to swap out base models describing the core dynamics, and but it would also include flexibility in the choice of functional forms describing forcing and core processes.
To get malaria transmission right, we would need to be able to deal with heterogeneity of all sorts.
The framework should be structurally flexible, so that a model could incorporate space, time, and human population strata to deal with demography and population heterogeneity.
It should have scalability to handle realism and complexity: it should be possible to scale down spatial granularity for fine-grained spatial simulations <span class="citation">[<a href="#ref-CarterR2002SpatialSimulation">11</a>–<a href="#ref-PerkinsTA2013HeterogeneityMixing">13</a>]</span>, to scale down temporally for fine-grained temporal simulations <span class="citation">[<a href="#ref-WuSL2020MBITES">8</a>]</span>, or to scale up to understand or analyze regional processes and the emerging patterns <span class="citation">[<a href="#ref-TatemAJ2010InternationalPopulation">14</a>]</span>.
To serve the needs of malaria programs, a framework would need built-in support for exogenous forcing by weather and vector control to model malaria as a changing baseline modified by control.
To get integrated vector control right, we went all-in with an individual-based simulation model for mosquito ecology and behavior (called MBITES) that could handle exquisite biological detail <span class="citation">[<a href="#ref-WuSL2020MBITES">8</a>]</span>.
MBITES was inspirational but impractical, so we revisited models to incorporate new ideas about mosquito search and behaviors.
To serve programmatic needs, we developed algorithms and theory with skill sets that included the durability of interventions – the waning potency of insecticides or decaying coverage –
and the net effect of one unit of vector control in relation to transmission intensity and coverage.
To make all the pieces fit together, we needed interfaces that could connect up models in a generic way; in the design phase, we worked with two model families for each major dynamical component – one that was dead simple, and one that had a was highly realistic.
In some cases, the interface designs called for development of new algorithms: blood feeding, egg laying, environmental heterogeneity, human mobility, and mosquito dispersal.
In making a master list to test the framework’s extensibility, we found that some odd cases that needed to pass information among components – endectocides and auto-disseminated larvicides – but it was easy enough to accommodate these.
Beyond the algorithms, these models needed the support of mathematical theory.
We wanted to understand thresholds so we wrote the routines that would compute thresholds for malaria transmission in heterogeneous systems, when appropriate.</p>
<p>Sometime in the fall of 2022, the last few pieces came together. In collaboration with Uganda’s National Malaria Control Division (NMCD) and the Bioko Island Malaria Elimination Program (BIMEP), we have now developed a malaria policy framework that we call <strong><em>adaptive malaria control.</em></strong> We published the first versions of <a href="https://cran.r-project.org/package=MicroMoB">MicroMoB</a> and <a href="https://CRAN.R-project.org/package=exDE">exDE</a> at CRAN.
We submitted a paper to PLoS Computational Biology <span class="citation">[<a href="#ref-WuSL2023SpatialDynamics">15</a>]</span>. A second paper forced us to confront a set of software design questions in relation to exogenous forcing [Add the citation here when it is published]. Meanwhile, we decided to rebrand exDE as <a href="https://dd-harp.github.io/ramp.xde/"><strong>ramp.xde</strong></a> for (ordinary and delay differential equations). We redesigned MicroMoB to catch up to ramp.xde, and rebranded it as <a href="https://dd-harp.github.io/ramp.dts/"><strong>ramp.dts</strong></a> (for discrete time systems).</p>
<p>After all that, it was time to write this book.</p>
<!-- In adaptive malaria control, we assume that policy needs mathematical models and concepts, but ideally, the mathematics would serve a role without drawing unnecessary attention. -->
<!-- Malaria policy discussions must focus on the issues at hand, including the concepts and evidence, not on the mathematics *per se*. -->
<!-- Ideally, mathematical ideas should convey rigor in understanding the summary statistics that appear in reports, and they should help structure policy discussions without becoming the focus of attention, except perhaps when the mathematics draws attention to something that needs to be clarified. -->
<!-- Ideally, the framework could be taken up and used by teams of local experts working in their own countries to reduce the burden of malaria and plan for its elimination.  -->
<!-- The framework would thus need to be flexible enough to support programmatic activites. -->
<!-- The same framework could also support academic activities taken up on the side. -->
<hr />
<p>This book was written as a primer for anyone who wants to build and analyze mathematical models of malaria.
In the chapters on <a href="#basic-malaria-models">Basic Malaria Models</a> and <a href="#the-ross-macdonald-model">The Ross-Macdonald Model</a>, we write code in the text. The book is freely available, and it is possible to download the markdown files from github and use the code in RStudio.
After the first few chapters, the examples in the book use <strong>ramp.xde</strong> and <strong>ramp.dts,</strong> two software packages written for R that are designed for scalable and nimble model building.
We use the software because it lowers the costs of building and implementing models that are up to the task of guiding malaria policy.
An advantage of using this framework and accompanying software is that it has solved the technical problems that often arise when building models that combine many factors.
These sorts of pitfalls are inevitable and annoying, and they are usually discovered the hard way.
We found design solutions that would help others building models to avoid these sorts of problems.
The framework and software took longer to develop than expected, in part, because there were more pitfalls than we had anticipated, and because we found most of them the hard way.
For those who are not interested in using the software, the book covers most of the mathematical models and theory developed for malaria over the past century.</p>
<p>This book has been written to introduce the major concepts in the mathematical study of malaria transmission dynamics and control using the core features of the mathematical framework and the software (see Figure 1.1). Behind the scenes, the work was being done in a private githubr repository, the RAMP-Model-Library, which was set up during the primary design phase. The RAMP-Model-Library is where we made all our design mistakes: was the software truly plug-and-play, and was the framework truly extensible? As the primary design phase came to a close, the library that was once the laboratory became a classroom and a museum. Over time elements of library are being transformed into vignettes, the models are being added to publicly available code, and the ideas are being published in papers. The whole project is a resource for any developer who wants to add new base models or functionality. Most of all, all this is being set up for the end user, someone in a malaria program or working with a malaria program who wants to use simulation based analytics to analyze policies. This book is structured into a set of lessons that teach concepts. Some of the concepts build on one another, and others take on new challenges. We combine these lessons into some examples where we show some algorithms to build models fit for purpose. When a topic deserves a deeper dive, we have supplemented this book with vignettes or lessons.</p>
<hr />
<center>
<div class="float">
<img src="Figures/ScalableComplexity.png" style="width:80.0%" alt="A schematic diagram of the elements in the framework (top half) and the process of model building and model fitting (bottom half)" />
<div class="figcaption">A schematic diagram of the elements in the framework (top half) and the process of model building and model fitting (bottom half)</div>
</div>
</center>
<hr />
<p>This book shows, through examples, how to use the software to build malaria models.
Even without the software, it fills a gap for students who have taken an introduction to mathematical epidemiology or infectious disease modeling and want to go on in malaria.
What are all the special topics that would need to be covered to build models that could be needed in malaria?
This book <em>could</em> be the basis for such a course, if there were ever enough students.
Since there will probably never be enough graduate students at my university who are interested in applied malaria dynamics, the material is being developed for any student anywhere.
I will also be writing and recording some short lectures on a subset of topics.</p>
<p>The premise of this book is thus that the reader has started with a solid background in infectious disease models and malaria. We assume they’ve seen the Ross-Macdonald model before, that they’ve taken a class in mathematical epidemiology, and that they know something about how to construct and analyze models. This book emphasizes concepts and teaches through examples. We have left out a lot of the technical and mathemtical details, but we have written some vignettes and lessons to supplement the book. Most of this is found in the documentation for <strong>ramp.xde</strong> or <strong>ramp.dts</strong> or one of the supporting libraries.<br />
<!-- or it can be found in the [`RAMP-Model-Library`](../../RAMP-Model-Library/RAMP-Model-Library.html).  --></p>
<p>While this book should help others build models for malaria policy, but it stops short of applying models to policy. That is covered in another book, <a href="../../RAMP-Book/_book/index.html" target="_blank"><strong><em>Robust Analytics for Malaria Policy</em>.</strong></a></p>
<hr />
<p>In doing all this, we are building on an enormous body of work that started with Ronald Ross. While Ross is better known for identifying malaria parasites in a mosquito gut, which proved that malaria is mosquito transmitted, we are more interested in the rest of his career.</p>
<p>After winning the Nobel Prize in 1902, Ross was instrumental in building solid quantitative foundations for malaria transmission and its measurement. Ronald Ross wrote the first models describing malaria transmission. In his writings from 1899 to 1911, it’s clear that he was searching for quantitative way of saying something simple – if there are not enough mosquitoes, the malaria transmission can’t be sustained. There must be a critical mosquito density, above the cutoff malaria transmission would be sustained, and below it malaria would be eliminated. Ross was looking for a formula that encapsulated his intuition: how were thresholds related to the fact that it took two bites for a mosquito to complete its life cycle? Eventually, Ross wrote down some systems of equations that would describe malaria. The ideas, mathematics, and identification of parameters and processes were extended by other scientists later, most notably Alfred Lotka and George Macdonald.</p>
<p>It seems that the challenge of malaria control was what pushed Ross toward modeling. Ross’s first model was a discussion of adult mosquito movement to guide larval source management <span class="citation">[<a href="#ref-RossR1905LogicalBasis">16</a>]</span>. The first model describing malaria transmission appeared in a book, <em>The Prevention of Malaria in Mauritius</em> <span class="citation">[<a href="#ref-RossR1908">17</a>]</span>. When it came to thinking through control, Ross found it useful to do the math. More than a century later, this book is a look at what his vision has become.</p>
<p>–David L. Smith</p>
<div id="contributors" class="section level2 unnumbered hasAnchor">
<h2 class="unnumbered hasAnchor">Contributors<a href="#contributors" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>I’ve done the primary writing for this book. The framework would not exist without the work of Sean L Wu and a few others. The book borrows from the work of others, and we have done our best to give credit through citations. It has been a collaborative process (see <a href="#contributors">Contributors</a>). The errors, however, are mostly mine. If you find mistakes or have questions, please drop me a note by email: <a href="mailto:smitdave@gmail.com">smitdave@gmail.com</a>.</p>
<p>This is a work in progress, so the list of contributors will change over time.</p>
<p>The software package <code>MicroMoB</code> was written by Sean L Wu, Sophie Liebkind, and David L Smith. The software package <code>exDE</code> was written by Sean L Wu and David L Smith.</p>
<p>Most of the content so far was written by David L Smith. Contributors from the RAMP Team include:</p>
<p>…please consult Dave if you would like a writing role.</p>
<!--chapter:end:index.Rmd-->
</div>
</div>
<div id="part-introduction" class="section level1 unnumbered hasAnchor">
<h1 class="unnumbered hasAnchor">(PART) Introduction<a href="#part-introduction" class="anchor-section" aria-label="Anchor link to header"></a></h1>
</div>
<div id="the-prevention-of-malaria" class="section level1 hasAnchor" number="1">
<h1 class="hasAnchor"><span class="header-section-number">1</span> The Prevention of Malaria<a href="#the-prevention-of-malaria" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Ronald Ross is best known for being the first person to observe malaria parasites in a mosquito <span class="citation">[<a href="#ref-RossR1897PeculiarPigmented">18</a>]</span>. The event – on August 20<span class="math inline">\(^{th}\)</span>, 1897 in a military hospital in Hyderabad, India – is now celebrated as <em>mosquito day</em>.
In the months that followed, Ross made the case that mosquitoes transmit malaria parasites <span class="citation">[<a href="#ref-RossR1898RoleMosquito">19</a>]</span>.
Concurrently, the life-cycle of human malaria parasites was described by an Italian team, led by Giovanni Battista Grassi <span class="citation">[<a href="#ref-GrassiB1898UlterioriRicerche">20</a>,<a href="#ref-GrassiB1901StudiDi">21</a>]</span>.
By 1899, a scientific consensus had formed among malaria experts that malaria was a mosquito-transmitted disease.
It would take some time before the “mosquito hypothesis” was accepted more broadly.</p>
<p>The discoveries made by Ross and Battista Grassi closed a loop that Charles Laveran had opened in 1880 when he identified malaria parasites in blood, providing the first clear evidence that human malaria was a parasitic disease <span class="citation">[<a href="#ref-Laveran1880">22</a>,<a href="#ref-Laveran1884">23</a>]</span>.
Laveran’s observation had spawned almost two decades of research describing malaria infections and disease in humans, all before the mode of transmission was known <span class="citation">[<a href="#ref-GarnhamPCC1988HistoryDiscoveries">24</a>]</span>.
The modern view of the parasite life-cycle was not complete until the 1940s, through research describing the parasite’s liver stages by Garnham and colleagues <span class="citation">[<a href="#ref-GarnhamPCC1988HistoryDiscoveries">24</a>,<a href="#ref-ShorttHE1948PreerythrocyticStage">25</a>]</span>.</p>
<p>Malaria is a disease that could be treated and measured before anyone knew what caused it or how it was transmitted.
Malaria was commonly treated with quinine once the compound had been isolated in 1824.
The chemical compound was isolated from the bark of Cinchona tree, which had been used to treat malaria fevers.
The spleen rate, a reasonable metric for malaria was described by Dempster in 1948 <span class="citation">[<a href="#ref-Dempster1848SpleenRate">26</a>]</span>.
All of this occurred before Laveran showed how that malaria was caused by infection with a parasite.</p>
<p>The elements of the story of malaria, including a full account of
how the malaria parasite’s life cycle was unravelled over time is a topic that worth taking some time to learn <span class="citation">[<a href="#ref-GarnhamPCC1988HistoryDiscoveries">24</a>,<a href="#ref-Bruce-ChwattLJ1988HistoryMalaria">27</a>–<a href="#ref-CoxFEG2010HistoryDiscovery">29</a>]</span>.</p>
<p>Knowing the mode of transmission, the British military launched vector control efforts to protect British citizens from malaria in its colonial empire.
At the time, vector control with bed nets and larval source management, and malaria was treated with quinine.
Lest we imagine malaria control in this era was for general humanitarian purposes, Ross emphasizes population segregation as a useful mode of malaria control for the colonizers.
Both Ross and Laveran were military doctors supporting colonial governments, a fact that we acknowledge that we can neither ignore nor excuse.
We try to learn enough history to avoid repeating the same mistakes.
We are sure to make enough mistakes of our own as we blunder forward.</p>
<p>In this first epoch of malaria control, it is Ross who once again draws our attention.
After his big discovery, Ross turned his attention to malaria control. In 1910,
he published a book, <em>The Prevention of Malaria.</em> A second second edition followed in 1911.
Ross’s work on malaria prevention is of interest because he laid out a vision for a quantitative approach to the prevention of malaria.
He clearly articulated how malaria control needed quantitative concepts, including well-developed metrics to measure malaria in populations.
Ross himself developed the thick film, a technique that was intended to increase the sensitivity of malaria diagnostics <span class="citation">[<a href="#ref-RossR1903ThickFilm">30</a>,<a href="#ref-RossR1903ImprovedMethod">31</a>]</span>.
In the service of understanding malaria for purposes of control, Ross developed the first mathematical models for malaria, in which he addressed basic questions about larval source management <span class="citation">[<a href="#ref-RossR1905LogicalBasis">16</a>]</span> and malaria transmission <span class="citation">[<a href="#ref-RossR1911Book">1</a>,<a href="#ref-RossR1908">17</a>,<a href="#ref-RossR1911Nature">32</a>]</span>.</p>
<p>In the second decade of malaria control, the last phase of Ross’s career, he formed an alliance with Hilda Hudson, a mathematics professor from Cambridge University. Between 1915 and 1917, Ross and Hudson developed mathematical theory to support the study of epidemics, which they called <em>a priori pathometry.</em> Then, in 1921, Martini developed a model describing the dynamics of infections that immunized their hosts. In 1927, Kermack and McKendrick published the first of a five-part series on the mathematical theory of epidemics that described the dynamics of acute immunizing infections, which overshadowed the work by Ross and Hudson. Nowadays, the field is called <em>mathematical epidemiology.</em></p>
<hr />
<p>The parasite’s life-cycle has been an organizing principle for the study of malaria.
The discoveries by Laveran, Ross, Battista Grassi, Garnham and others set the stage for hundreds of thousands of studies over 144 years (at the time of this writing) that have developed a rich and impressive body of knowledge.
Over that time, we have learned an enormous amount about malaria and its control.
The first comprehensive review of malaria, <em>Malariology. A Comprehensive Survey of all Aspects of this Group of Diseases from a Global Standpoint,</em> was published in 1949 in a two volume set edited by Mark F. Boyd with
70 chapters and 1643 pages from 65 contributors <span class="citation">[<a href="#ref-BoydMF1949MalariologyComprehensive">33</a>]</span>.
Almost 40 year later, 1988, the second comprehensive review of malaria was published in another two volume set, <em>Malaria: Principles and Practice of Malariology,</em>
edited by Walter H Wernsdorfer and Sir Ian McGregor; this set had 57 chapters and 1818 pages from 68 contributors, <span class="citation">[<a href="#ref-WernsdorferWH1988MalariaPrinciples">34</a>]</span>.
Another 40 years has passed, and it is almost time for an update.</p>
<p>This book is a primer on mathematical models to support robust analytics for malaria policy (RAMP).
It covers malaria epidemiology, mosquito ecology, human demography, and malaria transmission dynamics and control with a focus on the mathematical theory and models that have been developed over the past century.
While this book will cover many of the topics in those two-volume sets, it is focused more narrowly on introducing the mathematical study of malaria that started with Ross.
The field made some great leaps forward in the 1950s, when Macdonald wrote a series of papers that reviewed decades of field studies and updated Ross’s basic models.
Macdonald’s paper on the sporozoite transformed the quantitative study of malaria transmission by mosquitoes, drawing attention to the importance of mosquito survival.
In his next paper, Macdonald presented a formula for the basic reproductive number for malaria, an idea that almost certainly traces back to Alfred Lotka’s work in human demography.
Macdonald would have known Lotka from his extensive work on Ross’s models of malaria.
The simple mathematical models, now called <em>the Ross-Macdonald model</em>, thus defined basic theory for malaria transmission dynamics and control <span class="citation">[<a href="#ref-SmithDL2012_RossMacdonald">2</a>]</span>.
This book starts with the Ross-Macdonald model, and it covers a rich and wonderful set of models that has grown out of it.
Around 1970, the mathematical study of malaria entered a period of elaboration through the work of Klaus Dietz, Norman TJ Bailey, Joan Aron, Barbara Hellriegel, and others.
Ross was a pioneer in a field that has included important contributions by hundreds of scientists and analysts.</p>
<p>Nowadays, we can describe malaria as a managed, complex adaptive system involving non-linear interactions among mosquitoes, parasites, humans, and the managers. Malaria systems are heterogeneous and locally peculiar in some way: doing the same thing in different places can result in different outcomes. To understand why outcomes of malaria control vary, we need good theory for malaria, including malaria transmission intensity and seasonality, mosquito ecology and behaviors, mosquito and parasite genetics, health systems, and human behaviors. To give advice, we need malaria intelligence – information about these critical factors, and since the systems are peculiar, we will need local information to give tailored advice. We must grapple with questions about malaria that remain poorly understood, and we most offer advice even if there are enormous gaps in data and knowledge. We want to give policy advice that is robust to uncertainty. We will need well organized systems to store and analyze data and to develop intelligence that can help us learn and adapt. In all of these activities, mathematical models of malaria transmission dynamics and control play an important role.
In this book, <em>Applied Malaria Dynamics: Theory and Computation for Robust Analytics and Adaptive Malaria Control</em>, we take a deep dive into dynamical systems models for malaria epidemiology, transmission dynamics, and control. It is designed to serve as an introduction and resource for malaria analysts who seek to use evidence and mathematical models to develop advice about malaria policies. We introduce the material using a modular framework for building malaria models designed to suppport RAMP <span class="citation">[<a href="#ref-WuSL2023SpatialDynamics">15</a>]</span>. Most of the examples use one of two RAMP-branded R packages: one is designed to build and solve systems of ordinary or delay differential equations <a href="https://dd-harp.github.io/ramp.xde/">ramp.xde</a>; and the other supports discrete-time systems <a href="https://dd-harp.github.io/ramp.dts/">ramp.dts</a>. These are further supported by other ramp software packages, including model libraries, and other simulation software that takes a deep dive into mosquito ecology, mosquito dispersal, malaria epidmiology (in the narrow sense). We also hope that the material can be used in scientific research.</p>
<p>To get all this started, we will walk through concepts as they developed over time, which brings us back to Ronald Ross, the study of the prevention of malaria, and the study of epidemics.<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a></p>
<div id="the-quantitative-approach" class="section level2 hasAnchor" number="1.1">
<h2 class="hasAnchor"><span class="header-section-number">1.1</span> The Quantitative Approach<a href="#the-quantitative-approach" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The goal of malaria control is to prevent malaria. In the long-term, the expectation is that malaria will be eliminated from an ever growing list of places, and that it will eventually be eradicated.
All of this revolves around the study of malaria transmission by mosquito populations through blood feeding.</p>
<p>Since malaria is a mosquito-transmitted diseases, malaria control programs need some basic theory to understand how malaria (<em>i.e.</em> any disease that is caused by infection with the parasite) is related to exposure risk, malaria transmission intensity, and the prevalence of infection.
In particular, programs should should have a basic understanding that relates the factors driving malaria in a place, the metrics that we use to measure malaria, mosquito population densities and bionomics, and the actions taken by malaria control programs.</p>
<p>A vision for doing all this was articulated by Ross in the first decade of studying malaria transmission.
Ross was not the only one to grapple with the complex, multi-factorial nature of malaria transmission and vector control, but what set him apart was his attempt to use of mathematics to illustrate his ideas about malaria.
We will use Ross’s writings throughout this chapter to introduce the nature of the challenges of managing malaria control.
With the benefit of decades of research and cheap high-speed computing, we are in a better position to fulfill that vision than Ross ever could have.</p>
<p>At the end of this chapter, we make some attempt to put Ross into a broader historical narrative.</p>
<hr />
<p>In 1899, Ross announced a new phase of his career in a pair of essays on <em>exterminating</em> or <em>extirpating</em> malaria through mosquito control <span class="citation">[<a href="#ref-RossR1899ExterminationMalaria">35</a>,<a href="#ref-RossR1899InauguralLecture">36</a>]</span>. Ross’s initial focus was on larval source management:</p>
<blockquote>
<p><em>…in order to eliminate malaria wholly or partly from a given locality, it is necessary only to exterminate the various species of insect which carry the infection. This will certainly remove the malaria to a large extent and will almost certainly remove it altogether. It remains only to consider whether such a measure is practical <span class="citation">[<a href="#ref-RossR1899ExterminationMalaria">35</a>]</span>.</em></p>
</blockquote>
<p>Over the decade, Ross began to use quantitative concepts to understand some very basic questions. Ross was interested in using mathematics to help him reason through problems.
Among Ross’s early writings, we find a question posed in 1902, in <em>Mosquito Brigades and How to Organise Them</em> <span class="citation">[<a href="#ref-RossR1902MosquitoBrigades">37</a>]</span>:</p>
<blockquote>
<p>It may now be asked, what percentage of diminution in mosquito-borne diseases may be expected to follow a given percentage of reduction in the number of mosquitoes? I regret that I cannot as yet give any actual statistics on the point, but we may perhaps attempt an estimate on <em>a priori</em> grounds. We ask, are we to expect a decrease in the same ratio as the decrease in the number of mosquitoes; or in a dupblicate ratio? The disease will probably diminish in a duplicate ratio? —pp. 56 in <span class="citation">[<a href="#ref-RossR1902MosquitoBrigades">37</a>]</span></p>
</blockquote>
<p>Ross was thus trying to develop quantitative intuition to establish reasonable expectations about malaria transmission and the responses to mosquito control. His guess was that the responses should be non-linear because two bites are required for transmission – one to infect a mosquito and another to transmit it back to humans. In paragraph that follows, Ross explains what he meant by a <em>duplicate ratio.</em></p>
<blockquote>
<p>Now, if we reduce the number of mosquitoes in the locality by one-half, the mosquito bites also will be reduced by one half; and, consequently, only half as many people will now become infected as was formerly the case. But, since the mosquitoes themselves are infected by biting previously infected persons, the percentage of infected mosquitoes … will also be reduced in its turn, because the insects will now find fewer infected persons to bite. Hence, ultimately, the number of infected persons in the locality will be reduced by much more than one-half. In fact, we may perhaps assume that the number of infected persons will be reduced to one-quarter, that is, in the duplicate ratio of the percentage of reduction of the mosquitoes. —pp. 56 in <span class="citation">[<a href="#ref-RossR1902MosquitoBrigades">37</a>]</span></p>
</blockquote>
<p>While Ross was right that there should be a non-linearity, his quantitative logic failed when he tried to use it without going the rigorous process of developing and analyzing a mathematical model.
Using mathematical models, we would now argue that, in fact, the expected reduction varies from place to place.
The response would depend on the intensity of transmission before doing any control, which scales linearly with the density of mosquitoes.
When transmission is very intense, halving mosquitoes would scarcely change the fraction of humans infected.
In some places, halving mosquitoes might be enough to end local malaria transmission. If malaria transmission were sustained through malaria importation, then Ross’s answer would not be too far off.</p>
<p>Despite getting the logic wrong – or at the very least, underestimating the complexity of the question – Ross was asking relevant questions.
In this case, we was asking about <em>scaling relationships</em> in malaria transmission and their causes.
The search for an <em>a priori</em> approach would eventually lead to development of his first mathematical model for malaria transmission in 1908, in <em>Report on the Prevention of Malaria in Mauritius</em> <span class="citation">[<a href="#ref-RossR1908">17</a>]</span>. A clear basis for giving an answer would finally come when Lotka analyzed Ross’s models in 1923 <span class="citation">[<a href="#ref-LotkaAJ1923part1">38</a>–<a href="#ref-LotkaAJ1923part5">41</a>]</span>, and in Macdonald’s analysis of the sporozoite rate <span class="citation">[<a href="#ref-MacdonaldG1952Sporozoite">42</a>]</span> and his formula for the basic reproductive number for malaria <span class="citation">[<a href="#ref-MacdonaldG1952R0">43</a>]</span>. The study of these scaling relationships is still evolving.</p>
<p>Ross also discused response timelines. He was aware of differences in duration of infection for yellow fever, lypmhatic filariasis, and malaria. Compared to yellow fever, the responses to vector control should be slow because,</p>
<blockquote>
<p>…the parasites remain alive for years after the first moment of introduction by the mosquito…. We must not, therefore, expect to see malaria vanish, as if by magic, immediately after our campaign against mosquitoes. – pp. 53 of <span class="citation">[<a href="#ref-RossR1902MosquitoBrigades">37</a>]</span></p>
</blockquote>
<p>In all this, Ross was asking thus questions about what would determine the outcomes of malaria control.</p>
<p>What other factors could affect what was observed? One of the arguments against the “mosquito hypothesis” had been that malaria was sometimes found in places where there was no evidence for malaria transmission. In <em>The Prevention of Malaria,</em> Ross spends a great deal of time discussing the importance of imported malaria. In the chapters that follow, we will follow this idea through to its logical conclusion.</p>
</div>
<div id="larval-source-management" class="section level2 hasAnchor" number="1.2">
<h2 class="hasAnchor"><span class="header-section-number">1.2</span> Larval Source Management<a href="#larval-source-management" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The interest in mosquito populations originated from an academic discussion, in 1904, that critiqued a larval source management program in Mian Mar. One fact that clearly irked Ross was the lack of any good method for measuring mosquito populations accurately. The problem at hand:</p>
<blockquote>
<p>Suppose that we have to deal with a country of indefinite extent, every point of which is equally favorable to the propagation of gnats (or of any other animal); and suppose that every point of it is equally attractive to them as regards food supply; and that there is nothing, such for instance as steady winds or local enemies, which tends to drive them into certain parts of the country.- Then the density of the gnat population will be uniform all over the country. Of course, such a state of things does not actually exist in nature; but we shall nevertheless find it useful to’ consider it as if it does exist, and shall afterwards easily determine the variations from this ideal condition due to definite causes. Let us next select a circumscribed area within this country, and suppose that operations against the insects are undertaken inside it, but not outside it. The question before us is the following: How far will these operations affect the mosquito density within the area and immediately around it?</p>
</blockquote>
<p>Ross’s question was:</p>
<blockquote>
<p>How large must that radius be in order to render the center entirely mosquito-free?</p>
</blockquote>
</div>
<div id="malaria-population-dynamics" class="section level2 hasAnchor" number="1.3">
<h2 class="hasAnchor"><span class="header-section-number">1.3</span> Malaria Population Dynamics<a href="#malaria-population-dynamics" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>He recognized that prevalence could change, and that what set its value was a balance between two processes. The quantitative logic looks like this:</p>
<p><span class="math display">\[
\left[
\begin{array}{rcl}
\mbox{Fraction Infected Today} &amp;=&amp; \mbox{Fraction Infected Yesterday} \;\; -\\
&amp;&amp; \mbox{Cleared Infections} \;\; + \\
&amp;&amp; \mbox{Fraction Uninfected that Got Infected}\\
\end{array} \right]
\]</span></p>
<p>This description ignores malaria importation, infected people who died, infected people who emigrated, and infected people who immigrated. The model is neither comprehensive nor perfect. It was a starting point.</p>
<p>For short-lived mosquitoes, we assume they are much more likely to die than to clear infections. So for mosquitoes, the process is slightly different:</p>
<p><span class="math display">\[
\left[
\begin{array}{rcl}
\mbox{Fraction Infected Today} &amp;=&amp; \mbox{Fraction Infected that Survived} \;\; -\\
&amp;&amp; \mbox{Fraction Uninfected that Got Infected}\\
\end{array} \right]
\]</span></p>
<p>What’s important here is that infectious mosquitoes are infecting people when they bite, and infectious people are infecting mosquitoes when the mosquito blood feeds.</p>
<p>In planning and evaluating malaria control, it was important to develop some kind of expectations about where and when to do malaria control, what types of malaria control are likely to work best, and so on.</p>
<p>Despite all the focus on malaria, transmission Ross’s first mathematical model of malaria was about mosquito populations.</p>
<p>In 1911, Ross formulated a model (his second) as a system of two ordinary differential equations. The model appeared in the <span class="math inline">\(2^{nd}\)</span> edition of <em>The Prevention of Malaria</em> <span class="citation">[<a href="#ref-RossR1911Book">1</a>]</span>, and it also appeared in <em>Nature</em> <span class="citation">[<a href="#ref-RossR1911Nature">32</a>]</span> in this form:</p>
<p><span class="math display">\[
\begin{array}{rl}
dz/dt &amp;= k&#39; z&#39; (p-z) + q z \\
dz&#39;/dt &amp;= k z (p&#39;-z&#39;) + q&#39; z&#39; \\
\end{array}
\]</span></p>
</div>
<div id="measuring-transmission" class="section level2 hasAnchor" number="1.4">
<h2 class="hasAnchor"><span class="header-section-number">1.4</span> Measuring Transmission<a href="#measuring-transmission" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Through the first half of the 1900s, Ross promoted malaria control and malaria research.
He was a key player in public debates about malaria control and he launched a center to study malaria transmission that is still active today <span class="citation">[<a href="#ref-SmithDL2012_RossMacdonald">2</a>,<a href="#ref-BockarieMJ1999ItAll">44</a>]</span>.
He engaged in public debates about malaria control hosted by the <em>British Medical Journal</em>, and he published a book, <em>Mosquito Brigades and How to Organize Them</em> <span class="citation">[<a href="#ref-RossR1902MosquitoBrigades">37</a>]</span>.
The end of this phase of his career was marked by publication of the <span class="math inline">\(2^{nd}\)</span> edition of <em>The Prevention of Malaria</em> in 1911 <span class="citation">[<a href="#ref-RossR1911Book">1</a>]</span>.</p>
<p>This phase of Ross’s career is highly relevant to our study of <strong>Applied Malaria Dynamics</strong> because it was the beginning of a rigorous approach to malaria control including development of the first three mathematical models describing malaria transmission dynamics or control <span class="citation">[<a href="#ref-RossR1911Book">1</a>,<a href="#ref-RossR1905LogicalBasis">16</a>,<a href="#ref-RossR1908">17</a>,<a href="#ref-RossR1911Nature">32</a>]</span>.
Many of the early attempts to control malaria were implemented by the British Military. In the first few years, there were some successes, but there were also some failures <span class="citation">[<a href="#ref-RossR1907PreventionMalaria">45</a>]</span>.
Heterogeneity in the responses to malaria control efforts seem to have turned Ross to mathematics.
In 1904, he presented a paper at the International Congress of Arts and Science in St. Louis, Missouri that applied diffusion models to larval source management (published also in <em>Science</em><span class="citation">[<a href="#ref-RossR1905LogicalBasis">16</a>]</span>).
Ross’s transmission models appear in publications that emerged from consulting with national malaria programs in Mauritius and Greece <span class="citation">[<a href="#ref-RossR1908">17</a>,<a href="#ref-RossR1909">46</a>]</span>.
While he was writing about the nuts and bolts of control, he was also grappling with mathematical formulas that could help him understand malaria control quantitatively.
How would reducing mosquito densities change the prevalence of malaria?
Was there a critical population density of mosquitoes required to sustain transmission?
The result was the first mathematical model to describe malaria transmission dynamics <span class="citation">[<a href="#ref-RossR1908">17</a>]</span>.
A short time later, Ross would reformulate the model in the <span class="math inline">\(2^{nd}\)</span> edition of his book, <em>The Prevention of Malaria</em> <span class="citation">[<a href="#ref-RossR1911Book">1</a>]</span>.
He also published it in Nature <span class="citation">[<a href="#ref-RossR1911Nature">32</a>]</span>. For Ross, the mathematical models were a logical next step towards trying to understand malaria control in rigorous quantitative terms.</p>
</div>
<div id="the-study-of-epidemics" class="section level2 hasAnchor" number="1.5">
<h2 class="hasAnchor"><span class="header-section-number">1.5</span> The Study of Epidemics<a href="#the-study-of-epidemics" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>By 1915, when Ross turned his attention to the broader study of epidemics, his intent was to establish a new discipline, which he called <em>a priori pathometry</em>.
He set out to establish the mathematical foundations for the study of epidemics <span class="citation">[<a href="#ref-RossR1915AprioriPathometry">47</a>,<a href="#ref-RossR1916ApplicationTheory">48</a>]</span>.
In his 1916 paper, he wrote</p>
<blockquote>
<p><em>It is somewhat surprising that so little mathematical work should have been done on the subject of epidemics, and, indeed, on the distribution of diseases in general.</em></p>
</blockquote>
<p>The case for using mathematics had grown stronger as a result of a scientific revolution caused by invention of the light microscope that established a germ theory of disease, which included Laveran’s discovery in 1880. Even without knowing that bacteria, viruses, and parasites were transmitted among hosts causing disease, <em>contagion</em> was an impossible concept to ignore. Some mathematical work had already been done on infectious diseases, including a few models. It’s not clear whether Ross was aware of Daniel Bernouli’s mathematical model of small pox <span class="citation">[<a href="#ref-BernoulliD2004AttemptNew">49</a>,<a href="#ref-BacaerN2011DanielBernoulli">50</a>]</span>, or PD En’ko’s discrete time models for measles <span class="citation">[<a href="#ref-DietzK1988FirstEpidemic">51</a>]</span>.
Ross may have known about those models, but he certainly didn’t cite them.
Regardless, the mathematical study of infectious diseases in populations was, at that point in time, underdeveloped.
Ross wrote:</p>
<blockquote>
<p><em>…the principles of epidemiology on which preventive measures largely depend, such as the rate of infection, the frequency of outbreaks, and the loss of immunity, can scarceley ever be resolved by any other methods than those of analysis.</em></p>
</blockquote>
<p>Ross proposes a rudimentary three-tiered classification system for epidemics based on the patterns of fluctuating incidence with exemplars: 1) leprosy and tuberculosis; 2) measles and malaria; 3) plague and cholera.</p>
<blockquote>
<p><em>To what are these differences due? Why indeed should epidemics occur at all, and why should not all infectious diseases belong to the first group and not always remain at an almost flat rate?</em></p>
</blockquote>
<p>In 1917, he teamed up with Hilda Hudson, a Cambridge mathematician, to finish the first major contribution to mathematical epidemiology, or what he called <em>a priori pathometry</em> <span class="citation">[<a href="#ref-RossR1917AprioriPathometry2">52</a>,<a href="#ref-RossR1917AprioriPathometry3">53</a>]</span>.
Over 18 years (1899-1917), Ross’s ideas laid a solid foundations for the modern study of malaria transmission and theory of malaria control <span class="citation">[<a href="#ref-SmithDL2012_RossMacdonald">2</a>]</span>.</p>
</div>
<div id="mathematical-epidemiology" class="section level2 hasAnchor" number="1.6">
<h2 class="hasAnchor"><span class="header-section-number">1.6</span> Mathematical Epidemiology<a href="#mathematical-epidemiology" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Despite the heroic efforts of Ross and Hudson on <em>a priori pathometry</em>, they were missing a key element in the modern mathematical study of epidemics. In 1920, a new mathematical model was published by Martini, which described epidemics in which recovery from infection was followed by lifelong immunity.
Martini’s model would be explored in great detail in a series of papers by Kermack, and Mckendrick.
In modern language, Ross’s models would be studied as SIS compartmental models, while Martini’s equations would be called SIR compartmental models.
The two systems of equations have strikingly different features, and so do the kinds of epidemics they mimic.</p>
<p>In Ross’s model, a person would become susceptible to infection after recovering, so a person could be infected many times, and prevalence is a naturally meaningful statistic. In fact, Ross’s equations can be solved exactly: after Ross published the equations in Nature in 1911 <span class="citation">[<a href="#ref-RossR1911Nature">32</a>]</span>, Alfred Lotka published a closed-form solution in 1912 <span class="citation">[<a href="#ref-LotkaAJ1912Nature">54</a>]</span>.</p>
<p>There is no closed form solution to the SIR model, and prevalence is an ephemerally changing quantity.
The natural summary statistic for SIR epidemic is called <span class="math inline">\(S_\infty\)</span>, the portion remaining uninfected asymptotically.
In simple epidemics – an epidemic in a single population with no replenishment of susceptible hosts – the dynamics differ depending on how many cases that first case would tend to generate, called <span class="math inline">\(R_0\)</span>.
If <span class="math inline">\(R_0 &lt; 1\)</span>, then there is a closed form solution: <span class="math inline">\(S_\infty = S_0 - I_0(1-R_0)^{-1}\)</span>.
If that first case would generate more than one other case, and the number of cases would initially rise to a peak, when each new case would generate exactly one case.
Thereafter, the number of cases would decline.
The time course of an SIR epidemic does not have a closed form solution.</p>
<p>The differences between SIS and SIR models would provide a mathematical basis for answering Ross’s question and point to an important role for the concept of population immunity.
In SIS models, there is no immunity, so prevalence tends to approach an endemic equilibrium with very little tendency to cycle.
When susceptible populations the SIR models are replenished by birth or migration, there is a natural tendency to cycle.</p>
<p>The SIS model is a useful starting point, but Ross was aware of evidence that immunity to malaria would develop in humans.
The role of immunity is more complex, but a critical feature is that infection with one parasite would not prevent reinfection with another.
In places where exposure rates were high, reinfection – also called <em>superinfection</em> – was quite common.
The first model of malaria that was <em>not</em> an SIS model – published by George Macdonald but relying on mathematics by P. Armitage –
considered a role for <em>superinfection,</em> or reinfection of susceptible individuals.
In models with superinfection, an interesting statistic is the multiplicity of infection (MoI).
A useful discussion of this superinfection model and its mathematical flaws was written by Paul EM Fine <span class="citation">[<a href="#ref-FinePEM1975SuperinfectionProblem">55</a>]</span>.
What is, perhaps, more important is that superinfection in malaria facilitates sexual recombination for the parasites.
Sexual recombination facilitates development of parasite diversity, which could partly explain population immunity in malaria.</p>
<p>Sticking with Ross’s core challenge of how to study epidemics mathematically to understand the tendency to cycle, we must acknowledge
the complex natural history of population immunity. In malaria,
a model for the mathematical talents of Klaus Dietz combined with the epidemiological skills of Louis Molineaux to produce the first model of population immunity to malaria.
That model described infection dynamics in a population with partial immunity.
In malaria epidemiology, a core challenge is the problem of malaria immunity and its relationship to parasite genetic diversity, disease, and infectiousness.
In the mathematical study of malaria epidemiology, the formulation of adequate models is among the most pressing and most difficult to address.
Measles and a few other pathogens are well-described by the SIR model.
For these acute immunizing infections, infection is followed by a life-long immunity.
The dengue viruses has four (or maybe five) functionally distinct virues with complex patterns of cross immunity.
For other pathogens, population immunity is undermined when immune-escape variantes evolve in the pathogen populations.
For the influenza viruses and the coronavirus descendents of the viruses that sparked the global COVID-19 epidemic, escape variants arise at a rate that is high enough to sustain yearly outbreaks.</p>
<p>Adding to the complexity, immunity is not the only factor affecting a tendency to cycle.
For arthropod-transmitted pathogens, fluctuations in arthropod population densities and behaviors driven by weather affect trasmission rates.
For directly transmitted pathogens, humidity and survival in the environment and the tendency for populations to congregate amplifies transmission.
In malaria, fluctuating mosquito one factor that must <em>a priori</em> force transmission, and since population immunity probably has a weak effect,
seasonal malaria is largely driven by fluctuating mosquito populations.
In SIR models, seasonal fluctuations are sustained by an interaction between environmental factors and the depletion of susceptible individuals.</p>
</div>
<div id="approaching-complexity" class="section level2 hasAnchor" number="1.7">
<h2 class="hasAnchor"><span class="header-section-number">1.7</span> Approaching Complexity<a href="#approaching-complexity" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Malaria is complex and heterogeneous, which makes it difficult to study and manage. A core challenge in both science and policy is the availability of information. Mathematical models can help us understand and analyze all that complexity and make informed decisions, despite the data gaps.</p>
<p>While this book is about applied dynamics, the approach is eclectic. It relies heavily on conventional statistical analysis. An axiom we espouse is that two inferential approaches are better than one. This point of view was prominent in the early study of epidemics, tracing back to both Ross and Browne <span class="citation">[<a href="#ref-FinePEM1975RossPriori">56</a>]</span>. After Ross spent a decade studying malaria control, he realized the difficulty of understanding malaria epidemics, so he argued for an integrated approach. About the study of epidemics, he wrote</p>
<blockquote>
<p><em>The whole subject is capable of study by two distinct methods which are used in other branches of science, which are complementary of each other, and which should converge towards the same results – the <strong>a posteriori</strong> and the <strong>a priori</strong> methods. In the former we commence with observed statistics, endeavor to fit analytical laws to them, and so work backwards to the underlying cause (as done in much statistical work of the day); and in the latter, we assume a knowledge of the causes, construct our differential equations on that supposition, follow up the logical consequences, and finally test the calculated results by comparing them with the observed statistics.</em></p>
</blockquote>
<p>More than a century later, it is much easier to use computational tools to fulfill this vision.</p>
<p>While this lays out a useful agenda for <em>understanding malaria,</em> another axiom we espouse is that the process of giving advice about a policy must take on a broader set of challenges.
Policy and science are different in many ways, so there are good reasons why we might want to use different models and methods for basic research and policy analytics.
In policy, decisions <em>must</em> be made in a timely way, and they <em>should</em> use all available evidence, even if it’s weak.
Basic research is epistemologically conservative, by design.
Studies that are published in peer review must be repeatable, and in anticipation of criticism, the scientists aim to do things so well that they are unassailable.
This usually has the effect of narrowing and controlling the conditions under which the study was conducted.
When we operate in policy settings, we <em>should</em> design our studies in a different way, and we will thus need to deal with the uncertainty differently.
The studies that inform policies will need to take an approach that is broader – the models should be realistic enough to address the question of interest.
Such studies will often need to make compromises and decisions that are poorly informed by the evidence, which raises the question of how much a policy maker could trust it.
One strategy for making policies trustworthy is to repeat the supporting analysis using every reasonable approach, so that we can be reasonably sure our policy recommendations would not change.
The idea of fully propagating uncertainty is the essential feature of <em>robust analytics.</em>
If we make the effort, we can identify key sources of uncertainty, identify priority data needs, and collect new data that could help resolve some of the most important sources of uncertainty.
Building models to do this is challenging for practical reasons, and it requires drawing heavily on basic research.
In giving advice, we must give different weights to the uncertainty than we would in research.</p>
<p>In basic research, we develop mechanistic models to understand malaria as a biological process. In malaria epidemiology, the states and parameters describe infection, immunity, infectiousness, disease, and drug taking in response to exposure. Scientists focus on basic biological mechanisms in order to understand differences in malaria across spectrum of transmission. Immunity and drug-taking are important factors to consider, but it may be that differences in epidemiology and disease across settings arise from differences in the local parasite populations. The models are a way of summarizing knowledge in a quantitative form – something like a complex hypothesis. A test of a model’s adequacy is whether it can describe malaria accurately after accounting for differences in drug taking patterns and pattern of exposure.</p>
<p>We study mosquito ecology and blood feeding to understand malaria transmission and develop theory for malaria control. Transmission models couple parasite infection dynamics in humans and mosquitoes through blood feeding. Mosquito populations are shaped by the aquatic habitats for immature mosquito populations. These habitats are standing water bodies, and they are shaped by topography, hydrology, land use, and the water chemistry, which is affected by surrounding rocks, soils, vegetation and pollution. These habitats are filled (exogenously forced) by rainfall and after some eggs are laid, the mosquito dynamics are affected by crowding, predation, and other endogenous dynamics. Larval development and parasite development rates are modified by temperature. Adult mosquito activity rates are affected by temperature, relative humidity, and vector control. Indoor residual spraying (IRS) kills mosquitoes when they rest on a sprayed surface, usually after blood feeding or during the process of searching for a host. Insecticide treated nets (ITNs) protect humans from biting and kill some mosquitoes. By reducing the availability of potential blood hosts, nets can slow blood feeding in some contexts. Larval source management (LSM) reduces immature population densities.</p>
<p>By studying mosquito ecology and malaria transmission dynamics, we can start to understand malaria as a changing baseline that has been modified by malaria control. This is the problem confronted daily in malaria programs, but dealing with the evidence requires having the tools available to synthesize data describing different parts of malaria. The models help translate evidence into information that can be used to make decisions, to make strategic plans, and to mark progress against national plans. The models encapsulate information about transmission in context, so it is possible to study how malaria persists in a place over time, and how various factors have modified (or could modify) mosquito population dynamics and blood feeding and thereby suppress transmission. Transmission models help us to set intervention coverage targets based on an understanding of malaria connectivity to surrounding regions and local thresholds.</p>
<p>In policy, we use these models with the expectation that – if we fit the models by adjusting parameters that affect how malaria works in some particular place – they <em>should</em> help us understand transmission in some particular context and make good decisions about what to do.</p>
<p>Frustratingly, the heterogeneity and the complexity conspire against us. We would like to be sure about how malaria works across settings before we start using the models to stratify populations, tailor interventions to context, or targeting the interventions. Instead, we must admit that we don’t know everything we’d like to, and we probably never will. We must proceed with policy without having satisfactory answers to some basic questions. In policy, we will use the models to evaluate the consequences of having missing information, but we will also use the models to help us prioritize missing data so we can fill in the gaps. What missing data would reduce our uncertainty about what to do about malaria? How do we fill the critical knowledge gaps.</p>
<p>To understand malaria or to give policy advice, we must start simple and then add complexity, layer on layer. To deal with missing information, we start with generic models, and then add details to address concerns about some of the details that we hope to identify by studying the systems as we intervene. This approach – starting simple and then layering on complexity – makes it possible to learn as we go. A question is when it stops making sense to add realism to a model. A model that it too simple and abstract might help us understand the basic dynamics and give generic advice, but we would question the model’s adequacy if it could not reproduce the patterns we cared about in some particular place at some particular time. As a rule of thumb, a model should be just complex enough to <em>describe</em> the patterns we care about and <em>weigh</em> the relevant options to give advice. Practically speaking, it’s hard to know you’ve gone far enough unless, at some point, it’s clear that you’ve gone a bit too far.</p>
<p>Over the past few years, we developed a new framework for building models that would make it possible to start simple and then build models of malaria transmission at any level of complexity. We wanted to be able to build in realism by adding complexity one feature at a time. Through this process we can create nested, hierarchical models in branching chains. At the ends of the chains, we might find highly realistic models that are, perhaps, overfit. (The cautions against overfitting play out differently in policy given the urgency of acting in a timely way, but it is also possible to go out and collect new data.) We call the framework’s ability to do this <strong>scalability</strong> and the resulting swarms have <strong>scalable complexity.</strong> The iterative attempt to make plans, weigh evidence, quantify uncertainty, gather new data to reduce uncertainty, and then restart the annual cycle, is called <strong>adaptive malaria control.</strong></p>
<p>To make this possible, we needed a way of building models that would keep the focus on the policy questions and on a dialogue between malaria managers and the analytical support team. We thus sought to design modular software with <em>plug-and-play</em> functionality and a high degree of structural flexibility. We needed the framework to be extensible. After making a lot of mistakes, the primary design phase is over, and the algorithms have been published in two software packages. We are currently extending the library of <em>base models</em>, which includes some simple or classical models that are instructive or of historical interest. We are also fine-tuning the design requirements for models as we develop protocols that streamline fitting models to data. The software avoids the mistakes we made over the past few years, reuses models, and streamlines the model building process. We hope this software has dramatically lowered the costs of building and analyzing these complex, realistic models.</p>
<p>In malaria epidemiology (narrowly defined as a study of infection and disease in humans), the relationship between exposure, infection, immunity, disease, and infectiousness changes in populations as they age, and it is affected by drug taking. This picture grows more complex as we consider intervening with vaccines or monoclonal antibodies, or as we look at interactions with anemia, nutritional status, and human genetics. Our models need to interface with data from clinical settings and research, so they will need to consider diagnostics, parasite counts, detection, and transmission. Combining these factors can give rise to an overwhelming amount of complexity. Later, we will introduce new models and show how it possible to simplify all this complexity and make sense of malaria.</p>
<p>We are interested in using these models to guide policy, which requires both solid computation and good communication. In this book, we lay a foundation for understanding the complexity by studying some simple compartmental models. We will review classical queuing models for superinfection and the multiplicity of infection (MoI); new models for the age of infection (AoI) or stage of infection (SoI); immunity; parasite densities, fever, disease, and detection; gametocytes and transmission, and drug taking. To end up with models that can handle all the complexity, we build probabilistic models that combine these factors. In doing so, we find that we can do some powerful analysis, and we can map the states in these models onto outcomes that matter for research and policy: test positivity, parasite counts, infectiousness, and disease. With patience, we can combine these factors and develop a framework for understanding malaria in populations that match the features of individual-based simulation models. We end up with a sensible understanding malaria epidemiology as ontogeny – development of immunity as a part of an organisms history. We back this view with some very usable models that capture the changing character of malaria in cohorts of humans as they age.</p>
<p>We are interested in understanding malaria control in context, which requires delving into mosquito ecology and behavior. In this book, we start with a simple model for mosquito ecology and parasite infection dynamics in mosquitoes. We add aquatic population dynamics, mosquito population regulation, and exogenous forcing by weather. Later, we worry about adult mosquito behavioral states such as mating, sugar feeding, and egg laying. We introduce the concept of resource availability, and we develop an understanding of mosquito search and movement in response to resource availability. We take some deep dives to understand how mosquito spatial dynamics work at a fine spatial grain, and then we scale up to understand mosquito populations on landscapes.</p>
<p>At first, we describe mosquito blood feeding and transmission with a few simple parameters. Later, we develop a new model for mosquito blood feeding in a dynamically changing host population with parameters that allow host strata to be more or less available. We also modify our understanding of heterogeneous exposure to biting. We develop a methods for modeling environmental heterogeneity, heterogeneous exposure by age, and a generalized way of handling <a href="Frailty">failty</a>– other sources of heterogeneous biting – through stratification.</p>
<p>We must take a detour to understand how to handle the effects of temperature on the parasite’s extrinsic incubation period (EIP). We need a way of dealing with mosquito survival and dispersal through the EIP. This problem has been effectively solved.</p>
<p>To round out this picture, we need a way of dealing with other aspects of human ecology that affect malaria transmission dynamics, including human mobility, human demography, bed net usage, adherance to drugs, and care seeking. Differences among humans call for a synthesis of studies that have identified traits that affect malaria, stratification, and simulation to identify useful ways of propagating the heterogeneity through analyses.</p>
<p>To go along with a theory of transmission, we need a theory of control. We compute effect sizes and evaluate area effects. We develop a generalized concept of effect modification that considers the total effect of a single unit of control. We modify basic processes by including the effects of vector control and mass medical interventions (<em>e.g.</em> seasonal malaria chemoprotection, mass drug administration, vaccines, and monoclonal antibodies). Relying on behavioral state models and the concept of resource availability, we develop a models for integrated vector control.</p>
<p>This is a book about how to do the math that is required for robust analytics for malaria programs. The goal is to use all the data available, but especially the data generated by malaria programs, to paint a clear picture of malaria transmission as a changing baseline that has been modified by control.</p>
</div>
<div id="historical-notes" class="section level2 hasAnchor" number="1.8">
<h2 class="hasAnchor"><span class="header-section-number">1.8</span> Historical Notes<a href="#historical-notes" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="the-light-microscope" class="section level3 hasAnchor" number="1.8.1">
<h3 class="hasAnchor"><span class="header-section-number">1.8.1</span> The Light Microscope<a href="#the-light-microscope" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="mathematical-epidemiology-before-ross" class="section level3 hasAnchor" number="1.8.2">
<h3 class="hasAnchor"><span class="header-section-number">1.8.2</span> Mathematical Epidemiology Before Ross<a href="#mathematical-epidemiology-before-ross" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We note that contemporary scholars of Ross, including Brownlee and Lotka, were also applying mathematics in human demography and health.
Ross’s mathematical models of malaria transmission were also not the first models for the transmission of an infectious disease.
First was Bernoulli’s model of smallpox, and P’Enko had published a model for flu a few years before.
Ross was</p>
<p>Our philosophy has been to design a framework for model building that can be used by programs.
In this context, <em>model building</em> means designing ensembles of models. The next step involves applying a set of tools to computational tasks that are beyond what our brains could do. To accomplish our goals, we need more than the mathematical framework. We need to be able to implement and compute models. This requires new software.</p>
<p>The software is structured around three major dynamical components and two interfaces. The dynamical components are: 1) the humans and malaria epidemiology, including the effects of treating malaria with drugs; 2) adult mosquito ecology, behavior and infection dynamics; and 3) aquatic mosquito ecology. Malaria transmission by mosquito populations, including the <span class="math inline">\(2^{nd}\)</span> and <span class="math inline">\(3^{rd}\)</span> dynamical component are set up to consider the effects of weather and vector control. The first interface links humans, adult mosquitoes, and parasites to describe parasite transmission through mosquito blood feeding and human exposure to infective mosquito populations. The second interface links adult and mosquito populations through egg laying and emergence. Within each component and interface, there are multiple sub-domains, and there are built in design features to deal with heterogeneity and other features for malaria control. After a 140 years of studying malaria, there’s a lot of detail that could be important in some way.
<!-- Part of what we need to do is sort through all that detail to find what is most relevant. --></p>
<!-- We have organized the concepts in this book around a narrative that allows us to introduce the core concepts -- those that make modular computation possible -- in an order that minimizes the need to draw on unfamiliar concepts. We start with the Ross-Maconald model, but our next task is to explain the new model for mosquito blood feeding.   -->
<p>The software we have developed is meant to lower the costs of building and using models. We want programs to be focused on the decisions, the data, the concepts, and the analysis. As a metaphor, some students learn a numerical method for approximating <span class="math inline">\(\sqrt{2}\)</span> in school, but after learning it once, they stop worrying about <em>how</em> it is computed and they punch buttons into a calculator. Knowing how to compute something is sometimes useful, but worrying about how to compute it each time would interrupt the process that called for computing it. Instead, we punch the formula into a scientific calculator or any software that does computation confident that the machine knows how to do it. In applying models, the same kind of logic applies. People need to understand the concepts, but like a calculator, the tools should hide the technical details that don’t add to a discussion. The software we have developed is a reliable interface for calculations designed to support policy.</p>
<p>To learn how to use that software, we need to get through a lot of material. The background material in the following presentation is fairly sparse. We are trying to introduce just <em>enough</em> mathematics to teach users the critical concepts so they know what the software can do. We assume that the work will be done by teams that include a few people who understand the mathematics, who can guide others through the process.</p>
<p>All of this sounds very complex, but we must start with something simple and layer on complexity in an ordered way. The first model we present is a Ross-Macdonald model.</p>
<!-- To fill in some of the gaps and technical, we have written (or can write) vignettes. On occasion, the text includes links to these vignettes for those who might find them useful. Please send suggestions about new vignettes to [smitdave@gmail.com](mailto:smitdave@gmail.com). -->
<!--chapter:end:101-Prevention-of-Malaria.Rmd-->
</div>
</div>
</div>
<div id="basic-malaria-models" class="section level1 hasAnchor" number="2">
<h1 class="hasAnchor"><span class="header-section-number">2</span> Basic Malaria Models<a href="#basic-malaria-models" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p><em>Basic malaria models as deterministic or stochastic systems of difference or differential equations</em></p>
<hr />
<p>As Ross was planning malaria control activities, he sought to develop mathematics for support to help him set rational expectations about the likely outcomes of control.
Given his interests in malaria metrics, he sought to understand why malaria prevalence differed from place to place.
To explain these differences, so he developed mathematical models that described infection and the loss of infection, the processes affecting how malaria prevalence would change over time.</p>
<p>Malaria infections in two host populations – humans and mosquitoes – are connected through mosquito blood feeding, so malaria transmission works as an integrated system. The process looks something like the following diagram.</p>
<hr />
<div class="float">
<img src="Figures/LifeCycleModel.png" alt="Infection Dynamics – The parasite life-cycle involves a dynamic process in two host populations, and it requires blood meals. Uninfected mosquitoes get infected when they take up parasites after blood feeding on an infected human. Uninfected humans become infected by the mosquitoes transmitted in saliva when a mosquito bites, prior to blood feeding." />
<div class="figcaption"><strong>Infection Dynamics</strong> – The parasite life-cycle involves a dynamic process in two host populations, and it requires blood meals. Uninfected mosquitoes get infected when they take up parasites after blood feeding on an infected human. Uninfected humans become infected by the mosquitoes transmitted in saliva when a mosquito bites, prior to blood feeding.</div>
</div>
<hr />
<p>This graph is the basis for causal theory for malaria parasite propagation in populations, but students of causation might object that the graph describes a cycle and thus it can not be causal.
If we applied the logic more generally, no graph describing any organisms life cycle would be causal, and yet life is undoubtedly the cause of life.
The missing element is time: a life-cycle graph would be directed and acyclic if it had an arrow that traced life in one generation giving rise to life in the next.
To understand this as a causal diagram, we must thus imagine that it describes a dynamical process in populations: infected mosquitoes today are biting and infecting humans tomorrow; and infectious humans today are causing infections in mosquitoes tomorrow when they take a blood meal.
Seen in this way, we can begin to develop a quantitative theory that describes all the factors that determines malaria prevalence in populations.
How does malaria persist in a population?
It persists through the transmission of parasites among hosts during blood feeding.
What factors determine prevalence?
It is a balance between the gain and loss of infection.</p>
<p>To develop a mathematical model, Ross believed that it was possible to write down <em>a priori</em> – or in other words, to formulate mathematical models using quantitative logic – a description of the process.
To write down the model, we must make some assumptions about the process.
We begin with an abstract concept of place – <em>here.</em>
We imagine that populations here are comprised of individual mosquitoes and individual humans, and we are interested in computing the fractions of humans and mosquitoes that are infected.
Since infections don’t last forever, the prevalence of infection in mosquitoes and humans reflects a balance between infections acquired through parasite transmission and the natural loss of infection through parasite clearance or host mortality.
In many places, forces affecting the the balance can be changing; mosquito population density fluctuates over time, for example.
Ross’s equations assumed that transmission by mosquitoes was constant over time, and they focused on <em>local</em> transmission, ignoring exposure elsewhere (<em>e.g.</em> through travel).
This model thus ignores many factors that would be important for planning for control. Ross discussed all these factors, but since he was pioneering a new approach, the models were very simple.</p>
<p>Mosquitoes lived short lives, so the loss of parasites in mosquitoes would mainly occur through mosquito mortality:</p>
<p><span class="math display">\[\begin{equation}
\mbox{MOSQUITOES}
\\ \; \\
\left[
\begin{array}{rcl}
\mbox{Infected Tomorrow} &amp;=&amp; \mbox{Infected Today} \\
&amp;-&amp;\mbox{Infected: Died}\\
&amp;+&amp;\mbox{Uninfected: Got Infected}\\
\end{array} \right]
(\#eq:Mprocess)
\end{equation}\]</span></p>
<p>This description of a process ignores the loss of infection in mosquitoes, and changing mosquito population density.
It ignores the <em>extrinsic incubation period</em> (EIP), the lag between the point in time when a mosquito gets infected and when it becomes infectious.
This basic description of the process does not explicitly address the process that gives rise to uninfected mosquitoes.
The mathematical formulation implies, without stating it explicitly, that each dying infected mosquito gets replaced by an uninfected mosquito emerging from an aquatic habitat.
Otherwise, the mosquito population would declining over time.
Ross was interested in malaria transmission dynamics, so the mosquito ecology was almost invisible.</p>
<p>Humans live long lives, so parasite loss would mainly occur through natural clearance.</p>
<p><span class="math display">\[\begin{equation}
\mbox{HUMANS}
\\ \; \\
\left[
\begin{array}{rcl}
\mbox{Infected Tomorrow} &amp;=&amp; \mbox{Infected Today} \;\; \\
&amp;-&amp; \mbox{Infected: Cleared Infection}\\
&amp;+&amp; \mbox{Uninfected: Got Infected}\\
\end{array} \right]
(\#eq:Hprocess)
\end{equation}\]</span></p>
<p>This description of the process thus ignores human demography, including births, deaths, and migration. The model also ignores a large number of other factors, including superinfection, the complex time course of an infection, immunity, and treatment with anti-malarial drugs. (In Ross’s day, quinine was expensive and difficult to obtain, but it was sometimes used.)</p>
<p>To describe malaria transmission and factors that determine the prevalence of malaria in human populations over time, we formulate mathematical models as dynamical systems.
In the sections that follow, we will formulate dynamical systems in discrete and continuous time, and as a deterministic or stochastic processes.
In the following, we will write down several distinct sets of mathematical equations that follow the basic rules described above:</p>
<ol style="list-style-type: decimal">
<li><p>In Section @ref(dtsRoss), we present two basic deterministic discrete-time systems.</p></li>
<li><p>In Section @ref(sdtsRoss), we present a stochastic discrete-time system;</p></li>
<li><p>In Section @ref(xdeRoss), we present a deterministic continuous-time system;</p></li>
<li><p>In Section @ref(sxdeRoss), we present a stochastic process in continuous-time;</p></li>
<li><p>In Section @ref(mathSpecies), we compare and contrast these four mathematical species.</p></li>
</ol>
<p>As a reminder, we’re not trying to delve too deeply into malaria epidemiology with the models in this chapter.
Instead, this chapter is about trying to develop a toolbox that we can use to investigate malaria transmission dynamics and control.
Our goals are thus to learn the basic elements of different kinds of models, and to develop some basic intuition about the different kinds of models that exist, and how we can think about models as approximations.
Each model is implemented as R code<a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a>
Later, we will start using some R packages that were developed to support robust analytics for malaria policy.
Later, we’ll worry about modifying the assumptions to ensure that we are dealing with the issues that matter for in malaria policy.</p>
<div id="dtsRoss" class="section level2 hasAnchor" number="2.1">
<h2 class="hasAnchor"><span class="header-section-number">2.1</span> Deterministic, Discrete Time<a href="#dtsRoss" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><em>The parts of a model: variables, parameters, initial conditions.</em></p>
<hr />
<p>In this section, we present the basic, deterministic, discrete-time model for a mosquito-transmitted pathogen. Because it is the first model in the book, we’ll take the time to explain some background material in detail. We’ll discuss the parts of a model, and we walk through sections about solving, computation, analysis, and model verification. The first model we present, called <code>ross_dts_1,</code> we is numerically unstable in some cases. At the end we present another model, called <code>ross_dts_2</code> that is numerically stable.</p>
<div id="ross_dts_1" class="section level3 hasAnchor" number="2.1.1">
<h3 class="hasAnchor"><span class="header-section-number">2.1.1</span> <code>ross_dts_1</code><a href="#ross_dts_1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We will present the parts of the model first, and write down the equations last. The parts of a model are called parameters and variables. To solve the model, we will need initial conditions for the variables. As we go, we will also write R code that implements the model and that solves it. In writing the code, we will adopt some conventions that we can use to help us write good code.</p>
<p><strong>Variables</strong> are quantities that describe the state of a system.
One variable in this model is time, denoted <span class="math inline">\(t.\)</span>
The <em>dependent variables</em> are the quantities that we want to compute, and they are
computed at various time points. Time is marching forward, unaffected by the dependent variables, so we call it the <em>independent variable.</em></p>
<p>In this model, there are two dependent variables: the proportion of humans and mosquitoes that are infected at each point in time. Since it is a discrete time system, the values of the variables are defined only at integer values of <span class="math inline">\(t.\)</span> We define the variables as follows:</p>
<ul>
<li><p>let <span class="math inline">\(t\)</span> represent time, in days;</p></li>
<li><p>let <span class="math inline">\(x_t\)</span> be the fraction of people who are infected at time <span class="math inline">\(t,\)</span> and <span class="math inline">\(0 \leq x_t \leq 1;\)</span></p></li>
<li><p>let <span class="math inline">\(y_t\)</span> be the fraction of mosquitoes who are infected at time <span class="math inline">\(t,\)</span> <span class="math inline">\(0 \leq y_t \leq 1.\)</span></p></li>
</ul>
<p>Another term for the fraction of a population that infected with parasites is <em>prevalence.</em></p>
<p><strong>Initial Conditions</strong> are the values of the variables at one point in time. Since the values of our variables in the next time step (at time <span class="math inline">\(t+1\)</span>) depend on their values now (at time <span class="math inline">\(t\)</span>), we can’t really compute anything specific unless we specify the values of the variables at one point in time. Having set one set of values, we can use the equations to compute the rest.</p>
<p>The initial conditions specify the values of all our variables at the beginning of the simulation. By convention, this is usually at time <span class="math inline">\(t=0,\)</span> but we could also specify their values at any other point in time.</p>
<p>We can now begin to write R code to set up the objects so we can compute them. We set these initial values to be small:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="co"># Initial Conditions at a point in time, as a Named Vector </span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>xy <span class="ot">=</span> <span class="fu">c</span>(<span class="at">t=</span><span class="dv">0</span>, <span class="at">x=</span><span class="fl">0.01</span>, <span class="at">y=</span><span class="fl">0.001</span>)</span></code></pre></div>
<p>In R, this object <code>xy</code> is called a <em>named vector.</em> The names are carried along but they don’t affect any computation done with <code>xy.</code> It is also useful that the names often get inherited (but not always). The names can be used with <code>as.list()</code> or <code>data.frame().</code> When combined with the <code>with()</code> function, we can create a context where we can call them by name:</p>
<pre><code>## [1] 0.01</code></pre>
<p>This code has adopted the convention of using named vectors so that we can write functions in a way that is easy to read. It also makes it easier to deal with the model outputs.</p>
<p><strong>Parameters</strong> are quantities – rates, numbers, or probabilities – that describe some part of the process. Unlike variables, parameter values are chosen outside of a model and passed to it. In <code>ross_dts_1,</code> these parameters are constant. Since they are constant, we call this an <em>autonomous</em> system of equations. In other models, we could have parameter values that changes over time, so the system would be called <em>non-autonomous.</em></p>
<p>The parameters in this model define changes in prevalence: the fraction of humans that clear an infection each day; the fraction of infected mosquitoes that die; and blood feeding and infection.</p>
<ul>
<li><p>Let <span class="math inline">\(s\)</span> denote the fraction of people who clear infections after one day; <span class="math inline">\(0 &lt; s &lt; 1.\)</span></p></li>
<li><p>Let <span class="math inline">\(u\)</span> denote the fraction of mosquitoes who die in one day; <span class="math inline">\(0 &lt; u &lt; 1.\)</span></p></li>
<li><p>Let <span class="math inline">\(a\)</span> denote the fraction of mosquitoes who blood feed on a human in a day; <span class="math inline">\(0 &lt; a &lt; 1.\)</span></p></li>
<li><p>Let <span class="math inline">\(m\)</span> denote the number of mosquitoes per human; <span class="math inline">\(m \geq 0.\)</span></p></li>
</ul>
<p><strong>Equations</strong> describe dynamic changes in the variables over time. In this case, the process is described by a system of coupled difference equations.</p>
<p>Finally, we put all this together into a mathematical statement that has translated the description of a process, that are describe the process.</p>
<p><span class="math display">\[\begin{equation}
\begin{array}{rl}
x_{t+1} &amp;=  x_t - s x_t + m a y_t (1-x_t)  \\
y_{t+1} &amp;=  y_t - u y_t + a x_t (1 - y_t) \\
\end{array}
(\#eq:ross1a)
\end{equation}\]</span></p>
<p>We could rewrite the equations to make it easier to interpret them.</p>
<p><span class="math display">\[\begin{equation}
\begin{array}{rl}
x_{t+1} - x_t &amp;=  - s x_t + m a y_t (1-x_t)  \\
y_{t+1} - y_t &amp;=  - u y_t + a x_t (1 - y_t) \\
\end{array}
(\#eq:ross1b)
\end{equation}\]</span></p>
<p>In this alternative way of writing down the equations, the left hand side is interpreted as <em>the daily change,</em> and the terms on the right hand side describes those changes. The RHS has four terms:</p>
<ul>
<li><p><span class="math inline">\(- s x_t\)</span> – is a decrease in the prevalence of human malaria infections caused by clearance of human infections: the fraction of humans who are infected is <span class="math inline">\(x_t\)</span>; a fraction <span class="math inline">\(s\)</span> clears infections each day.</p></li>
<li><p><span class="math inline">\(+ may_t (1-x_t)\)</span> – is an increase in the prevalence of human malaria infections caused by the bites of infectious mosquitoes: the fraction of humans who are not infected is <span class="math inline">\(1-x_t\)</span>; a fraction <span class="math inline">\(m a y_t\)</span> gets infected.</p></li>
<li><p><span class="math inline">\(-u y_t\)</span> – is a decrease in the prevalence of mosquito malaria infections caused by mosquito mortality: the fraction of mosquitoes who are infected is <span class="math inline">\(y_t\)</span>; a fraction <span class="math inline">\(u\)</span> die.</p></li>
<li><p><span class="math inline">\(+ a x_t (1-y_t)\)</span> – is an increase in the prevalence of mosquito malaria infections caused blood feeding on an infected human: the fraction of mosquitoes who are not infected is <span class="math inline">\(1-y_t\)</span>; a fraction <span class="math inline">\(a x_t\)</span> blood feeds on an infected human and gets infected.</p></li>
</ul>
<p>To foreshadow something we will address in sub-section @ref(dtsRoss2), if <span class="math inline">\(may_t &gt;1,\)</span> then it is not a proportion, and the equations don’t make sense.</p>
<hr />
<p>To update the variables, we write a function in R. Since we will be developing a lot of functions and models, we adopt a simple naming convention: since it was developed by Ross, we attach the stem <code>ross</code>; since this is a discrete time system, we attach the suffix <code>dts</code>; we might want to generate other variants, so we append a number. The function is thus called <code>ross_dts_1.</code></p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="co"># INPUTS</span></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a><span class="co"># xy - current variables, as a named vector</span></span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a><span class="co"># p  - the parameters, as a list</span></span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a><span class="co"># OUTPUTS</span></span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a><span class="co"># the updated values of the variables, as a named vector</span></span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a></span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a>ross_dts_1 <span class="ot">=</span> <span class="cf">function</span>(xy, p){</span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a>  <span class="fu">with</span>(<span class="fu">as.list</span>(xy), </span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a>    <span class="fu">with</span>(p,{</span>
<span id="cb3-11"><a href="#cb3-11" tabindex="-1"></a>      xn <span class="ot">=</span> x <span class="sc">-</span> s<span class="sc">*</span>x <span class="sc">+</span> m<span class="sc">*</span>a<span class="sc">*</span>y<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>x) </span>
<span id="cb3-12"><a href="#cb3-12" tabindex="-1"></a>      yn <span class="ot">=</span> y <span class="sc">-</span> u<span class="sc">*</span>y <span class="sc">+</span> a<span class="sc">*</span>x<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>y) </span>
<span id="cb3-13"><a href="#cb3-13" tabindex="-1"></a>      <span class="fu">return</span>(<span class="fu">c</span>(<span class="at">t=</span>t<span class="sc">+</span><span class="dv">1</span>, <span class="at">x=</span>xn, <span class="at">y=</span>yn))</span>
<span id="cb3-14"><a href="#cb3-14" tabindex="-1"></a>    })</span>
<span id="cb3-15"><a href="#cb3-15" tabindex="-1"></a>  )</span>
<span id="cb3-16"><a href="#cb3-16" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="solving" class="section level3 hasAnchor" number="2.1.2">
<h3 class="hasAnchor"><span class="header-section-number">2.1.2</span> Solving<a href="#solving" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>With the R code we developed, we can <em>solve</em> the equations, which involves computing the values of the variables iteratively. Since the values of the variables change, we create another object <code>xy_t</code> that we can use to store the values of computed variables over time.</p>
<p>We iterate in two steps. First, we compute the values.</p>
<p>Since we initialized the system at time <span class="math inline">\(t=0,\)</span> the following computes the values of the parameters at time <span class="math inline">\(t=1.\)</span> We can take a peak at the values we computed:</p>
<pre><code>##           t           x           y 
## 1.000000000 0.010445000 0.003414167</code></pre>
<p>Next, we store the values using <code>rbind</code></p>
<p>We can take a peak:</p>
<pre><code>##      t        x           y
## xy_t 0 0.010000 0.001000000
## xy   1 0.010445 0.003414167</code></pre>
<p>We can iterate over many time steps, each time storing the values:</p>
<p>We can look at the last few values, the values of <span class="math inline">\(t,\)</span> <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> are stored in columns:</p>
<pre><code>##     t         x         y
## xy 38 0.9865573 0.7465869
## xy 39 0.9866426 0.7468730
## xy 40 0.9866975 0.7470700</code></pre>
<p>As we can see, the values are changing a little at the end.</p>
</div>
<div id="visualizing" class="section level3 hasAnchor" number="2.1.3">
<h3 class="hasAnchor"><span class="header-section-number">2.1.3</span> Visualizing<a href="#visualizing" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We can now plot out the values over the first 40 days. Since <code>xy_t</code> is a named list, we transform it and plot:</p>
<p><img src="figs/plot_ross_dts_1-1.png" width="672" /></p>
<p>Notice that after 40 days, the values of <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> appear to be approaching some value asymptotically. This is an important feature of these systems, one that we would like to understand and explore a bit more in the following sections.</p>
</div>
<div id="computation" class="section level3 hasAnchor" number="2.1.4">
<h3 class="hasAnchor"><span class="header-section-number">2.1.4</span> Computation<a href="#computation" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Computers are very good at repeating tasks, but if we want to get the computers to repeat tasks efficiently, we must write code that does it. One useful trick is to write functions that call other functions to expedite workflows. In this case, we want to write a function that <em>solves</em> the equations (<em>i.e.</em> that iteratively computes and stores the values) over some time interval:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="co"># INPUTS</span></span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a><span class="co"># pars - the parameters, as a list </span></span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a><span class="co"># x0   - the initial value of x</span></span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a><span class="co"># y0   - the initial value of y</span></span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a><span class="co"># t0   - the initial value of t</span></span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a><span class="co"># tmax - the last value of t </span></span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb7-8"><a href="#cb7-8" tabindex="-1"></a><span class="co"># OUTPUTS</span></span>
<span id="cb7-9"><a href="#cb7-9" tabindex="-1"></a><span class="co"># the values of the variables over time, as a list </span></span>
<span id="cb7-10"><a href="#cb7-10" tabindex="-1"></a>ross_dts_solve_1 <span class="ot">=</span> <span class="cf">function</span>(pars, <span class="at">x0=</span>.<span class="dv">01</span>, <span class="at">y0 =</span> <span class="fl">0.001</span>, <span class="at">t0=</span><span class="dv">0</span>, <span class="at">tmax=</span><span class="dv">100</span>){</span>
<span id="cb7-11"><a href="#cb7-11" tabindex="-1"></a>   xy <span class="ot">=</span> <span class="fu">c</span>(<span class="at">t=</span>t0, <span class="at">x=</span>x0, <span class="at">y=</span>y0) </span>
<span id="cb7-12"><a href="#cb7-12" tabindex="-1"></a>   xy_t <span class="ot">=</span> xy </span>
<span id="cb7-13"><a href="#cb7-13" tabindex="-1"></a>   <span class="cf">for</span>(t <span class="cf">in</span> (t0<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>tmax){</span>
<span id="cb7-14"><a href="#cb7-14" tabindex="-1"></a>     xy <span class="ot">=</span> <span class="fu">ross_dts_1</span>(xy, pars)</span>
<span id="cb7-15"><a href="#cb7-15" tabindex="-1"></a>     xy_t <span class="ot">=</span> <span class="fu">rbind</span>(xy_t, xy)</span>
<span id="cb7-16"><a href="#cb7-16" tabindex="-1"></a>   }</span>
<span id="cb7-17"><a href="#cb7-17" tabindex="-1"></a>   <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">time=</span>xy_t[,<span class="dv">1</span>], <span class="at">x=</span>xy_t[,<span class="dv">2</span>], <span class="at">y =</span> xy_t[,<span class="dv">3</span>], <span class="at">last =</span> xy)) </span>
<span id="cb7-18"><a href="#cb7-18" tabindex="-1"></a>}</span></code></pre></div>
<p>We can write another function that <em>plots</em> the equations (<em>i.e.</em> that iteratively computes and stores the values) over some time interval:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="co"># INPUTS</span></span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a><span class="co"># xy_t - a list with elements named x, y, and time</span></span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a><span class="co"># type - plot type:  &quot;l&quot; or &quot;p&quot; or &quot;b&quot;</span></span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a><span class="co"># lty  - lty  </span></span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a><span class="co"># add  - if TRUE, add to existing plot </span></span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb8-7"><a href="#cb8-7" tabindex="-1"></a><span class="co"># OUTPUTS</span></span>
<span id="cb8-8"><a href="#cb8-8" tabindex="-1"></a><span class="co"># the values of the variables over time, as a list </span></span>
<span id="cb8-9"><a href="#cb8-9" tabindex="-1"></a>plot_xy <span class="ot">=</span> <span class="cf">function</span>(xy_t, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">lty=</span><span class="dv">1</span>, <span class="at">add=</span><span class="cn">FALSE</span>){<span class="fu">with</span>(xy_t,{</span>
<span id="cb8-10"><a href="#cb8-10" tabindex="-1"></a>  <span class="cf">if</span>(add <span class="sc">==</span> <span class="cn">FALSE</span>) </span>
<span id="cb8-11"><a href="#cb8-11" tabindex="-1"></a>  <span class="fu">plot</span>(time, x, <span class="st">&quot;n&quot;</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">ylab =</span> <span class="st">&quot;Prevalence&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;Time&quot;</span>)</span>
<span id="cb8-12"><a href="#cb8-12" tabindex="-1"></a>  <span class="fu">lines</span>(time, x, <span class="at">type =</span> type, <span class="at">lty=</span>lty, <span class="at">col =</span> <span class="st">&quot;darkgreen&quot;</span>, <span class="at">pch =</span><span class="dv">15</span>)</span>
<span id="cb8-13"><a href="#cb8-13" tabindex="-1"></a>  <span class="fu">lines</span>(time, y, <span class="at">type =</span> type, <span class="at">lty=</span>lty, <span class="at">col =</span> <span class="st">&quot;darkorange&quot;</span>, <span class="at">pch =</span><span class="dv">19</span>)</span>
<span id="cb8-14"><a href="#cb8-14" tabindex="-1"></a>  <span class="fu">text</span>(<span class="dv">0</span>, <span class="fl">0.9</span>, <span class="st">&quot;x&quot;</span>, <span class="at">col =</span> <span class="st">&quot;darkgreen&quot;</span>, <span class="at">pos=</span><span class="dv">4</span>) </span>
<span id="cb8-15"><a href="#cb8-15" tabindex="-1"></a>  <span class="fu">text</span>(<span class="dv">0</span>, <span class="fl">0.8</span>, <span class="st">&quot;y&quot;</span>, <span class="at">col =</span> <span class="st">&quot;darkorange&quot;</span>, <span class="at">pos=</span><span class="dv">4</span>) </span>
<span id="cb8-16"><a href="#cb8-16" tabindex="-1"></a>})}</span></code></pre></div>
<p>Now, all the work we did above can be plotted using a single function call:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="fu">plot_xy</span>(<span class="fu">ross_dts_solve_1</span>(ross_dts_par, <span class="at">tmax=</span><span class="dv">40</span>), <span class="at">type=</span><span class="st">&quot;p&quot;</span>) </span></code></pre></div>
<p><img src="figs/replot_ross_dts_1-1.png" width="672" /></p>
<p>Now, it is easier to repeat all our analysis with a simple function call.</p>
</div>
<div id="steady-states" class="section level3 hasAnchor" number="2.1.5">
<h3 class="hasAnchor"><span class="header-section-number">2.1.5</span> Steady States<a href="#steady-states" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The fact that our variables asymptotically approach some values over time is an important feature of dynamical systems, so we would like to do some analysis to understand it better. If we look at Eq. @ref(eq:ross1b), we can understand why. In this model, there is no change when the proportion of humans becoming infected is equal to the proportion clearing infections; and the proportion of mosquitoes becoming infected is equal to the proportion dying.</p>
<p>In the following, we compute how much the system is changing over time. We can simply iterate once and compare the differences. After iterating 40 times, the differences are very small:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="co"># The last value is still stored as xy; the [-1] omits t</span></span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a>xy[<span class="sc">-</span><span class="dv">1</span>] <span class="sc">-</span> <span class="fu">ross_dts_1</span>(xy, ross_dts_par)[<span class="sc">-</span><span class="dv">1</span>]</span></code></pre></div>
<pre><code>##             x             y 
## -3.545225e-05 -1.355019e-04</code></pre>
<p>If we iterate another hundred days and check again, the differences have gotten even smaller:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">41</span><span class="sc">:</span><span class="dv">140</span>){</span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a>  xy <span class="ot">=</span> <span class="fu">ross_dts_1</span>(xy, ross_dts_par)</span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a>  xy_t <span class="ot">=</span> <span class="fu">rbind</span>(xy_t, xy) </span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a>} </span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a>xy[<span class="sc">-</span><span class="dv">1</span>] <span class="sc">-</span> <span class="fu">ross_dts_1</span>(xy, ross_dts_par)[<span class="sc">-</span><span class="dv">1</span>]</span></code></pre></div>
<pre><code>## x y 
## 0 0</code></pre>
<p>After simulating, the variables reach a steady state, where asymptotically <span class="math inline">\(x_{t+1} = x_t\)</span> and <span class="math inline">\(y_{t+1} = y_t\)</span>.</p>
<p>A steady state occurs when there is no daily change, so <span class="math inline">\(x_{t+1} - x_t = 0\)</span> and <span class="math inline">\(y_{t+1} - y_t = 0.\)</span> We can figure out the steady state values are by substituting <span class="math inline">\(x_{t+1} = x_t = x\)</span> and <span class="math inline">\(y_{t+1} = y_t = y\)</span> into Eq.@ref(eq:ross1b) and then solving for <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span>. After cancelling and rearranging, we get:</p>
<p><span class="math display">\[\begin{equation}
\begin{array}{rl}
m a y (1-x) &amp;=  s x \\
a x (1 - y) &amp;=  u y\\
\end{array}
(\#eq:ross1steady)
\end{equation}\]</span></p>
<p>Equations @ref(eq:ross1steady) say: <em>the proportion of humans becoming infected is equal to the proportion clearing infections</em>; and <em>the proportion of mosquitoes becoming infected is equal to the proportion dying.</em></p>
<p>The most obvious solution to these equations is <span class="math inline">\(x=y=0,\)</span> when there is no malaria. We call it the disease-free steady state. A disease-free equilibrium makes sense, since if we start with no infected mosquitoes or infected humans in this deterministic model, there can never be any.</p>
<p>There is another solution where malaria is present. We solve the second equation first:</p>
<p><span class="math display">\[y = a x / (u + a x).\]</span></p>
<p>Next, we substitute this for the <span class="math inline">\(y\)</span> term that is in the first equation, and we get:</p>
<p><span class="math display">\[m a^2 (1-x) =  s (u+ax)\]</span></p>
<p>and now we solve for <span class="math inline">\(x\)</span></p>
<p><span class="math display">\[x = \frac{\textstyle{ma^2 - su}}{\textstyle{ma^2 + sa}}\]</span>
We can write a function to compute this steady state:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="co"># INPUTS</span></span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a><span class="co"># params - the parameters, as a list </span></span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a><span class="co"># OUTPUTS</span></span>
<span id="cb14-5"><a href="#cb14-5" tabindex="-1"></a><span class="co"># the steady state values of x and y </span></span>
<span id="cb14-6"><a href="#cb14-6" tabindex="-1"></a>ross_dts_steady_0 <span class="ot">=</span> <span class="cf">function</span>(params){<span class="fu">with</span>(params,{</span>
<span id="cb14-7"><a href="#cb14-7" tabindex="-1"></a>  xx <span class="ot">=</span> (m<span class="sc">*</span>a<span class="sc">^</span><span class="dv">2</span> <span class="sc">-</span> s<span class="sc">*</span>u)<span class="sc">/</span> (m<span class="sc">*</span>a<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> s<span class="sc">*</span>a)</span>
<span id="cb14-8"><a href="#cb14-8" tabindex="-1"></a>  yy <span class="ot">=</span> a<span class="sc">*</span>xx<span class="sc">/</span>(u<span class="sc">+</span>a<span class="sc">*</span>xx) </span>
<span id="cb14-9"><a href="#cb14-9" tabindex="-1"></a>  <span class="fu">c</span>(<span class="at">x=</span>xx,<span class="at">y=</span>yy)</span>
<span id="cb14-10"><a href="#cb14-10" tabindex="-1"></a>})}</span></code></pre></div>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a><span class="fu">ross_dts_steady_0</span>(ross_dts_par)</span></code></pre></div>
<pre><code>##         x         y 
## 0.9867987 0.7475000</code></pre>
</div>
<div id="thresholds" class="section level3 hasAnchor" number="2.1.6">
<h3 class="hasAnchor"><span class="header-section-number">2.1.6</span> Thresholds<a href="#thresholds" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>All our analysis worked out well for the parameter values that we chose, but what if we had picked different parameters?</p>
<p>There must be some very low level of mosquitoes, for example, where malaria parasites can’t be sustained in a population. If we reduce <span class="math inline">\(m\)</span> to <span class="math inline">\(0.005\)</span> and evaluate the expression at the steady state, we get negative values for <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span>.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a>ross_dts_par1 <span class="ot">=</span> ross_dts_par</span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a>ross_dts_par1<span class="sc">$</span>m <span class="ot">=</span> <span class="fl">0.005</span></span>
<span id="cb17-3"><a href="#cb17-3" tabindex="-1"></a><span class="fu">ross_dts_steady_0</span>(ross_dts_par1)</span></code></pre></div>
<pre><code>##           x           y 
## -0.06666667 -0.25000000</code></pre>
<p>What happens if we simulate this? (Let’s set the initial conditions to reasonably high values)</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a><span class="fu">plot_xy</span>(<span class="fu">ross_dts_solve_1</span>(ross_dts_par1, <span class="at">x0 =</span> .<span class="dv">5</span>, <span class="at">y0=</span>.<span class="dv">3</span>, <span class="at">tmax=</span><span class="dv">1500</span>)) </span></code></pre></div>
<p><img src="figs/ross_dts_1_zero-1.png" width="672" /></p>
<p>Our function <code>ross_dts_steady_0</code> gives us a negative number.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a><span class="fu">ross_dts_steady_0</span>(ross_dts_par1)</span></code></pre></div>
<pre><code>##           x           y 
## -0.06666667 -0.25000000</code></pre>
<p>If we look at the equations, it’s easy enough to spot the problem. Since <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> must be positive, then it must be true that <span class="math display">\[m a^2 &gt; su.\]</span> We call this a threshold condition.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a>m_crit <span class="ot">=</span> <span class="fu">with</span>(ross_dts_par, s<span class="sc">*</span>u<span class="sc">/</span>a<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb22-2"><a href="#cb22-2" tabindex="-1"></a>m_crit </span></code></pre></div>
<pre><code>## [1] 0.006666667</code></pre>
<p>If we check, we find that this gives us the disease free equilibrium.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" tabindex="-1"></a>ross_dts_par2 <span class="ot">=</span> ross_dts_par</span>
<span id="cb24-2"><a href="#cb24-2" tabindex="-1"></a>ross_dts_par2<span class="sc">$</span>m <span class="ot">=</span> m_crit</span>
<span id="cb24-3"><a href="#cb24-3" tabindex="-1"></a><span class="fu">ross_dts_steady_0</span>(ross_dts_par2)</span></code></pre></div>
<pre><code>## x y 
## 0 0</code></pre>
<p>It doesn’t make sense to have a negative amount of malaria. Since <code>ross_dts_steady_0</code>gives us negative numbers, we can use this little bit of information to write a better function, one that returns <span class="math inline">\(0\)</span> instead of a negative number:</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" tabindex="-1"></a><span class="co"># INPUTS</span></span>
<span id="cb26-2"><a href="#cb26-2" tabindex="-1"></a><span class="co"># params - the parameters, as a list </span></span>
<span id="cb26-3"><a href="#cb26-3" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb26-4"><a href="#cb26-4" tabindex="-1"></a><span class="co"># OUTPUTS</span></span>
<span id="cb26-5"><a href="#cb26-5" tabindex="-1"></a><span class="co"># the steady state values of x and y </span></span>
<span id="cb26-6"><a href="#cb26-6" tabindex="-1"></a>ross_dts_steady_1 <span class="ot">=</span> <span class="cf">function</span>(params){<span class="fu">with</span>(params,{</span>
<span id="cb26-7"><a href="#cb26-7" tabindex="-1"></a>  xx <span class="ot">=</span> <span class="fu">ifelse</span>(m<span class="sc">*</span>a<span class="sc">^</span><span class="dv">2</span> <span class="sc">&gt;</span> s<span class="sc">*</span>u, (m<span class="sc">*</span>a<span class="sc">^</span><span class="dv">2</span> <span class="sc">-</span> s<span class="sc">*</span>u)<span class="sc">/</span>(m<span class="sc">*</span>a<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> s<span class="sc">*</span>a), <span class="dv">0</span>) </span>
<span id="cb26-8"><a href="#cb26-8" tabindex="-1"></a>  yy <span class="ot">=</span> a<span class="sc">*</span>xx<span class="sc">/</span>(u<span class="sc">+</span>a<span class="sc">*</span>xx) </span>
<span id="cb26-9"><a href="#cb26-9" tabindex="-1"></a>  <span class="fu">c</span>(<span class="at">x=</span>xx,<span class="at">y=</span>yy)</span>
<span id="cb26-10"><a href="#cb26-10" tabindex="-1"></a>})}</span></code></pre></div>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" tabindex="-1"></a><span class="fu">ross_dts_steady_1</span>(ross_dts_par1)</span></code></pre></div>
<pre><code>## x y 
## 0 0</code></pre>
</div>
<div id="verification" class="section level3 hasAnchor" number="2.1.7">
<h3 class="hasAnchor"><span class="header-section-number">2.1.7</span> Verification<a href="#verification" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>If we’re going to take ourselves seriously, we want to get used to double checking everything to avoid inserting mistakes. One way to do this is to find two or more ways of computing the same thing, for verification.</p>
<p>If we’ve done everything right, we ought to get the same values for the steady states through our analysis and simulation.</p>
<p>The last values of <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> from the simulation are:</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" tabindex="-1"></a>xy[<span class="sc">-</span><span class="dv">1</span>]</span></code></pre></div>
<pre><code>##         x         y 
## 0.9867987 0.7475000</code></pre>
<p>The last values of <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> from evaluating <code>ross_dts_steady_1()</code> are:</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" tabindex="-1"></a><span class="fu">ross_dts_steady_1</span>(ross_dts_par) </span></code></pre></div>
<pre><code>##         x         y 
## 0.9867987 0.7475000</code></pre>
<p>It’s tempting to look at the printout and assume these two numbers are exactly equal, but when we deal with computers, everything gets computed and stored in some way. We can never be sure that a match will be be exact. We can simply sum up the absolute values of the differences:</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">abs</span>(xy[<span class="sc">-</span><span class="dv">1</span>] <span class="sc">-</span> <span class="fu">ross_dts_steady_1</span>(ross_dts_par)))</span></code></pre></div>
<pre><code>## [1] 3.330669e-16</code></pre>
<p>If we wanted to reduce this to a simple error check, we should pick a tolerance level – say <span class="math inline">\(10^{-9}\)</span> – and then just ask if we are closer than that:</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" tabindex="-1"></a><span class="co"># INPUTS</span></span>
<span id="cb35-2"><a href="#cb35-2" tabindex="-1"></a><span class="co"># xy  - xy </span></span>
<span id="cb35-3"><a href="#cb35-3" tabindex="-1"></a><span class="co"># par - a set of parameters for a ross_dts model </span></span>
<span id="cb35-4"><a href="#cb35-4" tabindex="-1"></a><span class="co"># tol - a tolerance level </span></span>
<span id="cb35-5"><a href="#cb35-5" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb35-6"><a href="#cb35-6" tabindex="-1"></a><span class="co"># OUTPUTS</span></span>
<span id="cb35-7"><a href="#cb35-7" tabindex="-1"></a><span class="co"># boolean - </span></span>
<span id="cb35-8"><a href="#cb35-8" tabindex="-1"></a>ross_dts_checkit_1 <span class="ot">=</span> <span class="cf">function</span>(xy, ross_dts_pars, <span class="at">tol=</span><span class="fl">1e-9</span>){</span>
<span id="cb35-9"><a href="#cb35-9" tabindex="-1"></a>  <span class="fu">sum</span>(<span class="fu">abs</span>(xy[<span class="sc">-</span><span class="dv">1</span>] <span class="sc">-</span> <span class="fu">ross_dts_steady_1</span>(ross_dts_pars)))  <span class="sc">&lt;</span> tol</span>
<span id="cb35-10"><a href="#cb35-10" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" tabindex="-1"></a><span class="fu">ross_dts_checkit_1</span>(xy, ross_dts_par)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
</div>
<div id="numerical-instability" class="section level3 hasAnchor" number="2.1.8">
<h3 class="hasAnchor"><span class="header-section-number">2.1.8</span> Numerical Instability<a href="#numerical-instability" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>There is another problem with the equations. If we set <span class="math inline">\(m\)</span> too high, such that at some point <span class="math inline">\(m a y_t &gt; 1,\)</span> then the whole system eventually crashes:</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" tabindex="-1"></a>ross_dts_par3 <span class="ot">=</span> ross_dts_par</span>
<span id="cb38-2"><a href="#cb38-2" tabindex="-1"></a>ross_dts_par3<span class="sc">$</span>m <span class="ot">=</span> <span class="dv">20</span> </span>
<span id="cb38-3"><a href="#cb38-3" tabindex="-1"></a><span class="fu">plot_xy</span>(<span class="fu">ross_dts_solve_1</span>(ross_dts_par3, <span class="at">x0 =</span> .<span class="dv">01</span>, <span class="at">y0=</span>.<span class="dv">001</span>, <span class="at">tmax=</span><span class="dv">20</span>), <span class="st">&quot;b&quot;</span>) </span></code></pre></div>
<p><img src="figs/ross_dts_mess-1.png" width="672" /></p>
<p>In discrete time formulations, we must be very careful to ensure that we have formulated a proper model. How can we fix this problem? We have to go back and rethink the way we formulated our model. How does the probability of getting infected scale with the number of infective bites?</p>
</div>
<div id="dtsRoss2" class="section level3 hasAnchor" number="2.1.9">
<h3 class="hasAnchor"><span class="header-section-number">2.1.9</span> <code>ross_dts_2</code><a href="#dtsRoss2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>There is a good solution to the problem that gave rise to this numerical instability. The question at hand is what fraction of people would become infected, on average, if the expected number of bites was <span class="math inline">\(may_t?\)</span> Ideally, we want to return a proportion, even when <span class="math inline">\(may_t&gt;1.\)</span> We call this quantity – the fraction that gets infected in a day – the <em>daily attack rate.</em></p>
<p>If we knew that there were exactly an integer number of bites, <span class="math inline">\(ma,\)</span> then the proportion of people not getting infected would be those that didn’t get infected from any one of the bites, or <span class="math inline">\((1-y_t)^{ma}.\)</span> There is, however, an even better way to think about this.</p>
<p>In a lot of cases like this, without any other information, we would assume that the number of bites, per person, would follow a Poisson distribution. It’s actually easier to say who doesn’t get infected, and that’s the zero term of a Poisson, <span class="math inline">\(e^{-may_t}.\)</span> The probability of getting infected is the complement of the probability of getting at least one bite, or</p>
<p><span class="math display">\[1 - e^{-m a y_t}\]</span></p>
<p><strong>Equations</strong></p>
<p>Our variables, initial conditions, and parameters are all defined in the same way as <code>ross_dts_1,</code> but now our equations have changed:</p>
<p><span class="math display">\[\begin{equation}
\begin{array}{rl}
x_{t+1} &amp;=  x_t - s x_t + (1-e^{-m a y_t}) (1-x_t)  \\
y_{t+1} &amp;=  y_t - u y_t + a x_t (1 - y_t) \\
\end{array}
(\#eq:ross1c)
\end{equation}\]</span></p>
<p>As before, we write a function to numerically solve the discrete time system:</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" tabindex="-1"></a><span class="co"># INPUTS</span></span>
<span id="cb39-2"><a href="#cb39-2" tabindex="-1"></a><span class="co"># xy      - current variables, as a named vector</span></span>
<span id="cb39-3"><a href="#cb39-3" tabindex="-1"></a><span class="co"># params  - the parameters, as a list</span></span>
<span id="cb39-4"><a href="#cb39-4" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb39-5"><a href="#cb39-5" tabindex="-1"></a><span class="co"># OUTPUTS</span></span>
<span id="cb39-6"><a href="#cb39-6" tabindex="-1"></a><span class="co"># the updated values of the variables, as a named vector</span></span>
<span id="cb39-7"><a href="#cb39-7" tabindex="-1"></a>ross_dts_2 <span class="ot">=</span> <span class="cf">function</span>(xy, params){<span class="fu">with</span>(<span class="fu">as.list</span>(xy), <span class="fu">with</span>(params,{</span>
<span id="cb39-8"><a href="#cb39-8" tabindex="-1"></a>  xn <span class="ot">=</span> x <span class="sc">-</span> s<span class="sc">*</span>x <span class="sc">+</span> (<span class="dv">1</span><span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span>m<span class="sc">*</span>a<span class="sc">*</span>y))<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>x) </span>
<span id="cb39-9"><a href="#cb39-9" tabindex="-1"></a>  yn <span class="ot">=</span> y <span class="sc">-</span> u<span class="sc">*</span>y <span class="sc">+</span> a<span class="sc">*</span>x<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>y) </span>
<span id="cb39-10"><a href="#cb39-10" tabindex="-1"></a>  t<span class="ot">=</span>t<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb39-11"><a href="#cb39-11" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">c</span>(<span class="at">t=</span>t, <span class="at">x=</span>xn, <span class="at">y=</span>yn))</span>
<span id="cb39-12"><a href="#cb39-12" tabindex="-1"></a>}))}</span></code></pre></div>
<p>Once again, we can wrap a function around the solver so that it’s easier to use the code:</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" tabindex="-1"></a><span class="co"># INPUTS</span></span>
<span id="cb40-2"><a href="#cb40-2" tabindex="-1"></a><span class="co"># pars - the parameters, as a list </span></span>
<span id="cb40-3"><a href="#cb40-3" tabindex="-1"></a><span class="co"># x0   - the initial value of x</span></span>
<span id="cb40-4"><a href="#cb40-4" tabindex="-1"></a><span class="co"># y0   - the initial value of y</span></span>
<span id="cb40-5"><a href="#cb40-5" tabindex="-1"></a><span class="co"># t0   - the initial value of t</span></span>
<span id="cb40-6"><a href="#cb40-6" tabindex="-1"></a><span class="co"># tmax - the last value of t </span></span>
<span id="cb40-7"><a href="#cb40-7" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb40-8"><a href="#cb40-8" tabindex="-1"></a><span class="co"># OUTPUTS</span></span>
<span id="cb40-9"><a href="#cb40-9" tabindex="-1"></a><span class="co"># the values of the variables over time, as a list </span></span>
<span id="cb40-10"><a href="#cb40-10" tabindex="-1"></a>ross_dts_solve_2 <span class="ot">=</span> <span class="cf">function</span>(pars, <span class="at">x0=</span>.<span class="dv">01</span>, <span class="at">y0 =</span> <span class="fl">0.001</span>, <span class="at">t0=</span><span class="dv">0</span>, <span class="at">tmax=</span><span class="dv">100</span>){</span>
<span id="cb40-11"><a href="#cb40-11" tabindex="-1"></a>   xy <span class="ot">=</span> <span class="fu">c</span>(<span class="at">t=</span>t0, <span class="at">x=</span>x0, <span class="at">y=</span>y0) </span>
<span id="cb40-12"><a href="#cb40-12" tabindex="-1"></a>   xy <span class="ot">=</span> <span class="fu">c</span>(<span class="at">t=</span><span class="dv">0</span>, <span class="at">x=</span>x0, <span class="at">y=</span>y0) </span>
<span id="cb40-13"><a href="#cb40-13" tabindex="-1"></a>   xy_t <span class="ot">=</span> xy </span>
<span id="cb40-14"><a href="#cb40-14" tabindex="-1"></a>   <span class="cf">for</span>(t <span class="cf">in</span> (t0<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>tmax){</span>
<span id="cb40-15"><a href="#cb40-15" tabindex="-1"></a>     xy <span class="ot">=</span> <span class="fu">ross_dts_2</span>(xy, pars)</span>
<span id="cb40-16"><a href="#cb40-16" tabindex="-1"></a>     xy_t <span class="ot">=</span> <span class="fu">rbind</span>(xy_t, xy)</span>
<span id="cb40-17"><a href="#cb40-17" tabindex="-1"></a>   }</span>
<span id="cb40-18"><a href="#cb40-18" tabindex="-1"></a>   <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">time=</span>xy_t[,<span class="dv">1</span>], <span class="at">x=</span>xy_t[,<span class="dv">2</span>], <span class="at">y =</span> xy_t[,<span class="dv">3</span>], <span class="at">last =</span> xy)) </span>
<span id="cb40-19"><a href="#cb40-19" tabindex="-1"></a>}</span></code></pre></div>
<p>Now, we can visualize the output using code we’ve already written, and can see that we have fixed our stability problem.</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" tabindex="-1"></a><span class="fu">plot_xy</span>(<span class="fu">ross_dts_solve_2</span>(ross_dts_par3, <span class="at">x0 =</span> .<span class="dv">01</span>, <span class="at">y0=</span>.<span class="dv">001</span>, <span class="at">tmax=</span><span class="dv">20</span>), <span class="st">&quot;b&quot;</span>) </span></code></pre></div>
<p><img src="figs/plot_ross_dts_2-1.png" width="672" /></p>
<p><strong>Verification</strong></p>
<p>For verification, we want a method to solve things two different ways. If we want to compute the steady state, we’re stuck with the problem of solving this equation:</p>
<p><span class="math display">\[(1-e^{-m a^2 x/(u + a x)}) (1-x) = sx\]</span></p>
<p>It’s surprisingly easy to write down equations, like this one, that we can’t solve with pencil and paper. We can still find a way of computing the steady state, but we have to write R code that solves for <span class="math inline">\(x\)</span> numerically.</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" tabindex="-1"></a><span class="co"># INPUTS</span></span>
<span id="cb42-2"><a href="#cb42-2" tabindex="-1"></a><span class="co"># par - the model parameters, as a list </span></span>
<span id="cb42-3"><a href="#cb42-3" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb42-4"><a href="#cb42-4" tabindex="-1"></a><span class="co"># OUTPUTS</span></span>
<span id="cb42-5"><a href="#cb42-5" tabindex="-1"></a><span class="co"># the steady state values of x and y </span></span>
<span id="cb42-6"><a href="#cb42-6" tabindex="-1"></a>ross_dts_steady_2 <span class="ot">=</span> <span class="cf">function</span>(pars){<span class="fu">with</span>(pars,{</span>
<span id="cb42-7"><a href="#cb42-7" tabindex="-1"></a>   f_xx <span class="ot">=</span> <span class="cf">function</span>(x, pp){<span class="fu">with</span>(pp,{</span>
<span id="cb42-8"><a href="#cb42-8" tabindex="-1"></a>     xx <span class="ot">=</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">exp</span>(<span class="sc">-</span>m<span class="sc">*</span>a<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>x<span class="sc">/</span>(u<span class="sc">+</span>a<span class="sc">*</span>x)))<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>x) <span class="sc">-</span> s<span class="sc">*</span>x</span>
<span id="cb42-9"><a href="#cb42-9" tabindex="-1"></a>     y <span class="ot">=</span> a<span class="sc">*</span>xx<span class="sc">/</span>(u<span class="sc">+</span>a<span class="sc">*</span>xx)</span>
<span id="cb42-10"><a href="#cb42-10" tabindex="-1"></a>     yy <span class="ot">=</span> u<span class="sc">*</span>y <span class="sc">+</span> a<span class="sc">*</span>xx<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>y) </span>
<span id="cb42-11"><a href="#cb42-11" tabindex="-1"></a>     <span class="fu">return</span>(xx<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> yy<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb42-12"><a href="#cb42-12" tabindex="-1"></a>   })}</span>
<span id="cb42-13"><a href="#cb42-13" tabindex="-1"></a>   xx <span class="ot">=</span> <span class="fu">optimize</span>(f_xx, <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">pp=</span>pars, <span class="at">tol =</span> <span class="fl">1e-10</span>)<span class="sc">$</span>min</span>
<span id="cb42-14"><a href="#cb42-14" tabindex="-1"></a>   yy <span class="ot">=</span> a<span class="sc">*</span>xx<span class="sc">/</span>(u<span class="sc">+</span>a<span class="sc">*</span>xx) </span>
<span id="cb42-15"><a href="#cb42-15" tabindex="-1"></a>   <span class="fu">c</span>(xx, yy)</span>
<span id="cb42-16"><a href="#cb42-16" tabindex="-1"></a>})}</span></code></pre></div>
<p>Finding the equilibrium this way, we get:</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" tabindex="-1"></a><span class="fu">ross_dts_steady_2</span>(ross_dts_par3)</span></code></pre></div>
<pre><code>## [1] 0.9949051 0.7490410</code></pre>
<p>Second, by getting the solution after many iterations.</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" tabindex="-1"></a><span class="fu">ross_dts_solve_2</span>(ross_dts_par3, <span class="at">x0=</span>.<span class="dv">1</span>, <span class="at">y0=</span>.<span class="dv">05</span>,<span class="at">tmax=</span><span class="dv">300</span>)<span class="sc">$</span>last[<span class="sc">-</span><span class="dv">1</span>]</span></code></pre></div>
<pre><code>##         x         y 
## 0.9949051 0.7490410</code></pre>
<p>By inspection, these two numbers are very close, but not exactly matching. Once again, we want to ensure that our code does not have any mistakes, so we write a function to verify our results. We set a term that describes an acceptable tolerance for computational errors, and ask if we’re at least that close.</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" tabindex="-1"></a>ross_dts_checkit_2 <span class="ot">=</span> <span class="cf">function</span>(pars, <span class="at">x0 =</span> .<span class="dv">1</span>, <span class="at">y0=</span>.<span class="dv">05</span>, <span class="at">tmax=</span><span class="dv">500</span>, <span class="at">tol=</span><span class="fl">1e-7</span>){</span>
<span id="cb47-2"><a href="#cb47-2" tabindex="-1"></a>  xyt <span class="ot">=</span> <span class="fu">ross_dts_solve_2</span>(pars, <span class="at">x0=</span>x0, <span class="at">y0=</span>y0, <span class="at">tmax=</span>tmax)</span>
<span id="cb47-3"><a href="#cb47-3" tabindex="-1"></a>  <span class="fu">sum</span>(<span class="fu">abs</span>(xyt<span class="sc">$</span>last[<span class="sc">-</span><span class="dv">1</span>] <span class="sc">-</span> <span class="fu">ross_dts_steady_2</span>(pars))) <span class="sc">&lt;</span> tol</span>
<span id="cb47-4"><a href="#cb47-4" tabindex="-1"></a>}</span></code></pre></div>
<p>Do the two answers differ by less than <span class="math inline">\(10^{-7}\)</span>?</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" tabindex="-1"></a><span class="fu">ross_dts_checkit_2</span>(ross_dts_par3)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<p>It’s a little unsatisfying to get numerical errors, but machines don’t do exact computation easily. We’re interested in getting as close as we need to get without doing a lot of work that would, in the end, never make a difference. The operating principle here is that we need to be sure that our code is doing what we think it should, and that it is giving answers that are close enough.</p>
</div>
</div>
<div id="sdtsRoss" class="section level2 hasAnchor" number="2.2">
<h2 class="hasAnchor"><span class="header-section-number">2.2</span> Stochastic, Discrete Time<a href="#sdtsRoss" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><em>Demographic stochasticity.</em></p>
<hr />
<p>If we followed individuals in a population that followed the simple rules described in Equation @ref(eq:Mprocess) and Equation @ref(eq:Hprocess), we would like to be able to understand how they are connected to the deterministic equations we developed in Section-@ref(dtsRoss). Setting aside the problems that get introduced by sampling populations for the moment – we will pretend we’re omniscient – we would find random changes occurring:</p>
<ul>
<li><p>individual humans would be switching states over time at random: from infected to uninfected and back;</p></li>
<li><p>individual mosquitoes would be dying at random: infected mosquitoes would get replaced by uninfected mosquitoes, and uninfected mosquitoes would be blood feeding and getting infected if they blood fed on an infected (and infectious) human.</p></li>
</ul>
<p>The world really has a random component to it. It is not deterministic but stochastic.</p>
<p>In the <em>deterministic</em> models that we called <code>ross_dts_1</code> and <code>ross_dts_2,</code> the values of each variable at each point in time were specified <em>exactly</em> by the equations, the rules for updating the variables each day. The values of the variables were <em>proportions,</em> which is related to the metric <em>prevalence.</em> In these models, the variables asymptotically approach a <em>steady state.</em> Once at the steady state, the fractions infected would never change.</p>
<p>In models with stochasticity, we could use the same exact rules to specify what is expected to happen, but we must draw a random number to determine the values of the variables. To do this, we want to be working with the counting numbers – the number of humans in a population and the number of those humans who are infected; and the number of mosquitoes in a population, and the number of those mosquitoes who are infected. The variability in the values of our variables over time due to the random component of parasite infection dynamics – also called the parasite demographics – would be called <strong>demographic stochasticity.</strong> The model has <em>some</em> things in common with the ones we described above: the model doesn’t have a steady state, but there is something like a steady state that the variables fluctuate around. We’ll call it an attractor. The variables are always pulled towards the attractor, but the values of the variables are constantly changing around it.</p>
<p>In a real study, we can’t pretend to be omniscient, but we will discuss that later.</p>
<p><strong>Parameters</strong> – We can use the same parameters as before, but there are two new parameters:</p>
<ul>
<li><p><span class="math inline">\(M\)</span> is the number of mosquitoes: <span class="math inline">\(M\)</span> is a counting number</p></li>
<li><p><span class="math inline">\(H\)</span> is the number of humans; <span class="math inline">\(H\)</span> is a counting number</p></li>
</ul>
<p>Otherwise we use the same parameters as we did before.</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" tabindex="-1"></a><span class="co"># The parameters, as a list </span></span>
<span id="cb50-2"><a href="#cb50-2" tabindex="-1"></a>ross_sdts_par <span class="ot">=</span> <span class="fu">list</span>(</span>
<span id="cb50-3"><a href="#cb50-3" tabindex="-1"></a>  <span class="at">M =</span> <span class="dv">50</span>,   <span class="co"># The number of mosquitoes </span></span>
<span id="cb50-4"><a href="#cb50-4" tabindex="-1"></a>  <span class="at">H =</span> <span class="dv">100</span>,   <span class="co"># The number of humans </span></span>
<span id="cb50-5"><a href="#cb50-5" tabindex="-1"></a>  <span class="at">s =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">200</span>, <span class="co"># The fraction of infections that clear each day</span></span>
<span id="cb50-6"><a href="#cb50-6" tabindex="-1"></a>  <span class="at">u =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">12</span>,  <span class="co"># The fraction of mosquitoes that die each day</span></span>
<span id="cb50-7"><a href="#cb50-7" tabindex="-1"></a>  <span class="at">a =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>   <span class="co"># The fraction of mosquitoes that blood feed on a human each day</span></span>
<span id="cb50-8"><a href="#cb50-8" tabindex="-1"></a>)</span>
<span id="cb50-9"><a href="#cb50-9" tabindex="-1"></a>ross_sdts_par<span class="sc">$</span>m <span class="ot">=</span> <span class="fu">with</span>(ross_sdts_par, M<span class="sc">/</span>H)</span></code></pre></div>
<p><strong>Variables</strong></p>
<p>In the stochastic model, our variables are counting numbers, not fractions:</p>
<ul>
<li><p><span class="math inline">\(Y \leq M\)</span> is the number of infected mosquitoes: <span class="math inline">\(Y\)</span> is a counting number</p></li>
<li><p><span class="math inline">\(X \leq H\)</span> is the number of infected humans: <span class="math inline">\(X\)</span> is a counting number</p></li>
</ul>
<p>It is easy enough to define prevalence:</p>
<ul>
<li><p><span class="math inline">\(x = X/H\)</span> is malaria prevalence in humans; the fraction of humans infected</p></li>
<li><p><span class="math inline">\(y = Y/M\)</span> is malaria prevalence in mosquitoes; the fraction of mosquitoes infected</p></li>
</ul>
<p><strong>Equations</strong></p>
<p>Now we have got to describe a stochastic process. Each individual changes state with some probability. Each one is a Bernoulli random variable, and the appropriate proability mass function is the binomial model. In R, we use the built-in function <code>rbinom(1, N, p)</code> to draw one random variable on <span class="math inline">\(N\)</span> individuals that remains in the same state with probability <span class="math inline">\(p\)</span>.</p>
<p>In each step, there are four possible changes, depending on the states:</p>
<ul>
<li><p><span class="math inline">\(X\)</span> - if humans are infected today, they might lose infection. An infection is lost with probability <span class="math inline">\(s\)</span>, so the fraction that remain infected is <span class="math inline">\(1-s.\)</span> The number that remains infected is <code>rbinom(1, X, 1-s).</code></p></li>
<li><p><span class="math inline">\(H-X\)</span> - if humans are uninfected today, they might get infected. The probability of getting infected is called the <em>daily attack rate.</em> The expected number of infected bites is <span class="math inline">\(aY/H\)</span>, and if we use the Poisson to model the distribution of bites per person, then the attack rate is <span class="math inline">\(1-e^{-aY/H}\)</span>. The number that remains ends up infected is <code>rbinom(1, H-X, ar).</code></p></li>
<li><p><span class="math inline">\(Y\)</span> - if mosquitoes are infected today, they might die. The fraction dying is <span class="math inline">\(u\)</span>, so the number of surviving infected mosquitoes is <code>rbinom(1, X, 1-s).</code></p></li>
<li><p><span class="math inline">\(H-Y\)</span> - if mosquitoes are uninfected today, they might get infected. To get infected, a mosquito must blood feed on an infected human, so the fraction getting infected is <span class="math inline">\(aX/H\)</span>. The number that gets infected is <code>rbinom(1, H-Y, a X/H).</code></p></li>
</ul>
<p>The rule for updating the number of infected humans and mosquitoes is thus:</p>
<p><span class="math display">\[\begin{equation}
\begin{array}{rl}
X_{t+1} &amp;= \mbox{Binom}(X, 1-s) + \mbox{Binom}(H-X, 1-e^{-a Y/H}) \\
Y_{t+1} &amp;= \mbox{Binom}(Y, 1-u) + \mbox{Binom}(M-Y, aX/H) \\
\end{array}
\end{equation}\]</span></p>
<p>The following implements this as R code:</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" tabindex="-1"></a><span class="co"># XY      - a vector of the form c(t, X, Y) </span></span>
<span id="cb51-2"><a href="#cb51-2" tabindex="-1"></a><span class="co"># params  - the parameters, as a list </span></span>
<span id="cb51-3"><a href="#cb51-3" tabindex="-1"></a>ross_sdts <span class="ot">=</span> <span class="cf">function</span>(XY, params){</span>
<span id="cb51-4"><a href="#cb51-4" tabindex="-1"></a>  <span class="fu">with</span>(<span class="fu">as.list</span>(XY), </span>
<span id="cb51-5"><a href="#cb51-5" tabindex="-1"></a>    <span class="fu">with</span>(params,{</span>
<span id="cb51-6"><a href="#cb51-6" tabindex="-1"></a>      ar <span class="ot">=</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">exp</span>(<span class="sc">-</span>a<span class="sc">*</span>Y<span class="sc">/</span>H)</span>
<span id="cb51-7"><a href="#cb51-7" tabindex="-1"></a>      Xn <span class="ot">=</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, X, <span class="dv">1</span><span class="sc">-</span>s) <span class="sc">+</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, H<span class="sc">-</span>X, ar)  </span>
<span id="cb51-8"><a href="#cb51-8" tabindex="-1"></a>      Yn <span class="ot">=</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, Y, <span class="dv">1</span><span class="sc">-</span>u) <span class="sc">+</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, M<span class="sc">-</span>Y, a<span class="sc">*</span>X<span class="sc">/</span>H)  </span>
<span id="cb51-9"><a href="#cb51-9" tabindex="-1"></a>      t<span class="ot">=</span>t<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb51-10"><a href="#cb51-10" tabindex="-1"></a>      <span class="fu">return</span>(<span class="fu">c</span>(<span class="at">t=</span>t, <span class="at">X=</span>Xn, <span class="at">Y=</span>Yn))</span>
<span id="cb51-11"><a href="#cb51-11" tabindex="-1"></a>}))}</span></code></pre></div>
<p>We write a wrapper that solves it:</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" tabindex="-1"></a><span class="co"># INPUTS</span></span>
<span id="cb52-2"><a href="#cb52-2" tabindex="-1"></a><span class="co"># pars - the parameters, as a list </span></span>
<span id="cb52-3"><a href="#cb52-3" tabindex="-1"></a><span class="co"># X0   - the initial number of infected humans</span></span>
<span id="cb52-4"><a href="#cb52-4" tabindex="-1"></a><span class="co"># Y0   - the initial number of infected mosquitoes </span></span>
<span id="cb52-5"><a href="#cb52-5" tabindex="-1"></a><span class="co"># t0   - the initial value of t</span></span>
<span id="cb52-6"><a href="#cb52-6" tabindex="-1"></a><span class="co"># tmax - the last value of t </span></span>
<span id="cb52-7"><a href="#cb52-7" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb52-8"><a href="#cb52-8" tabindex="-1"></a><span class="co"># OUTPUTS</span></span>
<span id="cb52-9"><a href="#cb52-9" tabindex="-1"></a><span class="co"># the values of the variables over time, as a list </span></span>
<span id="cb52-10"><a href="#cb52-10" tabindex="-1"></a>sim_ross_sdts <span class="ot">=</span> <span class="cf">function</span>(pars, <span class="at">X0=</span><span class="dv">2</span>, <span class="at">Y0 =</span> <span class="dv">1</span>, <span class="at">t0=</span><span class="dv">0</span>, <span class="at">tmax=</span><span class="dv">100</span>){</span>
<span id="cb52-11"><a href="#cb52-11" tabindex="-1"></a>   XY <span class="ot">=</span> <span class="fu">c</span>(<span class="at">t=</span>t0, <span class="at">X=</span>X0, <span class="at">Y=</span>Y0) </span>
<span id="cb52-12"><a href="#cb52-12" tabindex="-1"></a>   XY_t <span class="ot">=</span> XY </span>
<span id="cb52-13"><a href="#cb52-13" tabindex="-1"></a>   <span class="cf">for</span>(t <span class="cf">in</span> (t0<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>tmax){</span>
<span id="cb52-14"><a href="#cb52-14" tabindex="-1"></a>     XY <span class="ot">=</span> <span class="fu">ross_sdts</span>(XY, pars)</span>
<span id="cb52-15"><a href="#cb52-15" tabindex="-1"></a>     XY_t <span class="ot">=</span> <span class="fu">rbind</span>(XY_t, XY)</span>
<span id="cb52-16"><a href="#cb52-16" tabindex="-1"></a>   }</span>
<span id="cb52-17"><a href="#cb52-17" tabindex="-1"></a>   X<span class="ot">=</span>XY_t[,<span class="dv">2</span>] </span>
<span id="cb52-18"><a href="#cb52-18" tabindex="-1"></a>   Y<span class="ot">=</span>XY_t[,<span class="dv">3</span>]</span>
<span id="cb52-19"><a href="#cb52-19" tabindex="-1"></a>   x<span class="ot">=</span>X<span class="sc">/</span>pars<span class="sc">$</span>H </span>
<span id="cb52-20"><a href="#cb52-20" tabindex="-1"></a>   y<span class="ot">=</span>Y<span class="sc">/</span>pars<span class="sc">$</span>M </span>
<span id="cb52-21"><a href="#cb52-21" tabindex="-1"></a>   <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">time=</span>XY_t[,<span class="dv">1</span>], <span class="at">x=</span>x, <span class="at">y=</span>y, <span class="at">X=</span>X, <span class="at">Y=</span>Y, <span class="at">last =</span> XY)) </span>
<span id="cb52-22"><a href="#cb52-22" tabindex="-1"></a>}</span></code></pre></div>
<p>We can write another function that <em>plots</em> the equations (<em>i.e.</em> that iteratively computes and stores the values) over some time interval:</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" tabindex="-1"></a><span class="co"># INPUTS</span></span>
<span id="cb53-2"><a href="#cb53-2" tabindex="-1"></a><span class="co"># XY_t - a list with elements named x, y, and time</span></span>
<span id="cb53-3"><a href="#cb53-3" tabindex="-1"></a><span class="co"># type - plot type:  &quot;l&quot; or &quot;p&quot; or &quot;b&quot;</span></span>
<span id="cb53-4"><a href="#cb53-4" tabindex="-1"></a><span class="co"># lty  - lty  </span></span>
<span id="cb53-5"><a href="#cb53-5" tabindex="-1"></a><span class="co"># add  - if TRUE, add to existing plot </span></span>
<span id="cb53-6"><a href="#cb53-6" tabindex="-1"></a>plot_XY <span class="ot">=</span> <span class="cf">function</span>(XY_t, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lty=</span><span class="dv">1</span>, <span class="at">add=</span> <span class="cn">FALSE</span>){<span class="fu">with</span>(XY_t,{</span>
<span id="cb53-7"><a href="#cb53-7" tabindex="-1"></a>  <span class="cf">if</span>(add <span class="sc">==</span> <span class="cn">FALSE</span>) </span>
<span id="cb53-8"><a href="#cb53-8" tabindex="-1"></a>  <span class="fu">plot</span>(time, X, <span class="at">type =</span> <span class="st">&quot;n&quot;</span>, <span class="at">ylim =</span> <span class="fu">range</span>(<span class="dv">0</span>, X, Y), <span class="at">ylab =</span> <span class="st">&quot;Number Infected&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;Time&quot;</span>)</span>
<span id="cb53-9"><a href="#cb53-9" tabindex="-1"></a>  <span class="fu">lines</span>(time, X, <span class="at">type=</span>type, <span class="at">lty=</span>lty, <span class="at">col=</span><span class="st">&quot;darkgreen&quot;</span>, <span class="at">pch =</span><span class="dv">15</span>)</span>
<span id="cb53-10"><a href="#cb53-10" tabindex="-1"></a>  <span class="fu">lines</span>(time, Y, <span class="at">type=</span>type, <span class="at">lty=</span>lty, <span class="at">col=</span><span class="st">&quot;darkorange&quot;</span>, <span class="at">pch =</span><span class="dv">19</span>)</span>
<span id="cb53-11"><a href="#cb53-11" tabindex="-1"></a>  <span class="fu">text</span>(<span class="dv">0</span>, <span class="fl">0.9</span><span class="sc">*</span><span class="fu">max</span>(X,Y), <span class="st">&quot;X&quot;</span>, <span class="at">col =</span> <span class="st">&quot;darkgreen&quot;</span>, <span class="at">pos=</span><span class="dv">4</span>) </span>
<span id="cb53-12"><a href="#cb53-12" tabindex="-1"></a>  <span class="fu">text</span>(<span class="dv">0</span>, <span class="fl">0.8</span><span class="sc">*</span><span class="fu">max</span>(X,Y), <span class="st">&quot;Y&quot;</span>, <span class="at">col =</span> <span class="st">&quot;darkorange&quot;</span>, <span class="at">pos=</span><span class="dv">4</span>) </span>
<span id="cb53-13"><a href="#cb53-13" tabindex="-1"></a>})}</span></code></pre></div>
<p>A useful feature of R is the ability to replicate any particular sequence of random numbers by setting a <em>seed.</em> This also makes it easy to write a book knowing what the random number sequence will be.</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">253</span>)</span>
<span id="cb54-2"><a href="#cb54-2" tabindex="-1"></a>XYt <span class="ot">&lt;-</span> <span class="fu">sim_ross_sdts</span>(ross_sdts_par, <span class="at">tmax=</span><span class="dv">300</span>) </span></code></pre></div>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" tabindex="-1"></a><span class="fu">plot_XY</span>(XYt)</span></code></pre></div>
<p><img src="figs/unnamed-chunk-32-1.png" width="672" /></p>
<p>Once we’re close to the steady state, some time after the first 100 days, we can compute the mean:</p>
<pre><code>##        X        Y 
## 95.10945 36.26866</code></pre>
<p>This can be visualized as a histogram:</p>
<p><img src="figs/unnamed-chunk-33-1.png" width="768" /></p>
<p>Since we can compute prevalence, we can plot it out:</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" tabindex="-1"></a><span class="fu">plot_xy</span>(XYt)</span></code></pre></div>
<p><img src="figs/unnamed-chunk-34-1.png" width="672" /></p>
<pre><code>##         x         y 
## 0.9510945 0.7253731</code></pre>
<p><img src="figs/unnamed-chunk-36-1.png" width="768" /></p>
<p>The system still tends towards a point – we’ll call it an attractor and not a steady state. The values of <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> (or of <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span>) fluctuate around that steady state. Since the counting number values get repeated, we can illustrate what the cloud looks like by jittering the locations of the points:</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" tabindex="-1"></a><span class="fu">with</span>(XYt,{</span>
<span id="cb59-2"><a href="#cb59-2" tabindex="-1"></a>  ix <span class="ot">=</span> <span class="fu">which</span>(time<span class="sc">&gt;</span><span class="dv">100</span>)</span>
<span id="cb59-3"><a href="#cb59-3" tabindex="-1"></a>  <span class="fu">plot</span>(<span class="fu">jitter</span>(X[ix]), <span class="fu">jitter</span>(Y[ix]), <span class="at">xlab =</span> <span class="st">&quot;X&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Y&quot;</span>)</span>
<span id="cb59-4"><a href="#cb59-4" tabindex="-1"></a>}) </span>
<span id="cb59-5"><a href="#cb59-5" tabindex="-1"></a><span class="fu">points</span>(mX, mY, <span class="at">col =</span> <span class="st">&quot;darkred&quot;</span>, <span class="at">pch =</span> <span class="dv">8</span>, <span class="at">cex =</span><span class="dv">3</span>)</span></code></pre></div>
<p><img src="figs/unnamed-chunk-37-1.png" width="384" /></p>
<p>We note that mean prevalence is very close to the steady state of the deterministic system with the same parameter values:</p>
<pre><code>## [1]  0.004686644 -0.014157539</code></pre>
<p>An important feature of stochastic systems is that it is possible for the parasite to randomly fade out, if at any time <span class="math inline">\(X=Y=0.\)</span> This is something we’d like to take a bit more time computing.</p>
</div>
<div id="xdeRoss" class="section level2 hasAnchor" number="2.3">
<h2 class="hasAnchor"><span class="header-section-number">2.3</span> Deterministic, Continuous Time<a href="#xdeRoss" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><em>Differential equations.</em></p>
<hr />
<p>In this section, we present a basic, deterministic, continuous-time model. After seeing the <code>ross_dts</code> models, this model will look and feel familiar. Instead of describing a difference over a fixed time step, we describe a derivative. The idea of derivative is usually introduced as the second new concept in any introduction to calculus. Instead of describing the fraction of a population that changes over any fixed time interval, the derivative describes change over an interval of time that is infinitesimally small.</p>
<p>To understand differential equations, you will need a background in calculus. If you’ve had a semester of calculus, you will have come across derivatives. Depending on how much calculus, you might not have solved differential equations. The point of this book is to introduce malaria analytics, so we will not be delving into mathematical theory or numerical methods very much.</p>
<p>In discrete-time, the equations could be written in this form:</p>
<p><span class="math display">\[
\begin{array}{rl}
x_{t+1} - x_t &amp;=  F_x (x_t, y_t) \\
y_{t+1} - y_t &amp;=  F_y (x_t, y_t)  \\
\end{array}
\]</span>
The left hand side says “the difference in” <span class="math inline">\(x\)</span> or <span class="math inline">\(y\)</span> “over one time step is equal to” <span class="math inline">\(F_x\)</span> or <span class="math inline">\(F_y,\)</span> which are functions of the two variables. We can now ask what would happen if we sub-divided a day into <span class="math inline">\(n\)</span> equal periods. In the limit as <span class="math inline">\(n\)</span> goes to infinity, we replace the differences (terms on the left hand side) with derivatives. The differential equations are now written in this form:</p>
<p><span class="math display">\[
\begin{array}{rl}
\frac{\textstyle{dx}}{\textstyle{dt}} &amp;=  F_x (x, y)  \\
\frac{\textstyle{dy}}{\textstyle{dt}} &amp;=  F_y (x, y) \\
\end{array}
\]</span></p>
<p>These differential equation models have the same components as the difference equations: variables, initial conditions, and parameters.</p>
<p>To compute anything, we will need to use numerical methods. Fortunately, R has a package to handle numerical methods for differential equations, called <strong>deSolve.</strong></p>
<p>Here, we present and solve <code>ross_xde</code>a continuous time, deterministic model that is similar to Ross’s 2nd model <span class="citation">[<a href="#ref-RossR1911Nature">32</a>]</span>.</p>
<div id="ross_xde" class="section level3 hasAnchor" number="2.3.1">
<h3 class="hasAnchor"><span class="header-section-number">2.3.1</span> <code>ross_xde</code><a href="#ross_xde" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong>Variables</strong> – In <code>ross_xde,</code> the dependent variables have the same meaning as in the <code>ross_dts</code> equations, but the independent variable. We now write an equation describing the fraction of humans and mosquitoes that are infected at each point in time.</p>
<ul>
<li><p>Let <span class="math inline">\(x(t)\)</span> be the fraction of people who are infected at time <span class="math inline">\(t,\)</span> and <span class="math inline">\(0 \leq x(t) \leq 1.\)</span></p></li>
<li><p>Let <span class="math inline">\(y(t)\)</span> be the fraction of mosquitoes who are infected at time <span class="math inline">\(t,\)</span> <span class="math inline">\(0 \leq y(t) \leq 1.\)</span></p></li>
</ul>
<p><strong>Initial Conditions</strong> – As before, we will need to define initial conditions.</p>
<p><strong>Parameters</strong> – In this model, the parameters describe rates of change.</p>
<ul>
<li><p>Let <span class="math inline">\(r\)</span> denote the fraction of people who clear infections after one day; <span class="math inline">\(0 &lt; r &lt; 1.\)</span></p></li>
<li><p>Let <span class="math inline">\(g\)</span> denote the fraction of mosquitoes who die in one day; <span class="math inline">\(0 &lt; g &lt; 1.\)</span></p></li>
<li><p>Let <span class="math inline">\(a\)</span> denote the fraction of mosquitoes who blood feed on a human in a day; <span class="math inline">\(0 &lt; a &lt; 1.\)</span></p></li>
<li><p>Let <span class="math inline">\(m\)</span> denote the number of mosquitoes per human; <span class="math inline">\(m \geq 0.\)</span></p></li>
</ul>
<p><strong>Equations</strong> – Finally, we put all this together into a mathematical statement that has translated the description of a process. There are four terms:</p>
<ul>
<li><p>The fraction of humans who are infected is <span class="math inline">\(x\)</span>; infections clear at the rate <span class="math inline">\(r.\)</span></p></li>
<li><p>The fraction of mosquitoes who are infected is <span class="math inline">\(y\)</span>; mosquitoes die at the rate <span class="math inline">\(g.\)</span></p></li>
<li><p>The fraction of humans who are not infected is <span class="math inline">\(1-x\)</span>; infections occur at the rate <span class="math inline">\(m a y.\)</span></p></li>
<li><p>The fraction of mosquitoes who are not infected is <span class="math inline">\(1-y\)</span>; infections occur at the rate <span class="math inline">\(a x.\)</span></p></li>
</ul>
<p><span class="math display">\[
\begin{array}{rl}
dx/dt &amp;= may(1-x) - r x\\
dy/dt &amp;= ax(1-y) - g y \\
\end{array}
\]</span></p>
<p>The form of the function that computes the derivatives in R is defined by <code>deSolve</code></p>
</div>
<div id="rates-vs.-proportions" class="section level3 hasAnchor" number="2.3.2">
<h3 class="hasAnchor"><span class="header-section-number">2.3.2</span> Rates <em>vs.</em> Proportions<a href="#rates-vs.-proportions" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The rates in differential equations can be compared to the proportions in discrete time systems. When the rates describe a change of state, a loss term for one of the variables, there are two easy interpretations. First, we consider the rate of loss of infected humans in a population, <span class="math inline">\(-rx.\)</span> The core underlying process is exponential decay. If we followed a cohort, the waiting time for an individual to change states would follow an exponential distribution with rate <span class="math inline">\(1/r\)</span>. Second, after one day, the fraction that remains infected is <span class="math inline">\(e^{-r}\)</span>. If we set <span class="math inline">\(r=1/200,\)</span> for example, the expected waiting time to clear an infection is 200 days. The rate of loss after one day is very close to, but slightly less than <span class="math inline">\(r\)</span>:</p>
<pre><code>## [1] 0.005000000 0.004987521</code></pre>
</div>
<div id="solutions" class="section level3 hasAnchor" number="2.3.3">
<h3 class="hasAnchor"><span class="header-section-number">2.3.3</span> Solutions<a href="#solutions" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We now want to solve the initial value problem: given <span class="math inline">\(x(0)\)</span> and <span class="math inline">\(y(0),\)</span> can we find solutions <span class="math inline">\(x(t)\)</span> and <span class="math inline">\(y(t)\)</span>? To do so, we call <code>deSolve::ode,</code> which takes for arguments: the initial values, the points in time to ouput values of <span class="math inline">\(x(t)\)</span> and <span class="math inline">\(y(t)\)</span>, a function that computes the derivatives, and the parameters:</p>
<pre><code>##   time          x          y
## 1    0 0.01000000 0.01000000
## 2    1 0.01128886 0.01172469
## 3    2 0.01279276 0.01363682
## 4    3 0.01453497 0.01577333
## 5    4 0.01654339 0.01817408
## 6    5 0.01884959 0.02088053</code></pre>
</div>
<div id="computation-visualization" class="section level3 hasAnchor" number="2.3.4">
<h3 class="hasAnchor"><span class="header-section-number">2.3.4</span> Computation &amp; Visualization<a href="#computation-visualization" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>For easy in working with these equations, we write a wrapper:</p>
<p>Because we have returned it as a data frame, the column names are <code>time</code> and <code>x</code> and <code>y.</code> We can plot the values using <code>with().</code></p>
<p><img src="figs/unnamed-chunk-46-1.png" width="672" /></p>
<p>These differential equations require</p>
</div>
<div id="steady-states-1" class="section level3 hasAnchor" number="2.3.5">
<h3 class="hasAnchor"><span class="header-section-number">2.3.5</span> Steady States<a href="#steady-states-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We can learn a bit more about how these equations behave by changing the initial values:</p>
<p><img src="figs/unnamed-chunk-48-1.png" width="672" /></p>
<p>We notice that the orbits all asymptotically approach the same values, regardless of where they started. Once there, they stay there.</p>
</div>
<div id="verification-1" class="section level3 hasAnchor" number="2.3.6">
<h3 class="hasAnchor"><span class="header-section-number">2.3.6</span> Verification<a href="#verification-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We ought to be able to compute the value of these steady states: it is a value of <span class="math inline">\(x(t)\)</span> and <span class="math inline">\(y(t)\)</span> such that <span class="math inline">\(dx/dt=dy/dt=0.\)</span> To find it, we set <span class="math inline">\(dx/dt=dy/dt=0\)</span> and solve for <span class="math inline">\(x\)</span> and <span class="math inline">\(y.\)</span> One obvious value, once again, is <span class="math inline">\(x=y=0.\)</span></p>
<p><span class="math display">\[
\begin{array}{rl}
0 &amp;= may(1-x) - r x\\
0 &amp;= ax(1-y) - g y \\
\end{array}
\]</span></p>
<p>Solve the second equation for <span class="math inline">\(y\)</span></p>
<p><span class="math display">\[y = ax/(g+ax)\]</span></p>
<p>Substitute back into the first equation:</p>
<p><span class="math display">\[ma^2 (1-x) = r(g+ax)\]</span>
and solve.</p>
<p><span class="math display">\[x = \frac{\textstyle{m a^2 - rg}}{\textstyle{m a^2 + ra}}\]</span></p>
<p>Noting that <span class="math inline">\(m a^2 &gt; rg\)</span> must be a threshold condition, we write a function to compute the steady state using the formula we just derived:</p>
<pre><code>##         x         y 
## 0.9487179 0.7400000</code></pre>
<p>We check it against the other way, which involves running the system for a very long time.</p>
<pre><code>##         x         y 
## 0.9487179 0.7400000</code></pre>
</div>
<div id="thresholds-1" class="section level3 hasAnchor" number="2.3.7">
<h3 class="hasAnchor"><span class="header-section-number">2.3.7</span> Thresholds<a href="#thresholds-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>write me.</p>
</div>
</div>
<div id="sxdeRoss" class="section level2 hasAnchor" number="2.4">
<h2 class="hasAnchor"><span class="header-section-number">2.4</span> Stochastic, Continuous Time<a href="#sxdeRoss" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In continuous time, the state of the system is updated one event at a time.</p>
<ul>
<li><p>The total rate of change of the system is <span class="math inline">\(T = may(H-X) + rX + aX(M-Y) + gY\)</span></p></li>
<li><p><span class="math inline">\(Y \rightarrow Y+1\)</span></p></li>
<li><p><span class="math inline">\(Y \rightarrow Y-1\)</span></p></li>
<li><p><span class="math inline">\(X \rightarrow X+1\)</span></p></li>
<li><p><span class="math inline">\(X \rightarrow X-1\)</span></p></li>
</ul>
<pre><code>##          t          X          Y          x          y 
##  0.3400889 11.0000000 10.0000000  0.1100000  0.2000000 
##          t          X          Y          x          y 
##  0.3675833 12.0000000 10.0000000  0.1200000  0.2000000 
##          t          X          Y          x          y 
##  0.4201633 12.0000000  9.0000000  0.1200000  0.1800000 
##          t          X          Y          x          y 
##  0.7824542 13.0000000  9.0000000  0.1300000  0.1800000 
##         t         X         Y         x         y 
##  1.072306 14.000000  9.000000  0.140000  0.180000</code></pre>
<p><img src="figs/unnamed-chunk-56-1.png" width="672" /></p>
<p><img src="figs/unnamed-chunk-57-1.png" width="768" /></p>
<p>If we want to compare it to the other model, we can compute prevalence:</p>
<p><img src="figs/unnamed-chunk-58-1.png" width="768" /></p>
</div>
<div id="mathSpecies" class="section level2 hasAnchor" number="2.5">
<h2 class="hasAnchor"><span class="header-section-number">2.5</span> Mathematical Species<a href="#mathSpecies" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>What species of mathematics is best suited for a task? Does it matter what species of mathematics we choose to build our models?</p>
<p>As we use models to help us understand malaria in some particular place, we are faced with some questions about to interpret the outputs of models. One of the reasons we presented deterministic and stochastic models in discrete-time and in continuous-time was to learn about about modeling by drawing attention to some of the differences – the models all represent the same process, but the outputs differ. Some of these differences are unsurprising and probably not important, but if we are to learn how to critically evaluate a model, we must pay attention to these differences.
s</p>
<p><img src="figs/unnamed-chunk-63-1.png" width="672" /></p>
<div id="deterministic-models" class="section level3 hasAnchor" number="2.5.1">
<h3 class="hasAnchor"><span class="header-section-number">2.5.1</span> Deterministic Models<a href="#deterministic-models" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In the deterministic models, the variables over time are repeated in exactly the same way. If we changed a parameter or an initial condition, we would of course get different orbits. The discrete-time and continuous-time models differ slightly from each other. Some small differences will persist because we are dealing with non-linear processes.</p>
<p>In the following, we have plotted the outputs of all three deterministic models, and the differences between the continuous time and the two discrete-time models (bottom). The main difference between the two models is that malaria prevalence increases more slowly in the discrete-time models. The model <code>ross_dts_1</code> is slightly closer to the continuous time model.</p>
<p><img src="figs/compare-1.png" width="672" /></p>
<p>How different are these two models? We could develop a formal distance metric to compare two models. First, since the variables in the continuous-time model is defined for every value of <span class="math inline">\(t\)</span>, but the discrete-time model is defined only for integer values of <span class="math inline">\(t\)</span>, we can only make comparisons for integer values of <span class="math inline">\(t.\)</span> In the simulations above, we took care to output the values of both models at the same time points, so we can simply take the sum of squared differences:</p>
<pre><code>## [1] 0.0003286306</code></pre>
<p>Or the sub of their absolute values of the differences:</p>
<p>We can interpret this to mean that the average sum of differences is about 1.6%</p>
<pre><code>## [1] 0.008878746</code></pre>
</div>
<div id="stochastic-models" class="section level3 hasAnchor" number="2.5.2">
<h3 class="hasAnchor"><span class="header-section-number">2.5.2</span> Stochastic Models<a href="#stochastic-models" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In stochastic models, the values of the variables differ each time we run the model.</p>
<p><img src="figs/unnamed-chunk-68-1.png" width="672" /></p>
</div>
</div>
<div id="notes" class="section level2 hasAnchor" number="2.6">
<h2 class="hasAnchor"><span class="header-section-number">2.6</span> Notes<a href="#notes" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li><p>The Reed-Frost model</p></li>
<li><p>The chain-binomial model</p></li>
</ul>
<!--chapter:end:102-Basic-Dynamics.Rmd-->
</div>
</div>
<div id="the-ross-macdonald-model" class="section level1 hasAnchor" number="3">
<h1 class="hasAnchor"><span class="header-section-number">3</span> The Ross-Macdonald Model<a href="#the-ross-macdonald-model" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p><em>A <strong>Ross-Macdonald</strong> model as a system of delay differential equations. The classification of transmission. The basic reproductive number. Vectorial capacity.</em></p>
<hr />
<p>When I first learned about malaria, I remember hearing about the <em>Ross-Macdonald</em> model, and I came across several recent papers describing Ross-Macdonald models.
A few years ago, I went searching for <em>The Ross-Macdonald Model</em> with the hope of finding a canonical form with George Macdonald’s name attached to it.
I was looking for a publication where I could find the model written down concisely as a system of differential equations.
Instead, I found that Macdonald was associated with several new ideas spread across several publications, including many ideas he attributed (or ought to have attributed) to others <span class="citation">[<a href="#ref-SmithDL2012_RossMacdonald">2</a>]</span>.
Two useful publications were by Paul Fine <span class="citation">[<a href="#ref-FinePEM1975SuperinfectionProblem">55</a>]</span> and Norman Bailey <span class="citation">[<a href="#ref-BaileyNTJ1982BiomathematicsMalaria">57</a>]</span> about Ross, Macdonald, and the various mathematical versions of malaria models.
I found the term “so-called Ross-Macdonald” in a 1982 book chapter by Joan Aron and Bob May <span class="citation">[<a href="#ref-AronJL1982PopulationDynamics">58</a>]</span>.</p>
<p>Macdonald’s papers are conceptually rich discussions of mathematical concept and data from various sources; the formulas that do appear are mostly relegated to appendices.
Between 1950 and 1956, Macdonald published 11 papers on malaria epidemiology, dynamics, and control.
(In that same interval, Macdonald published at least three other papers on other topics in malaria.)
In 1957, he published a book called <em>The Epidemiology and Control of Malaria,</em> and he was rapporteur for the <em>Sixth Report</em> of the <em>Expert Committee on Malaria,</em> which established the basic plan for the Global Malaria Eradication Programme.
In the 1960s, he published some relevant follow-up papers, including a diagram of the basic reproductive number.
Macdonald’s core contributions were to provide a synthesis of malaria epidemiology and quantitative medical entomology; to introduce Lotka’s concept of a basic reproductive number into malaria epidemiology (and indeed, to all of mathematical epidemiology); and to introduce some very basic ideas about a theory of vector control. Macdonald’s paper on the sporozoite rate revolutionized quantitative malaria epidemiology.</p>
<p>To understand Macdonald, it’s worth taking a closer look at the papers from 1950 and 1952.
In 1950, he published a synthetic review of malaria malaria epidemiology <span class="citation">[<a href="#ref-MacdonaldG1950Epidemiology">59</a>]</span>, and a new model for superinfection <span class="citation">[<a href="#ref-MacdonaldG1950Superinfection">60</a>]</span>.
The paper on superinfection has a flaw – the mathematics presented does not match the description of the process.
The issue was discussed at length by Paul Fine <span class="citation">[<a href="#ref-FinePEM1975SuperinfectionProblem">55</a>]</span>.
In 1952, Macdonald published his analysis of the sporozoite rate <span class="citation">[<a href="#ref-MacdonaldG1952Sporozoite">42</a>]</span>, and then he wrote a paper about endemic malaria that included a formula for the basic reproductive number, <span class="math inline">\(R_0\)</span> <span class="citation">[<a href="#ref-MacdonaldG1952R0">43</a>]</span>.
Macdonald reports that the mathematical analysis of superinfection and the sporozoite rate had been done by Armitage; the paper appeared in 1953 <span class="citation">[<a href="#ref-ArmitageP1953">61</a>]</span>.
A formula for superinfection, from the 1950 paper, simplifies to Ross’s equation to get the expression for <span class="math inline">\(R_0.\)</span>
In 1955-56, he published papers discussing the measurement of malaria transmission theory for control and for malaria eradication <span class="citation">[<a href="#ref-MacdonaldG1955MeasurementMalaria">62</a>–<a href="#ref-MacdonaldG1956TheoryEradication">64</a>]</span>.
The formulas in Macdonald’s footnotes and appendices from the 1952 papers have enough information to write down the equations he must have been working from, and this is what we will present in the next section.</p>
<p>The codification of the Ross-Macdonald model in the 1980s coincided with a rising interest in disease ecology and mathematical epidemiology in departments of ecology.
All this history, spanning the period from roughly 1899 to 1969, has been reviewed before <span class="citation">[<a href="#ref-SmithDL2012_RossMacdonald">2</a>]</span>, and I have added some historical notes at the end of this chapter.
My search for <em>The Ross-Macdonald Model</em> was not in vain – I learned a lot more about the history, and I discovered that no canonical version of the model exists.
What is presented in the following is the best candidate for a canonical model.
It is system of equations that uses Macdonald’s notation from the 1952 papers, that ignores any discussion of superinfection, and that replicates Macdonald’s footnotes from both papers.</p>
<div id="infection" class="section level2 hasAnchor" number="3.1">
<h2 class="hasAnchor"><span class="header-section-number">3.1</span> Infection<a href="#infection" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Macdonald’s model for superinfection was based on the idea of the <em>multiplicity of infection</em> (MoI). If infections were occurring faster than they could clear, it stands to reason that each person will carry the parasites that could be traced back to more than one infectious bite. Getting back to the question of prevalence, how long would it take for all those parasites to clear?</p>
</div>
<div id="mosquito-bionomics" class="section level2 hasAnchor" number="3.2">
<h2 class="hasAnchor"><span class="header-section-number">3.2</span> Mosquito Bionomics<a href="#mosquito-bionomics" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Macdonald made several important contributions to the mathematical study of malaria. Ross’s original formulation remained the standard until Macdonald’s paper on the sporozoite rate <span class="citation">[<a href="#ref-MacdonaldG1952Sporozoite">42</a>]</span>. Because of it’s historical interest, we’ll discuss Ross’s formulation in the discussion of [Macdonald’s Model], in part, to make it clear why Macdonald’s contribution was significant enough to get his name attached.</p>
<p>In the 1950s, George Macdonald published a set of papers describing malaria transmission dynamics and control, culminating in publicataion of a book <em>The Epidemiology and Control of Malaria</em> <span class="citation">[<a href="#ref-MacdonaldG1957Book">65</a>]</span>.
<!-- An important caveat is that Macdonald relied on the mathematical talents of Armitage for the equations describing superinfection and the sporozoite ratel  .  --></p>
<p>In 1950, Macdonald published a new model with human malaria superinfection <span class="citation">[<a href="#ref-MacdonaldG1950Superinfection">60</a>]</span> and a synthetic review of malaria epidemiology <span class="citation">[<a href="#ref-MacdonaldG1950Epidemiology">59</a>]</span>. In 1952, Macdonald published a synthetic review of medical entomology <span class="citation">[<a href="#ref-MacdonaldG1952Sporozoite">42</a>]</span> and introduced the concept of a basic reproductive number, <span class="math inline">\(R_0\)</span> <span class="citation">[<a href="#ref-MacdonaldG1952R0">43</a>]</span>.</p>
<p>As a side note, it’s highly likely that Macdonald was aware of Lotka’s demographic concept of <span class="math inline">\(R_0\)</span>, as well as his work with Sharpe on delay differential equations <span class="citation">[<a href="#ref-LotkaAJ1923part4">66</a>]</span>, though we have been unable to find a single line where Macdonald gives Lotka the credit. For these reasons, and others, the equations ought to be described as the Ross-Lotka-Macdonald model.</p>
</div>
<div id="equations" class="section level2 hasAnchor" number="3.3">
<h2 class="hasAnchor"><span class="header-section-number">3.3</span> Equations<a href="#equations" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><strong>Variables</strong></p>
<p>The model has three variables:</p>
<ul>
<li><p><span class="math inline">\(x\)</span> is the fraction of humans who are infected;</p></li>
<li><p><span class="math inline">\(y\)</span> is the fraction of adult female mosquitoes who are infected.</p></li>
<li><p><span class="math inline">\(z\)</span> is the fraction of adult female mosquitoes who are infective.</p></li>
</ul>
<p><strong>Parameters</strong></p>
<p>The model has several parameters:</p>
<ul>
<li><p><span class="math inline">\(g\)</span>: mosquitoes die at a constant rate, <span class="math inline">\(g\)</span>. This is equivalent to assuming that the mosquito lifespan is exponentially distributed with a mean <span class="math inline">\(1/g\)</span>. Macdonald’s equation use <span class="math inline">\(p\)</span>, the fraction surviving one day, <span class="math inline">\(p = e^{-g}\)</span>.</p></li>
<li><p><span class="math inline">\(\tau\)</span>: it takes <span class="math inline">\(\tau\)</span> days for parasites to mature and reach the salivary glands, called the EIP. The fraction surviving the EIP is <span class="math inline">\(p^\tau = e^{-g \tau}\)</span>.</p></li>
<li><p><span class="math inline">\(m\)</span>: there are <span class="math inline">\(m\)</span> mosquitoes per human;</p></li>
<li><p><span class="math inline">\(a\)</span>: mosquitoes blood feed on humans at the rate <span class="math inline">\(a\)</span>;</p></li>
<li><p><span class="math inline">\(b\)</span>: a fraction of bites by <em>infectious</em> mosquitoes causes an infection;</p></li>
<li><p><span class="math inline">\(r\)</span>: human malaria infections clear at the rate <span class="math inline">\(r\)</span>;</p></li>
<li><p><span class="math inline">\(c\)</span>: a fraction of bites on infected humans infect a mosquito, denoted <span class="math inline">\(c\)</span></p></li>
</ul>
<p>In this formulation of the model, we ignore the delay for the EIP but we count the mortality:</p>
<p><span class="math display">\[
\begin{array}{rl}
dx/dt &amp;= b m a z (1-x) - r x \\
dy/dt &amp;= c a x (1-y) - g y  \\
dz/dt &amp;= e^{-g \tau} c a x_\tau (1-y_\tau) - g z  \\
\end{array}
\]</span></p>
<p>this.</p>
</div>
<div id="solutions-1" class="section level2 hasAnchor" number="3.4">
<h2 class="hasAnchor"><span class="header-section-number">3.4</span> Solutions<a href="#solutions-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="the-basic-reproductive-number" class="section level2 hasAnchor" number="3.5">
<h2 class="hasAnchor"><span class="header-section-number">3.5</span> The Basic Reproductive Number<a href="#the-basic-reproductive-number" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="sensitivity-to-parameters" class="section level2 hasAnchor" number="3.6">
<h2 class="hasAnchor"><span class="header-section-number">3.6</span> Sensitivity to Parameters<a href="#sensitivity-to-parameters" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="vectorial-capacity" class="section level2 hasAnchor" number="3.7">
<h2 class="hasAnchor"><span class="header-section-number">3.7</span> Vectorial Capacity<a href="#vectorial-capacity" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="classifying-transmission" class="section level2 hasAnchor" number="3.8">
<h2 class="hasAnchor"><span class="header-section-number">3.8</span> Classifying Transmission<a href="#classifying-transmission" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="history" class="section level2 hasAnchor" number="3.9">
<h2 class="hasAnchor"><span class="header-section-number">3.9</span> History<a href="#history" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In 1975 <span class="citation">[<a href="#ref-FinePEM1975SuperinfectionProblem">55</a>]</span>, Paul Fine discusses various versions of mathematical models developed by Ross and Macdonald, discussing various formulations of models with superinfection. In 1982, Norman Bailey discusses the history of development of the models in <em>The Biomathematics of Malaria</em> <span class="citation">[<a href="#ref-BaileyNTJ1982BiomathematicsMalaria">57</a>]</span>; and Joan Aron and Robert May present a “Ross-Macdonald” model and several additional variants
<span class="citation">[<a href="#ref-AronJL1982PopulationDynamics">58</a>]</span>. Later, we argued that the name <em>Ross-Macdonald</em> model was, in fact, a</p>
<ul>
<li>The history of development of mathematical models for malaria is covered in depth by Norman T.J. Bailey in <em>The Biomathematics of Malaria.</em></li>
</ul>
<div id="lotka" class="section level3 hasAnchor" number="3.9.1">
<h3 class="hasAnchor"><span class="header-section-number">3.9.1</span> Lotka<a href="#lotka" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In retrospect, it became clear that Alfred Lotka played an important yet overlooked role in development of basic theory for malaria.
Ross had actually published three mathematical models.
Two of these described malaria transmission.
Lotka analyzed both transmission models in 1923, and in a collaboration with Sharpe, he had extended the models to consider the effects of a delay.
Lotka had also introduced the idea of a basic reproductive number for human demography.
Macdonald adapted Lotka’s ideas to malaria, largely without attribution.
Arguably, it could be called the Ross-Lotka-Macdonald model.</p>
<p>Ross’s first model described malaria transmission dynamics using difference equations <span class="citation">[<a href="#ref-RossR1908">17</a>]</span>. That model was reviewed, analyzed, and critiqued first by H. Waite in 1910 <span class="citation">[<a href="#ref-WaiteH1910MosquitoesMalaria">67</a>]</span>.</p>
<p>Aron and May <span class="citation">[<a href="#ref-AronJL1982PopulationDynamics">58</a>]</span> present a “Ross-Macdonald” model that is close to what we have Ross model, and then a v. The history of mathematical models for malaria is covered in depth by Norman T.J. Bailey in <em>The Biomathematics of Malaria.</em></p>
<p>Ross’s second model.</p>
<p>The Ross-Macdonald model and its development have been discussed elsewhere <span class="citation">[<a href="#ref-SmithDL2012_RossMacdonald">2</a>,<a href="#ref-BaileyNTJ1982BiomathematicsMalaria">57</a>,<a href="#ref-AronJL1982PopulationDynamics">58</a>]</span>; it was a model developed by Macdonald that was based on Ross’s earlier work and that was supported by the mathematical talents of Armitage. There is not a single paper where Macdonald described the system of differential equations. Instead, the model appeared in parts of several different publications that presented equations and formulas describing malaria transmission, and that reviewed existing data.</p>
<p>The model that Maconald started with was first developed by
Ronald Ross (who published two models of malaria transmission), but we also owe a lot to Alfred Lotka, who analyzed both models.</p>
<p>The formulation is a bit hard to follow, so we will present a system of difference equations in place of the equations Ross actually wrote down.</p>
<p><strong>Lotka</strong></p>
<p>Ross’s second model was thoroughly analyzed by Lotka, who had taken an active interest in Ross’s malaria models. In 1912, he published a set of solutions to Ross’s equations <span class="citation">[<a href="#ref-LotkaAJ1912Nature">54</a>]</span>. In 1923, Lotka published an analysis of both of Ross’s models in five parts. The first two parts reformulate Ross’s models <span class="citation">[<a href="#ref-LotkaAJ1923part1">38</a>,<a href="#ref-LotkaAJ1923part2">39</a>]</span>. The third part tackles numerical issues, which includes a photograph of a clay model of the phase plane as a surface <span class="citation">[<a href="#ref-LotkaAJ1923part3">40</a>]</span>, and the fifth part is a concise summary <span class="citation">[<a href="#ref-LotkaAJ1923part5">41</a>]</span>. In the <span class="math inline">\(4^{th}\)</span>, which was led by Sharpe, a new model was introduced that included delays for the latent periods <span class="citation">[<a href="#ref-LotkaAJ1923part4">66</a>]</span>.<br />
### Alfred J. Lotka</p>
<ul>
<li><p>While Alfred J. Lotka is more famous for his work in demography and ecology, he took an interest in Ross’s work on malaria and he made some important contributions to mathematical malaria epidemiology:</p></li>
<li><p>Most importantly, Lotka developed the concept of the basic reproductive number in his work in human demography, which was defined as the expected number of females that would be born to a newborn female.</p></li>
</ul>
</div>
<div id="macdonald-and-medical-entomology" class="section level3 hasAnchor" number="3.9.2">
<h3 class="hasAnchor"><span class="header-section-number">3.9.2</span> Macdonald and Medical Entomology<a href="#macdonald-and-medical-entomology" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="r_0-in-the-gmep" class="section level3 hasAnchor" number="3.9.3">
<h3 class="hasAnchor"><span class="header-section-number">3.9.3</span> <span class="math inline">\(R_0\)</span> in the GMEP<a href="#r_0-in-the-gmep" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>we’ll discuss Ross’s actual formulation,</p>
<!--chapter:end:103-Ross-Macdonald-Model.Rmd-->
</div>
</div>
</div>
<div id="metrics-and-models" class="section level1 hasAnchor" number="4">
<h1 class="hasAnchor"><span class="header-section-number">4</span> Metrics and Models<a href="#metrics-and-models" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p><em>Measuring malaria. Prevalence. Incidence. Observational processes.</em></p>
<hr />
<p>If we want to manage malaria, we must be able to measure it. Models are approximations. We make a distinction between biological processes and observational processes.</p>
<div id="malaria-epidemiology" class="section level2 hasAnchor" number="4.1">
<h2 class="hasAnchor"><span class="header-section-number">4.1</span> Malaria Epidemiology<a href="#malaria-epidemiology" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="infection-prevalence" class="section level3 hasAnchor" number="4.1.1">
<h3 class="hasAnchor"><span class="header-section-number">4.1.1</span> Infection Prevalence<a href="#infection-prevalence" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><p>Spleen Rate</p></li>
<li><p>Parasite Rate</p></li>
</ul>
</div>
<div id="infection-incidence" class="section level3 hasAnchor" number="4.1.2">
<h3 class="hasAnchor"><span class="header-section-number">4.1.2</span> Infection Incidence<a href="#infection-incidence" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>Infection vs. Disease</li>
</ul>
</div>
<div id="disease" class="section level3 hasAnchor" number="4.1.3">
<h3 class="hasAnchor"><span class="header-section-number">4.1.3</span> Disease<a href="#disease" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="serology" class="section level3 hasAnchor" number="4.1.4">
<h3 class="hasAnchor"><span class="header-section-number">4.1.4</span> Serology<a href="#serology" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
</div>
<div id="entomology" class="section level2 hasAnchor" number="4.2">
<h2 class="hasAnchor"><span class="header-section-number">4.2</span> Entomology<a href="#entomology" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="entomological-inoculation-rates" class="section level3 hasAnchor" number="4.2.1">
<h3 class="hasAnchor"><span class="header-section-number">4.2.1</span> Entomological Inoculation Rates<a href="#entomological-inoculation-rates" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><p>HBR</p></li>
<li><p>SR</p></li>
<li><p>EIR</p></li>
</ul>
</div>
<div id="bionomics" class="section level3 hasAnchor" number="4.2.2">
<h3 class="hasAnchor"><span class="header-section-number">4.2.2</span> Bionomics<a href="#bionomics" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
</div>
<div id="transmission" class="section level2 hasAnchor" number="4.3">
<h2 class="hasAnchor"><span class="header-section-number">4.3</span> Transmission<a href="#transmission" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="infectiousness" class="section level3 hasAnchor" number="4.3.1">
<h3 class="hasAnchor"><span class="header-section-number">4.3.1</span> Infectiousness<a href="#infectiousness" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="vectorial-capacity-1" class="section level3 hasAnchor" number="4.3.2">
<h3 class="hasAnchor"><span class="header-section-number">4.3.2</span> Vectorial Capacity<a href="#vectorial-capacity-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="transmission-efficiency" class="section level3 hasAnchor" number="4.3.3">
<h3 class="hasAnchor"><span class="header-section-number">4.3.3</span> Transmission Efficiency<a href="#transmission-efficiency" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
</div>
<div id="surveillance" class="section level2 hasAnchor" number="4.4">
<h2 class="hasAnchor"><span class="header-section-number">4.4</span> Surveillance<a href="#surveillance" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="observation" class="section level2 hasAnchor" number="4.5">
<h2 class="hasAnchor"><span class="header-section-number">4.5</span> Observation<a href="#observation" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<!--chapter:end:104-Metrics-and-Models.Rmd-->
</div>
</div>
<div id="research-and-policy" class="section level1 hasAnchor" number="5">
<h1 class="hasAnchor"><span class="header-section-number">5</span> Research and Policy<a href="#research-and-policy" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Macdonald’s model was put to the test in a field trial, conducted from September 1966 through February 1969 in the southern part of the Kankiya District of the Katsina Emirate in the North Central State of Nigeria <span class="citation">[<a href="#ref-NajeraJA1974CriticalReview">68</a>]</span>. A major conclusion was that there were major discrepancies that were <em>…in a considerable part due to the deficiencies of the model.</em></p>
<p>Some of those discrepancies were addressed through the development of a new model developed for a new field trial that was conducted in Garki, Nigeria <span class="citation">[<a href="#ref-DietzK1974GarkiModel">69</a>]</span>.</p>
<div id="information-and-decisions" class="section level2 hasAnchor" number="5.1">
<h2 class="hasAnchor"><span class="header-section-number">5.1</span> Information and Decisions<a href="#information-and-decisions" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="a-models-skill-set" class="section level2 hasAnchor" number="5.2">
<h2 class="hasAnchor"><span class="header-section-number">5.2</span> A Model’s Skill Set<a href="#a-models-skill-set" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="temporal-epochs" class="section level2 hasAnchor" number="5.3">
<h2 class="hasAnchor"><span class="header-section-number">5.3</span> Temporal Epochs<a href="#temporal-epochs" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="inference" class="section level2 hasAnchor" number="5.4">
<h2 class="hasAnchor"><span class="header-section-number">5.4</span> Inference<a href="#inference" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="imputation" class="section level2 hasAnchor" number="5.5">
<h2 class="hasAnchor"><span class="header-section-number">5.5</span> Imputation<a href="#imputation" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<!--chapter:end:105-Research-and-Policy.Rmd-->
</div>
</div>
<div id="part-toolbox" class="section level1 unnumbered hasAnchor">
<h1 class="unnumbered hasAnchor">(PART) Toolbox<a href="#part-toolbox" class="anchor-section" aria-label="Anchor link to header"></a></h1>
</div>
<div id="malaria-models-for-policy" class="section level1 hasAnchor" number="6">
<h1 class="hasAnchor"><span class="header-section-number">6</span> Malaria Models for Policy<a href="#malaria-models-for-policy" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="malaria-epidemiology-1" class="section level2 hasAnchor" number="6.1">
<h2 class="hasAnchor"><span class="header-section-number">6.1</span> Malaria Epidemiology<a href="#malaria-epidemiology-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="human-demography" class="section level2 hasAnchor" number="6.2">
<h2 class="hasAnchor"><span class="header-section-number">6.2</span> Human Demography<a href="#human-demography" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="the-burden-of-malaria" class="section level2 hasAnchor" number="6.3">
<h2 class="hasAnchor"><span class="header-section-number">6.3</span> The Burden of Malaria<a href="#the-burden-of-malaria" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="mosquito-ecology-and-behavior" class="section level2 hasAnchor" number="6.4">
<h2 class="hasAnchor"><span class="header-section-number">6.4</span> Mosquito Ecology and Behavior<a href="#mosquito-ecology-and-behavior" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="theory-for-vector-control" class="section level2 hasAnchor" number="6.5">
<h2 class="hasAnchor"><span class="header-section-number">6.5</span> Theory for Vector Control<a href="#theory-for-vector-control" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="blood-feeding-and-transmission" class="section level2 hasAnchor" number="6.6">
<h2 class="hasAnchor"><span class="header-section-number">6.6</span> Blood Feeding and Transmission<a href="#blood-feeding-and-transmission" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="spatial-dynamics-and-connectivity" class="section level2 hasAnchor" number="6.7">
<h2 class="hasAnchor"><span class="header-section-number">6.7</span> Spatial Dynamics and Connectivity<a href="#spatial-dynamics-and-connectivity" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Spatial</p>
</div>
<div id="parasite-diversity" class="section level2 hasAnchor" number="6.8">
<h2 class="hasAnchor"><span class="header-section-number">6.8</span> Parasite Diversity<a href="#parasite-diversity" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="evolution-of-drug-resistance" class="section level2 hasAnchor" number="6.9">
<h2 class="hasAnchor"><span class="header-section-number">6.9</span> Evolution of Drug Resistance<a href="#evolution-of-drug-resistance" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="evolution-of-insecticide-resistance" class="section level2 hasAnchor" number="6.10">
<h2 class="hasAnchor"><span class="header-section-number">6.10</span> Evolution of Insecticide Resistance<a href="#evolution-of-insecticide-resistance" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<!--chapter:end:120-Models-for-Policy.Rmd-->
</div>
</div>
<div id="heterogeneous-transmission" class="section level1 hasAnchor" number="7">
<h1 class="hasAnchor"><span class="header-section-number">7</span> Heterogeneous Transmission<a href="#heterogeneous-transmission" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>The Ross-Macdonald model is a good starting point, but if we want to develop models for policy, we will need to delve deeper into the mathematical processes that are driving malaria transmission, and we will need to understand some of the related biological processes.</p>
<div id="blood-feeding" class="section level2 hasAnchor" number="7.1">
<h2 class="hasAnchor"><span class="header-section-number">7.1</span> Blood Feeding<a href="#blood-feeding" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="mosquito-searching" class="section level3 hasAnchor" number="7.1.1">
<h3 class="hasAnchor"><span class="header-section-number">7.1.1</span> Mosquito Searching<a href="#mosquito-searching" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="risky-human-behaviors" class="section level3 hasAnchor" number="7.1.2">
<h3 class="hasAnchor"><span class="header-section-number">7.1.2</span> Risky Human Behaviors<a href="#risky-human-behaviors" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
</div>
<div id="environmental-heterogeneity" class="section level2 hasAnchor" number="7.2">
<h2 class="hasAnchor"><span class="header-section-number">7.2</span> Environmental Heterogeneity<a href="#environmental-heterogeneity" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="heterogeneous-biting" class="section level2 hasAnchor" number="7.3">
<h2 class="hasAnchor"><span class="header-section-number">7.3</span> Heterogeneous Biting<a href="#heterogeneous-biting" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<!--chapter:end:121-Heterogeneous-Transmission.Rmd-->
</div>
</div>
<div id="aron-may" class="section level1 hasAnchor" number="8">
<h1 class="hasAnchor"><span class="header-section-number">8</span> Adult Mosquito Dynamics<a href="#aron-may" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p><strong>New Concepts:</strong> non-autonomous systems</p>
<hr />
<p>If we are to do anything in malaria, we must move past Macdonald’s assumption that mosquito population density does not fluctuate.</p>
<p>The goal of this book is to present mathematical models for malaria transmission dynamics and control that are developed well enough to support malaria policies.</p>
<div id="emergence" class="section level2 hasAnchor" number="8.1">
<h2 class="hasAnchor"><span class="header-section-number">8.1</span> Emergence<a href="#emergence" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="variables" class="section level3 hasAnchor" number="8.1.1">
<h3 class="hasAnchor"><span class="header-section-number">8.1.1</span> Variables<a href="#variables" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Aron &amp; May, 1982</p>
<p>We define the following variables:</p>
<ul>
<li><p><span class="math inline">\(M\)</span> is the density of mosquitoes.</p></li>
<li><p><span class="math inline">\(Y\)</span> is the density of infected mosquitoes.</p></li>
<li><p><span class="math inline">\(Z\)</span> is the density of infectious mosquitoes.</p></li>
<li><p><span class="math inline">\(X\)</span> is the density of infected humans.</p></li>
</ul>
<p>In dynamical systems, we ask how the variables (<em>i.e.</em> <span class="math inline">\(M\)</span>, <span class="math inline">\(Y\)</span>, <span class="math inline">\(Z\)</span>, and <span class="math inline">\(X\)</span>) change over time. In the following, we describe the changes on variable about a time.</p>
<p>For our first equation, we start with adult, female mosquito populations. (It is tiresome to repeat <em>adult, female</em> each time, and we’re ignoring male mosquitoes at this point anyway, so <em>mosquito</em> hereafter means <em>adult, female mosquito</em>, unless we say otherwise.) The number of mosquitoes is changing as new adults emerge from aquatic habitats or die.</p>
<p>To model changes in <span class="math inline">\(M\)</span>, we assume the following:</p>
<ul>
<li><p>mosquitoes emerge from aquatic habitats at the rate of <span class="math inline">\(\Lambda(t)\)</span> adults, per day;</p></li>
<li><p>mosquitoes die at a constant rate, <span class="math inline">\(g\)</span>. This is equivalent to assuming that the mosquito lifespan is exponentially distributed with a mean <span class="math inline">\(1/g\)</span>. The fraction surviving one day is <span class="math inline">\(e^{-g}\)</span>.</p></li>
</ul>
<p>Our first equation describes changes in the number of mosquitoes:</p>
<p><span class="math display">\[\begin{equation}
\frac{dM}{dt} = \Lambda(t) - g M
\end{equation}\]</span></p>
</div>
<div id="blood-fed-mosquitoes" class="section level3 hasAnchor" number="8.1.2">
<h3 class="hasAnchor"><span class="header-section-number">8.1.2</span> Blood Fed Mosquitoes<a href="#blood-fed-mosquitoes" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>At this point, we will take a detour and define a variable describing the density of mosquitoes that have blood fed at least once, <span class="math inline">\(V\)</span>. After blood feeding, a mosquito is either gravid or <em>parous</em>, meaning its ovaries are distended from laying an egg batch. We do this, in part, because the fraction of mosquitoes that are parous is routinely collected, and because it gives us a chance to focus on blood feeding.</p>
<p>To describe <em>blood feeding</em>, we assume the following:</p>
<ul>
<li><p>mosquitoes blood feed at the rate <span class="math inline">\(f\)</span>, per mosquito, per day; in this model, this implies that the waiting time to a blood meal is <span class="math inline">\(1/f\)</span> days.</p></li>
<li><p>a fraction of all mosquito blood meals, <span class="math inline">\(q\)</span>, is taken on humans; we call this the <em>human fraction</em></p></li>
<li><p>the human blood feeding rate is the product of these two parameters, <span class="math inline">\(fq\)</span>, which is defined as the number of human blood meals, per mosquito, per day.</p></li>
</ul>
<p>The number of human blood meals by a population of vector mosquitoes, per person, per day is called the human biting rate (HBR). In this model, HBR is given by a formula:</p>
<p><span class="math display">\[\mbox{HBR} = \frac{fqM}{H}\]</span></p>
<p>Later, we discuss the correspondence between the HBR in models and data.</p>
<p><span class="math display">\[\begin{equation}
\frac{dY}{dt} = f q (M-Y) - g V
\end{equation}\]</span></p>
<p>We won’t use <span class="math inline">\(V\)</span> to describe the dynamics of infection, but we might find it useful to understand how parity changes in mosquito populations.</p>
</div>
<div id="infected-mosquitoes" class="section level3 hasAnchor" number="8.1.3">
<h3 class="hasAnchor"><span class="header-section-number">8.1.3</span> Infected Mosquitoes<a href="#infected-mosquitoes" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Mosquitoes become infected after blood feeding on an infectious human. To model changes in <span class="math inline">\(Y\)</span>, we extend the model of blood feeding to include infection. We need to know what fraction of blood meals end up infecting a mosquito that has not already been infected.</p>
<p>To model changes in <span class="math inline">\(Y\)</span>, we need to describe <em>infection rates</em>. We assume the following:</p>
<ul>
<li>a fraction of human blood meals, infects mosquitoes. We call this quantity <em>net infectiousness</em> (NI) and (for reasons that we will discuss in a moment), we give it a name, <span class="math inline">\(\kappa\)</span>:</li>
</ul>
<p><span class="math display">\[\begin{equation}
\kappa(t) = c \frac{X(t)}{H}
(\#eq:kappaDef)
\end{equation}\]</span></p>
<ul>
<li>infected mosquitoes die at the same rate as uninfected mosquitoes.</li>
</ul>
<p>We can now write down our second equation describing changes in the number of infected mosquitoes:</p>
<p><span class="math display">\[\begin{equation}
\frac{dY}{dt} = f q \kappa (M-Y) -g Y
\end{equation}\]</span></p>
</div>
<div id="infectious-mosquitoes" class="section level3 hasAnchor" number="8.1.4">
<h3 class="hasAnchor"><span class="header-section-number">8.1.4</span> Infectious Mosquitoes<a href="#infectious-mosquitoes" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>To become infectious, a mosquito has to become infected and then survive through the extrinsic incubation period (EIP). We assume:</p>
<ul>
<li><p>mosquitoes become infectious after a fixed delay, <span class="math inline">\(\tau\)</span> days, called the EIP. The fraction of mosquitoes that survive through the EIP is <span class="math inline">\(e^{-g \tau}\)</span>.</p></li>
<li><p>infectious mosquitoes die at the same rate as other mosquitoes.</p></li>
</ul>
<p>For a mosquito to become infectious, it must have become infected <span class="math inline">\(\tau\)</span> days ago and survived through <span class="math inline">\(\tau\)</span> days with probability <span class="math inline">\(e^{-g\tau}\)</span>. To write this in equations, we use a subscripted <span class="math inline">\(\tau\)</span> to denote the value of a variable (<span class="math inline">\(M\)</span>, <span class="math inline">\(Y\)</span> or <span class="math inline">\(X\)</span>) or term (<span class="math inline">\(\kappa\)</span>) at time <span class="math inline">\(t-\tau\)</span>. For example <span class="math inline">\(X_\tau\)</span> is the number of people who were infected and infecious at time <span class="math inline">\(t-\tau\)</span>, and <span class="math inline">\(M_\tau\)</span> is the number of mosquitoes at time <span class="math inline">\(t-\tau\)</span>.</p>
<p>The number of infectious mosquitoes that are added to the population at a point in time includes all the mosquitoes that became infected at time <span class="math inline">\(t-\tau\)</span> and survived the EIP. This is our third equation describing changes in the number of infectious mosquitoes:</p>
<p><span class="math display">\[\begin{equation}
\frac{dZ}{dt} = f q  \kappa_\tau (M_\tau-Y_\tau) e^{-g\tau} -g Z
\end{equation}\]</span></p>
<p>Here, <span class="math inline">\(Z\)</span> represents the number of mosquitoes with <em>sporozoites</em> in their salivary glands. The <em>fraction</em> of mosquitoes with sporozoites in their salivary glands has been called the <em>sporozoite rate</em> (SR), which in our notation is</p>
<p><span class="math display">\[ z = \frac{Z}{M}\]</span></p>
<p>The number of bites by vector mosquitoes, per person, per day is called the entomological inoculation rate (EIR). It is defined as the product of the HBR and the SR:</p>
<p><span class="math display">\[\mbox{EIR} = \mbox{SR} \times \mbox{HBR}\]</span></p>
<p>In our notation, the EIR is:</p>
<p><span class="math display">\[\mbox{EIR} = z \frac{fqM}{H} = \frac{fqZ}{H}\]</span>
As with the HBR, we would like to know how to connect estiamted values of the EIR to our formulas. Since that’s <em>really</em> complicated, we’ve spent a lot of time in the following sections discussing it.</p>
</div>
<div id="RossEqn" class="section level3 hasAnchor" number="8.1.5">
<h3 class="hasAnchor"><span class="header-section-number">8.1.5</span> Infected Humans<a href="#RossEqn" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Humans become infected after being bitten by an infectious mosquito. We assume the following:</p>
<ul>
<li><p>A fraction <span class="math inline">\(b\)</span> of all bites by infectious mosquitoes cause an infection.</p></li>
<li><p>The hazard rate for infection, also called the <em>force of infection</em> (FoI) and denoted <span class="math inline">\(h\)</span> is <span class="math inline">\(b \times\)</span> EIR: <span class="math display">\[h = fqb \frac{Z}{H}\]</span></p></li>
<li><p>Infections clear at the rate <span class="math inline">\(r\)</span>, per infection, per day (the average time to clear is <span class="math inline">\(1/r\)</span> days), and after clearing an infection a person becomes susceptible to infection again.</p></li>
</ul>
<p>We can now write down our fourth equation describing changes in the number of infected humans:</p>
<p><span class="math display">\[\begin{equation}
\frac{dX}{dt} = h (H-X) - r X
\end{equation}\]</span></p>
</div>
<div id="as-a-system" class="section level3 hasAnchor" number="8.1.6">
<h3 class="hasAnchor"><span class="header-section-number">8.1.6</span> …as a System<a href="#as-a-system" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>While we presented these equations one at a time, they work as a system. To see it all at once, we write it here as a system with four equations and two terms:</p>
<p><span class="math display">\[\begin{equation}
\begin{array}{rl}
\frac{dM}{dt} &amp;= \Lambda(t) - g M \\
\frac{dY}{dt} &amp;= fq\kappa(M-Y) - g Y \\
\frac{dZ}{dt} &amp;= fq\kappa_\tau(M_\tau-Y_\tau)e^{-g\tau} - g Z \\
\frac{dX}{dt} &amp;= h (H-X) - rX  \\ \\ \hline \\
\kappa &amp;= c \frac{X(t)}{H} \\
h &amp;= b fq \frac{Z(t)}{H} \\
\end{array}
\end{equation}\]</span></p>
<center>
<div class="float">
<img src="Figures/AronMay.png" alt="A diagram of the a version of the Ross-Macdonald model, using equations from Aron and May [58]" />
<div class="figcaption">A diagram of the a version of the Ross-Macdonald model, using equations from Aron and May <span class="citation">[<a href="#ref-AronJL1982PopulationDynamics">58</a>]</span></div>
</div>
</center>
<p>These equations describe processes in three domains (Figure 2.1):</p>
<ul>
<li><p>adult mosquito ecology (<span class="math inline">\(M\)</span>, and perhaps <span class="math inline">\(V\)</span>);</p></li>
<li><p>parasite infection dynamics in mosquito populations (<span class="math inline">\(Y\)</span> and <span class="math inline">\(Z\)</span>);</p></li>
<li><p>parasite infection dynamics in human populations (<span class="math inline">\(X\)</span>).</p></li>
</ul>
<p>The equations describing parasite infections in mosquito populations also include the variable <span class="math inline">\(M\)</span>, so the mosquito infection dynamics are coupled to the mosquito population dynamics. The way we’ve written the equations, each compartment has an input term (<em>i.e.</em>, <span class="math inline">\(\Lambda\)</span>, <span class="math inline">\(\kappa\)</span>, or <span class="math inline">\(h\)</span>) that depends on something else. We’ve passed <span class="math inline">\(\Lambda\)</span> as a parameter. For the infection dynamics, the terms <span class="math inline">\(\kappa\)</span> and <span class="math inline">\(h\)</span> couple two separate systems. For adult mosquito dynamics, emergence is passed to the model as a parameters.</p>
<p>There are, of course, more compact ways of writing these equations. We have written the equations this way to emphasize a few things. First, the terms make it clear exactly how the equations in one domain are connected to another. Second, if we wanted to start <em>changing</em> some of the assumptions, these terms help to isolate the parts we might like to change. By writing the equations in this modularized form, we can start to understand how we might be able to write software that would allow us to represent mosquito infection dynamics with different systems of equations.</p>
<p>The next step is to find solutions.</p>
<p><em>NOTE:</em> We don’t introduce <code>exDE</code> or <code>MicroMoB</code> until <a href="#modularity-and-software">Modularity and Software</a>.</p>
</div>
<div id="solutions-2" class="section level3 hasAnchor" number="8.1.7">
<h3 class="hasAnchor"><span class="header-section-number">8.1.7</span> Solutions<a href="#solutions-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>What does a <strong>solution</strong> to these equations look like?</p>
<p>Solutions to these equations are values of the variables over time <span class="math inline">\(\left( M(t), Y(t), Z(t), X(t) \right)\)</span> that satisfy the system of four equations described above. We call these solutions <em>orbits.</em> To put it another way, if we took the derivatives of the orbits for any variable at any point in time using the basic definition <span class="math display">\[\lim_{h\rightarrow 0} \frac{x(t+h)-x(t)}{h},\]</span> and then we used the values of the variables at time <span class="math inline">\(t\)</span> to compute <span class="math inline">\(dM/dt\)</span>, <span class="math inline">\(dY/dt\)</span>, <span class="math inline">\(dZ/dt\)</span>, and <span class="math inline">\(dX/dt\)</span> (<em>i.e.</em>, using the formulas), we would get the same values.</p>
<p>It is important that these orbits are unique: after specifying the <em>initial values</em> of the variables, there is one and only one set of orbits that solves the equations. When we solve the equations, we usually produce solutions from a starting point into a future, but the orbits are defined for all time – <span class="math inline">\(i.e.\)</span> the process implies the existence of solutions far back into the past. These are deterministic equations, after all.</p>
<p>As written, the equations do not define a <em>model.</em> Instead, the equations define a process or a <strong>model family.</strong> A model is something that <em>can</em> produce orbits. A model is defined only after assigning specific values to the parameters. Informally, we will often slip and use the “model” to describe a model family. It’s easy to slip up, and sometimes we can get by with being sloppy, but we need to remember the distinction. When we say that the software is <em>modular,</em> we mean that it is easy to swap out one <em>model family</em> for another.</p>
<p>To find solutions of equations we use an R software package called <code>deSolve.</code> Because of the delay for the EIP, these are called <em>delay differential equations,</em> which are handled using a function called <code>dede</code>. An important step in solving delay differential equations is a function <code>lagvalue()</code> that computes and returns the values of variables at a time lag, <span class="math inline">\(\ell\)</span>. In these equations, the lag is set by the EIP, <span class="math inline">\(\tau\)</span>, so we must evaluate
<code>lagvalue(t-tau).</code></p>
<p>In solving <em>ordinary differential equations,</em> we must pass initial conditions. To solve a delay differential equations with a maximum lag <span class="math inline">\(\ell\)</span>, we must specify the initial conditions for the interval <span class="math inline">\([-\ell, t_0)\)</span>, where <span class="math inline">\(t_0\)</span> is the point in time when we start computing solutions.
In these equations, since the equation for <span class="math inline">\(dZ/dt\)</span> looks back <span class="math inline">\(\tau\)</span> units, we must specify values of <span class="math inline">\(M(t)\)</span>, <span class="math inline">\(Y(t)\)</span>, and <span class="math inline">\(X(t)\)</span> for all values of <span class="math inline">\(t \in [-\tau, t_0)\)</span>. This forces an awkward choice, since we don’t know the solutions backwards in time, but would need to know those solutions to use them. What is typically done – and we’ve done it here – is to specify a constant set of initial values and moving on.</p>
<p>Doing this introduces a little <em>numerical slop.</em> By slop, we mean that these values are <em>not</em> what we would get if we ran the equations backwards in time. In these equations, it won’t affect our analysis most of the time, so we’re happy to acknowledge this little problem and find ways around it. It’s a little thing, but we should never forget it, because we might find that it <em>is</em> affecting our analysis at some point.</p>
<p>With <code>deSolve,</code> solving differential equations is not difficult – it just involves following a few steps. In the following, we walk through these steps:</p>
<ul>
<li><p>Write a function that computes the derivatives;</p></li>
<li><p>Define initial conditions;</p></li>
<li><p>Define the values of the parameters;</p></li>
<li><p>Define a mesh on time;</p></li>
<li><p>Call a function that solves the equations, such as <code>dede</code> for delay differential equations.</p></li>
</ul>
<p>Many users will find that reading this code is like learning how to compute <span class="math inline">\(\sqrt{2}\)</span>. If so, feel free to learn it once and then skip it.</p>
<div id="derivatives" class="section level4 hasAnchor" number="8.1.7.1">
<h4 class="hasAnchor"><span class="header-section-number">8.1.7.1</span> Derivatives<a href="#derivatives" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The first step is to write down the equations to compute the derivatives. The solver expects a function with three required arguments (in this order):</p>
<ul>
<li><p><code>t</code> is time</p></li>
<li><p><code>y</code> is the list of variables</p></li>
<li><p><code>params</code> is a set of parameters</p></li>
</ul>
<p>The derivatives are computed and returned in the same order as ‘y’ in a <code>list</code>. To make code that is easy to read, we make <code>params</code> as a <code>list</code> with parameter names (see below), so that inside the function <code>with(params,{...})</code>, the parameter names are visible.</p>
</div>
</div>
<div id="initial-values" class="section level3 hasAnchor" number="8.1.8">
<h3 class="hasAnchor"><span class="header-section-number">8.1.8</span> Initial Values<a href="#initial-values" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>To run the model, we must supply initial values. If you were writing code yourself, it would be important to remember that the initial values and the return value for the derivatives must occur in the same order.</p>
<p>A useful convention in {R} is to pass the initial values as a named list. Later, we can turn the outputs into a data frame, and then we can retrieve the variables by name.</p>
<p>The object <code>y0</code> is a named list – the names are attached but invisible.</p>
<pre><code>##  M  Y  Z  X 
## 60  0  0  1</code></pre>
<p>When we turn it into a list, with <code>as.list,</code> the names are attached to the values:</p>
<pre><code>## [1] 60</code></pre>
<p>If we use <code>with</code>, we create an environment where we can simply use the names:</p>
<pre><code>## [1] 60</code></pre>
</div>
<div id="parameter-values" class="section level3 hasAnchor" number="8.1.9">
<h3 class="hasAnchor"><span class="header-section-number">8.1.9</span> Parameter Values<a href="#parameter-values" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We pass the parameters as a list. It might seem like overkill, but we have written a function <code>makeParams()</code> that takes default values and generates a list. This makes it easy to generate a new set of parameter values with alternative values, and it also helps us to write and pass function <span class="math inline">\(\Lambda(t)\)</span> with parameters we like. By passing the parameter as a list, the parameter values are available to the function <code>dAronMay</code> when we use <code>with(params, {})</code>.</p>
<p>Note that we have also attached the initial values of the variables as a parameter set, which are the return values for <code>lagvalue(t)</code> when <code>t&lt;0</code>.</p>
<p>To make it absolutely clear, we are assuming:</p>
<ul>
<li><p><span class="math inline">\(g=1/12\)</span>: mosquitoes live about <span class="math inline">\(12\)</span> days, on average</p></li>
<li><p><span class="math inline">\(f=1/2.5\)</span>: mosquitoes feed every 2.5 days, on average</p></li>
<li><p><span class="math inline">\(q=0.95\)</span>: the human fraction is 95%; mosquitoes feed on humans 95% of the time</p></li>
<li><p><span class="math inline">\(c=0.15\)</span>: about 15% of bites on infectious humans infect a mosquito</p></li>
<li><p><span class="math inline">\(b=0.55\)</span>: about 55% of bites by infective mosquitoes cause an infection</p></li>
<li><p><span class="math inline">\(r=1/200\)</span>: human infections last about <span class="math inline">\(200\)</span> days, on average</p></li>
<li><p><span class="math inline">\(H=1000\)</span>: we’re simulating transmission in a population of a thousand humans</p></li>
<li><p><span class="math inline">\(\tau=10\)</span>: the extrinsic incubation period is about 10 days</p></li>
<li><p>For emergence, we tune the average value using <span class="math inline">\(m\)</span> and it is scaled to <span class="math inline">\(H\)</span>:</p>
<ul>
<li><p>The parameter <span class="math inline">\(m\)</span> in the function above has been set to <span class="math inline">\(0.05\)</span> by default.</p></li>
<li><p>The parameter <span class="math inline">\(ss\)</span> affects the amplitude of the fluctuations. We force it to take on values between 0 and 1.</p></li>
<li><p>Emergence is modeled as a sinusoidal function with a yearly cycle.</p></li>
</ul></li>
</ul>
<p><span class="math display">\[\Lambda(t) = m H \left(1 + \sin \left(\frac{2\pi t}{365}\right)\right)\]</span></p>
</div>
<div id="solving-1" class="section level3 hasAnchor" number="8.1.10">
<h3 class="hasAnchor"><span class="header-section-number">8.1.10</span> Solving<a href="#solving-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We define a mesh over time – the points in time when we would like to know the values of the variables:</p>
<p>This code solves the equations:</p>
</div>
<div id="visualizing-1" class="section level3 hasAnchor" number="8.1.11">
<h3 class="hasAnchor"><span class="header-section-number">8.1.11</span> Visualizing<a href="#visualizing-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>When we plot out the solutions, they look like this.</p>
<p><img src="figs/unnamed-chunk-77-1.png" width="528" /></p>
</div>
</div>
<div id="steady-states-2" class="section level2 hasAnchor" number="8.2">
<h2 class="hasAnchor"><span class="header-section-number">8.2</span> Steady States<a href="#steady-states-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Here, we analyze the system of equations in a narrow case when there is <em>no seasonality,</em> and the system reaches a <em>steady state.</em> To do so, we set the parameter <code>ss=1</code>, so that <span class="math inline">\(\Lambda(t)\)</span> is a constant; the resulting system is <em>autonomous.</em> We do this, in part, because the resulting system is easier to understand. We can develop intuition that can be applied (albeit with caution) to more complex systems. To be clear, we are dealing with this system:</p>
<p><span class="math display">\[\begin{equation}
\begin{array}{rl}
\frac{dM}{dt} &amp;= \Lambda - g M \\
\frac{dY}{dt} &amp;= fq\kappa(M-Y) - g Y \\
\frac{dZ}{dt} &amp;= fq\kappa_\tau(M_\tau-Y_\tau)e^{-g\tau} - g Z \\
\frac{dX}{dt} &amp;= h (H-X) - rX  \\ \\ \hline \\
\kappa &amp;= c \frac{X(t)}{H} \\
h &amp;= b fq \frac{Z(t)}{H} \\
\end{array}
\end{equation}\]</span></p>
<p>As before, we have put the equations in their modularized form above, and the connecting terms below.</p>
<p>The first thing to note is that <span class="math inline">\(M\)</span> affects <span class="math inline">\(Y\)</span> and <span class="math inline">\(Z\)</span>, which affect <span class="math inline">\(X\)</span>; but <span class="math inline">\(M\)</span> is not affected by <span class="math inline">\(Y\)</span> or <span class="math inline">\(Z\)</span>. Mosquito population density is <em>exogenous</em> to malaria dynamics.</p>
<div id="mosquito-density" class="section level3 hasAnchor" number="8.2.1">
<h3 class="hasAnchor"><span class="header-section-number">8.2.1</span> Mosquito Density<a href="#mosquito-density" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We can thus treat it separately in the analysis:</p>
<p><span class="math display">\[\begin{equation}
\frac{dM}{dt} = \Lambda - g M
\end{equation}\]</span></p>
<p>Since emergence rates are steady, mosquito population density reaches a steady state when <span class="math inline">\(dM/dt=0\)</span>, which occurs at:</p>
<p><span class="math display">\[\begin{equation}
\bar M = \frac{\Lambda}{g}
\end{equation}\]</span></p>
</div>
<div id="eir" class="section level3 hasAnchor" number="8.2.2">
<h3 class="hasAnchor"><span class="header-section-number">8.2.2</span> EIR<a href="#eir" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Next, we note that at a steady state, the delayed values of variables and terms don’t change, so from <span class="math inline">\(dY/dt\)</span>, we get:</p>
<p><span class="math display">\[\begin{equation}
g \bar Y = fq\kappa(\bar M- \bar Y)
\end{equation}\]</span></p>
<p>If we substitute the formula for <span class="math inline">\(\bar M\)</span> and solve for <span class="math inline">\(\bar Y\)</span>, we get:</p>
<p><span class="math display">\[\begin{equation}
\bar Y = \frac{fq\kappa}{g + fq\kappa} \frac{\Lambda}{g}
\end{equation}\]</span></p>
<p>and since at the steady state, any variable at time <span class="math inline">\(t+\tau\)</span> is equal to its value at time <span class="math inline">\(t\)</span>, we substitute the formula for <span class="math inline">\(g \bar Y\)</span> into <span class="math inline">\(dZ/dt\)</span> to get:</p>
<p><span class="math display">\[\begin{equation}
g \bar Y e^{-g\tau} = g \bar Z
\end{equation}\]</span></p>
<p>Solving for <span class="math inline">\(\bar Z\)</span> we get:</p>
<p><span class="math display">\[\begin{equation}
\bar Z =  \frac{f q \kappa}{g + fq \kappa} \frac{\Lambda}{g} e^{-g\tau}
\end{equation}\]</span></p>
<p>At the steady state, <span class="math display">\[\mbox{EIR} = fq \frac{\bar Z}{H}.\]</span></p>
<p>In field studies, the EIR is the product of the HBR and the sporozoite rate (SR). The sporozoite rate (SR, <span class="math inline">\(z\)</span>) is given by:</p>
<p><span class="math display">\[\begin{equation}
\bar z =  \frac{Z}{M} = \frac{f q \kappa}{g + fq \kappa} e^{-g\tau}
\end{equation}\]</span></p>
<p>So we can understand the EIR as having two parts:</p>
<p><span class="math display">\[\begin{equation}
\mbox{EIR} = \mbox{HBR} \times  \mbox{SR}
\end{equation}\]</span></p>
<p>or equivalently</p>
<p><span class="math display">\[\begin{equation}
\mbox{EIR} = \frac{\textstyle{fq\Lambda}}{\textstyle{H}} \times \frac{\textstyle{f q \kappa}}{\textstyle{g + fq \kappa}} e^{-g\tau}
\end{equation}\]</span></p>
<p>This formula for the SR (albeit with slightly different notation) was originally derived as part of the Ross-Macdonald model <span class="citation">[<a href="#ref-MacdonaldG1952Sporozoite">42</a>,<a href="#ref-ArmitageP1953">61</a>]</span>. Also, Smith and McKenzie (2004) have written a useful discussion of mosquito demography <span class="citation">[<a href="#ref-SmithDL2004Statics">70</a>]</span>.</p>
</div>
<div id="vectorial-capacity-2" class="section level3 hasAnchor" number="8.2.3">
<h3 class="hasAnchor"><span class="header-section-number">8.2.3</span> Vectorial Capacity<a href="#vectorial-capacity-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Here, we pause to define a term that describes the number of human blood meals each mosquito would take over its whole life:</p>
<p><span class="math display">\[S = \frac{fq}{g}.\]</span></p>
<p>Since <span class="math inline">\(1/g\)</span> is the mosquito lifespan in days, and <span class="math inline">\(fq\)</span> is the human blood feeding rate, <span class="math inline">\(S\)</span> is the number of human bloodmeals a mosquito would take over its lifespan. Intuitively, it makes sense that this <em>should</em> be what drives transmission, since it takes two human blood meals to transmit malaria parasites.</p>
<p>If we rearrange the terms a bit, we can rewrite out the expression for the EIR:</p>
<p><span class="math display">\[\begin{equation}
\mbox{EIR}(\kappa) = fq \frac{\bar Z}{H} = \frac{\Lambda}{H} S^2  e^{-g\tau} \frac{\kappa}{1 + S \kappa}
\end{equation}\]</span></p>
<p>This formula for the EIR has two parts. We call the first part <em>vectorial capacity</em> (<span class="math inline">\(V\)</span>):</p>
<p><span class="math display">\[\begin{equation}
V = \frac{\Lambda}{H} S^2  e^{-g\tau}
(\#eq:VCdefined)
\end{equation}\]</span></p>
<p>The second part is an expression that involves mainly <span class="math inline">\(\kappa\)</span>.</p>
<p><span class="math display">\[\begin{equation}
\frac{\kappa}{1 + S \kappa}
(\#eq:EIR2ndpart)
\end{equation}\]</span></p>
<p>The relationship between VC and EIR at a steady state is a product:</p>
<p><span class="math display">\[\begin{equation}
\mbox{EIR}(\kappa) = V \frac{\kappa}{1 + S \kappa}
(\#eq:EIR2VC)
\end{equation}\]</span></p>
<p>Vectorial capacity describes the slope of the EIR when <span class="math inline">\(\kappa\)</span> is small:</p>
<p><span class="math display">\[\begin{equation}
\left. d\frac{\mbox{EIR}(\kappa)}{d\kappa}\right|_{\kappa = 0} = V
(\#eq:VCisdEIR)
\end{equation}\]</span></p>
<p>We say that VC describes <em>potential</em> transmission, even if the parasites are absent. Another way to say the same thing is that when <span class="math inline">\(\kappa\)</span> is small, then:</p>
<p><span class="math display">\[\begin{equation}
\mbox{EIR}(\kappa) \approx V \kappa
\end{equation}\]</span></p>
<p>We can interpret vectorial capacity (<span class="math inline">\(V\)</span>) in simple terms. It describes <em>the number of infective bites that would arise from all the mosquitoes biting a single human on a single day</em> but only <em>if all those mosquitoes became infected.</em> Vectorial capacity tells the story of potential parasite transmission by mosquitoes in four steps, which highlights the fact that two human blood meals are required for the parasite to be transmitted and complete its life-cycle.</p>
<p><span class="math display">\[\begin{equation}
\begin{array}{|c|c|c|c|c|c|c|}
\Lambda/H &amp;  &amp; S \kappa &amp;  &amp; e^{-g\tau} &amp; &amp; S \\
&amp; \rightarrow &amp;  &amp; \rightarrow &amp;  &amp; \rightarrow &amp;  \\
\mbox{Mosquito} &amp; &amp; \mbox{Parasite} &amp; &amp; \mbox{Mosquito} &amp;&amp; \mbox{Parasite} \\
\mbox{Emerges} &amp; &amp; \mbox{Infects} &amp; &amp; \mbox{Survives} &amp;&amp; \mbox{Infects} \\
&amp; &amp; \mbox{Mosquito} &amp; &amp; \mbox{EIP} &amp;&amp; \mbox{Human}
\end{array}
(\#eq:VCstory)
\end{equation}\]</span></p>
<p>As a reminder, while Eq. @ref(eq:VCstory) includes <span class="math inline">\(\kappa\)</span>, the formula for VC, in Eq. @ref(eq:VCdefined), assumes that <span class="math inline">\(\kappa=1\)</span>: the VC describes transmission as if humans were perfectly infectious. It was defined this way on purpose: it was meant to include mosquito parameters and exclude human factors. We can think of VC as defining something like a conditional expectation, a maximum, or (as we have already said) a measure of <em>potential transmission by mosquitoes</em> that is independent of human factors.</p>
<p>While <span class="math inline">\(\kappa\)</span> (the numerator in Eq.@ref(eq:EIR2ndpart) accounts for <em>most</em> of the difference between the EIR and the VC, the rest of the difference is due to the denominator in Eq. @ref(eq:EIR2ndpart), <span class="math inline">\(1+S\kappa\)</span>, which traces back to the formula from <span class="math inline">\(dY/dt\)</span>, which assumes that mosquitoes are either infected or not. The denominator is a measure of saturation – the fraction of mosquitoes that get <em>superinfected</em> with parasites. The main point here is that as <span class="math inline">\(\kappa\)</span> increases, saturation increases. If we set <span class="math inline">\(S\)</span> to the values in the previous plots, we can isolate the relationship:</p>
<div class="figure">
<img src="figs/unnamed-chunk-78-1.png" alt="The effect (compare the solid and dashed black lines) and effect size of saturation (blue), graphically." width="672" />
<p class="caption">
(#fig:unnamed-chunk-78)The effect (compare the solid and dashed black lines) and effect size of saturation (blue), graphically.
</p>
</div>
<p>In these formulas, the measure of saturation is exactly <span class="math inline">\(1+S\kappa\)</span>. We could rewrite the relationship between the EIR and VC in a way
that tells us something about how we might be underestimating a parasite’s reproductive success:</p>
<p><span class="math display">\[\mbox{EIR}\times (1 + S \kappa) = V \kappa\]</span>
which suggests that each infectious bite is passing along an excess <span class="math inline">\(S\kappa\)</span> bites.</p>
</div>
<div id="malaria-prevalence-thresholds" class="section level3 hasAnchor" number="8.2.4">
<h3 class="hasAnchor"><span class="header-section-number">8.2.4</span> Malaria Prevalence &amp; Thresholds<a href="#malaria-prevalence-thresholds" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We let <span class="math inline">\(x\)</span> denote infection prevalence:</p>
<p><span class="math display">\[\begin{equation}
x = \frac{X}{H}
\end{equation}\]</span></p>
<p>so <span class="math inline">\(\kappa = c x\)</span>, and</p>
<p><span class="math display">\[\begin{equation}
\frac{dx}{dt} = \frac{1}{H} \frac{dX}{dt} = h (1-x)-r x
\end{equation}\]</span></p>
<p>We can also define the basic reproductive number:</p>
<p><span class="math display">\[\begin{equation}
R_0 = \frac{bcV}{r}.
\end{equation}\]</span></p>
<p>It is the product of four terms:</p>
<ul>
<li><p>Vectorial capacity, <span class="math inline">\(V\)</span>, the number of infective bites, per person, per day;</p></li>
<li><p>The number of days a person would remain infectious, <span class="math inline">\(1/r\)</span>;</p></li>
<li><p>The fraction of infectious bites that would infect a human, <span class="math inline">\(b\)</span>;</p></li>
<li><p>The fraction of blood meals on infectious humans that would infect a mosquito, <span class="math inline">\(c\)</span></p></li>
</ul>
<p>After taking their product, we can interpret <span class="math inline">\(R_0\)</span> as a measure of the parasite’s reproductive success after a single generation. It only depends on where we start counting. It could be one of the following:</p>
<ul>
<li><p>the number of infected mosquitoes that would arise from a single infected mosquito;</p></li>
<li><p>the number of infectious mosquitoes that would arise from a single infectious mosquito;</p></li>
<li><p>the number of infected and infectious humans that would arise from a single infected and infectious human.</p></li>
</ul>
<p>Here, <span class="math inline">\(R_0\)</span> plays an important role in these equations if we start with <span class="math inline">\(dX/dt\)</span>; then transform it to <span class="math inline">\(dx/dt\)</span>; then replace <span class="math inline">\(h\)</span> with <span class="math inline">\(bE\)</span>; then replace <span class="math inline">\(\kappa\)</span> with <span class="math inline">\(cx\)</span>; then divide by <span class="math inline">\(r\)</span>; and rearrange:</p>
<p><span class="math display">\[\begin{equation}
\frac{1}{r} \frac{dx}{dt} = x \left[R_0 \left(\frac{1-x}{1 + cSx} \right)  - 1\right]  
\end{equation}\]</span></p>
<p>Since <span class="math inline">\(x\)</span> is the prevalence, it is always in the interval <span class="math inline">\([0,1]\)</span>. When <span class="math inline">\(x\)</span> is very close to <span class="math inline">\(0\)</span>, then</p>
<p><span class="math display">\[\begin{equation}
\frac{1-x}{1 + cSx} \lesssim 1.
\end{equation}\]</span></p>
<p>and as <span class="math inline">\(x\)</span> grows very small:</p>
<p><span class="math display">\[\begin{equation}
\lim_{x \rightarrow 0} \frac{1-x}{1 + cSx} = 1.
\end{equation}\]</span></p>
<p>It follows that when <span class="math inline">\(x\)</span> is small, <span class="math inline">\(dx/dt&gt;0\)</span> if and only if <span class="math inline">\(R_0 &gt; 1\)</span>. Depending on <span class="math inline">\(R_0\)</span>, only one of two possibilities can hold:</p>
<ul>
<li><p>either <span class="math inline">\(R_0&lt;1\)</span>, so that <span class="math inline">\(x=0\)</span> is the steady state;</p></li>
<li><p>or <span class="math inline">\(R_0 &gt; 1\)</span>, and the steady state is:</p></li>
</ul>
<p><span class="math display">\[\begin{equation}
\bar x = \frac{R_0 -1}{R_0 + c S}
\end{equation}\]</span></p>
<p>Since at the steady state, <span class="math inline">\(\kappa = c \bar x\)</span>, we can plug this back into the formulas above to get <span class="math inline">\(\bar Y\)</span> and <span class="math inline">\(\bar Z\)</span>.</p>
<p>What we’ve learned about these equations is that if mosquito population densities are constant, then malaria reaches a steady state: if <span class="math inline">\(R_0 &gt;1\)</span>, then there is a positive endemic equilibrium, and if <span class="math inline">\(R_0 &lt; 1\)</span>, then malaria is absent from the system. The system is said to be stable – in fact, is is globally asymptotically stable, which means that all the orbits end up converging to the steady state. This statement has been proved many times in many papers, and since this book is focused on policy, we’ll let others worry about proofs.</p>
</div>
<div id="checking-our-work" class="section level3 hasAnchor" number="8.2.5">
<h3 class="hasAnchor"><span class="header-section-number">8.2.5</span> Checking our Work<a href="#checking-our-work" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>An advantage of working in this environment is that we can check our work. One way we could solve these equations would be to run them for a very long time:</p>
<p>We make a parameter set that defines the model:</p>
<pre><code>## [1] 600.00000 211.01706  91.70764 793.10541</code></pre>
<p>By plotting it out, we can check to see if we’ve run it for long enough:</p>
<p><img src="figs/unnamed-chunk-81-1.png" width="528" /></p>
<p>We can check our algebra by computing the same quantities, and <span class="math inline">\(R_0\)</span> and other quantities we care about:</p>
<pre><code>## $std
##         M         Y         Z         X 
## 600.00000 211.01706  91.70764 793.10541 
## 
## $extra
##      S      V     R0      x  kappa    EIR    FoI 
## 4.5600 0.4520 7.4600 0.7930 0.1190 0.0348 0.0192 
## 
## $annual
## aEIR aFoI 
## 12.7  7.0</code></pre>
<p>Now, we can compare directly:</p>
<pre><code>##       M        Y        Z        X
## eq1 600 211.0171 91.70764 793.1054
## eq2 600 211.0171 91.70764 793.1054</code></pre>
</div>
</div>
<div id="stable-orbits" class="section level2 hasAnchor" number="8.3">
<h2 class="hasAnchor"><span class="header-section-number">8.3</span> Stable Orbits<a href="#stable-orbits" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>If emergence rates vary seasonally, how much of the analysis that we did to understand <em>steady states</em> still holds? Obviously, if conditions are changing seasonally, the model does not reach a steady state. In fact, after modification to suit the context, many of the same principles translate. The steady state analysis provides a good qualitative guide, but that the answers will look different. Here, we illustrate by solving systems to illustrate some basic points, which is easy enough. Analysis of the resulting dynamics can be quite difficult; it is covered in <a href="#temporal-dynamics">Temporal Dynamics</a>.</p>
<div id="thresholds-2" class="section level3 hasAnchor" number="8.3.1">
<h3 class="hasAnchor"><span class="header-section-number">8.3.1</span> Thresholds<a href="#thresholds-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>There is a threshold condition <span class="math inline">\(R_0&gt;1\)</span> that determines whether malaria is endemic, but the formula for <span class="math inline">\(R_0\)</span> depends on the form of <span class="math inline">\(\Lambda(t)\)</span>. If we set <span class="math inline">\(R_0=1\)</span>, we can show that the threshold for persistence in a seasonal environment is <span class="math inline">\(R_0 &gt; \sigma &gt; 1\)</span> (see Figure 1.1). The math to compute threshold conditions in seasonal environments is in <a href="#temporal-dynamics">Temporal Dynamics</a>.</p>
<div class="figure">
<img src="figs/unnamed-chunk-86-1.png" alt="Here, we set $R_0= 1.02$ for the model with constant emergence, and we show that malaria persists. For the same parameters and for the same *average* emergence rate, malaria declines with seasonality." width="672" />
<p class="caption">
(#fig:unnamed-chunk-86)Here, we set <span class="math inline">\(R_0= 1.02\)</span> for the model with constant emergence, and we show that malaria persists. For the same parameters and for the same <em>average</em> emergence rate, malaria declines with seasonality.
</p>
</div>
</div>
<div id="orbits" class="section level3 hasAnchor" number="8.3.2">
<h3 class="hasAnchor"><span class="header-section-number">8.3.2</span> Orbits<a href="#orbits" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>If <span class="math inline">\(R_0 &gt;1\)</span>, then all orbits converge to a set of <em>stable orbits</em> (See Figure 1.1). If <span class="math inline">\(\Lambda(t)\)</span> has an annual cycle, then after the orbits converge:</p>
<pre><code>- $M(t+365) = M(t)$; 
- $Y(t+365) = Y(t)$ and $Z(t+365) = Z(t)$; 
- $X(t+365) = X(t)$. </code></pre>
<div class="figure">
<img src="figs/unnamed-chunk-87-1.png" alt="With different initial values, the orbits converge and eventually lie on top of one another." width="672" />
<p class="caption">
(#fig:unnamed-chunk-87)With different initial values, the orbits converge and eventually lie on top of one another.
</p>
</div>
</div>
<div id="average-dynamics" class="section level3 hasAnchor" number="8.3.3">
<h3 class="hasAnchor"><span class="header-section-number">8.3.3</span> Average Dynamics<a href="#average-dynamics" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>If <span class="math inline">\(R_0&gt;1\)</span> and malaria is endemic, the <em>average</em> prevalence of malaria infection is variable in a seasonal environment. While the prevalence is higher at the peak, the average for the whole year tends to be lower.</p>
<div class="figure">
<img src="figs/compareTS-1.png" alt="Here, we set $R_0= 2$ for the model with constant emergence, and we show that the prevalence of malaria is similar in the seasonal environment, but it's higher as transmission peaks, lower in the off-season, and lower overall." width="672" />
<p class="caption">
(#fig:compareTS)Here, we set <span class="math inline">\(R_0= 2\)</span> for the model with constant emergence, and we show that the prevalence of malaria is similar in the seasonal environment, but it’s higher as transmission peaks, lower in the off-season, and lower overall.
</p>
</div>
<!--chapter:end:122-Adult-Mosquito-Dynamics.Rmd-->
</div>
</div>
</div>
<div id="human-age-demography" class="section level1 hasAnchor" number="9">
<h1 class="hasAnchor"><span class="header-section-number">9</span> Human Age &amp; Demography<a href="#human-age-demography" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>A core limitation of most malaria models is that they need to have the capability of handling human demography and age. Here, we present the Ross-Macdonald model for exposure and infection in a population with age.</p>
<p><strong>Human Demography:</strong> The problem, in a nutshell, is that our human population is changing dynamically as it ages over time. We let <span class="math inline">\(H(a,t)\)</span> denote the density of a human population of age <span class="math inline">\(a\)</span> at time <span class="math inline">\(t,\)</span> and we can describe age-specific survival as an age- and time-specific rate <span class="math inline">\(\mu(a,t).\)</span> Demographic changes in cohorts are described as follows:<br />
<span class="math display">\[
\frac{\partial H(a,t)}{da} + \frac{\partial H(a,t)}{dt} = -\mu(a,t) H(a,t)
\]</span>
In this case, births are specified as a boundary condtion <span class="math inline">\(H(0,t) = B(t).\)</span></p>
<p><strong>Malaria Dynamics:</strong> To model malaria infection dynamics in this population, we let <span class="math inline">\(h(a,t)\)</span> denote the force of infection for the cohort of age <span class="math inline">\(a\)</span> at time <span class="math inline">\(t\)</span>:</p>
<p><span class="math display">\[
\frac{\partial X(a,t)}{da} + \frac{\partial X(a,t)}{dt} = h(a,t) \left(H(a,t) - X(a,t) \right) - r X(a,t)
\]</span>
The problem for malaria in humans is exacerbated by the development of immunity in populations. We would like to have some methods that make it possible to investigate data describing malaria in populations as they age.</p>
<div id="cohort-dynamics" class="section level2 hasAnchor" number="9.1">
<h2 class="hasAnchor"><span class="header-section-number">9.1</span> Cohort Dynamics<a href="#cohort-dynamics" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We now</p>
</div>
<div id="gallerkin" class="section level2 hasAnchor" number="9.2">
<h2 class="hasAnchor"><span class="header-section-number">9.2</span> Gallerkin<a href="#gallerkin" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We now</p>
<!--chapter:end:123-HumanAgeDemography.Rmd-->
</div>
</div>
<div id="mosquito-ecology" class="section level1 hasAnchor" number="10">
<h1 class="hasAnchor"><span class="header-section-number">10</span> Mosquito Ecology<a href="#mosquito-ecology" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="egg-laying" class="section level2 hasAnchor" number="10.1">
<h2 class="hasAnchor"><span class="header-section-number">10.1</span> Egg Laying<a href="#egg-laying" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<!--chapter:end:124-Mosquito-Ecology.Rmd-->
</div>
</div>
<div id="part-malaria-modeling" class="section level1 unnumbered hasAnchor">
<h1 class="unnumbered hasAnchor">(PART) Malaria Modeling<a href="#part-malaria-modeling" class="anchor-section" aria-label="Anchor link to header"></a></h1>
</div>
<div id="model-building" class="section level1 hasAnchor" number="11">
<h1 class="hasAnchor"><span class="header-section-number">11</span> Model Building<a href="#model-building" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>The Ross-Macdonald model is a good model to start learning about malaria, but our task is to understand malaria well enough to give robust advice about policy. After more than a century of malaria research and control, we can describe the magnitude of that challenge in clear terms.</p>
<p>What kind of a problem is malaria?</p>
<p>Malaria can be understood as a complex adaptive system. It is characterized by non-linear, dynamical interactions among four kinds of interacting agents: parasites, mosquitoes, humans, and malaria control managers. These are exogenously forced systems – in addition to malaria control, mosquito ecology and malaria transmission are affected by temperature, rainfall, land use changes, and other environmental conditions. From the perspective of a malaria control manager, malaria transmission is a changing baseline that is modified by control. Malaria is also accurately described as a disease of poverty: malaria tends to disappear in places with education and wealth, so economic development and education have been among the most effective ways of ending malaria.</p>
<p>On the other hand, malaria transmission dynamics and the responses to control depend on the local context. Lewis Wendell Hackett, a malariologist who worked on malaria in the 1930s, wrote:</p>
<blockquote>
<p>… malaria is so moulded and altered by local conditions that it becomes a thousand different diseases and epidemiological puzzles. Like chess, it is played with a few pieces, but is capable of an infinite variety of situations <span class="citation">[<a href="#ref-HackettLW1937MalariaEurope">71</a>]</span>.</p>
</blockquote>
<p>Malaria systems are locally peculiar because of differences in mosquito species and their behavior and ecology, local human cultural practices and behaviors. These behaviors affect blood feeding and the ways that mosquitoes come into contact with malaria interventions. The question is what local details are relevant for malaria policy.</p>
<p>How can we deal with forced, managed, complex adaptive systems? One approach is to use mathematical models to help us understand them. The study of complexity has mainly been restricted to academics, who have provided us with many useful case studies. If we are going to work in policy, however, we need to be very practical. While the Ross-Macdonald model clearly demonstrates how transmission intensity is clearly related to mosquito bionomics, the model does not address what factors set the values of those bionomic parameters in context. It is likely to be a mosquito’s innate biology interacting with resource availability, weather, and vector control, but how can we begin to translate the models into something more than an object lesson? With so much complexity, we will need to move beyond analysis with a pencil and paper. Our work will require computation and simulation.</p>
<p>If we think of a model as having a <em>skill set</em> – the set of observable quantities that are naturally represented by the latent states such that they can be computed without requiring extraneous information – then a major limitation of the Ross-Macdonald model is that it has a limited skill set: it’s skill set does not include most of the features that malaria programs care about. The model is useful in the classroom, and it can help to inform our basic understanding of malaria. If we want to use the model to answer some policy questions, we will find ourselves waving our hands to make excuses about the features it is missing. The other way is to ask about all the ways our models and analysis could be wrong, and then build models with the skill sets to tackle these problems. Adding complexity to a model, so that it has the right skill set, also comes with its own perils.</p>
<p>If we want to scale up simulation-based analytics to support malaria policy through eradication, it will inevitably involve capacity building, but what sort of training is needed? Certainly, we hope that an analytics team would include someone who has the skills required to critically evaluate models, but this is not as easy as you think. What makes a model good? What makes an analysis useful? It is easy to imagine training up a generation who could do some kind of analysis, but we don’t want to train automata – people who would keep doing some analysis, over and over, just because it is what has been done before. We ought to have a reason for doing the analysis. It ought to serve some purpose. Success in policy analytics requires people who have skills in thinking creatively and critically to solve problems. We need people who can build and evaluate models.</p>
<p>This book has taken an approach to model building that is based on the notion of <em>scalable complexity.</em></p>
<p>If we want to discuss the models we might use to analyze malaria policies, and if we want to have a discussion about that process, it will probably help us to be more careful about how we use terms like <em>model</em> and <em>model building.</em> In the service of defining the skill sets required to be a good analyst, this chapter discusses the life-cycle of a model, including the process of building and evaluating models from the beginning to the end (or in math from <span class="math inline">\(\alpha\)</span> to <span class="math inline">\(\omega\)</span>).</p>
<div id="compartment-models" class="section level2 hasAnchor" number="11.1">
<h2 class="hasAnchor"><span class="header-section-number">11.1</span> Compartment Models<a href="#compartment-models" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="primary-model-development" class="section level2 hasAnchor" number="11.2">
<h2 class="hasAnchor"><span class="header-section-number">11.2</span> Primary Model Development<a href="#primary-model-development" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Most models started with a question: something like <em>Why is the sky blue?</em> or <em>How many mosquitoes does it take to sustain malaria transmission?</em> Blue sky questions don’t go anywhere unless there’s a basis for understanding the underlying process. If there is some kind of basis, the next step is to try represent the process in some logically compelling form, such as a diagram with boxes and arrows.</p>
</div>
<div id="implementation-and-verification" class="section level2 hasAnchor" number="11.3">
<h2 class="hasAnchor"><span class="header-section-number">11.3</span> Implementation and Verification<a href="#implementation-and-verification" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="solving-2" class="section level3 hasAnchor" number="11.3.1">
<h3 class="hasAnchor"><span class="header-section-number">11.3.1</span> Solving<a href="#solving-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><p><strong>Fitted Parameters:</strong></p></li>
<li><p><strong>Initial Conditions:</strong></p></li>
</ul>
</div>
<div id="mathematical-analysis" class="section level3 hasAnchor" number="11.3.2">
<h3 class="hasAnchor"><span class="header-section-number">11.3.2</span> Mathematical Analysis<a href="#mathematical-analysis" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><p><strong>steady states</strong></p></li>
<li><p><strong>stability analysis</strong></p></li>
<li><p><strong>algorithms</strong></p></li>
<li><p><strong>primary analysis</strong></p></li>
</ul>
</div>
<div id="simulation" class="section level3 hasAnchor" number="11.3.3">
<h3 class="hasAnchor"><span class="header-section-number">11.3.3</span> Simulation<a href="#simulation" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
</div>
<div id="what-is-a-model" class="section level2 hasAnchor" number="11.4">
<h2 class="hasAnchor"><span class="header-section-number">11.4</span> What is a Model?<a href="#what-is-a-model" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="accuracy-validation" class="section level2 hasAnchor" number="11.5">
<h2 class="hasAnchor"><span class="header-section-number">11.5</span> Accuracy &amp; Validation<a href="#accuracy-validation" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li><p>Model features</p></li>
<li><p>Functional range</p></li>
<li><p>Heterogeneity</p></li>
</ul>
<div id="validation-points" class="section level3 hasAnchor" number="11.5.1">
<h3 class="hasAnchor"><span class="header-section-number">11.5.1</span> Validation Points<a href="#validation-points" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
</div>
<div id="the-measure-of-a-model" class="section level2 hasAnchor" number="11.6">
<h2 class="hasAnchor"><span class="header-section-number">11.6</span> The Measure of a Model<a href="#the-measure-of-a-model" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>If we want to evaluate whether a model is good</p>
<div id="limitations" class="section level3 hasAnchor" number="11.6.1">
<h3 class="hasAnchor"><span class="header-section-number">11.6.1</span> Limitations<a href="#limitations" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><strong>Functional Range</strong> the maximum granularity</li>
</ul>
</div>
<div id="parsimony" class="section level3 hasAnchor" number="11.6.2">
<h3 class="hasAnchor"><span class="header-section-number">11.6.2</span> Parsimony<a href="#parsimony" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
</div>
<div id="secondary-model-development" class="section level2 hasAnchor" number="11.7">
<h2 class="hasAnchor"><span class="header-section-number">11.7</span> Secondary Model Development<a href="#secondary-model-development" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li><strong>elaboration</strong></li>
</ul>
<p>Model building is a core part of applied dynamics, but if we are to othere are many different activities</p>
<p>What does it mean to build a model?</p>
</div>
<div id="conclusions" class="section level2 hasAnchor" number="11.8">
<h2 class="hasAnchor"><span class="header-section-number">11.8</span> Conclusions<a href="#conclusions" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<!--chapter:end:150-Model-Building.Rmd-->
</div>
</div>
<div id="ch-uncertainty" class="section level1 hasAnchor" number="12">
<h1 class="hasAnchor"><span class="header-section-number">12</span> Uncertainty<a href="#ch-uncertainty" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="what-we-dont-know-about-malaria" class="section level2 hasAnchor" number="12.1">
<h2 class="hasAnchor"><span class="header-section-number">12.1</span> What we Don’t Know about Malaria<a href="#what-we-dont-know-about-malaria" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="what-we-dont-know-about-malaria-1" class="section level2 hasAnchor" number="12.2">
<h2 class="hasAnchor"><span class="header-section-number">12.2</span> What we Don’t Know about Malaria<a href="#what-we-dont-know-about-malaria-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<!--chapter:end:151-Uncertainty.Rmd-->
</div>
</div>
<div id="realism" class="section level1 hasAnchor" number="13">
<h1 class="hasAnchor"><span class="header-section-number">13</span> Realism<a href="#realism" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>There are several reasons why models for policy will tend to be more complex than models developed for scientific research.
In science, the questions are narrow and the study designs are focused enough to form tests of ideas that have clear outcomes.
When models are used to guide policy, the same level of scientific rigor should be applied, but weighing all the evidence requires a broder synthesis.<br />
To build models that can guide malaria policies, the models must be <em>realistic</em> enough to be compelling, and they <em>ought</em> to reflect the knowledge and experience accumulated over years of studying and controlling malaria.
Policy advice should be checked for consistency across studies.
The models must be complex enough to serve many purposes all at once.
To weigh tradeoffs, policy requires broad, synthetic models that allow for comparisons across subject matter domains.</p>
<p>To carry a conversation forward, the models used to guide discussions will need to retain a memory of what has been learned already, so they will tend to add features and grow more complex.
Given the uncertainty, policy should be based on model swarms that propagate the uncertainty.
The predictions of those models must be specific enough to be proven wrong, so that over time <em>some</em> of the models can be trusted over others.
The same models can be used to identify which missing data would have the greatest impact on a policy, and ideally, studies can be conducted to gather this data.
Over time, the advice should shift from <em>generic</em> advice to <em>specific</em> advice as more evidence is gathered.
This is, in a nutshell, how daptive management works.</p>
<p>It might take a lot of work to build a model that has been fit to all the evidence describing malaria in a management unit over the recent past, and it might cut against the instincts we have as scientists to add all that realism, but it’s worth it to make the effort if it helps communicate with malaria managers.</p>
<hr />
<p>In designing a software solution to the problem of building realistic models, we designed a framework for building models and a toolbox to build model swarms that would address the concerns of malaria programs. In the chapters that follow, we’ll show the features of this framework by constructing examples. Even if we’re principled about adding complexity, a cost of doing so is <em>computational complexity.</em> That is something the software was designed to manage. For the moment, we thus want to set aside concerns about <em>realism</em> vs. <em>abstraction</em>, about <em>parsimony</em>, and about <em>error propagation,</em> and we want to simply ask the question of how to build models with the features we want.</p>
<p>This chapter is an overview of the historical development of malaria models and an introduction to the toolbox. We’ll cover the same material in much greater detail in the chapters that follow, and we’ll construct examples using <code>exDE</code> and <code>MicroMoB</code>.</p>
<div id="malaria-epidemiology-2" class="section level2 hasAnchor" number="13.1">
<h2 class="hasAnchor"><span class="header-section-number">13.1</span> Malaria Epidemiology<a href="#malaria-epidemiology-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="transmission-1" class="section level2 hasAnchor" number="13.2">
<h2 class="hasAnchor"><span class="header-section-number">13.2</span> Transmission<a href="#transmission-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The second topic we must tackle is blood feeding, which is an interaction between mosquitoes and humans. It is an asymmetric relationship – mosquitoes search for blood hosts, select a host, and blood feed. Humans, for their part, attract mosquitoes from a distance, move around, and spend time in places when mosquitoes are biting. Humans can wear protective clothing (or not), use bed nets (or not), or do other things that make them more or less available to humans. Despite all this, humans are often unaware that they have been bitten.</p>
<p>Transmission occurs during blood feeding, and models of blood feeding <em>should</em> be able to take all this heterogeneity into account. If the models do a proper accounting, then the total number of human blood meals taken by mosquitoes would equal the number of blood meals received by humans. In doing so, we find no inspiration from Macdonald, whose description of human blood feeding was simple and phenomenological: a single parameter described the human blood feeding rates. After Garrett-Jones described the human blood index, drawing on decades of work, the one parameter was split into an overall blood feeding rate (<span class="math inline">\(f\)</span>) and a human fraction (<span class="math inline">\(q\)</span>). The question left unaddressed by Macdonald was how these rates vary by context, and the consequences for exposure. To do this, we reformulated the algorithm describing blood feeding <span class="citation">[<a href="#ref-WuSL2023SpatialDynamics">15</a>]</span>.</p>
<p>Over the past two decades, several papers have drawn attention to the way blood feeding behaviors are or ought to be constrained by the availability of vertebrate hosts. It may be fine to assume that the density of vertebrate hosts doesn’t change, but <em>something</em> should change when a large fraction of people are using bednets. Even with static parameters, we should think through the limiting cases: if there are no vertebrate hosts, then there blood feeding should not occur (<em>i.e.</em>, <span class="math inline">\(f=0\)</span>); if there are no human hosts, then there should be no human blood meals (<span class="math inline">\(q=0\)</span>); and if there are no alternatives to humans, all blood meals should be on humans (<span class="math inline">\(q=1\)</span>).</p>
<p>The concepts we devised for blood feeding must, therefore, integrate the notion of frailty with the process of mosquito search. On the one hand, the mosquitoes should blood feed at a slower rate if hosts are unavailable. On the other hand, human biting should become heterogeneous. To arrive at an adequate description, we need to formalize this notion of host availability.
The logic is that mosquitoes <em>search</em> for humans. Differences among humans in their attractiveness are represented by a <em>search weight.</em> Mosquito search in a place depends on the amount of time spent by humans, but also by daily mosquito activity patterns; from these, we develop a notion of <em>time at risk</em> that characterize the way human activities expose them to mosquitoes. The mosquitoes add up all the time at risk spent by all the humans, which gives a measure of their <em>availability.</em> Availability describes humans as well as other vertebrate hosts, which are modified by mosquito preferences. The overall feeding rates and the human fraction are computed from availability using <em>functional responses.</em></p>
<p>To complete the picture, we consider how the expected rate of exposure could have a distribution in the population, which we call environmental heterogeneity.</p>
</div>
<div id="mosquito-ecology-1" class="section level2 hasAnchor" number="13.3">
<h2 class="hasAnchor"><span class="header-section-number">13.3</span> Mosquito Ecology<a href="#mosquito-ecology-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="resource-availability" class="section level3 hasAnchor" number="13.3.1">
<h3 class="hasAnchor"><span class="header-section-number">13.3.1</span> Resource Availability<a href="#resource-availability" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="egg-laying-1" class="section level3 hasAnchor" number="13.3.2">
<h3 class="hasAnchor"><span class="header-section-number">13.3.2</span> Egg Laying<a href="#egg-laying-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="regulation" class="section level3 hasAnchor" number="13.3.3">
<h3 class="hasAnchor"><span class="header-section-number">13.3.3</span> Regulation<a href="#regulation" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="exogenous-forcing" class="section level3 hasAnchor" number="13.3.4">
<h3 class="hasAnchor"><span class="header-section-number">13.3.4</span> Exogenous Forcing<a href="#exogenous-forcing" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
</div>
<div id="heterogeneity-stratification" class="section level2 hasAnchor" number="13.4">
<h2 class="hasAnchor"><span class="header-section-number">13.4</span> Heterogeneity &amp; Stratification<a href="#heterogeneity-stratification" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Human populations are heterogeneous. Some kinds of heterogeneity affect how we understand malaria and what we should do, including who to target. To deal with heterogeneity in models, we will often need to <em>segment</em> a human population into sub-populations, or <em>strata.</em> When we talk about <em>stratification,</em> we mean it the narrow sense of segmenting a human population (<em>i.e.</em> not subdividing landscapes spatially<a href="#fn3" class="footnote-ref" id="fnref3"><sup>3</sup></a>), because the model predictions made by creating strata that are more homogeneous should be more accurate. The guiding principle is that our analytics will should strive to be more accurate, and that we should thus identify and remove those sources of heterogeneity that would affect policy advice, whether it affects estimating the impact of interventions in the past or projecting those impacts into the future. We acknowledge that models are approximations, and that our approximations don’t have to be perfect. The goal is to find ways of propagating uncertainty that are <em>good enough</em> for the task at hand.</p>
<p>In malaria epidemiology, <em>some</em> kinds of endogenous heterogeneity <em>could</em> be built into the <em>epidemiological state space.</em> Other kinds of heterogeneity, including consistent differences in exposure, differences in care seeking and drug taking, and differences created by malaria control (<em>e.g.</em> net ownership or vaccination), usually require stratification. The decision about how to strike the right balance depends on the model and the purpose of a study.</p>
<p>The framework and supporting software offer a toolbox for stratification. It is designed to stratify populations in a principled way, so that we can <em>understand</em> how the heterogeneity affects transmission or outcomes that we care about, but we can also <em>combine</em> effects. We want to stratify populations by applying rules that <em>split</em> populations when the differences are large enough. (If we started with complex models, we might choose to <em>join</em> populations if the differences were small.) By so doing, we can <em>compare</em> the behaviors of models that differ from each other in only one way. If the differences are not too large, or if the differences in dynamical behaviors we care about are not too large, we might decide not to split the strata, and use the average. Because of the way models are encoded, it’s easy to build models that split the strata in multiple, independent ways.</p>
<div id="strata-in-the-ross-model" class="section level3 hasAnchor" number="13.4.1">
<h3 class="hasAnchor"><span class="header-section-number">13.4.1</span> Strata in the Ross model<a href="#strata-in-the-ross-model" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>As a simple example, consider a simple Ross-style model for infection with exposure and recovery (described in Section @ref(RossEqn)):</p>
<p><span class="math display">\[\frac{dX}{dt} = h (H-X)-r X\]</span></p>
<p>If exposure is heterogeneous, we could split this population into two strata and add subscripts (<em>i.e.</em>, indexed by <span class="math inline">\(i \in \left\{1,2, \ldots \right\}\)</span>):</p>
<p><span class="math display">\[\frac{dX_i}{dt} =  k_i h (H_i -X_i)-r X_i\]</span></p>
<p>We hold the <em>average</em> FoI constant by constraining the values of <span class="math inline">\(k_i\)</span>:</p>
<p><span class="math display">\[\frac{\sum_i k_i H_i}{H} = 1\]</span>
Stratification is important if the differences are large. With two strata, it would not make sense to stratify if <span class="math inline">\(k_1 \approx k_2\)</span>, but if <span class="math inline">\(k_2 \gg k_1\)</span> then it might change our expectations, or it might change what we recommend.</p>
</div>
<div id="frailties" class="section level3 hasAnchor" number="13.4.2">
<h3 class="hasAnchor"><span class="header-section-number">13.4.2</span> Frailties<a href="#frailties" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We will introduce segmentation first through models of [Heterogeneous Exposure] to malaria, where we consider various sources of <em>frailty</em> – proportional differences in the average hazard rate for infection (<span class="math inline">\(k_i\)</span>, in the example above). These differences in exposure can arise because of age, house type, risky behaviors, other factors. Frailty that is attributable to location (<em>e.g.</em> proximity of home to aquatic habitats) can be dealt with by sub-dividing space into <em>patches,</em> a topic that is taken up in [Space] below and <a href="#spatial-dynamics">Spatial Dynamics</a>. Depending on the size of the patches, some differences in average rates of exposure due to location can persist, and these could be dealt with by generic stratification into high <em>vs.</em> low exposure strata.</p>
<p>Some of the heterogeneous traits that we care about change dynamically, so we will also need to consider population <em>flows</em> among strata, which change the sizes of the strata. We would like to deal with these flows in a principled way. Bed net ownership and use are among the human behaviors that matters most for programs. In some cases, we will want to understand dynamic changes in bed net ownership, the patterns of use among those who own a net, personal protection, and community effects. Later, we show how to construct an example that <em>describes</em> all of these aspects of bednets.</p>
<p>Segmentation is what we need to build models of pharmaceutical interventions with waning effectiveness, such as mass vaccination. Among the most important factors in malaria is age. We have defined algorithms to model [Aging] and other demographic change, the loss of bednets, waning protection or changing housing quality.</p>
</div>
<div id="age" class="section level3 hasAnchor" number="13.4.3">
<h3 class="hasAnchor"><span class="header-section-number">13.4.3</span> Age<a href="#age" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Immunity to malaria develops with age and exposure. The development of immunity is probably changing throughout life, so it makes sense to think of malaria epidemiology as ontogeny.</p>
<p>For systems described generically by the state space, <span class="math inline">\(\mathscr X\)</span>, the dynamics we care about have the form:</p>
<p><span class="math display">\[\frac{\partial {\mathscr X}(a,t)}{\partial a} + \frac{\partial {\mathscr X}(a,t)}{\partial t}\]</span></p>
<p>We might want to deal with malaria differently if we are studying malaria in cohorts. In a population where the FoI over time is <span class="math inline">\(h(t)\)</span>, we might want to follow a birth cohort, so we define <span class="math inline">\(h_d(a) = h(t-a)\)</span> for all <span class="math inline">\(t&gt;d\)</span>. We can then solve:</p>
<p><span class="math display">\[\frac{d{\mathscr X}}{d a} \]</span>
which produces states in cohorts as they age, <span class="math inline">\({\mathscr X}(a|h).\)</span></p>
<p>When we simulate malaria transmission dynamics in populations for policy, we will want to put a mesh on age and segment the population. The dynamics are define for age strata, where the FoI is defined differently for each age stratum:</p>
<p><span class="math display">\[\frac{d{\mathscr X}_a}{d t}\]</span></p>
<p>which produces age-dependent states over time, <span class="math inline">\({\mathscr X}_a(t|h).\)</span></p>
<p>Our algorithms should guarantee that the epidemiological states over time provide an accurate match for the epidemiological states over age.</p>
</div>
</div>
<div id="spatial-dynamics" class="section level2 hasAnchor" number="13.5">
<h2 class="hasAnchor"><span class="header-section-number">13.5</span> Spatial Dynamics<a href="#spatial-dynamics" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="human-migration-mobility-travel" class="section level3 hasAnchor" number="13.5.1">
<h3 class="hasAnchor"><span class="header-section-number">13.5.1</span> Human Migration, Mobility &amp; Travel<a href="#human-migration-mobility-travel" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The notion of a spatially distributed risk for humans and the modalities of human travel.</p>
<ul>
<li><p>Humans move around, so we develop a model of <em>time spent</em>. Time spent is sub-divided into three parts:</p>
<ul>
<li><p>time spent at home;</p></li>
<li><p>time spent traveling, when a night is spent away from home;</p></li>
<li><p>human mobility, which describes time spent around home when not traveling.</p></li>
</ul></li>
<li><p>For travel, we estimate a travel FoI.</p></li>
<li><p>For time at home and mobility, after weighing time spent and mosquito diurnal activity patterns by time of day, we modify time spent to get a notion of <em>time at risk</em></p></li>
<li><p>After modifying time at risk by search weights, mosquito blood meals are distributed among all hosts according to their availability.</p></li>
</ul>
</div>
<div id="mosquito-search-dispersal" class="section level3 hasAnchor" number="13.5.2">
<h3 class="hasAnchor"><span class="header-section-number">13.5.2</span> Mosquito Search &amp; Dispersal<a href="#mosquito-search-dispersal" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="the-mixing-matrix" class="section level3 hasAnchor" number="13.5.3">
<h3 class="hasAnchor"><span class="header-section-number">13.5.3</span> The Mixing Matrix<a href="#the-mixing-matrix" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="pathogen-dispersal-by-humans" class="section level3 hasAnchor" number="13.5.4">
<h3 class="hasAnchor"><span class="header-section-number">13.5.4</span> Pathogen Dispersal by Humans<a href="#pathogen-dispersal-by-humans" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="pathogen-dispersal-by-mosquitoes" class="section level3 hasAnchor" number="13.5.5">
<h3 class="hasAnchor"><span class="header-section-number">13.5.5</span> Pathogen Dispersal by Mosquitoes<a href="#pathogen-dispersal-by-mosquitoes" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>To describe mosquito spatial dynamics, we</p>
</div>
</div>
<div id="exogenous-forcing-1" class="section level2 hasAnchor" number="13.6">
<h2 class="hasAnchor"><span class="header-section-number">13.6</span> Exogenous Forcing<a href="#exogenous-forcing-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="weather" class="section level3 hasAnchor" number="13.6.1">
<h3 class="hasAnchor"><span class="header-section-number">13.6.1</span> Weather<a href="#weather" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="habitat-dynamics" class="section level3 hasAnchor" number="13.6.2">
<h3 class="hasAnchor"><span class="header-section-number">13.6.2</span> Habitat Dynamics<a href="#habitat-dynamics" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Space is big, so we start by drawing boundaries around a part of the world we want to study, that we call the <em>spatial domain.</em></p>
</div>
<div id="the-eip" class="section level3 hasAnchor" number="13.6.3">
<h3 class="hasAnchor"><span class="header-section-number">13.6.3</span> The EIP<a href="#the-eip" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="seasonality" class="section level3 hasAnchor" number="13.6.4">
<h3 class="hasAnchor"><span class="header-section-number">13.6.4</span> Seasonality<a href="#seasonality" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
</div>
<div id="integrated-vector-control" class="section level2 hasAnchor" number="13.7">
<h2 class="hasAnchor"><span class="header-section-number">13.7</span> Integrated Vector Control<a href="#integrated-vector-control" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="integrated-malaria-control" class="section level2 hasAnchor" number="13.8">
<h2 class="hasAnchor"><span class="header-section-number">13.8</span> Integrated Malaria Control<a href="#integrated-malaria-control" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="context" class="section level2 hasAnchor" number="13.9">
<h2 class="hasAnchor"><span class="header-section-number">13.9</span> Context<a href="#context" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<!--chapter:end:152-Realism.Rmd-->
</div>
</div>
<div id="modularity-and-software" class="section level1 hasAnchor" number="14">
<h1 class="hasAnchor"><span class="header-section-number">14</span> Modularity and Software<a href="#modularity-and-software" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Hundreds of publications have described new models of malaria <span class="citation">[<a href="#ref-ReinerRC2013SystematicReview">3</a>,<a href="#ref-SmithNR2018AgentbasedModels">10</a>]</span>. The challenge we have taken on is to find a new way of building models for malaria that draws from all those good ideas to build models at any level of complexity. We want to do this with reusable, professional quality software. Ideally, the models that we develop would be sufficiently complex to address policy questions, yet remain amenable to analysis. To get there, we took a step back to try and understand <em>malaria models</em>, and to put this into a birds-eye view of the process of model building.</p>
<hr />
<p>From Ross’s first published model in 1905 to the first draft of this book, 117 years have passed. The story of malaria models can be summarized in three epochs.</p>
<p>Ross’s models, and contributions to mathematical study of malaria made by Alfred J Lotka (1912-1923), George Macdonald (1950-1968), and Garrett-Jones (1964-1970) take us to the end first epoch, which is marked by the end of the Global Malaria Eradication Programme (GMEP, 1955-1969). As part of the GMEP, Macdonald’s formulas were extended by Garrett-Jones into the concept of <em>vectorial capacity</em> and a rudimentary theory of vector control. By 1970, the <em>Ross-Macdonald</em> model was more than just a set of equations. It was a theory for malaria dynamics and control supported by a well-developed set of concepts, parameters and metrics <span class="citation">[<a href="#ref-SmithDL2012_RossMacdonald">2</a>]</span>.</p>
<p>Over that same period of time, mathematical theory for directly transmitted diseases took a parallel path, with important mathematical contributions from Kermack and McKendrick, NTJ Bailey, and Bartlett. Sometime around 1980, mathematical epidemiology began a period of innovation and synthesis, particularly after the publications of Robert May and Roy Anderson made it a mainstream activity in departments of ecology.</p>
<p>In malaria and mosquito-borne diseases, Klaus Dietz publications span the second epoch (1971-2006), including development of a mathematical model with immunity for the Garki Project <span class="citation">[<a href="#ref-DietzK1974GarkiModel">69</a>]</span>, work on the dynamics of malaria under treatment by drugs <span class="citation">[<a href="#ref-DietzK1975ModelsParasitic">72</a>]</span>, seasonality <span class="citation">[<a href="#ref-DietzK1976Seasonality">73</a>]</span>, and heterogeneous biting <span class="citation">[<a href="#ref-DietzK1980ModelsVectorborne">74</a>,<a href="#ref-DietzK1988EpidemiologicalModels">75</a>]</span>. During this time, theory developed for malaria borrowed concepts and methods. In spatial dynamics, the patch models of Yorke and ** were modified to by Dye and Hasibeder to describe mosquito-borne pathogens <span class="citation">[<a href="#ref-DyeC1986PopulationDynamics">76</a>,<a href="#ref-HasibederG1988PopulationDynamics">77</a>]</span>.</p>
<p>The last epoch of malaria, which starts around 2006, is marked by two major developments: a maturing theory of malaria control; and the rise of branded, individual-based models.</p>
<p>The publication of <em>OpenMalaria</em> in 2006 marks the beginning of the last epoch of malaria. Some important antecedents were Dana Fochs models for <em>Aedes</em> dynamics and dengue virus transmission, as <em>CIMSiM</em> and <em>DENSiM</em>. In malaria, several within-host models had been developed <span class="citation">[<a href="#ref-MolineauxL1999ReviewIntrahost">4</a>,<a href="#ref-MolineauxL2001PlasmodiumFalciparum">78</a>]</span>. <em>OpenMalaria</em> traces its history back to an intrahost model developed by Dietz and Louis Molineaux <span class="citation">[<a href="#ref-MolineauxL2001PlasmodiumFalciparum">78</a>]</span>. After <em>OpenMalaria,</em> two other branded individual-based models were developed. One was developed by a team at Imperial College called <em>Malaria Tools.</em> Another was developed by a team at the Institute for Disease Modeling called <em>eMod.</em> The fact that the models were named and branded was significant – the authors had developed software that they would maintain and that they were willing to stand behind. The models had finally dealt with <em>disease</em> in a serious way, and through publications, the fitted models demonstrated a fidelity to evidence. The branding signaled continuity and consistency.</p>
<p>Around 2007, new models of vector control began to appear that related intevention coverage levels to effect sizes. Macdonald’s work had focused on sensitivity to parameters, and the GMEP emphasized technical efficiency to achieve very high coverage (with IRS). Garrett-Jones developed vectorial capacity as a way of understanding vector control and effect modification by insecticide resistance. The new models extended Garrett-Jones ideas. The need for new models was motivated, at least in part, by the goal of achieving universal coverage with ITNs. What were reasonable coverage targets? The new generation of vector control models introduced the concept of an effect size on transmission as a function of intervention coverage levels, where coverage had one definition for operations (<em>e.g.</em> something like ownership) and another for effect sizes (<em>e.g.</em> related to vector contact rates with interventions). The goal of achieving very high coverage with ITNs bumped into the reality that nets are not durable, so new models have been devised to look at intervention coverage in relation to distribution schemes and product durability. While these concepts had been considered during the GMEP design phase, they did not appear in Macdonald’s models.</p>
<hr />
<p>If we want to take advantage of all the research that has been done, we need a way of understanding malaria models and the whole business of model building.</p>
<div id="model-building-1" class="section level2 hasAnchor" number="14.1">
<h2 class="hasAnchor"><span class="header-section-number">14.1</span> Model Building<a href="#model-building-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Model building is a fairly involved process that includes several unavoidable steps:</p>
<ul>
<li><p>There must be some motivation for building a model, which usually starts with a conversation, boxes and arrows drawn on paper or a chalkboard or whiteboard. The process involves refining the questions, until there’s a well-formed idea – a reason for building a model.</p></li>
<li><p>The idea gets translated into mathematics. The boxes get translated into variables, the arrows are rate parameters, a mathematical formalism is selected.</p></li>
<li><p>The model gets analyzed. In some cases, when the model complexity exceeds a very low threshold on complexity,
this is done with pencil and paper. It is only possible to analyze individual parts of the model this way.</p></li>
<li><p>The model gets translated into pseudo-code, and then it gets implemented as software that can produce output. This is followed by a long and painful process of verifying that the software does what the pseudo-code says it <em>should</em> do. After awhile, the software is trusted, and it’s time to use it.</p></li>
<li><p>Some thought is given to the correspondence between the variables in a model, observable quantities, and the observational process itself. This process can be a part of what happens above, but at some point, the models need to be fitted to data.</p></li>
<li><p>The software produces output and then: the outputs are visualized; models are fitted to data; graphs are made; papers or reports are published; and careers advance.</p></li>
</ul>
<p>That’s the simple story of model development. What happens next is could be one of the following:</p>
<ul>
<li><p>Someone re-examines an existing model and notices it is inadequate in some way: it is missing some features, or it might make an assumption that ought to be modified. Simple models become spatial models, single populations are structured.</p></li>
<li><p>Someone decides to implement the model in a different way, perhaps with a different mathematical formalism. Continuous time models are translated into discrete time models. Deterministic models become stochastic. Autonomous processes become non-autonomous.</p></li>
</ul>
<p>Through this process, hundreds of malaria models were published.</p>
<p>A problem with this process has been that the software is often developed for bespoke tasks (<em>i.e.</em> to publish a paper). The software is often poorly documented and difficult to reuse. The costs of building a model for one task limited the complexity of the model. It was difficult to combine elements of one model developed for one purpose, with someone else’s model developed for another purpose.</p>
<p>In malaria, this <em>ad hoc</em> process of writing new models was found to be inadequate to serve the broad range of policy questions. One way of dealing with the complexity was to build individual-based models, but individual-based models have some of the same limitations as reality.</p>
</div>
<div id="modular-computation" class="section level2 hasAnchor" number="14.2">
<h2 class="hasAnchor"><span class="header-section-number">14.2</span> Modular Computation<a href="#modular-computation" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Before <em>OpenMalaria</em>, most models of malaria modified the Ross-Macdonald model in one way <span class="citation">[<a href="#ref-ReinerRC2013SystematicReview">3</a>]</span>. The innovation was focused on specific themes or questions: how long would an infection last in models with superinfection?</p>
<div id="exde" class="section level3 hasAnchor" number="14.2.1">
<h3 class="hasAnchor"><span class="header-section-number">14.2.1</span> <code>exDE</code><a href="#exde" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We have written the software that solves these equations in a package called <a href="https://cran.r-project.org/web/packages/exDE/index.html"><code>exDE</code></a>.</p>
</div>
</div>
<div id="notes-1" class="section level2 hasAnchor" number="14.3">
<h2 class="hasAnchor"><span class="header-section-number">14.3</span> Notes<a href="#notes-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="why-use-densities" class="section level3 hasAnchor" number="14.3.1">
<h3 class="hasAnchor"><span class="header-section-number">14.3.1</span> Why use densities?<a href="#why-use-densities" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>To show why we use densities, we present a simple example. If we write down an equation describing changes in the density of infected humans, <span class="math inline">\(X\)</span>, in a population with total human population density <span class="math inline">\(H\)</span>. We let <span class="math inline">\(V\)</span> denote vectorial capacity, and <span class="math inline">\(b\)</span> the fraction of infective bites that cause an infection, and we assume the force of infection is <span class="math inline">\(bVX/H\)</span>. The dynamics of infection are described by this simple equation:</p>
<p><span class="math display">\[\frac{dX}{dt} = bV\frac{X}{H}(H-X)-rX\]</span>
In this equation, prevalence is <span class="math inline">\(x = X/H.\)</span> Following through with the change in variables, we can write down the equation for the change in prevalence:</p>
<p><span class="math display">\[\frac{dx}{dt} = \frac{1}{H^2} \left(H \frac{dX}{dt} - X \frac{dH}{dt} \right)\]</span></p>
<p>and with some rearranging, we get:</p>
<p><span class="math display">\[\frac{dx}{dt} = bVx(1-x)-rx -x \frac{dH}{dt}\]</span></p>
<p>The second equation is as simple as the first only if <span class="math inline">\(dH/dt=0\)</span>. Since we will want to deal with dynamical changes in host populations, we will avoid formulating base models that have proportions.</p>
<!--chapter:end:153-Modular-Framework.Rmd-->
</div>
</div>
</div>
<div id="part-epidemiology" class="section level1 unnumbered hasAnchor">
<h1 class="unnumbered hasAnchor">(PART) Epidemiology<a href="#part-epidemiology" class="anchor-section" aria-label="Anchor link to header"></a></h1>
</div>
<div id="malaria-epidemiology-3" class="section level1 hasAnchor" number="15">
<h1 class="hasAnchor"><span class="header-section-number">15</span> Malaria Epidemiology<a href="#malaria-epidemiology-3" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="life-stages" class="section level2 hasAnchor" number="15.1">
<h2 class="hasAnchor"><span class="header-section-number">15.1</span> Life Stages<a href="#life-stages" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="overview" class="section level2 hasAnchor" number="15.2">
<h2 class="hasAnchor"><span class="header-section-number">15.2</span> Overview<a href="#overview" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>A major challenge for malaria dynamics is how to define an state space describing malaria infection and immunity in human populations that captures the essential elements of malaria dynamics well enough to trust for making policies.
There are features of malaria infections that have been identified and studied in the past: superinfection; the complex time course of an infection – including fluctuating parasite densities – and the problem of detection; gametogenesis, gametocyte maturation and gametocyte dynamics; fever and disease; development of immunity with exposure including its effects on infection, disease, and infectiousness; treatment, adherence to drug regimens, chemoprotection and infection curing. Over time, these issues have been addressed in various models.
We need model that is good enough for policy, but this also means developing a commmon understanding of malaria that can serve as a basis for discussion.</p>
<p>To get to that point, we must start simple and add complexity.</p>
<p>The model for malaria infection that we presented in [Malaria Dynamics] was developed by Ross. In today’s vernacular, it would be called an SIS compartment model. The model is very simple, and it is probably inadequate for every task, but it is useful and it has been used. The model assumes that malaria infections clear at a constant rate regardless of the age of infection or other factors. The persistence of malaria infections over decades tells us that this assumption is clearly false, but it is good enough for some programmatic needs. During the GMEP, Ross’s model was used to characterized the response timelines for the <em>Pf</em>PR after the interruption of transmission. Drawing on multiple sources, Macdonald estimated that the duration of infection was around 200 days, which was good enough to use as a basis for monitoring and evaluating the interruption of transmission <span class="citation">[<a href="#ref-MacdonaldG1964MalariaParasite">79</a>]</span>. The simpler model was used even though Macdonald had already proposed an alternative model that considered superinfection <span class="citation">[<a href="#ref-MacdonaldG1950Superinfection">60</a>]</span>. Despite the simplicity, the model was adequate to the task <span class="citation">[<a href="#ref-SmithDL2009EndemicityResponse">80</a>]</span>. An important lesson is that the simplicity has some advantages, and the models that get used in policy tend to be very simple.</p>
<p>The question is how to develop models that are simple and yet are up to policy tasks, which means that the models must (at some point) get validated against research data. Doing so means having sufficient complexity to deal with exposure, infection, detection, immunity, disease, infectiousness, care seeking, and drug taking. Whatever model is selected as a basis for policy, it should be simple enough to understand and yet complex enough to capture the <em>gist</em> of malaria epidemiology. The models, however chosen, must get it right. Sorting through all the complexity to get a model that is good enough is a daunting task. This introduction is mainly historical, but we use it to preview some of the themes. In the following history, we discuss some of the important innovations.</p>
</div>
<div id="infection-1" class="section level2 hasAnchor" number="15.3">
<h2 class="hasAnchor"><span class="header-section-number">15.3</span> Infection<a href="#infection-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="superinfection" class="section level3 hasAnchor" number="15.3.1">
<h3 class="hasAnchor"><span class="header-section-number">15.3.1</span> Superinfection<a href="#superinfection" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>From early on in malaria epidemiology it was clear that exposure to malaria differed among populations, and that in some places, the rate of exposure was far higher than the rate of clearance. Ross emphasized a need to measure exposure both entomologically, through metrics that are known today as the EIR and the FoI, and parasitologically, through the prevalence of infection by light microscopy (or more commonly today, through RDTs), which was called the malaria <em>parasite rate</em> . There was no good reason to believe that people in highly malarious areas would be exposed faster than they would clear infections, so they would carry infections that could be traced back to many infectious mosquitoes <span class="citation">[<a href="#ref-WaltonGA1947ControlMalaria">81</a>]</span>. This phenomenon was called superinfection.</p>
<p>Macdonald was the first to develop a mechanistic model of superinfection <span class="citation">[<a href="#ref-MacdonaldG1950Superinfection">60</a>]</span>, but the mathematical formulation was at odds with his description <span class="citation">[<a href="#ref-FinePEM1975SuperinfectionProblem">55</a>]</span>. It is an interesting bit of history for a different time.</p>
<p>A mathematical basis for understanding superinfection was worked out as a problem in the study of stochastic processes as part of <em>queueing theory.</em> This may seem strange, but understanding how many people are queueing involves understanding how people come in and how fast they are processed. One of these queuing models has become a mainstay of malaria epidemiology; in queuing theory, it is called <span class="math inline">\(M/M/\infty\)</span>.</p>
<p>The model tracks the <strong>multiplicity of infection</strong> (MoI). It assumes that infections arrive through exposure at a rate <span class="math inline">\(h\)</span> (the FoI), and that they clear independently. Without clearance, the MoI, denoted <span class="math inline">\(\zeta\)</span>, would just go up. The model assumes that each infection clears at the rate <span class="math inline">\(r\)</span>; if the MoI were <span class="math inline">\(3\)</span> then infections would clear at the rate <span class="math inline">\(3r\)</span>. Regardless of how fast infections arrive, the fact that the pressure for the MOI to go down increases with MoI means that the MoI will reach a stable state. The mean MoI is <span class="math inline">\(h/r.\)</span> The following diagram illustrates and provides the equations:</p>
<p><span class="math display">\[\begin{equation*}
\begin{array}{c}
%
\begin{array}{ccccccccc}
\zeta_0 &amp;  {h\atop \longrightarrow} \atop {\longleftarrow \atop r} &amp; \zeta_1  &amp; {h\atop \longrightarrow} \atop {\longleftarrow \atop {2r}} &amp; \zeta_2  &amp; {h \atop \longrightarrow} \atop {\longleftarrow \atop {3r}} &amp; \zeta_3  &amp; {h \atop \longrightarrow} \atop {\longleftarrow \atop {4r}}&amp; \ldots
\end{array}
\\
\\
\begin{array}{rl}
d\zeta_0/dt &amp;= -h \zeta_0 + r \zeta_1 \\
d \zeta_i /dt &amp;= -(h+r) \zeta_i + h \zeta_{i-1} + r(i+1) \zeta_{i+1} \\
\end{array}
\end{array}
\end{equation*}\]</span></p>
<p>If one is willing to abandon compartment models, then it is possible to formulate more elegant solution using hybrid models. The mean MoI, <span class="math inline">\(m\)</span> changes according to the equation:</p>
<p><span class="math display">\[\frac{dm}{dt} = h - r m.\]</span>
Using queuing models, it is easy to show that the distribution of the MoI is Poisson, and in these hybrid models, if the initial distribution is not Poisson, then it will converge to the Poisson distribution asymptotically. The complex dynamics of superinfection can thus be reduced to this simple equation.</p>
<p>Unfortunately, things become more complex if we add simple features such as treatment with drugs, or heterogeneous exposure. The distribution of the MoI is no longer Poisson <span class="citation">[<a href="#ref-HenryJM2020HybridModel">82</a>]</span>. Superinfection is an important part of malaria epidemiology, and we will use these models for superinfection in developing some adequate models for infection and immunity.</p>
<p>In the Garki Model (see below), the waiting time to clear an infection used these queuing models to formulate an approximate clearance rate: <span class="math display">\[ \frac{h}{e^{h/r}-1}\]</span></p>
</div>
</div>
<div id="disease-immunity" class="section level2 hasAnchor" number="15.4">
<h2 class="hasAnchor"><span class="header-section-number">15.4</span> Disease &amp; Immunity<a href="#disease-immunity" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The biggest failing of Ross’s model, perhaps, was that it did not make any attempt to grapple with acquired immunity to malaria. It had always been clear that immunity to malaria was important because the prevalence of infection declined throughout adolescence and was consistently lower in adults, and because disease and severe disease were common in young children. The data accumulated through years of studying malaria, done as part of malaria therapy, provided supporting evidence for immunity. There was a difference in outcomes from being exposed to the same parasite (homologous challenge) compared with a different parasite (a heterologous challenge). Immunity had something to do with the number of different parasites that a person had seen.</p>
<p>The first model to grapple with immunity was the Garki Model <span class="citation">[<a href="#ref-DietzK1974GarkiModel">69</a>]</span>. The main idea in the Garki Model was that it would be possible to understand malaria dynamics by expanding the number of compartments: the population was sub-divided into two non-immmune or semi-immune. Infection dynamics were tracked separately within each immune category: the infections would clear faster from semi-immune individuals, they were are not infectious, and they are less likely to test positive if they were infectious. Some features of the Garki model seem odd in retrospect: there were two infected states for non-immunes (<span class="math inline">\(y_1\)</span> and <span class="math inline">\(y_2\)</span>), but only one for semi-immunes; there was no way to lose immunity; and the assumption that semi-immunes are not infectious.</p>
<p>The Garki Model has had a poweful influence on malaria modeling. Several models since then have expanded on various themes. Several compartment models have been developed that replicate infection dynamics across immune stages: we call this <em>stage-structured immunity.</em></p>
<p>In the Garki Model, we can simulate the immuno-epidemiology of cohorts as they age. Eventually, the cohort <em>would</em> settle to an equilibrium. At that point, everyone is semi-immune, a sizable fraction remains non-immune after a century. By the time the cohort reaches the steady state, everyone in the cohort has died. If we focus on the dynamics in the first two decades of life, prevalence rises as people become infected, and then it falls as people become semi-immune. The changing epidemiology as cohorts age is an important feature of malaria. In models like this, the concept of a <em>steady state</em> teaches us something, but the models draw attention to the sharp changes in malaria that occur throught the first 20 years of life. We can adapt the idea of steady state to suit our needs – under constant exposure, cohorts trace out <em>stable orbits</em> as they age. These stable orbits are a basis for understanding malaria dynamics <em>vs.</em> age.</p>
<p>One application of these stable orbits is to understand the the relationship between age and infection prevalence as a function of exposure. Curiously, the Garki Model captures the basic shape of age-<em>Pf</em>PR curves, but it does not get the details right. When we start to look at the factors affecting the <em>Pf</em>PR by age in populations, we must acknowledge the need to add other features: drug taking and chemoprotection; differences in exposure that arise for a number of reasons; anemia, perhaps; seasonality. Not everything is about immuno-epidemiology.</p>
</div>
<div id="gametocytes-and-infectiousness" class="section level2 hasAnchor" number="15.5">
<h2 class="hasAnchor"><span class="header-section-number">15.5</span> Gametocytes and Infectiousness<a href="#gametocytes-and-infectiousness" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In Ross’s models, everyone who is infected is also infectious. This is clearly wrong, but it may not be a terrible assumption under most circumstances. The Garki Model made the extreme assumption that semi-immune individuals are not infectious at all. There is now copious evidence that adults <em>do</em> transmit parasites to mosquitoes, but they are not as infectious. This decline in infectiousness occurs for two reasons: first, the densities of asexual-stage parasites in adults are controlled by immunity, so they are lower. Since a fraction of asexual parasites becomes gametocytes, the densities of gametocytes are also lower in adults. Second, gametocyte densities are modulated by an immune response that affects malaria parasites in mosquitoes, which is called <em>gametocyte-stage transmission blocking</em> immunity. The dynamics of gametocyte-stage immunity change with age and exposure, and we will need to understand how this form of immunity waxes and wanes.</p>
<p>There are some other important details about malaria infections that might be relevant in some contexts. First, <em>P. falciparum</em> gametocytes take 8-12 days to mature. When combined with the 6 days in the liver, we must acknowledge that the latent period is at least 2 weeks. Because gametocytes must reach densities high enough to be transmitted, the effective latent period for humans is probably closer to 20 days. Since the parasites also need 10 days or more to mature in mosquitoes, the shortest parasite generations are probably at least a month long.</p>
<p>Another feature of gametocytes that matters is that gametocyte populations are not always affected by anti-malarial drugs, so after taking drugs that clear all the asexual-stages, some people will remain infectious to mosquitoes for quite a while after being treated with some drugs.</p>
<p>Ross’s assumption may serve most needs, but the models must be good enough to guide policies, such as MDA or malaria elimination, when details about gametocytes and infectiousness can affect the outcomes of policies.</p>
</div>
<div id="treatment-and-chemoprotection" class="section level2 hasAnchor" number="15.6">
<h2 class="hasAnchor"><span class="header-section-number">15.6</span> Treatment and Chemoprotection<a href="#treatment-and-chemoprotection" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>It is impossible to understand malaria infection dynamics without accounting for treatment with anti-malarial drugs and a brief period of chemo-protection that follows. The first model for drug treatment was developed to understand MDA <span class="citation">[<a href="#ref-DietzK1975ModelsParasitic">72</a>]</span>. In developing models for policy, we must be careful about drug taking and its effects because it modifies the relationship between exposure (the EIR) and infection.</p>
<div id="the-time-course-of-an-infection" class="section level3 hasAnchor" number="15.6.1">
<h3 class="hasAnchor"><span class="header-section-number">15.6.1</span> The Time Course of an Infection<a href="#the-time-course-of-an-infection" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The time course of infections is complex, and we will need to develop some models that relate parasite densities. In the chapters that follow, we introduce two main kinds of models:</p>
<ul>
<li><p>AoI</p></li>
<li><p>SoI</p></li>
</ul>
</div>
<div id="intrahost-models" class="section level3 hasAnchor" number="15.6.2">
<h3 class="hasAnchor"><span class="header-section-number">15.6.2</span> Intrahost Models<a href="#intrahost-models" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>There are two kinds of models we will discuss, but we would like to avoid them in making policy if possible.</p>
<ul>
<li><p>In host models;</p></li>
<li><p>Individual-based models.</p></li>
</ul>
</div>
<div id="synthesis" class="section level3 hasAnchor" number="15.6.3">
<h3 class="hasAnchor"><span class="header-section-number">15.6.3</span> Synthesis<a href="#synthesis" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In the end, we do not need perfect models of malaria infection and immunity, but we do need a sound understanding of several things to make policy:</p>
<ul>
<li><p>The prevalence of infection by age as a function of exposure and drug-taking;</p>
<ul>
<li><p>…in a cross-section of the population;</p></li>
<li><p>…in the care-seeking population.</p></li>
</ul></li>
<li><p>The incidence of malaria by severity and by age;</p></li>
<li><p>The fraction of malaria that is promptly treated by severity and by age;</p></li>
<li><p>The net infectiousness of a population of humans to mosquitoes.</p></li>
</ul>
<p>In the chapters that follow, we will develop some models that based on a new concept – the age of the youngest infection – that combine many of the ideas in the chapters above.</p>
<!--chapter:end:200-Malaria-Epidemiology.Rmd-->
</div>
</div>
</div>
<div id="stage-structured-infection" class="section level1 hasAnchor" number="16">
<h1 class="hasAnchor"><span class="header-section-number">16</span> Stage-Structured Infection<a href="#stage-structured-infection" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>In the following sections, we walk through several models for the dynamics of malaria infection and immunity in humans. We cover infection and detection, immunity, infectiousness, disease, drug taking, and cohort dynamics.</p>
<div id="stages-of-infection" class="section level2 hasAnchor" number="16.1">
<h2 class="hasAnchor"><span class="header-section-number">16.1</span> Stages of Infection<a href="#stages-of-infection" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="controlled-infections" class="section level2 hasAnchor" number="16.2">
<h2 class="hasAnchor"><span class="header-section-number">16.2</span> Controlled Infections<a href="#controlled-infections" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="malariotherapy" class="section level3 hasAnchor" number="16.2.1">
<h3 class="hasAnchor"><span class="header-section-number">16.2.1</span> Malariotherapy<a href="#malariotherapy" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="chmi" class="section level3 hasAnchor" number="16.2.2">
<h3 class="hasAnchor"><span class="header-section-number">16.2.2</span> CHMI<a href="#chmi" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
</div>
<div id="a-simple-infection" class="section level2 hasAnchor" number="16.3">
<h2 class="hasAnchor"><span class="header-section-number">16.3</span> A Simple Infection<a href="#a-simple-infection" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="time-course" class="section level3 hasAnchor" number="16.3.1">
<h3 class="hasAnchor"><span class="header-section-number">16.3.1</span> Time Course<a href="#time-course" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="duration" class="section level3 hasAnchor" number="16.3.2">
<h3 class="hasAnchor"><span class="header-section-number">16.3.2</span> Duration<a href="#duration" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
</div>
<div id="superinfection-1" class="section level2 hasAnchor" number="16.4">
<h2 class="hasAnchor"><span class="header-section-number">16.4</span> Superinfection<a href="#superinfection-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="process-vs.-observation" class="section level2 hasAnchor" number="16.5">
<h2 class="hasAnchor"><span class="header-section-number">16.5</span> Process <em>vs.</em> Observation<a href="#process-vs.-observation" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="detection" class="section level3 hasAnchor" number="16.5.1">
<h3 class="hasAnchor"><span class="header-section-number">16.5.1</span> Detection<a href="#detection" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The state space modeling approach.</p>
<!--chapter:end:201-Malaria-Infection.Rmd-->
</div>
</div>
</div>
<div id="stage-structured-infections" class="section level1 hasAnchor" number="17">
<h1 class="hasAnchor"><span class="header-section-number">17</span> Stage-Structured Infections<a href="#stage-structured-infections" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>In the following sections, we walk through several models for the dynamics of malaria infection and immunity in humans. We cover infection and detection, immunity, infectiousness, disease, drug taking, and cohort dynamics.</p>
<div id="stages-of-infection-1" class="section level2 hasAnchor" number="17.1">
<h2 class="hasAnchor"><span class="header-section-number">17.1</span> Stages of Infection<a href="#stages-of-infection-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="controlled-infections-1" class="section level2 hasAnchor" number="17.2">
<h2 class="hasAnchor"><span class="header-section-number">17.2</span> Controlled Infections<a href="#controlled-infections-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="malariotherapy-1" class="section level3 hasAnchor" number="17.2.1">
<h3 class="hasAnchor"><span class="header-section-number">17.2.1</span> Malariotherapy<a href="#malariotherapy-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="chmi-1" class="section level3 hasAnchor" number="17.2.2">
<h3 class="hasAnchor"><span class="header-section-number">17.2.2</span> CHMI<a href="#chmi-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
</div>
<div id="a-simple-infection-1" class="section level2 hasAnchor" number="17.3">
<h2 class="hasAnchor"><span class="header-section-number">17.3</span> A Simple Infection<a href="#a-simple-infection-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="time-course-1" class="section level3 hasAnchor" number="17.3.1">
<h3 class="hasAnchor"><span class="header-section-number">17.3.1</span> Time Course<a href="#time-course-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="duration-1" class="section level3 hasAnchor" number="17.3.2">
<h3 class="hasAnchor"><span class="header-section-number">17.3.2</span> Duration<a href="#duration-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
</div>
<div id="superinfection-2" class="section level2 hasAnchor" number="17.4">
<h2 class="hasAnchor"><span class="header-section-number">17.4</span> Superinfection<a href="#superinfection-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="process-vs.-observation-1" class="section level2 hasAnchor" number="17.5">
<h2 class="hasAnchor"><span class="header-section-number">17.5</span> Process <em>vs.</em> Observation<a href="#process-vs.-observation-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="detection-1" class="section level3 hasAnchor" number="17.5.1">
<h3 class="hasAnchor"><span class="header-section-number">17.5.1</span> Detection<a href="#detection-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The state space modeling approach.</p>
<!--chapter:end:202-Stage-Structured-Infection.Rmd-->
</div>
</div>
</div>
<div id="queuing-models-and-superinfection" class="section level1 hasAnchor" number="18">
<h1 class="hasAnchor"><span class="header-section-number">18</span> Queuing Models and Superinfection<a href="#queuing-models-and-superinfection" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="parasite-densities-and-detection" class="section level2 hasAnchor" number="18.1">
<h2 class="hasAnchor"><span class="header-section-number">18.1</span> Parasite Densities and Detection<a href="#parasite-densities-and-detection" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="light-microscopy" class="section level2 hasAnchor" number="18.2">
<h2 class="hasAnchor"><span class="header-section-number">18.2</span> Light Microscopy<a href="#light-microscopy" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="biomarkers-and-rdts" class="section level2 hasAnchor" number="18.3">
<h2 class="hasAnchor"><span class="header-section-number">18.3</span> Biomarkers and RDTs<a href="#biomarkers-and-rdts" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="pcr" class="section level2 hasAnchor" number="18.4">
<h2 class="hasAnchor"><span class="header-section-number">18.4</span> PCR<a href="#pcr" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<!--chapter:end:203-Queuing-and-Superinfection.Rmd-->
</div>
</div>
<div id="stage-structured-immunity" class="section level1 hasAnchor" number="19">
<h1 class="hasAnchor"><span class="header-section-number">19</span> Stage-Structured Immunity<a href="#stage-structured-immunity" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Immunity to malaria has been described as being <em>weak</em> and immunity has a <em>poor memory</em>. In quantitative terms, this means that almost every aspect of infection is affected by the history of exposure, and exposure accumulates with age.</p>
<p>In developing our models so far, we have ignored age as a factor in malaria epidemiology. In analyzing the models, we looked for steady states or stable temporal orbits. These analyses give a misleading impression of malaria.</p>
<p>The first model to examine malaria immunity was developed for the Garki Project <span class="citation">[<a href="#ref-DietzK1974GarkiModel">69</a>]</span>. We will present the model, for historical reasons, and then we will</p>
<p>it is much easier to formulate models for malaria infection dynamics in cohorts as they age.</p>
<div id="the-garki-model" class="section level2 hasAnchor" number="19.1">
<h2 class="hasAnchor"><span class="header-section-number">19.1</span> The Garki Model<a href="#the-garki-model" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="stage-structured-immunity-1" class="section level2 hasAnchor" number="19.2">
<h2 class="hasAnchor"><span class="header-section-number">19.2</span> Stage-Structured Immunity<a href="#stage-structured-immunity-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="strain-specific-immunity" class="section level2 hasAnchor" number="19.3">
<h2 class="hasAnchor"><span class="header-section-number">19.3</span> Strain Specific Immunity<a href="#strain-specific-immunity" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="memory-tracking" class="section level2 hasAnchor" number="19.4">
<h2 class="hasAnchor"><span class="header-section-number">19.4</span> Memory Tracking<a href="#memory-tracking" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="age-vs.-prevalence" class="section level2 hasAnchor" number="19.5">
<h2 class="hasAnchor"><span class="header-section-number">19.5</span> Age <em>vs.</em> Prevalence<a href="#age-vs.-prevalence" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<!--chapter:end:204-Stage-Structured-Immunity.Rmd-->
</div>
</div>
<div id="age-structured-infection-models" class="section level1 hasAnchor" number="20">
<h1 class="hasAnchor"><span class="header-section-number">20</span> Age-Structured Infection Models<a href="#age-structured-infection-models" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<!--chapter:end:205-Age-Structured-Infections.Rmd-->
</div>
<div id="hybrid-models" class="section level1 hasAnchor" number="21">
<h1 class="hasAnchor"><span class="header-section-number">21</span> Hybrid Models<a href="#hybrid-models" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<!--chapter:end:206-Hybrid-Models.Rmd-->
</div>
<div id="within-host" class="section level1 hasAnchor" number="22">
<h1 class="hasAnchor"><span class="header-section-number">22</span> Within Host<a href="#within-host" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<!--chapter:end:208-WithinHost.Rmd-->
</div>
<div id="fever-and-severe-disease" class="section level1 hasAnchor" number="23">
<h1 class="hasAnchor"><span class="header-section-number">23</span> Fever and Severe Disease<a href="#fever-and-severe-disease" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="fever" class="section level2 hasAnchor" number="23.1">
<h2 class="hasAnchor"><span class="header-section-number">23.1</span> Fever<a href="#fever" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="anemia" class="section level2 hasAnchor" number="23.2">
<h2 class="hasAnchor"><span class="header-section-number">23.2</span> Anemia<a href="#anemia" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="severe-disease" class="section level2 hasAnchor" number="23.3">
<h2 class="hasAnchor"><span class="header-section-number">23.3</span> Severe Disease<a href="#severe-disease" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<!--chapter:end:220-Disease.Rmd-->
</div>
</div>
<div id="drug-taking" class="section level1 hasAnchor" number="24">
<h1 class="hasAnchor"><span class="header-section-number">24</span> Drug Taking<a href="#drug-taking" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="curing-infections" class="section level2 hasAnchor" number="24.1">
<h2 class="hasAnchor"><span class="header-section-number">24.1</span> Curing Infections<a href="#curing-infections" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="chemoprotection" class="section level2 hasAnchor" number="24.2">
<h2 class="hasAnchor"><span class="header-section-number">24.2</span> Chemoprotection<a href="#chemoprotection" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="adherance" class="section level2 hasAnchor" number="24.3">
<h2 class="hasAnchor"><span class="header-section-number">24.3</span> Adherance<a href="#adherance" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="treatment-rates" class="section level2 hasAnchor" number="24.4">
<h2 class="hasAnchor"><span class="header-section-number">24.4</span> Treatment Rates<a href="#treatment-rates" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<!--chapter:end:230-DrugTaking.Rmd-->
</div>
</div>
<div id="gametocytes-and-infectiousness-1" class="section level1 hasAnchor" number="25">
<h1 class="hasAnchor"><span class="header-section-number">25</span> Gametocytes and Infectiousness<a href="#gametocytes-and-infectiousness-1" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="gametocytemia" class="section level2 hasAnchor" number="25.1">
<h2 class="hasAnchor"><span class="header-section-number">25.1</span> Gametocytemia<a href="#gametocytemia" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="anti-gametocyte-immunity" class="section level2 hasAnchor" number="25.2">
<h2 class="hasAnchor"><span class="header-section-number">25.2</span> Anti-Gametocyte Immunity<a href="#anti-gametocyte-immunity" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<!--chapter:end:240-Infectiousness.Rmd-->
</div>
</div>
<div id="models-and-malaria-epidemiology" class="section level1 hasAnchor" number="26">
<h1 class="hasAnchor"><span class="header-section-number">26</span> Models and Malaria Epidemiology<a href="#models-and-malaria-epidemiology" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="section" class="section level2" number="26.1">
<h2><span class="header-section-number">26.1</span> </h2>
<!--chapter:end:250-ModelingMalaria.Rmd-->
</div>
</div>
<div id="part-mosquito-ecology" class="section level1 unnumbered hasAnchor">
<h1 class="unnumbered hasAnchor">(PART) Mosquito Ecology<a href="#part-mosquito-ecology" class="anchor-section" aria-label="Anchor link to header"></a></h1>
</div>
<div id="mosquitoes" class="section level1 hasAnchor" number="27">
<h1 class="hasAnchor"><span class="header-section-number">27</span> Mosquitoes<a href="#mosquitoes" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>In a previous chapter, we consider adult mosquito population density as a process closely related to, but also exogenous to the process of parasite transmission. We formulated the models for mosquito density in terms of an emergence rate, <span class="math inline">\(\Lambda(t)\)</span>. In many studies, this might be good enough. There are some challenges in vector control, however, that call for a deeper understanding of adult mosquito population dynamics in relation to the population dynamics of immature mosquito populations. It’s hard to imagine giving any advice about LSM without a model of mosquito ecology. Adult vector control will reduce mosquito population densities, but it would also reduce egg laying affecting immature mosquito populations <span class="citation">[<a href="#ref-BradyOJ2015AdultVector">83</a>]</span>. Mosquito populations have their own thresholds for persistence, and their own spatial dynamics.</p>
<p>While it could be argued that these are not the primary concerns for malaria programs – we would not disagree – our mathematical framework must be strong enough to support analytics for integrated vector control, including LSM. Immature mosquito dynamics are one of the core dynamical components in our framework. We introduce the topic here, using a very basic model for mosquito ecology <span class="citation">[<a href="#ref-SmithDL2013LarvalDynamics">84</a>]</span>.</p>
<p>To extend the previous model, we need to make several changes and additional assumptions:</p>
<ul>
<li><p>We define terms that describe egg-laying by adult mosquitoes;</p></li>
<li><p>We write a basic equation to describe the dynamics of immature mosquitoes in aquatic habitats as a function of egg-laying. These models describe how eggs hatch, how mosquito larvae develop and mature in aquatic habitats, pupate, and then emerge as adults. The models do not need to be complex, but they could be.</p></li>
<li><p>We replace the parameter <span class="math inline">\(\Lambda(t)\)</span> from the Aron-May model with a term that
describes emergence of adults from aquatic habitats.</p></li>
</ul>
<p>One of the big themes we want to introduce here is that the outcomes of vector control can vary substantially by context because of differences in mosquito ecology.</p>
<div id="aquatic-dynamics" class="section level2 hasAnchor" number="27.1">
<h2 class="hasAnchor"><span class="header-section-number">27.1</span> Aquatic Dynamics<a href="#aquatic-dynamics" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="equations-1" class="section level3 hasAnchor" number="27.1.1">
<h3 class="hasAnchor"><span class="header-section-number">27.1.1</span> Equations<a href="#equations-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Here, we start with the equation for adult ecology from before, leaving out parasite transmission dynamics. We modify the basic slightly by adding one extra term that describes delayed maturation, a different response to crowding <span class="citation">[<a href="#ref-SmithDL2013LarvalDynamics">84</a>]</span>. The mosquito maturation rate, <span class="math inline">\(\psi e^{-\sigma L}\)</span> defines the average time from egg to emergence, and we add one parameter that slows down larval development in response to crowding. The per-capita mortality rate, <span class="math inline">\(\psi  + \theta L\)</span>, has two parts: a density independent term <span class="math inline">\(\psi\)</span> and a response to mean crowding <span class="math inline">\(\theta L\)</span>. We assume that adults lay <span class="math inline">\(\chi\)</span> eggs per feeding cycle.</p>
<p><span class="math display">\[\begin{equation}
\begin{array}{rl}
\frac{dM}{dt} &amp;= \Lambda - g M\\  \\ \hline
\frac{dL}{dt} &amp;= \eta - (\psi e^{-\sigma L} + \phi + \theta L) L \\
\Lambda &amp;= \frac{1}{2} \psi L e^{-\sigma L}\\
\eta &amp;= \chi f M \\
\end{array}
\end{equation}\]</span></p>
</div>
<div id="solutions-3" class="section level3 hasAnchor" number="27.1.2">
<h3 class="hasAnchor"><span class="header-section-number">27.1.2</span> Solutions<a href="#solutions-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="regulation-1" class="section level3 hasAnchor" number="27.1.3">
<h3 class="hasAnchor"><span class="header-section-number">27.1.3</span> Regulation<a href="#regulation-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>This code solves the equations:</p>
<p>The first thing to point out is that changing the dynamics take some time to approach equilibrium – a couple of months, in this model. The second is that increasing mortality rates for mosquitoes in aquatic habitats by a factor of 10 affects the mosquito densities in minor ways.</p>
<p><img src="figs/unnamed-chunk-92-1.png" width="672" /></p>
<p>The third is that increasing the response to mean crowding has a very strong effect on the population dynamics.</p>
<p><img src="figs/unnamed-chunk-93-1.png" width="672" /></p>
<p>The third point is that density dependent responses to mean crowding cause much larger changes to this system than density-dependent mortality. Aquatic dynamics have a strong tendency to oscillate, but more critically, delayed maturation strongly affects the ratio of adult mosquitoes to adults.</p>
<p><img src="figs/compareML-1.png" width="672" /></p>
<p><img src="figs/test-1.png" width="672" /></p>
</div>
</div>
<div id="understanding-mosquito-dynamics" class="section level2 hasAnchor" number="27.2">
<h2 class="hasAnchor"><span class="header-section-number">27.2</span> Understanding Mosquito Dynamics<a href="#understanding-mosquito-dynamics" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>This</p>
<!--chapter:end:300-Mosquitoes.Rmd-->
</div>
</div>
<div id="behavioral-state-models" class="section level1 hasAnchor" number="28">
<h1 class="hasAnchor"><span class="header-section-number">28</span> Behavioral State Models<a href="#behavioral-state-models" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<!--chapter:end:301-Behavioral-States.Rmd-->
</div>
<div id="regulation-of-mosquito-populations" class="section level1 hasAnchor" number="29">
<h1 class="hasAnchor"><span class="header-section-number">29</span> Regulation of Mosquito Populations<a href="#regulation-of-mosquito-populations" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<!--chapter:end:302-Mosquito-Population-Regulation.Rmd-->
</div>
<div id="mosquito-dispersal" class="section level1 hasAnchor" number="30">
<h1 class="hasAnchor"><span class="header-section-number">30</span> Mosquito Dispersal<a href="#mosquito-dispersal" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<!--chapter:end:305-Mosquito-Dispersal.Rmd-->
</div>
<div id="mosquito-age" class="section level1 hasAnchor" number="31">
<h1 class="hasAnchor"><span class="header-section-number">31</span> Mosquito Age<a href="#mosquito-age" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<!--chapter:end:306-Mosquito-Age.Rmd-->
</div>
<div id="multi-species-models" class="section level1 hasAnchor" number="32">
<h1 class="hasAnchor"><span class="header-section-number">32</span> Multi-Species Models<a href="#multi-species-models" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="vector-competence" class="section level2 hasAnchor" number="32.1">
<h2 class="hasAnchor"><span class="header-section-number">32.1</span> Vector Competence<a href="#vector-competence" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<!--chapter:end:308-MultipleVectors.Rmd-->
</div>
</div>
<div id="aquatic-ecology" class="section level1 hasAnchor" number="33">
<h1 class="hasAnchor"><span class="header-section-number">33</span> Aquatic Ecology<a href="#aquatic-ecology" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<!--chapter:end:310-Aquatic-Dynamics.Rmd-->
</div>
<div id="mosquito-larval-stages" class="section level1 hasAnchor" number="34">
<h1 class="hasAnchor"><span class="header-section-number">34</span> Mosquito Larval Stages<a href="#mosquito-larval-stages" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<!--chapter:end:311-Larval-Stages.Rmd-->
</div>
<div id="temporal-dynamics" class="section level1 hasAnchor" number="35">
<h1 class="hasAnchor"><span class="header-section-number">35</span> Temporal Dynamics<a href="#temporal-dynamics" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="exogenous-forcing-2" class="section level2 hasAnchor" number="35.1">
<h2 class="hasAnchor"><span class="header-section-number">35.1</span> Exogenous Forcing<a href="#exogenous-forcing-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="mosquito-survival-through-the-eip" class="section level2 hasAnchor" number="35.2">
<h2 class="hasAnchor"><span class="header-section-number">35.2</span> Mosquito Survival through the EIP<a href="#mosquito-survival-through-the-eip" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<!--chapter:end:330-ExogenousForcing.Rmd-->
</div>
</div>
<div id="measuring-mosquitoes" class="section level1 hasAnchor" number="36">
<h1 class="hasAnchor"><span class="header-section-number">36</span> Measuring Mosquitoes<a href="#measuring-mosquitoes" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<!--chapter:end:340-MeasuringMosquitoes.Rmd-->
</div>
<div id="part-transmission" class="section level1 unnumbered hasAnchor">
<h1 class="unnumbered hasAnchor">(PART) Transmission<a href="#part-transmission" class="anchor-section" aria-label="Anchor link to header"></a></h1>
</div>
<div id="blood-feeding-1" class="section level1 hasAnchor" number="37">
<h1 class="hasAnchor"><span class="header-section-number">37</span> Blood Feeding<a href="#blood-feeding-1" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>The endpoint</p>
<div id="search-and-risk" class="section level3 hasAnchor" number="37.0.1">
<h3 class="hasAnchor"><span class="header-section-number">37.0.1</span> Search and Risk<a href="#search-and-risk" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="search-weights-and-availability" class="section level3 hasAnchor" number="37.0.2">
<h3 class="hasAnchor"><span class="header-section-number">37.0.2</span> Search Weights and Availability<a href="#search-weights-and-availability" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>To deal with heterogeneous exposure and many other phenomena, we need a sensible way of segmenting humans into population <strong>strata</strong>. Stratification makes it possible to deal with population heterogeneity.</p>
<p>A new model of <strong>blood feeding</strong> is based on a model of blood feeding as the endpoint of a search for a blood host <span class="citation">[<a href="#ref-WuSL2023SpatialDynamics">15</a>]</span>.</p>
<ul>
<li><p>Each sub-population has a <em>search weight</em> (<span class="math inline">\(w\)</span>), and the total <em>availability</em> of humans for blood feeding (<span class="math inline">\(W\)</span>) is the sum of the sizes of the strata weighted by their search weights.</p></li>
<li><p>We also consider the availability of alternative vertebrate species for blood feeding (<span class="math inline">\(O\)</span>).</p></li>
</ul>
</div>
<div id="functional-response" class="section level3 hasAnchor" number="37.0.3">
<h3 class="hasAnchor"><span class="header-section-number">37.0.3</span> Functional Response<a href="#functional-response" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><p>Mosquito blood feeding rates are computed using a <em>functional response</em> to total availability of vertebrate hosts (<span class="math inline">\(f = F_f(B)\)</span>).</p></li>
<li><p>To compute total availability, we add a scaling parameter on alternative hosts, because mosquito preferences can translate into different patterns of search; total availability is <span class="math inline">\(B=W + O^\zeta\)</span>.</p></li>
<li><p>The human fraction is proportional to the relative availability of hosts <span class="math inline">\(q = W/B\)</span>.</p></li>
</ul>
</div>
<div id="environmental-heterogeneity-1" class="section level3 hasAnchor" number="37.0.4">
<h3 class="hasAnchor"><span class="header-section-number">37.0.4</span> Environmental Heterogeneity<a href="#environmental-heterogeneity-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><p>The <em>search weights</em> thus translate into a kind of <strong><a href="#frailtyCh">Frailty</a></strong>, which is one component of <em>heterogeneous exposure.</em> Important sources of frailty include bednet use, housing type, and age.</p></li>
<li><p>We also want to consider <em>variability</em> in exposure within a stratum – what is the distribution of the <em>expected</em> number of bites over time? We have already discussed frailties, so this is a different kind of heterogeneous exposure that we call <strong><a href="#environmental-heterogeneity">Environmental Heterogeneity</a></strong>. This helps us to align models with data: mosquito counts data tend to be described well by <em>negative binomial</em> distributions, so it is likely that the distribution of infectious bites also follows a negative binomial distribution. We introduce a function that translate the EIR into the FoI:
<span class="math display">\[h=F_h(E)\]</span></p></li>
</ul>
<p>In the Ross-Macdonald model, the underlying assumption is consistent with a Poisson distribution, but we have also derived <em>negative binomial hazard rates</em>. Environmental heterogeneity can arise from two sources:</p>
<ul>
<li><p>the aggregated distributions of mosquitoes in micro-habitats, and the redistribution of mosquito populations by wind and weather;</p></li>
<li><p>random movements of humans around mosquito micro-habitats that affect their risk in a way that doesn’t tend to change the mean;</p></li>
</ul>
</div>
<div id="host-availability" class="section level2 hasAnchor" number="37.1">
<h2 class="hasAnchor"><span class="header-section-number">37.1</span> Host Availability<a href="#host-availability" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="blood-feeding-rates" class="section level2 hasAnchor" number="37.2">
<h2 class="hasAnchor"><span class="header-section-number">37.2</span> Blood Feeding Rates<a href="#blood-feeding-rates" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="the-human-fraction" class="section level2 hasAnchor" number="37.3">
<h2 class="hasAnchor"><span class="header-section-number">37.3</span> The Human Fraction<a href="#the-human-fraction" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="the-mixing-matrix-beta" class="section level2 hasAnchor" number="37.4">
<h2 class="hasAnchor"><span class="header-section-number">37.4</span> The Mixing Matrix, <span class="math inline">\(\beta\)</span><a href="#the-mixing-matrix-beta" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<!--chapter:end:400-Transmission.Rmd-->
</div>
</div>
<div id="human-mobility" class="section level1 hasAnchor" number="38">
<h1 class="hasAnchor"><span class="header-section-number">38</span> Human Mobility<a href="#human-mobility" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="modalities" class="section level2 hasAnchor" number="38.1">
<h2 class="hasAnchor"><span class="header-section-number">38.1</span> Modalities<a href="#modalities" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="time-at-risk" class="section level2 hasAnchor" number="38.2">
<h2 class="hasAnchor"><span class="header-section-number">38.2</span> Time at Risk<a href="#time-at-risk" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="travel" class="section level2 hasAnchor" number="38.3">
<h2 class="hasAnchor"><span class="header-section-number">38.3</span> Travel<a href="#travel" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="migration" class="section level2 hasAnchor" number="38.4">
<h2 class="hasAnchor"><span class="header-section-number">38.4</span> Migration<a href="#migration" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<!--chapter:end:401-HumanMobility.Rmd-->
</div>
</div>
<div id="spatial-dynamics-1" class="section level1 hasAnchor" number="39">
<h1 class="hasAnchor"><span class="header-section-number">39</span> Spatial Dynamics<a href="#spatial-dynamics-1" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<!--chapter:end:402-SpatialDynamics.Rmd-->
</div>
<div id="heterogeneous-transmission-1" class="section level1 hasAnchor" number="40">
<h1 class="hasAnchor"><span class="header-section-number">40</span> Heterogeneous Transmission<a href="#heterogeneous-transmission-1" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>For humans, exposure to malaria means exposure to the bites of infectious mosquitoes. A problem that we’ll have to deal with sooner or later is that exposure risk differs among humans over space and time. While this might seem like an odd thing to introduce so early, we will have to tackle the topic sometime. The discussion of <a href="#heterogeneous-biting">Heterogeneous Biting</a>, in the previous chapter, showed that heterogeneity plays an important in understanding transmission and thresholds. This discussion of heterogeneous exposure (<em>i.e.</em>, looking at heterogeneous biting from the human side) is a good way of introducing some of the core concepts that are built into the framework:</p>
<ul>
<li><p><a href="#heterogeneous-biting">Heterogeneous Biting</a> is one way of getting around a conundrum. In models with homogeneous biting, the relationship between <em>average</em> mosquito density and the prevalence of infection would lead us to make quantitative predictions about the likely effects of vector control.</p></li>
<li><p>We discuss two different kinds of heterogeneous exposure: frailty, and environmental heterogeneity. In a nutshell, frailty multiplies the mean hazard rate for a sub-population by some amount <span class="math inline">\(k\)</span>. Environmental heterogeneity does not affect the mean, but it changes the distribution of the mean.</p></li>
<li><p>We introduce the idea that we can deal with frailties in human populations by segmenting the population into strata.</p></li>
<li><p>We set the stage for a new model of mosquito <strong>blood feeding</strong> that we introduce in the next chapter.</p></li>
<li><p>In a chapter on [Approximation], we use these models to discuss the problem of model-based inference.</p></li>
</ul>
<div id="overview-1" class="section level2 hasAnchor" number="40.1">
<h2 class="hasAnchor"><span class="header-section-number">40.1</span> Overview<a href="#overview-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Some reasons heterogeneous exposure to malaria have been documented in hundreds of studies. This is an overview.</p>
<div id="age-1" class="section level3 hasAnchor" number="40.1.1">
<h3 class="hasAnchor"><span class="header-section-number">40.1.1</span> Age<a href="#age-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><p>Port, Boreham</p></li>
<li><p>Carnevale</p></li>
</ul>
</div>
<div id="location" class="section level3 hasAnchor" number="40.1.2">
<h3 class="hasAnchor"><span class="header-section-number">40.1.2</span> Location<a href="#location" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="house-type" class="section level3 hasAnchor" number="40.1.3">
<h3 class="hasAnchor"><span class="header-section-number">40.1.3</span> House Type<a href="#house-type" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="activities" class="section level3 hasAnchor" number="40.1.4">
<h3 class="hasAnchor"><span class="header-section-number">40.1.4</span> Activities<a href="#activities" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
</div>
<div id="frailtyCh" class="section level2 hasAnchor" number="40.2">
<h2 class="hasAnchor"><span class="header-section-number">40.2</span> Frailty<a href="#frailtyCh" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In general, we define frailty as a multiplicative factor on the FoI. If the average FoI in the population is <span class="math inline">\(h\)</span>, then the FoI in a stratum is <span class="math inline">\(hk\)</span>. The size of the stratum, <span class="math inline">\(p_k\)</span>, is constrained such that:</p>
<p><span class="math display">\[\int_0^\infty k \; p_k \; dk = 1\]</span></p>
<p>With this constraint, the mean FoI in the population is <span class="math inline">\(h\)</span>.</p>
<p>Continuous distributions are difficult to extend, but we can stratify a population to accomplish some of the same effects.</p>
</div>
<div id="environmentalHeterogeneity" class="section level2 hasAnchor" number="40.3">
<h2 class="hasAnchor"><span class="header-section-number">40.3</span> Environmental Heterogeneity<a href="#environmentalHeterogeneity" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<!--chapter:end:403-HeterogeneousTransmission.Rmd-->
</div>
</div>
<div id="part-malaria-control" class="section level1 unnumbered hasAnchor">
<h1 class="unnumbered hasAnchor">(PART) Malaria Control<a href="#part-malaria-control" class="anchor-section" aria-label="Anchor link to header"></a></h1>
</div>
<div id="malaria-control" class="section level1 hasAnchor" number="41">
<h1 class="hasAnchor"><span class="header-section-number">41</span> Malaria Control<a href="#malaria-control" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="health-systems" class="section level2 hasAnchor" number="41.1">
<h2 class="hasAnchor"><span class="header-section-number">41.1</span> Health Systems<a href="#health-systems" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Towards a theory of vector control.</p>
</div>
<div id="vector-control" class="section level2 hasAnchor" number="41.2">
<h2 class="hasAnchor"><span class="header-section-number">41.2</span> Vector Control<a href="#vector-control" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<!--chapter:end:500-VectorControl.Rmd-->
</div>
</div>
<div id="insecticide-treated-bednets" class="section level1 hasAnchor" number="42">
<h1 class="hasAnchor"><span class="header-section-number">42</span> Insecticide-Treated Bednets<a href="#insecticide-treated-bednets" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<!--chapter:end:501-ITN.Rmd-->
</div>
<div id="indoor-residual-spraying" class="section level1 hasAnchor" number="43">
<h1 class="hasAnchor"><span class="header-section-number">43</span> Indoor Residual Spraying<a href="#indoor-residual-spraying" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<!--chapter:end:502-IRS.Rmd-->
</div>
<div id="larval-source-management-1" class="section level1 hasAnchor" number="44">
<h1 class="hasAnchor"><span class="header-section-number">44</span> Larval Source Management<a href="#larval-source-management-1" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<!--chapter:end:503-LSM.Rmd-->
</div>
<div id="attractive-toxic-sugar-baits" class="section level1 hasAnchor" number="45">
<h1 class="hasAnchor"><span class="header-section-number">45</span> Attractive Toxic Sugar Baits<a href="#attractive-toxic-sugar-baits" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<!--chapter:end:504-ATSB.Rmd-->
</div>
<div id="integrated-vector-control-1" class="section level1 hasAnchor" number="46">
<h1 class="hasAnchor"><span class="header-section-number">46</span> Integrated Vector Control<a href="#integrated-vector-control-1" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<!--chapter:end:509-IntegratedVectorControl.Rmd-->
</div>
<div id="part-health-systems" class="section level1 unnumbered hasAnchor">
<h1 class="unnumbered hasAnchor">(PART) Health Systems<a href="#part-health-systems" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<!--chapter:end:600-Humans.Rmd-->
</div>
<div id="cohort-dynamics-1" class="section level1 hasAnchor" number="47">
<h1 class="hasAnchor"><span class="header-section-number">47</span> Cohort Dynamics<a href="#cohort-dynamics-1" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>We need a way of incorporating age into our models.</p>
<div id="boxcar-models" class="section level2 hasAnchor" number="47.1">
<h2 class="hasAnchor"><span class="header-section-number">47.1</span> Boxcar Models<a href="#boxcar-models" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="delay" class="section level2 hasAnchor" number="47.2">
<h2 class="hasAnchor"><span class="header-section-number">47.2</span> Delay<a href="#delay" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<!--chapter:end:601-CareSeeking.Rmd-->
</div>
</div>
<div id="human-demography" class="section level1 hasAnchor" number="48">
<h1 class="hasAnchor"><span class="header-section-number">48</span> Human Demography<a href="#human-demography" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="migration-1" class="section level2 hasAnchor" number="48.1">
<h2 class="hasAnchor"><span class="header-section-number">48.1</span> Migration<a href="#migration-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<!--chapter:end:602-Human-Demography.Rmd-->
</div>
</div>
<div id="human-travel-and-malaria-importation" class="section level1 hasAnchor" number="49">
<h1 class="hasAnchor"><span class="header-section-number">49</span> Human Travel and Malaria Importation<a href="#human-travel-and-malaria-importation" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<!--chapter:end:603-Travel.Rmd-->
</div>
<div id="stratification" class="section level1 hasAnchor" number="50">
<h1 class="hasAnchor"><span class="header-section-number">50</span> Stratification<a href="#stratification" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<!--chapter:end:605-Stratification.Rmd-->
</div>
<div id="pharmaceutical-interventions" class="section level1 hasAnchor" number="51">
<h1 class="hasAnchor"><span class="header-section-number">51</span> Pharmaceutical Interventions<a href="#pharmaceutical-interventions" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="smc" class="section level2 hasAnchor" number="51.1">
<h2 class="hasAnchor"><span class="header-section-number">51.1</span> SMC<a href="#smc" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="mda" class="section level2 hasAnchor" number="51.2">
<h2 class="hasAnchor"><span class="header-section-number">51.2</span> MDA<a href="#mda" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="drugs" class="section level2 hasAnchor" number="51.3">
<h2 class="hasAnchor"><span class="header-section-number">51.3</span> Drugs<a href="#drugs" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="vaccines" class="section level2 hasAnchor" number="51.4">
<h2 class="hasAnchor"><span class="header-section-number">51.4</span> Vaccines<a href="#vaccines" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<!--chapter:end:606-Pharmaceuticals.Rmd-->
</div>
</div>
<div id="part-analytics" class="section level1 unnumbered hasAnchor">
<h1 class="unnumbered hasAnchor">(PART) Analytics<a href="#part-analytics" class="anchor-section" aria-label="Anchor link to header"></a></h1>
</div>
<div id="malaria-analytics" class="section level1 hasAnchor" number="52">
<h1 class="hasAnchor"><span class="header-section-number">52</span> Malaria Analytics<a href="#malaria-analytics" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>The basic premise of this book, <em>Applied Malaria Dynamics,</em> is that we want to use mathematical models to support development of malaria policies.</p>
<p>Two core concepts missing from the Ross-Macdonald model were the burden of malaria and a theory of control</p>
<div id="the-burden-of-malaria-1" class="section level2 hasAnchor" number="52.1">
<h2 class="hasAnchor"><span class="header-section-number">52.1</span> The Burden of Malaria<a href="#the-burden-of-malaria-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="a-theory-of-control" class="section level2 hasAnchor" number="52.2">
<h2 class="hasAnchor"><span class="header-section-number">52.2</span> A Theory of Control<a href="#a-theory-of-control" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="generic-vs.-specific-advice" class="section level2 hasAnchor" number="52.3">
<h2 class="hasAnchor"><span class="header-section-number">52.3</span> Generic <em>vs.</em> Specific Advice<a href="#generic-vs.-specific-advice" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="imputation-1" class="section level2 hasAnchor" number="52.4">
<h2 class="hasAnchor"><span class="header-section-number">52.4</span> Imputation<a href="#imputation-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="robust-analytics" class="section level2 hasAnchor" number="52.5">
<h2 class="hasAnchor"><span class="header-section-number">52.5</span> Robust Analytics<a href="#robust-analytics" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Among the most important topics</p>
<p>In Chapter @ref(ch-uncertainty), we take a deep dive into uncertainty.</p>
<!--chapter:end:700-MalariaAnalytics.Rmd-->
</div>
</div>
<div id="malaria-metrics" class="section level1 hasAnchor" number="53">
<h1 class="hasAnchor"><span class="header-section-number">53</span> Malaria Metrics<a href="#malaria-metrics" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>If we want to use evidence to make policy, we need to understand transmission and disease in its local context, which we learn about from assembling and analyzing the evidence. In malaria, the evidence is usually one or more of a core set of metrics. One useful metric is the <em>Pf</em>PR from cross sectional surveys; these are available from research studies, but they are also available from demographic health surveys (DHS) or malaria indicator surveys (MIS). If we are lucky, we will also have mosquito catch counts data (by some method), which we scale by effort and report as something like the <em>Pf</em>HBR. We estimate the <em>Pf</em>SR from some of these caught mosquitoes, and we take their product, the <em>Pf</em>EIR. From other designs, we might have estimtes of the <em>Pf</em>FoI, or if serology was done, we might know the <em>Pf</em>SCR.</p>
<p>From routine clinical surveillance, we could get case counts or the <em>Pf</em>SPR. We can learn more if we stratify by age, or if we follow populations over time.</p>
<p>If we are to make sense of malaria as a changing baseline that has been modified by control, then we must know something about how transmission has been modified by control. First and foremost, we must understand anti-malarial drug taking, including the frequency of drug taking (for any purpose), adherence to prescribed regimens, and drug taking by severity. To understand transmission, we must have data describing intervention coverage and its timing. This would include patterns of bed net ownership and use over time, IRS and its coverage. We can’t make sense of vector control coverage data without knowing something about the patterns of insecticide resistance. We discuss [Measuring Vector Control] in the next chapter.</p>
<p>For planning, we would like to know the burden of malaria, and we would like to have an estimate of transmission – something like a malaria reproductive number.</p>
<p>In most places, we will have routine surveillance data. We would like to piece together a coherent and accurate picture of transmission from this and from any other data we may have. To do so, we would like to know how these statistics compare in settings where two or more of them have been measured at the same place and at the same time. From studies like this, we can start to understand the <strong>scaling relationships</strong> among metrics, and the factors that influence them. What we have learned from studying these relationships is that there the relationship are highly non-linear <span class="citation">[<a href="#ref-HaySI2008MeasuringMalaria">85</a>]</span>, and that some of the factors affecting this relationship are context dependent. We have already mentioned drug taking, and we must acknowledge the difficulty of estimating drug taking by age, in part, because it is often highly heterogeneous in populations. Other factors that have been implicated are heterogeneous biting, environmental heterogeneity, seasonality, travel and mobility.</p>
<p>Sitting between us and the truth is an observational process, and we must attempt to quantify bias and error in this sampling process if we are to have any hope of getting an accurate picture of transmission in context.</p>
<p>To get there, we need to organize our algorithms:</p>
<ul>
<li><p>The <em>Pf</em>PR varies in a population by age, sex, and the diagnostic method; so we simulate malaria in cohorts as they age, and we output the predicted <em>Pf</em>PR by age, sex, and diagnostic method.</p></li>
<li><p>The <em>Pf</em>PR is modified by drug-taking; the effect modification varies in a population by age, access to care, and adherence to drug regimens. In our algorithms, we must consider various patterns of drug taking and chemoprotection.</p></li>
<li><p>Exposure is <em>seasonal</em></p>
<ul>
<li><p>seasonality <em>would</em> affect the true <em>Pf</em>PR and the true <em>Pf</em>EIR over time;</p></li>
<li><p>seasonality <em>could</em> be a source of error in the estimated <em>Pf</em>PR (especially with respect to age) and estimated <em>Pf</em>EIR, particularly if the <em>Pf</em>PR is reported in young children, and mismatched even slightly with <em>Pf</em>EIR.</p></li>
</ul></li>
<li><p>Heterogeneous exposure:</p>
<ul>
<li><p>exposure varies by age;</p></li>
<li><p>there are other identifiable sources of frailty that we can deal with through stratification (<em>e.g.</em> house type, location, bed net use), and there are many frailties we will not be able to identify;</p></li>
<li><p>the relationship between exposure and infection is affected by <em>environmental heterogeneity;</em> because of variability in mosquito populations at a fine spatial grain over time and space, and the trajectories of individual humans who are put at risk,</p></li>
</ul></li>
<li><p>The <em>Pf</em>EIR near home is obscured by human mobility through time at risk and exposure away from home;</p></li>
<li><p>Travel and imported malaria can increase the <em>Pf</em>PR, even if there is no local exposure.</p></li>
<li><p>Measurement errors in the <em>Pf</em>EIR</p>
<ul>
<li><p>There are <em>house effects</em> that bias the estimation of the <em>Pf</em>EIR</p></li>
<li><p>Different methods of catching mosquitoes give different estimates for the HBR.</p></li>
</ul></li>
</ul>
<p>These effects are incorporated into the framework. Frailties are dealt with by stratifying by age (<span class="math inline">\(\omega(a)\)</span>) and other traits and assigning <em>biting weights</em>; when combined with mobility, these become part of the mixing matrix, <span class="math inline">\(\beta\)</span>. Environmental heterogeneity modifies the relationship between the <em>Pf</em>EIR by stratum and the <em>Pf</em>FoI (through <span class="math inline">\(F_h\)</span>). Seasonality in mosquito density (<span class="math inline">\(Z(t)\)</span>) translates into seasonality in exposure (<span class="math inline">\(S(t)\)</span>). Drug taking and immunity modify the <em>Pf</em>PR after exposure.</p>
<p>We would like to understand mosquito populations, but we will rely on whatever data we have to <em>estimate</em> the <em>Pf</em>EIR (see Figure 4.1). This is a core algorithm for simulation-based analytics, and the framework was designed to serve these ends.</p>
<p>In the following sections, we use the framework to illustrate the effects and effect sizes of these factors. The task of estimating is for another book, <strong>Robust Analytics for Malaria Policy.</strong> In this study, we make full use of modularity. We start by <em>stratifying</em> our human population by age, and possibly by other factors. We write algorithms that pass the density of blood feeding mosquitoes in a place, and our algorithms predict mosquito catch counts, depending on the method. From this, we compute the total FoI, which includes the <em>local</em> FoI (at and around home), and the <em>travel</em> FoI. These exposure rates, and algorithms describing drug taking, are translated into estimates of the true <em>Pf</em>PR. The models output the predicted <em>Pf</em>PR by age, sex, and method; and we also output the predicted patterns of care seeking and associated metrics at health facilities in an HMIS, by age and sex.</p>
<hr />
<div class="float">
<img src="Figures/Estimation.png" alt="Figure 4.1: A generalized framwork for understanding the relationship between the PfEIR and the PfPR:" />
<div class="figcaption">Figure 4.1: A generalized framwork for understanding the relationship between the <em>Pf</em>EIR and the <em>Pf</em>PR:</div>
</div>
<div id="realistic-bounds" class="section level2 hasAnchor" number="53.1">
<h2 class="hasAnchor"><span class="header-section-number">53.1</span> Realistic Bounds<a href="#realistic-bounds" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>An important reality check is that we can set sensible expectations about upper bounds on the <em>Pf</em>PR in relation to exposure. The maximum value of the <em>Pf</em>PR will tend to be observed in untreated populations with homogeneous exposure. To identify these bounds, we assume that we are passing the <em>true</em> <em>Pf</em>EIR, but not necessarily the <em>local</em> <em>Pf</em>EIR.</p>
</div>
<div id="the-local-fraction" class="section level2 hasAnchor" number="53.2">
<h2 class="hasAnchor"><span class="header-section-number">53.2</span> The Local Fraction<a href="#the-local-fraction" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="travel-1" class="section level3 hasAnchor" number="53.2.1">
<h3 class="hasAnchor"><span class="header-section-number">53.2.1</span> Travel<a href="#travel-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="mobility" class="section level3 hasAnchor" number="53.2.2">
<h3 class="hasAnchor"><span class="header-section-number">53.2.2</span> Mobility<a href="#mobility" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
</div>
<div id="drug-taking-1" class="section level2 hasAnchor" number="53.3">
<h2 class="hasAnchor"><span class="header-section-number">53.3</span> Drug Taking<a href="#drug-taking-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="seasonality-1" class="section level2 hasAnchor" number="53.4">
<h2 class="hasAnchor"><span class="header-section-number">53.4</span> Seasonality<a href="#seasonality-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="frailty" class="section level2 hasAnchor" number="53.5">
<h2 class="hasAnchor"><span class="header-section-number">53.5</span> Frailty<a href="#frailty" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>At low intensity, frailty can affect the prevalence</p>
</div>
<div id="environmental-heterogeneity-2" class="section level2 hasAnchor" number="53.6">
<h2 class="hasAnchor"><span class="header-section-number">53.6</span> Environmental Heterogeneity<a href="#environmental-heterogeneity-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="pfeir-vs.-pfpr-in-data" class="section level2 hasAnchor" number="53.7">
<h2 class="hasAnchor"><span class="header-section-number">53.7</span> <em>Pf</em>EIR <em>vs.</em> <em>Pf</em>PR in Data<a href="#pfeir-vs.-pfpr-in-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="pfeir-vs.-pffoi-in-data" class="section level2 hasAnchor" number="53.8">
<h2 class="hasAnchor"><span class="header-section-number">53.8</span> <em>Pf</em>EIR <em>vs.</em> <em>Pf</em>FoI in Data<a href="#pfeir-vs.-pffoi-in-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="synthesis-1" class="section level2 hasAnchor" number="53.9">
<h2 class="hasAnchor"><span class="header-section-number">53.9</span> Synthesis<a href="#synthesis-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<!--chapter:end:701-MalariaMetrics.Rmd-->
</div>
</div>
<div id="discrete-time" class="section level1 hasAnchor" number="54">
<h1 class="hasAnchor"><span class="header-section-number">54</span> Discrete Time<a href="#discrete-time" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<!--chapter:end:702-Scaling.Rmd-->
</div>
<div id="spatial-concepts-and-connectivity" class="section level1 hasAnchor" number="55">
<h1 class="hasAnchor"><span class="header-section-number">55</span> Spatial Concepts and Connectivity<a href="#spatial-concepts-and-connectivity" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<!--chapter:end:703-Connectivity.Rmd-->
</div>
<div id="mosquito-microecology" class="section level1 hasAnchor" number="56">
<h1 class="hasAnchor"><span class="header-section-number">56</span> Mosquito Microecology<a href="#mosquito-microecology" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Modeling mosquito population dynamics on point sets.</p>
<!--chapter:end:704-Microecology.Rmd-->
</div>
<div id="microsimulation" class="section level1 hasAnchor" number="57">
<h1 class="hasAnchor"><span class="header-section-number">57</span> Microsimulation<a href="#microsimulation" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<!--chapter:end:705-Microsimulation.Rmd-->
</div>
<div id="spatial-control" class="section level1 hasAnchor" number="58">
<h1 class="hasAnchor"><span class="header-section-number">58</span> Spatial Control<a href="#spatial-control" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<!--chapter:end:706-SpatialControl.Rmd-->
</div>
<div id="model-libraries" class="section level1 hasAnchor" number="59">
<h1 class="hasAnchor"><span class="header-section-number">59</span> Model Libraries<a href="#model-libraries" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<!--chapter:end:800-ModelLibraries.Rmd-->
</div>
<div id="base-models" class="section level1 hasAnchor" number="60">
<h1 class="hasAnchor"><span class="header-section-number">60</span> Base Models<a href="#base-models" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<!--chapter:end:801-BaseModels.Rmd-->
</div>
<div id="built-in-analytics" class="section level1 hasAnchor" number="61">
<h1 class="hasAnchor"><span class="header-section-number">61</span> Built-in Analytics<a href="#built-in-analytics" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<!--chapter:end:804-BuiltInAnalytics.Rmd-->
</div>
<div id="stochasticity" class="section level1 hasAnchor" number="62">
<h1 class="hasAnchor"><span class="header-section-number">62</span> Stochasticity<a href="#stochasticity" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<!--chapter:end:805-Stochasticity.Rmd-->
</div>
<div id="a-glossary" class="section level1 hasAnchor" number="63">
<h1 class="hasAnchor"><span class="header-section-number">63</span> A Glossary<a href="#a-glossary" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<!--chapter:end:998-Glossary.Rmd-->
</div>
<div id="part-supplements" class="section level1 unnumbered hasAnchor">
<h1 class="unnumbered hasAnchor">(PART) Supplements<a href="#part-supplements" class="anchor-section" aria-label="Anchor link to header"></a></h1>
</div>
<div id="references" class="section level1 hasAnchor" number="64">
<h1 class="hasAnchor"><span class="header-section-number">64</span> References<a href="#references" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<blockquote>
<p><em>There must have been a time, in the beginning, when we could have said – no. But somehow we missed it.</em> (Guildenstern)<br />
— from <em>Rosencranz and Guildenstern are Dead</em>, Tom Stoppard</p>
</blockquote>
<p>If you want a PDF and can’t find it at the link provided, let us know and we can help you find a copy.</p>
<!--chapter:end:999-References.Rmd-->
<div id="refs" class="references csl-bib-body">
<div id="ref-RossR1911Book" class="csl-entry">
<div class="csl-left-margin">1. </div><div class="csl-right-inline">Ross R. The <span>Prevention</span> of <span>Malaria</span>. 2nd ed. London: John Murray; 1911. </div>
</div>
<div id="ref-SmithDL2012_RossMacdonald" class="csl-entry">
<div class="csl-left-margin">2. </div><div class="csl-right-inline">Smith DL, Battle KE, Hay SI, Barker CM, Scott TW, McKenzie FE. Ross, <span>Macdonald</span>, and a theory for the dynamics and control of mosquito-transmitted pathogens. PLoS Pathog. 2012;8: e1002588. doi:<a href="https://doi.org/10.1371/journal.ppat.1002588">10.1371/journal.ppat.1002588</a></div>
</div>
<div id="ref-ReinerRC2013SystematicReview" class="csl-entry">
<div class="csl-left-margin">3. </div><div class="csl-right-inline">Reiner RC Jr, Perkins TA, Barker CM, Niu T, Chaves LF, Ellis AM, et al. A systematic review of mathematical models of mosquito-borne pathogen transmission: 1970-2010. J R Soc Interface. 2013;10: 20120921. </div>
</div>
<div id="ref-MolineauxL1999ReviewIntrahost" class="csl-entry">
<div class="csl-left-margin">4. </div><div class="csl-right-inline">Molineaux L, Dietz K. Review of intra-host models of malaria. Parassitologia. 1999;41: 221–231. Available: <a href="http://eutils.ncbi.nlm.nih.gov/entrez/eutils/elink.fcgi?dbfrom=pubmed&amp;id=10697860&amp;retmode=ref&amp;cmd=prlinks">http://eutils.ncbi.nlm.nih.gov/entrez/eutils/elink.fcgi?dbfrom=pubmed&amp;id=10697860&amp;retmode=ref&amp;cmd=prlinks</a></div>
</div>
<div id="ref-SmithDL2014Recasting" class="csl-entry">
<div class="csl-left-margin">5. </div><div class="csl-right-inline">Smith DL, Perkins TA, Reiner RC Jr, Barker CM, Niu T, Chaves LF, et al. Recasting the theory of mosquito-borne pathogen transmission dynamics and control. Trans R Soc Trop Med Hyg. 2014;108: 185–197. doi:<a href="https://doi.org/10.1093/trstmh/tru026">10.1093/trstmh/tru026</a></div>
</div>
<div id="ref-SmithDL2013StickySituation" class="csl-entry">
<div class="csl-left-margin">6. </div><div class="csl-right-inline">Smith DL, Cohen JM, Chiyaka C, Johnston G, Gething PW, Gosling R, et al. A sticky situation: The unexpected stability of malaria elimination. Philos Trans R Soc Lond B Biol Sci. 2013;368: 20120145. doi:<a href="https://doi.org/10.1098/rstb.2012.0145">10.1098/rstb.2012.0145</a></div>
</div>
<div id="ref-ChiyakaC2013Sticky" class="csl-entry">
<div class="csl-left-margin">7. </div><div class="csl-right-inline">Chiyaka C, Tatem AJ, Cohen JM, Gething PW, Johnston G, Gosling R, et al. Infectious disease. <span>The</span> stability of malaria elimination. Science. 2013;339: 909–910. doi:<a href="https://doi.org/10.1126/science.1229509">10.1126/science.1229509</a></div>
</div>
<div id="ref-WuSL2020MBITES" class="csl-entry">
<div class="csl-left-margin">8. </div><div class="csl-right-inline">Wu SL, Sánchez C HM, Henry JM, Citron DT, Zhang Q, Compton K, et al. Vector bionomics and vectorial capacity as emergent properties of mosquito behaviors and ecology. PLoS Comput Biol. 2020;16: e1007446. doi:<a href="https://doi.org/10.1371/journal.pcbi.1007446">10.1371/journal.pcbi.1007446</a></div>
</div>
<div id="ref-LevinS1991RelevantDetail" class="csl-entry">
<div class="csl-left-margin">9. </div><div class="csl-right-inline">Levin S. The <span>Problem</span> of <span>Relevant</span> <span>Detail</span>. In: Busenberg S, Martelli M, editors. Differential <span>Equations</span> <span>Models</span> in <span>Biology</span>, <span>Epidemiology</span> and <span>Ecology</span>: <span>Proceedings</span> of a <span>Conference</span> held in <span>Claremont</span> <span>California</span>, <span>January</span> 13–16, 1990. Berlin, Heidelberg: Springer Berlin Heidelberg; 1991. pp. 9–15. doi:<a href="https://doi.org/10.1007/978-3-642-45692-3_1">10.1007/978-3-642-45692-3_1</a></div>
</div>
<div id="ref-SmithNR2018AgentbasedModels" class="csl-entry">
<div class="csl-left-margin">10. </div><div class="csl-right-inline">Smith NR, Trauer JM, Gambhir M, Richards JS, Maude RJ, Keith JM, et al. Agent-based models of malaria transmission: <span>A</span> systematic review. Malar J. 2018;17: 299. doi:<a href="https://doi.org/10.1186/s12936-018-2442-y">10.1186/s12936-018-2442-y</a></div>
</div>
<div id="ref-CarterR2002SpatialSimulation" class="csl-entry">
<div class="csl-left-margin">11. </div><div class="csl-right-inline">Carter R. Spatial simulation of malaria transmission and its control by malaria transmission blocking vaccination. International Journal for Parasitology. 2002;32: 1617–1624. doi:<a href="https://doi.org/10.1016/S0020-7519(02)00190-X">10.1016/S0020-7519(02)00190-X</a></div>
</div>
<div id="ref-GuW2003IndividualbasedModel" class="csl-entry">
<div class="csl-left-margin">12. </div><div class="csl-right-inline">Gu W, Killeen GF, Mbogo CM, Regens JL, Githure JI, Beier JC. An individual-based model of <em><span>Plasmodium</span> falciparum</em> malaria transmission on the coast of <span>Kenya</span>. Trans R Soc Trop Med Hyg. 2003;97: 43–50. doi:<a href="https://doi.org/10.1016/s0035-9203(03)90018-6">10.1016/s0035-9203(03)90018-6</a></div>
</div>
<div id="ref-PerkinsTA2013HeterogeneityMixing" class="csl-entry">
<div class="csl-left-margin">13. </div><div class="csl-right-inline">Perkins TA, Scott TW, Le Menach A, Smith DL. Heterogeneity, mixing, and the spatial scales of mosquito-borne pathogen transmission. PLoS Comput Biol. 2013;9: e1003327. </div>
</div>
<div id="ref-TatemAJ2010InternationalPopulation" class="csl-entry">
<div class="csl-left-margin">14. </div><div class="csl-right-inline">Tatem AJ, Smith DL. International population movements and regional <em><span>Plasmodium</span> falciparum</em> malaria elimination strategies. Proc Natl Acad Sci U S A. 2010;107: 12222–12227. doi:<a href="https://doi.org/10.1073/pnas.1002971107">10.1073/pnas.1002971107</a></div>
</div>
<div id="ref-WuSL2023SpatialDynamics" class="csl-entry">
<div class="csl-left-margin">15. </div><div class="csl-right-inline">Wu SL, Henry JM, Citron DT, Ssebuliba DM, Nsumba JN, C HMS, et al. Spatial dynamics of malaria transmission. PLOS Computational Biology. 2023;19: e1010684. doi:<a href="https://doi.org/10.1371/journal.pcbi.1010684">10.1371/journal.pcbi.1010684</a></div>
</div>
<div id="ref-RossR1905LogicalBasis" class="csl-entry">
<div class="csl-left-margin">16. </div><div class="csl-right-inline">Ross R. The logical basis of the sanitary policy of mosquito reduction. Science. 1905;22: 689–699. doi:<a href="https://doi.org/10.1126/science.22.570.689">10.1126/science.22.570.689</a></div>
</div>
<div id="ref-RossR1908" class="csl-entry">
<div class="csl-left-margin">17. </div><div class="csl-right-inline">Ross R. Report on the <span>Prevention</span> of <span>Malaria</span> in <span>Mauritius</span>. London: Waterlow; 1908. </div>
</div>
<div id="ref-RossR1897PeculiarPigmented" class="csl-entry">
<div class="csl-left-margin">18. </div><div class="csl-right-inline">Ross R. On some peculiar pigmented cells found in two mosquitos fed on malarial blood. British medical journal. 1897;2: 1786–1788. Available: <a href="http://www.bmj.com/content/2/1929/1786.full.pdf">http://www.bmj.com/content/2/1929/1786.full.pdf</a></div>
</div>
<div id="ref-RossR1898RoleMosquito" class="csl-entry">
<div class="csl-left-margin">19. </div><div class="csl-right-inline">Ross R. The role of the mosquito in the evolution of the malarial parasite. Lancet. 1898;152: 488–490. Available: <a href="https://scholar.archive.org/work/vejsrzltgva5nmudubd5oebje4/access/ia_file/crossref-pre-1909-scholarly-works/10.1016%252Fs0140-6736%252801%252981394-5.zip/10.1016%252Fs0140-6736%252801%252981400-8.pdf">https://scholar.archive.org/work/vejsrzltgva5nmudubd5oebje4/access/ia_file/crossref-pre-1909-scholarly-works/10.1016%252Fs0140-6736%252801%252981394-5.zip/10.1016%252Fs0140-6736%252801%252981400-8.pdf</a></div>
</div>
<div id="ref-GrassiB1898UlterioriRicerche" class="csl-entry">
<div class="csl-left-margin">20. </div><div class="csl-right-inline">Grassi B, Bastianelli G, Bignami A. Ulteriori ricerche sul ciclo dei parassiti malarici umani sul corpo del zanzarone. Rend Acad Lincei. 1898. </div>
</div>
<div id="ref-GrassiB1901StudiDi" class="csl-entry">
<div class="csl-left-margin">21. </div><div class="csl-right-inline">Grassi B. Studi di uno zoologo sulla malaria. Roma : R. Accademia dei lincei,; 1901. doi:<a href="https://doi.org/10.5962/bhl.title.37999">10.5962/bhl.title.37999</a></div>
</div>
<div id="ref-Laveran1880" class="csl-entry">
<div class="csl-left-margin">22. </div><div class="csl-right-inline">Laveran A. Note sur un nouveau parasite dans le sang de plusieurs malades atteints de fièvre palustre. Note communiquée a l’Académie de Medicine, seance du. 1880;23. </div>
</div>
<div id="ref-Laveran1884" class="csl-entry">
<div class="csl-left-margin">23. </div><div class="csl-right-inline">Laveran A. Traité des fièvres palustres. Octave Doin; 1884. </div>
</div>
<div id="ref-GarnhamPCC1988HistoryDiscoveries" class="csl-entry">
<div class="csl-left-margin">24. </div><div class="csl-right-inline">Garnham PCC. History of <span>Discoveries</span> of <span>Malaria</span> <span>Parasites</span> and of <span>Their</span> <span>Life</span> <span>Cycles</span>. History and Philosophy of the Life Sciences. 1988;10: 93–108. Available: <a href="https://www.jstor.org/stable/23329001">https://www.jstor.org/stable/23329001</a></div>
</div>
<div id="ref-ShorttHE1948PreerythrocyticStage" class="csl-entry">
<div class="csl-left-margin">25. </div><div class="csl-right-inline">Shortt HE, Garnham PCC. The pre-erythrocytic stage of human malaria, <span>Plasmodium</span> vivax. Br Med J. 1948;1: 547. doi:<a href="https://doi.org/10.1136/bmj.1.4550.547">10.1136/bmj.1.4550.547</a></div>
</div>
<div id="ref-Dempster1848SpleenRate" class="csl-entry">
<div class="csl-left-margin">26. </div><div class="csl-right-inline">Dempster TE. Notes on the <span>Application</span> of the <span>Test</span> of <span>Organic</span> <span>Disease</span> of the <span>Spleen</span>, as an <span>Easy</span> and <span>Certain</span> <span>Method</span> of <span>Detecting</span> <span>Malarious</span> <span>Localities</span> in <span>Hot</span> <span>Climates</span>. Wm. H. Haycock, Secundra Orphan Press; 1848. Available: <a href="https://play.google.com/store/books/details?id=3j9pAAAAcAAJ">https://play.google.com/store/books/details?id=3j9pAAAAcAAJ</a></div>
</div>
<div id="ref-Bruce-ChwattLJ1988HistoryMalaria" class="csl-entry">
<div class="csl-left-margin">27. </div><div class="csl-right-inline">Bruce-Chwatt LJ. History of malaria from prehistory to eradication. In: Wernsdorfer WH, McGregor IA, editors. Malaria: <span>Principles</span> and <span>Practice</span> of <span>Malariology</span>. New York: Churchill Livingstone; 1988. pp. 1–59. Available: <a href="http://www.cabdirect.org/abstracts/19900861468.html">http://www.cabdirect.org/abstracts/19900861468.html</a></div>
</div>
<div id="ref-ServiceMW1978ShortHistory" class="csl-entry">
<div class="csl-left-margin">28. </div><div class="csl-right-inline">Service MW. A short history of early medical entomology. Journal of Medical Entomology. 1978;14: 603–626. Available: <a href="http://eutils.ncbi.nlm.nih.gov/entrez/eutils/elink.fcgi?dbfrom=pubmed&amp;id=357723&amp;retmode=ref&amp;cmd=prlinks">http://eutils.ncbi.nlm.nih.gov/entrez/eutils/elink.fcgi?dbfrom=pubmed&amp;id=357723&amp;retmode=ref&amp;cmd=prlinks</a></div>
</div>
<div id="ref-CoxFEG2010HistoryDiscovery" class="csl-entry">
<div class="csl-left-margin">29. </div><div class="csl-right-inline">Cox FEG. History of the discovery of the malaria parasites and their vectors. Parasit Vectors. 2010;3: 5. doi:<a href="https://doi.org/10.1186/1756-3305-3-5">10.1186/1756-3305-3-5</a></div>
</div>
<div id="ref-RossR1903ThickFilm" class="csl-entry">
<div class="csl-left-margin">30. </div><div class="csl-right-inline">Ross R. The thick film process for the detection of organisms in the blood. Liverpool, United Kingdom: University Press of Liverpool; 1903 Jun. </div>
</div>
<div id="ref-RossR1903ImprovedMethod" class="csl-entry">
<div class="csl-left-margin">31. </div><div class="csl-right-inline">Ross R. An improved method for the microscopical diagnosis of intermittent fever. The Lancet. 1903;161: 86. Available: <a href="http://scholar.google.com/scholar?q=related:G2VdXAzaHkoJ:scholar.google.com/&amp;hl=en&amp;num=30&amp;as_sdt=0,5">http://scholar.google.com/scholar?q=related:G2VdXAzaHkoJ:scholar.google.com/&amp;hl=en&amp;num=30&amp;as_sdt=0,5</a></div>
</div>
<div id="ref-RossR1911Nature" class="csl-entry">
<div class="csl-left-margin">32. </div><div class="csl-right-inline">Ross R. Some quantitative studies in epidemiology. Nature. 1911;87: 466–467. </div>
</div>
<div id="ref-BoydMF1949MalariologyComprehensive" class="csl-entry">
<div class="csl-left-margin">33. </div><div class="csl-right-inline">Boyd MF, editor. Malariology. <span>A</span> <span>Comprehensive</span> <span>Survey</span> of all <span>Aspects</span> of this <span>Group</span> of <span>Diseases</span> from a <span>Global</span> <span>Standpoint</span>. Philadelphia, Pa.; London,: W. B. Saunders Co.; 1949. Available: <a href="https://www.cabdirect.org/cabdirect/abstract/19501000283">https://www.cabdirect.org/cabdirect/abstract/19501000283</a></div>
</div>
<div id="ref-WernsdorferWH1988MalariaPrinciples" class="csl-entry">
<div class="csl-left-margin">34. </div><div class="csl-right-inline">Wernsdorfer WH, McGregor IA, editors. Malaria: <span>Principles</span> and <span>Practice</span> of <span>Malariology</span>. New York: Churchill Livingstone; 1988. Available: <a href="http://www.worldcat.org/title/malaria-principles-and-practice-of-malariology/oclc/15793746">http://www.worldcat.org/title/malaria-principles-and-practice-of-malariology/oclc/15793746</a></div>
</div>
<div id="ref-RossR1899ExterminationMalaria" class="csl-entry">
<div class="csl-left-margin">35. </div><div class="csl-right-inline">Ross R. Extermination of <span>Malaria</span>. Ind Med Gaz. 1899;34: 231–232. Available: <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC5145409/">https://www.ncbi.nlm.nih.gov/pmc/articles/PMC5145409/</a></div>
</div>
<div id="ref-RossR1899InauguralLecture" class="csl-entry">
<div class="csl-left-margin">36. </div><div class="csl-right-inline">Ross R. Inaugural <span>Lecture</span> on the <span>Possibility</span> of <span>Extirpating</span> <span>Malaria</span> from <span>Certain</span> <span>Localities</span> by a <span>New</span> <span>Method</span>. British medical journal. 1899;2: 1–4. Available: <a href="http://eutils.ncbi.nlm.nih.gov/entrez/eutils/elink.fcgi?dbfrom=pubmed&amp;id=20758555&amp;retmode=ref&amp;cmd=prlinks">http://eutils.ncbi.nlm.nih.gov/entrez/eutils/elink.fcgi?dbfrom=pubmed&amp;id=20758555&amp;retmode=ref&amp;cmd=prlinks</a></div>
</div>
<div id="ref-RossR1902MosquitoBrigades" class="csl-entry">
<div class="csl-left-margin">37. </div><div class="csl-right-inline">Ross R. Mosquito brigades and how to organise them. London: George Philip &amp; Son; 1902. </div>
</div>
<div id="ref-LotkaAJ1923part1" class="csl-entry">
<div class="csl-left-margin">38. </div><div class="csl-right-inline">Lotka AJ. Contribution to the <span>Analysis</span> of <span>Malaria</span> <span>Epidemiology</span>. <span>I</span>. <span>General</span> <span>Part</span>. American Journal of Epidemiology. 1923;3: 1–36. doi:<a href="https://doi.org/10.1093/oxfordjournals.aje.a118963">10.1093/oxfordjournals.aje.a118963</a></div>
</div>
<div id="ref-LotkaAJ1923part2" class="csl-entry">
<div class="csl-left-margin">39. </div><div class="csl-right-inline">Lotka AJ. Contribution to the <span>Analysis</span> of <span>Malaria</span> <span>Epidemiology</span>. <span>II</span>. <span>General</span> <span>Part</span> (continued). <span>Comparison</span> of <span>Two</span> <span>Formulae</span> given by <span>Sir</span> <span>Ronald</span> <span>Ross</span>. American Journal of Epidemiology. 1923;3: 38–54. doi:<a href="https://doi.org/10.1093/oxfordjournals.aje.a118965">10.1093/oxfordjournals.aje.a118965</a></div>
</div>
<div id="ref-LotkaAJ1923part3" class="csl-entry">
<div class="csl-left-margin">40. </div><div class="csl-right-inline">Lotka AJ. Contribution to the <span>Analysis</span> of <span>Malaria</span> <span>Epidemiology</span>. <span>III</span>. <span>Numerical</span> <span>Part</span>. American Journal of Epidemiology. 1923;3: 55–95. doi:<a href="https://doi.org/10.1093/oxfordjournals.aje.a118966">10.1093/oxfordjournals.aje.a118966</a></div>
</div>
<div id="ref-LotkaAJ1923part5" class="csl-entry">
<div class="csl-left-margin">41. </div><div class="csl-right-inline">Lotka AJ. Contribution to the <span>Analysis</span> of <span>Malaria</span> <span>Epidemiology</span>. <span>V</span>. <span>Summary</span>. American Journal of Epidemiology. 1923;3: 113–121. doi:<a href="https://doi.org/10.1093/oxfordjournals.aje.a118964">10.1093/oxfordjournals.aje.a118964</a></div>
</div>
<div id="ref-MacdonaldG1952Sporozoite" class="csl-entry">
<div class="csl-left-margin">42. </div><div class="csl-right-inline">Macdonald G. The analysis of the sporozoite rate. Trop Dis Bull. 1952;49: 569–586. Available: <a href="https://www.ncbi.nlm.nih.gov/pubmed/14958825">https://www.ncbi.nlm.nih.gov/pubmed/14958825</a></div>
</div>
<div id="ref-MacdonaldG1952R0" class="csl-entry">
<div class="csl-left-margin">43. </div><div class="csl-right-inline">Macdonald G. The analysis of equilibrium in malaria. Trop Dis Bull. 1952;49: 813–829. Available: <a href="https://www.ncbi.nlm.nih.gov/pubmed/12995455">https://www.ncbi.nlm.nih.gov/pubmed/12995455</a></div>
</div>
<div id="ref-BockarieMJ1999ItAll" class="csl-entry">
<div class="csl-left-margin">44. </div><div class="csl-right-inline">Bockarie MJ, Gbakima AA, Barnish G. It all began with <span>Ronald</span> <span>Ross</span>: 100 years of malaria research and control in <span>Sierra</span> <span>Leone</span> (1899–1999). Ann Trop Med Parasitol. 1999;93: 213–224. doi:<a href="https://doi.org/10.1080/00034983.1999.11813416">10.1080/00034983.1999.11813416</a></div>
</div>
<div id="ref-RossR1907PreventionMalaria" class="csl-entry">
<div class="csl-left-margin">45. </div><div class="csl-right-inline">Ross R. The prevention of malaria in <span>British</span> possessions, <span>Egypt</span>, and parts of <span>America</span>. The Lancet. 1907; 879–887. </div>
</div>
<div id="ref-RossR1909" class="csl-entry">
<div class="csl-left-margin">46. </div><div class="csl-right-inline">Ross R. Malaria in <span>Greece</span>. Washington, DC: Government Printing Office; 1909 pp. 697–710. </div>
</div>
<div id="ref-RossR1915AprioriPathometry" class="csl-entry">
<div class="csl-left-margin">47. </div><div class="csl-right-inline">Ross R. Some <em>a priori</em> pathometric equations. Br Med J. 1915;i: 546–547. doi:<a href="https://doi.org/10.1136/bmj.1.2830.546">10.1136/bmj.1.2830.546</a></div>
</div>
<div id="ref-RossR1916ApplicationTheory" class="csl-entry">
<div class="csl-left-margin">48. </div><div class="csl-right-inline">Ross R. An application of the theory of probabilities to the study of <em>a priori</em> pathometry. <span>Part</span> <span>I</span>. Proceedings of the Royal Society A: Mathematical, Physical and Engineering Science. 1916;92: 204–230. </div>
</div>
<div id="ref-BernoulliD2004AttemptNew" class="csl-entry">
<div class="csl-left-margin">49. </div><div class="csl-right-inline">Bernoulli D, Blower S. An attempt at a new analysis of the mortality caused by smallpox and of the advantages of inoculation to prevent it. Rev Med Virol. 2004;14: 275–288. Available: <a href="https://www.ingentaconnect.com/content/jws/rmv/2004/00000014/00000005/art00002?crawler=true">https://www.ingentaconnect.com/content/jws/rmv/2004/00000014/00000005/art00002?crawler=true</a></div>
</div>
<div id="ref-BacaerN2011DanielBernoulli" class="csl-entry">
<div class="csl-left-margin">50. </div><div class="csl-right-inline">Bacaër N. Daniel <span>Bernoulli</span>, d’<span>Alembert</span> and the inoculation of smallpox (1760). A short history of mathematical population dynamics. Springer; 2011. pp. 21–30. Available: <a href="https://link.springer.com/chapter/10.1007/978-0-85729-115-8_4">https://link.springer.com/chapter/10.1007/978-0-85729-115-8_4</a></div>
</div>
<div id="ref-DietzK1988FirstEpidemic" class="csl-entry">
<div class="csl-left-margin">51. </div><div class="csl-right-inline">Dietz K. The first epidemic model: A historical note on <span>PD</span> <span>En</span>’ko. Aust J Stat. 1988;30A: 56–65. doi:<a href="https://doi.org/10.1111/j.1467-842X.1988.tb00464.x">10.1111/j.1467-842X.1988.tb00464.x</a></div>
</div>
<div id="ref-RossR1917AprioriPathometry2" class="csl-entry">
<div class="csl-left-margin">52. </div><div class="csl-right-inline">Ross R, Hudson HP. An application of the theory of probabilities to the study of <em>a priori</em> pathometry. <span>Part</span> <span>II</span>. Proceedings of the Royal Society of London Series a-Mathematical Physical and Engineering Sciences. 1917;93: 212–225. </div>
</div>
<div id="ref-RossR1917AprioriPathometry3" class="csl-entry">
<div class="csl-left-margin">53. </div><div class="csl-right-inline">Ross R, Hudson H. An application of the theory of probabilities to the study of <em>a priori</em> pathometry. <span>Part</span> <span>III</span>. Proceedings of the Royal Society A: Mathematical, Physical and Engineering Science. 1917;93: 225–240. Available: <a href="http://adsabs.harvard.edu/abs/1917RSPSA..93..225R">http://adsabs.harvard.edu/abs/1917RSPSA..93..225R</a></div>
</div>
<div id="ref-LotkaAJ1912Nature" class="csl-entry">
<div class="csl-left-margin">54. </div><div class="csl-right-inline">Lotka AJ. Quantitative <span>Studies</span> in <span>Epidemiology</span>. Nature. 1912;88: 497–498. doi:<a href="https://doi.org/10.1038/088497b0">10.1038/088497b0</a></div>
</div>
<div id="ref-FinePEM1975SuperinfectionProblem" class="csl-entry">
<div class="csl-left-margin">55. </div><div class="csl-right-inline">Fine PEM. Superinfection - a problem in formulating a problem. Tropical Diseases Bulletin. 1975;75: 475–488. </div>
</div>
<div id="ref-FinePEM1975RossPriori" class="csl-entry">
<div class="csl-left-margin">56. </div><div class="csl-right-inline">Fine PEM. Ross’s a priori pathometry - a perspective. Proc R Soc Med. 1975;68: 547–551. Available: <a href="http://www.ncbi.nlm.nih.gov/entrez/query.fcgi?cmd=Retrieve&amp;db=PubMed&amp;dopt=Citation&amp;list_uids=1105597">http://www.ncbi.nlm.nih.gov/entrez/query.fcgi?cmd=Retrieve&amp;db=PubMed&amp;dopt=Citation&amp;list_uids=1105597</a></div>
</div>
<div id="ref-BaileyNTJ1982BiomathematicsMalaria" class="csl-entry">
<div class="csl-left-margin">57. </div><div class="csl-right-inline">Bailey NTJ. The <span>Biomathematics</span> of <span>Malaria</span>. Oxford: Charles Griffin &amp; Company Ltd.; 1982. Available: <a href="https://play.google.com/store/books/details?id=4MCAQgAACAAJ">https://play.google.com/store/books/details?id=4MCAQgAACAAJ</a></div>
</div>
<div id="ref-AronJL1982PopulationDynamics" class="csl-entry">
<div class="csl-left-margin">58. </div><div class="csl-right-inline">Aron JL, May RM. The population dynamics of malaria. In: Anderson RM, editor. The <span>Population</span> <span>Dynamics</span> of <span>Infectious</span> <span>Diseases</span>: <span>Theory</span> and <span>Applications</span>. Boston, MA: Springer US; 1982. pp. 139–179. doi:<a href="https://doi.org/10.1007/978-1-4899-2901-3_5">10.1007/978-1-4899-2901-3_5</a></div>
</div>
<div id="ref-MacdonaldG1950Epidemiology" class="csl-entry">
<div class="csl-left-margin">59. </div><div class="csl-right-inline">Macdonald G. The analysis of malaria parasite rates in infants. Tropical diseases bulletin. 1950;47: 915–938. </div>
</div>
<div id="ref-MacdonaldG1950Superinfection" class="csl-entry">
<div class="csl-left-margin">60. </div><div class="csl-right-inline">Macdonald G. The analysis of infection rates in diseases in which superinfection occurs. Trop Dis Bull. 1950;47: 907–915. Available: <a href="https://www.ncbi.nlm.nih.gov/pubmed/14798656">https://www.ncbi.nlm.nih.gov/pubmed/14798656</a></div>
</div>
<div id="ref-ArmitageP1953" class="csl-entry">
<div class="csl-left-margin">61. </div><div class="csl-right-inline">Armitage P. A note on the epidemiology of malaria. Trop Dis Bull. 1953;50: 890–892. </div>
</div>
<div id="ref-MacdonaldG1955MeasurementMalaria" class="csl-entry">
<div class="csl-left-margin">62. </div><div class="csl-right-inline">Macdonald G. The measurement of malaria transmission. Proceedings of the Royal Society of Medicine. 1955;48: 295–302. </div>
</div>
<div id="ref-MacdonaldG1956EpidemiologicalBasis" class="csl-entry">
<div class="csl-left-margin">63. </div><div class="csl-right-inline">Macdonald G. Epidemiological basis of malaria control. Bull World Health Organ. 1956;15: 613–626. Available: <a href="https://www.ncbi.nlm.nih.gov/pubmed/13404439">https://www.ncbi.nlm.nih.gov/pubmed/13404439</a></div>
</div>
<div id="ref-MacdonaldG1956TheoryEradication" class="csl-entry">
<div class="csl-left-margin">64. </div><div class="csl-right-inline">Macdonald G. Theory of the eradication of malaria. Bull World Health Organ. 1956;15: 369–387. Available: <a href="https://www.ncbi.nlm.nih.gov/pubmed/13404426">https://www.ncbi.nlm.nih.gov/pubmed/13404426</a></div>
</div>
<div id="ref-MacdonaldG1957Book" class="csl-entry">
<div class="csl-left-margin">65. </div><div class="csl-right-inline">Macdonald G. The epidemiology and control of malaria. Oxford university press; 1957. Available: <a href="https://www.cabdirect.org/cabdirect/abstract/19582900392">https://www.cabdirect.org/cabdirect/abstract/19582900392</a></div>
</div>
<div id="ref-LotkaAJ1923part4" class="csl-entry">
<div class="csl-left-margin">66. </div><div class="csl-right-inline">Sharpe FR, Lotka AJ. Contribution to the <span>Analysis</span> of <span>Malaria</span> <span>Epidemiology</span>. <span>IV</span>. <span>Incubation</span> lag. American Journal of Epidemiology. 1923;3: 96–112. doi:<a href="https://doi.org/10.1093/oxfordjournals.aje.a118967">10.1093/oxfordjournals.aje.a118967</a></div>
</div>
<div id="ref-WaiteH1910MosquitoesMalaria" class="csl-entry">
<div class="csl-left-margin">67. </div><div class="csl-right-inline">Waite H. Mosquitoes and malaria. <span>A</span> study of the relation between the number of mosquitoes in a locality and the malaria rate. Biometrika. 1910;7: 421–436. doi:<a href="https://doi.org/10.2307/2345376">10.2307/2345376</a></div>
</div>
<div id="ref-NajeraJA1974CriticalReview" class="csl-entry">
<div class="csl-left-margin">68. </div><div class="csl-right-inline">Nájera JA. A critical review of the field application of a mathematical model of malaria eradication. Bull World Health Organ. 1974;50: 449–457. Available: <a href="http://www.ncbi.nlm.nih.gov/entrez/query.fcgi?cmd=Retrieve&amp;db=PubMed&amp;dopt=Citation&amp;list_uids=4156197">http://www.ncbi.nlm.nih.gov/entrez/query.fcgi?cmd=Retrieve&amp;db=PubMed&amp;dopt=Citation&amp;list_uids=4156197</a></div>
</div>
<div id="ref-DietzK1974GarkiModel" class="csl-entry">
<div class="csl-left-margin">69. </div><div class="csl-right-inline">Dietz K, Molineaux L, Thomas A. A malaria model tested in the <span>African</span> savannah. Bull World Health Organ. 1974;50: 347–357. Available: <a href="http://www.ncbi.nlm.nih.gov/entrez/query.fcgi?cmd=Retrieve&amp;db=PubMed&amp;dopt=Citation&amp;list_uids=4613512">http://www.ncbi.nlm.nih.gov/entrez/query.fcgi?cmd=Retrieve&amp;db=PubMed&amp;dopt=Citation&amp;list_uids=4613512</a></div>
</div>
<div id="ref-SmithDL2004Statics" class="csl-entry">
<div class="csl-left-margin">70. </div><div class="csl-right-inline">Smith DL, McKenzie FE. Statics and dynamics of malaria infection in <span>Anopheles</span> mosquitoes. Malaria Journal. 2004;3: 13. doi:<a href="https://doi.org/10.1186/1475-2875-3-13">10.1186/1475-2875-3-13</a></div>
</div>
<div id="ref-HackettLW1937MalariaEurope" class="csl-entry">
<div class="csl-left-margin">71. </div><div class="csl-right-inline">Hackett LW. Malaria in <span>Europe</span>. London, Oxford University Press; 1937. </div>
</div>
<div id="ref-DietzK1975ModelsParasitic" class="csl-entry">
<div class="csl-left-margin">72. </div><div class="csl-right-inline">Dietz K. Models for parasitic disease control. Bull Int Stat Inst. 1975;46: 531–544. </div>
</div>
<div id="ref-DietzK1976Seasonality" class="csl-entry">
<div class="csl-left-margin">73. </div><div class="csl-right-inline">Dietz K. The incidence of infectious diseases under the influence of seasonal fluctuations. In: Berger J, Bühler WJ, Repges R, Tautu P, editors. Mathematical models in medicine. Berlin, Heidelberg: Springer Berlin Heidelberg; 1976. pp. 1–15. </div>
</div>
<div id="ref-DietzK1980ModelsVectorborne" class="csl-entry">
<div class="csl-left-margin">74. </div><div class="csl-right-inline">Dietz K. Models for vector-borne parasitic diseases. In: Barigozzi C, Levin SA, editors. Vito <span>Volterra</span> <span>Symposium</span> on <span>Mathematical</span> <span>Models</span> in biology. Berlin: Springer-Verlag; 1980. pp. 264–277. </div>
</div>
<div id="ref-DietzK1988EpidemiologicalModels" class="csl-entry">
<div class="csl-left-margin">75. </div><div class="csl-right-inline">Dietz K, Hadeler KP. Epidemiological models for sexually transmitted diseases. J Math Biol. 1988;26: 1–25. Available: <a href="https://www.ncbi.nlm.nih.gov/pubmed/3351391">https://www.ncbi.nlm.nih.gov/pubmed/3351391</a></div>
</div>
<div id="ref-DyeC1986PopulationDynamics" class="csl-entry">
<div class="csl-left-margin">76. </div><div class="csl-right-inline">Dye C, Hasibeder G. Population dynamics of mosquito-borne disease: Effects of flies which bite some people more frequently than others. Trans R Soc Trop Med Hyg. 1986;80: 69–77. doi:<a href="https://doi.org/10.1016/0035-9203(86)90199-9">10.1016/0035-9203(86)90199-9</a></div>
</div>
<div id="ref-HasibederG1988PopulationDynamics" class="csl-entry">
<div class="csl-left-margin">77. </div><div class="csl-right-inline">Hasibeder G, Dye C. Population dynamics of mosquito-borne disease: Persistence in a completely heterogeneous environment. Theor Popul Biol. 1988;33: 31–53. doi:<a href="https://doi.org/10.1016/0040-5809(88)90003-2">10.1016/0040-5809(88)90003-2</a></div>
</div>
<div id="ref-MolineauxL2001PlasmodiumFalciparum" class="csl-entry">
<div class="csl-left-margin">78. </div><div class="csl-right-inline">Molineaux L, Diebner HH, Eichner M, Collins WE, Jeffery GM, Dietz K. <em><span>Plasmodium</span> falciparum</em> parasitaemia described by a new mathematical model. Parasitology. 2001;122: 379–391. doi:<a href="https://doi.org/10.1017/s0031182001007533">10.1017/s0031182001007533</a></div>
</div>
<div id="ref-MacdonaldG1964MalariaParasite" class="csl-entry">
<div class="csl-left-margin">79. </div><div class="csl-right-inline">Macdonald G, Goeckel GW. The malaria parasite rate and interruption of transmission. Bull World Health Organ. 1964;31: 365–377. Available: <a href="https://www.ncbi.nlm.nih.gov/pubmed/14267746">https://www.ncbi.nlm.nih.gov/pubmed/14267746</a></div>
</div>
<div id="ref-SmithDL2009EndemicityResponse" class="csl-entry">
<div class="csl-left-margin">80. </div><div class="csl-right-inline">Smith DL, Hay SI. Endemicity response timelines for <em><span>Plasmodium</span> falciparum</em> elimination. Malaria Journal. 2009;8: 87. doi:<a href="https://doi.org/10.1186/1475-2875-8-87">10.1186/1475-2875-8-87</a></div>
</div>
<div id="ref-WaltonGA1947ControlMalaria" class="csl-entry">
<div class="csl-left-margin">81. </div><div class="csl-right-inline">Walton GA. On the control of malaria in <span>Freetown</span>, <span>Sierra</span> <span>Leone</span>; <span>I</span>. <em><span>Plasmodium</span> falciparum</em> and <em><span>Anopheles</span> gambiae</em> in relation to malaria occurring in infants. Ann Trop Med Parasitol. 1947;41: 380–407. doi:<a href="https://doi.org/10.1080/00034983.1947.11685341">10.1080/00034983.1947.11685341</a></div>
</div>
<div id="ref-HenryJM2020HybridModel" class="csl-entry">
<div class="csl-left-margin">82. </div><div class="csl-right-inline">Henry JM. A hybrid model for the effects of treatment and demography on malaria superinfection. Journal of Theoretical Biology. 2020;491: 110194. doi:<a href="https://doi.org/10.1016/j.jtbi.2020.110194">10.1016/j.jtbi.2020.110194</a></div>
</div>
<div id="ref-BradyOJ2015AdultVector" class="csl-entry">
<div class="csl-left-margin">83. </div><div class="csl-right-inline">Brady OJ, Godfray HCJ, Tatem AJ, Gething PW, Cohen JM, McKenzie FE, et al. Adult vector control, mosquito ecology and malaria transmission. International Health. 2015;7: 121–129. doi:<a href="https://doi.org/10.1093/inthealth/ihv010">10.1093/inthealth/ihv010</a></div>
</div>
<div id="ref-SmithDL2013LarvalDynamics" class="csl-entry">
<div class="csl-left-margin">84. </div><div class="csl-right-inline">Smith DL, Perkins TA, Tusting LS, Scott TW, Lindsay SW. Mosquito <span>Population</span> <span>Regulation</span> and <span>Larval</span> <span>Source</span> <span>Management</span> in <span>Heterogeneous</span> <span>Environments</span>. PLOS ONE. 2013;8: e71247. doi:<a href="https://doi.org/10.1371/journal.pone.0071247">10.1371/journal.pone.0071247</a></div>
</div>
<div id="ref-HaySI2008MeasuringMalaria" class="csl-entry">
<div class="csl-left-margin">85. </div><div class="csl-right-inline">Hay SI, Smith DL, Snow RW. Measuring malaria endemicity from intense to interrupted transmission. Lancet Infect Dis. 2008;8: 369–378. doi:<a href="https://doi.org/10.1016/S1473-3099(08)70069-0">10.1016/S1473-3099(08)70069-0</a></div>
</div>
</div>
</div>
<div class="footnotes footnotes-end-of-document">
<hr />
<ol>
<li id="fn1"><p>The narrative in this book is often historical, which serves two purposes.
First, it provides an excuse to cite and discuss old papers that should not get overlooked.
Second, a historical narrative allows us to introduce malaria complexity in an ordered way, starting from principles that are simple and abstract, and progressing towards ideas that are non-linear, messy, or subtle.
We will often use history as a way of structuring discussions, even as our attention turns increasingly to the mathematics we need to deal with the biological complexity of malaria in populations.<a href="#fnref1" class="footnote-back">↩︎</a></p></li>
<li id="fn2"><p>In developing this book, we assumed the reader would be familiar with R and RStudio.<a href="#fnref2" class="footnote-back">↩︎</a></p></li>
<li id="fn3"><p>In a broader sense, stratification is also about subdividing landscapes into a set of spatial domains that share relevant features in order to <em>tailor interventions to context.</em> That is a topic we take up in a separate book, (<a target="_blank" href = "/Users/smitdave/git/RAMP-Book/_book/index.html"> <strong>Robust Analytics for Malaria Policy.</strong> </a>).<a href="#fnref3" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
<!--bookdown:body:end-->
            </section>

          </div>
        </div>
      </div>
<!--bookdown:link_prev-->
<!--bookdown:link_next-->
    </div>
  </div>
<!--bookdown:config-->

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
